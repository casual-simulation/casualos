{"version":2,"updates":[{"id":0,"timestamp":1681824654760,"update":"AYwB/IalhwMAJwEEYm90cyQxNzQxMGQ4My03ZWVlLTRhMWUtYjYzOC02NTQ2Mzc0ZDE3YzMBJwD8hqWHAwAGc3lzdGVtAgQA/IalhwMBE2FiLTEuaW50ZXJmYWNlLnNjYW4nAPyGpYcDAARmb3JtAgQA/IalhwMVB25vdGhpbmcnAPyGpYcDAAxhYjFJbnRlcmZhY2UCBAD8hqWHAx0EdHJ1ZScA/IalhwMACWFiMUlnbm9yZQIEAPyGpYcDIgR0cnVlKAD8hqWHAwANYWIxQm90VmVyc2lvbgF9DicA/IalhwMAD29uUVJDb2RlU2Nhbm5lZAIEAPyGpYcDKJMNQGlmICghYnVpbGRlclZlcnNpb24pCnsKICAgIHJldHVybjsKfQoKYWIxLmxvZygiYWItMSBzY2FuIiArIHRoYXQpOwoKaWYgKGNvbmZpZ0JvdC50YWdzLnV1YWJTY2FuKQp7CiAgICBvcy5jbG9zZVFSQ29kZVNjYW5uZXIoKTsKCiAgICBsaW5rcy5zdG9yZS5hYjFQdWJsaXNoVVVBQih0aGF0KTsKfQplbHNlIGlmIChjb25maWdCb3QudGFncy5wdWJsaXNoU2NhbikKewogICAgb3MuY2xvc2VRUkNvZGVTY2FubmVyKCk7CgogICAgbGlua3Muc3RvcmUuYWIxUVJQdWJsaXNoKHRoYXQpOwp9CmVsc2UgaWYgKGNvbmZpZ0JvdC50YWdzLnByYWN0aWNlUGVybWl0U2NhbikKewogICAgbGV0IHNjYW5uZWRVUkw7CgogICAgY29uZmlnQm90LnRhZ3MucHJhY3RpY2VQZXJtaXRTY2FuID0gbnVsbDsKCiAgICBvcy5jbG9zZVFSQ29kZVNjYW5uZXIoKTsKCiAgICB0cnkKICAgIHsKICAgICAgICBzY2FubmVkVVJMID0gbmV3IFVSTCh0aGF0KTsKICAgIH0KICAgIGNhdGNoIChlKQogICAgewogICAgICAgIG9zLnRvYXN0KCJub3QgYSByZWNvZ25pemVkIHByYWN0aWNlIHBlcm1pdCIpOwoKICAgICAgICBjb25zb2xlLmxvZyhlKTsKCiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGxldCBwaENoZWNrID0gc2Nhbm5lZFVSTC5zZWFyY2hQYXJhbXMuaGFzKCJwaCIpOwogICAgbGV0IGluc3RDaGVjayA9IHNjYW5uZWRVUkwuc2VhcmNoUGFyYW1zLmhhcygiaW5zdCIpOwogICAgbGV0IGFiQ2hlY2sgPSBzY2FubmVkVVJMLnNlYXJjaFBhcmFtcy5oYXMoImFiIik7CiAgICBsZXQgY3dDaGVjayA9IHNjYW5uZWRVUkwuc2VhcmNoUGFyYW1zLmhhcygiY3ciKTsKCiAgICBpZiAocGhDaGVjayAmJiBpbnN0Q2hlY2sgJiYgYWJDaGVjayAmJiBjd0NoZWNrKQogICAgewogICAgICAgIG9zLmdvVG9VUkwodGhhdCk7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgb3MudG9hc3QoIm5vdCBhIHJlY29nbml6ZWQgcHJhY3RpY2UgcGVybWl0Iik7CiAgICB9CgogICAgc2hvdXQoImFiMU1lbnVSZWZyZXNoIik7Cn0KZWxzZSBpZiAoY29uZmlnQm90LnRhZ3MuYWIxU2NhbikKewogICAgc2hvdXQoImFiMU1lbnVSZWZyZXNoIik7CgogICAgY29uZmlnQm90LnRhZ3MuYWIxU2NhbiA9IG51bGw7CiAgICAKICAgIG9zLmNsb3NlUVJDb2RlU2Nhbm5lcigpOwoKICAgIGxldCBzY2FubmVkVVJMOwoKICAgIHRyeSAKICAgIHsKICAgICAgICBzY2FubmVkVVJMID0gbmV3IFVSTCh0aGF0KTsKICAgIH0KICAgIGNhdGNoIChlKSAKICAgIHsKICAgICAgICBsaW5rcy5zZWFyY2guYWIxTFRNU2VhcmNoKHthYklEOiB0aGF0fSk7CgogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZihzY2FubmVkVVJMLnNlYXJjaFBhcmFtcy5nZXQoImFiIikgPT0gImVnZ0NhcnRvbiIpCiAgICB7CiAgICAgICAgb3MuZ29Ub1VSTCh0aGF0KTsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBzY2FubmVkVVJMLnNlYXJjaFBhcmFtcy5mb3JFYWNoKCh2YWx1ZSwga2V5KSA9PiB7CiAgICAgICAgICAgIGxldCBuZXdUYWcgPSBrZXk7CiAgICAgICAgICAgIGxldCBuZXdWYWx1ZSA9IHZhbHVlOwoKICAgICAgICAgICAgY29uZmlnQm90LnRhZ3NbbmV3VGFnXSA9IG5ld1ZhbHVlOwogICAgICAgIH0pOwoKICAgICAgICBsaW5rcy5zZWFyY2guYWIxTFRNU2VhcmNoKHthYklEOiBjb25maWdCb3QudGFncy5hYn0pOwogICAgfQp9JwD8hqWHAwAFc3RvcmUCBAD8hqWHA7wNKPCflJc3NmFmMDQ5MS0zOTE5LTQ5ODQtYWE4Mi0yMmM3NDJmNDI2M2YnAPyGpYcDAAZzZWFyY2gCBAD8hqWHA+MNKPCflJdkODM3MTQ0NC05MTU4LTQ0MzYtOGZjNy04NGNjOTFiN2Y1MjUnAPyGpYcDABFhYjFDb3JlTWVudUFjdGlvbgIEAPyGpYcDig44QG9zLm9wZW5RUkNvZGVTY2FubmVyKCk7Cgpjb25maWdCb3QudGFncy5hYjFTY2FuID0gdHJ1ZTsnAPyGpYcDABBhYjFDb3JlTWVudUxhYmVsAgQA/IalhwPDDgRzY2FuJwD8hqWHAwAPYWIxQ29yZU1lbnVJY29uAgQA/IalhwPIDg9xcl9jb2RlX3NjYW5uZXInAPyGpYcDABRhYjFDb3JlTWVudVNvcnRPcmRlcgIEAPyGpYcD2A4BMycBBGJvdHMkNGFhZjY5OWUtYWJiZi00NGE4LTg1ZTEtNjhjYmI1ZGYwZTFmAScA/IalhwPaDgZzeXN0ZW0CBAD8hqWHA9sOFWFiLTEuaW50ZXJmYWNlLm51Z2dldCcA/IalhwPaDgRmb3JtAgQA/IalhwPxDgdub3RoaW5nJwD8hqWHA9oODGFiMUludGVyZmFjZQIEAPyGpYcD+Q4EdHJ1ZScA/IalhwPaDglhYjFJZ25vcmUCBAD8hqWHA/4OBHRydWUoAPyGpYcD2g4NYWIxQm90VmVyc2lvbgF9DycA/IalhwPaDg1hYjFMb2FkTnVnZ2V0AgQA/IalhwOED5kCQGxldCBudWdnZXROYW1lID0gdGhhdC5udWdnZXROYW1lOwpsZXQgZm9ybWF0dGVkTnVnZ2V0QUIgPSAibnVnXyIrbnVnZ2V0TmFtZTsKbGV0IGxvYWRlZE51Z2dldCA9IGF3YWl0IGxpbmtzLnNlYXJjaC5vbkxvb2t1cEFCMUVnZ3Moe2FiSUQ6IGZvcm1hdHRlZE51Z2dldEFCLCBhYlZlcnNpb246IHRoYXQudmVyc2lvbiwgcmV0dXJuVHlwZTogImRhdGEifSk7Cgpsb2FkZWROdWdnZXQgPSBsb2FkZWROdWdnZXQuc3RhdGVbbnVnZ2V0TmFtZV0ubnVnZ2V0OwoKcmV0dXJuIGxvYWRlZE51Z2dldDsnAPyGpYcD2g4QYWIxUHVibGlzaE51Z2dldAIEAPyGpYcDnhHvAkAvL3Nob3V0KCJhYjFQdWJsaXNoTnVnZ2V0Iiwge251ZzogIm51Z05hbWUiLCBkYXRhOiBkYXRhfSk7ICBBREQgRUdHIElEIEVWRU5UVUFMTFkKbGV0IHRlc3ROdWdnZXQgPSB0aGF0LmRhdGE7CmxldCBmb3JtYXR0ZWROdWdnZXQgPSB7aWQ6IHRoYXQubnVnLCBudWdnZXQ6IHRlc3ROdWdnZXR9OwpsZXQgdGVzdE51Z2dldE5hbWUgPSB0aGF0Lm51ZzsKbGV0IGZvcm1hdHRlZE51Z2dldEFCID0gIm51Z18iK3Rlc3ROdWdnZXROYW1lOwoKbWFza3MubnVnZ2V0VG9QdWJsaXNoID0gZm9ybWF0dGVkTnVnZ2V0QUI7CgpsaW5rcy5zdG9yZS5hYjFQdWJsaXNoQUIoe2FiOiBmb3JtYXR0ZWROdWdnZXRBQiwgdGFyZ2V0OiBmb3JtYXR0ZWROdWdnZXR9KTsnAPyGpYcD2g4PaW1wbGVtZW50TnVnZ2V0AgQA/IalhwOOFLIHQGxldCBudWdnZXROYW1lID0gdGhhdC5udWdnZXQ7CmxldCBudWdnZXRWZXJzaW9uQ2hlY2sgPSBudWdnZXROYW1lLmluZGV4T2YoIi52Iik7CmxldCB2ZXJzaW9uOwoKaWYgKG51Z2dldFZlcnNpb25DaGVjayAhPSAtMSkKewogICAgbnVnZ2V0TmFtZSA9IG51Z2dldE5hbWUuc3Vic3RyaW5nKDAsIG51Z2dldFZlcnNpb25DaGVjayk7CgogICAgbGV0IHZlcnNpb25DaGVjayA9IHRoYXQubnVnZ2V0LnN1YnN0cmluZyhudWdnZXRWZXJzaW9uQ2hlY2sgKyAyKTsKCiAgICBpZiAoaXNOYU4odmVyc2lvbkNoZWNrKSkKICAgIHsKICAgICAgICBjb25zb2xlLmxvZyh2ZXJzaW9uQ2hlY2ssICJ2ZXJzaW9uIGlzIG5vdCBhIG51bWJlciIpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIHZlcnNpb24gPSBOdW1iZXIodmVyc2lvbkNoZWNrKTsKICAgIH0KfQpjb25zb2xlLmxvZyhudWdnZXROYW1lLCB2ZXJzaW9uKTsKbGV0IG51Z0RhdGEgPSBhd2FpdCB0aGlzQm90LmFiMUxvYWROdWdnZXQoe251Z2dldE5hbWU6IG51Z2dldE5hbWUsIHZlcnNpb246IHZlcnNpb259KTsKCmlmIChudWdEYXRhID09ICJhYklEIG5vdCBmb3VuZCIpCnsKICAgIG9zLnRvYXN0KCJudWdnZXQgbm90IGZvdW5kIik7Cn0KZWxzZQp7CiAgICBsZXQgdGFyZ2V0Qm90ID0gZ2V0Qm90KCJpZCIsIHRoYXQuYm90KTsKICAgIGxldCB0YXJnZXRUYWcgPSB0YXJnZXRCb3QucmF3W3RoYXQudGFnXS50b1N0cmluZygpOwogICAgbGV0IHRhcmdldE51ZyA9ICJ7IiArIHRoYXQubnVnZ2V0ICsgIn0iOyAKICAgIGxldCBudWdQb3MgPSB0YXJnZXRUYWcuaW5kZXhPZih0YXJnZXROdWcpOwoKICAgIGRlbGV0ZVRhZ1RleHQodGFyZ2V0Qm90LCB0aGF0LnRhZywgbnVnUG9zLCB0YXJnZXROdWcubGVuZ3RoKTsKICAgIGluc2VydFRhZ1RleHQodGFyZ2V0Qm90LCB0aGF0LnRhZywgbnVnUG9zLCBudWdEYXRhKTsKfScA/IalhwPaDgxudWdnZXRCdXR0b24CBAD8hqWHA8Eb9QxAbGV0IHRhZ1ZhbHVlID0gdGhhdC50YWdWYWx1ZTsKbGV0IHJlZ2V4ID0gL1xuL2dpOwpsZXQgYnJlYWtDaGVjazsKbGV0IGJyZWFrQXJyYXkgPSBbMF07Ci8vbGV0IGNyZWF0ZWRCdXR0b25zID0gW107Cgp3aGlsZSAoYnJlYWtDaGVjayA9IHJlZ2V4LmV4ZWModGFnVmFsdWUpKQp7CiAgICBicmVha0FycmF5LnB1c2goYnJlYWtDaGVjay5pbmRleCk7Cn0KCmxldCBuZXdOdWdnZXRCdXR0b24gPSB7fTsKCm5ld051Z2dldEJ1dHRvbi5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwpuZXdOdWdnZXRCdXR0b24uZm9ybSA9ICJjb2RlQnV0dG9uIjsKbmV3TnVnZ2V0QnV0dG9uLnRhcmdldEJvdCA9IHRoYXQuYm90LmlkOwpuZXdOdWdnZXRCdXR0b24udGFyZ2V0VGFnID0gdGhhdC50YWc7Cm5ld051Z2dldEJ1dHRvbi5sYWJlbCA9ICJsb2FkIG51Z2dldCI7Cm5ld051Z2dldEJ1dHRvbi5udWdnZXRSZXNldCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKbmV3TnVnZ2V0QnV0dG9uW3RoYXQuYm90LmlkICsgIi4iICsgdGhhdC50YWddID0gdHJ1ZTsKbmV3TnVnZ2V0QnV0dG9uLm51Z2dldE1hbmFnZXIgPSAi8J+UlyIgKyB0aGlzQm90LmlkOwpuZXdOdWdnZXRCdXR0b24ub25DbGljayA9IGBAIGxpbmtzLm51Z2dldE1hbmFnZXIuaW1wbGVtZW50TnVnZ2V0KHtib3Q6IHRhZ3MudGFyZ2V0Qm90LCBudWdnZXQ6IHRhZ3MudGFyZ2V0TnVnZ2V0LCB0YWc6IHRhZ3MudGFyZ2V0VGFnfSk7CgpkZXN0cm95KHRoaXNCb3QpO2A7Cgpmb3IgKGxldCBudWdzID0gMDsgbnVncyA8IHRoYXQubnVnZ2V0Lmxlbmd0aDsgbnVncysrKQp7CiAgICBsZXQgY3VycmVudE51Z2dldCA9IHRoYXQubnVnZ2V0W251Z3NdOwogICAgLy9sZXQgYnV0dG9uQ2hlY2sgPSBjcmVhdGVkQnV0dG9ucy5pbmRleE9mKGN1cnJlbnROdWdnZXQubnVnTmFtZSk7CgogICAgaWYgKCFjdXJyZW50TnVnZ2V0IHx8IGN1cnJlbnROdWdnZXQgPT0gdW5kZWZpbmVkKSAvL3x8IGJ1dHRvbkNoZWNrICE9IC0xCiAgICB7CiAgICAgICAgY29udGludWU7CiAgICB9CgogICAgaWYgKGN1cnJlbnROdWdnZXQubnVnUHVibGlzaCkKICAgIHsKICAgICAgICBuZXdOdWdnZXRCdXR0b24ub25DbGljayA9IGBAIGxpbmtzLm51Z2dldE1hbmFnZXIucGFja2FnZU51Z2dldCh7Ym90OiB0YWdzLnRhcmdldEJvdCwgbnVnZ2V0OiB0YWdzLnRhcmdldE51Z2dldCwgdGFnOiB0YWdzLnRhcmdldFRhZ30pOwoKICAgICAgICBkZXN0cm95KHRoaXNCb3QpO2A7CgogICAgICAgIG5ld051Z2dldEJ1dHRvbi5sYWJlbCA9ICJwdWJsaXNoICIgKyBjdXJyZW50TnVnZ2V0Lm51Z05hbWUgKyAiIG51Z2dldCI7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbmV3TnVnZ2V0QnV0dG9uLmxhYmVsID0gImxvYWQgIiArIGN1cnJlbnROdWdnZXQubnVnTmFtZSArICIgbnVnZ2V0IjsKICAgIH0KCiAgICBuZXdOdWdnZXRCdXR0b24udGFyZ2V0TnVnZ2V0ID0gY3VycmVudE51Z2dldC5udWdOYW1lOwogICAgbmV3TnVnZ2V0QnV0dG9uW3RoYXQuYm90LmlkICsgIi4iICsgdGhhdC50YWcgKyAiU3RhcnQiXSA9IGN1cnJlbnROdWdnZXQubnVnU3RhcnQ7CgogICAgY3JlYXRlKG5ld051Z2dldEJ1dHRvbik7CgogICAgLy9jcmVhdGVkQnV0dG9ucy5wdXNoKGN1cnJlbnROdWdnZXQubnVnTmFtZSk7Cn0KCnJldHVybjsnAPyGpYcD2g4LbnVnZ2V0UGFyc2UCBAD8hqWHA7Uopw9AY29uc3Qgb3JpZ2luYWxUYWdWYWx1ZSA9IHRoYXQuZWRpdGVkQm90LnJhd1t0aGF0LmVkaXRlZFRhZ107CmxldCB0YWdWYWx1ZSA9IG9yaWdpbmFsVGFnVmFsdWU7CgppZiAoIXRhZ1ZhbHVlKSAKewogICAgcmV0dXJuOwp9CmVsc2UgaWYgKHR5cGVvZiB0YWdWYWx1ZSAhPT0gInN0cmluZyIpIAp7CiAgICB0YWdWYWx1ZSA9IHRhZ1ZhbHVlLnRvU3RyaW5nKCk7Cn0KCmxldCBpbml0aWFsUG9zc2libGVOdWdQb3MgPSAwOwoKaWYgKGluaXRpYWxQb3NzaWJsZU51Z1BvcyA9PSAtMSkgCnsKICAgIHJldHVybjsKfQplbHNlCnsKICAgIHRhZ1ZhbHVlID0gdGFnVmFsdWUuc3Vic3RyaW5nKGluaXRpYWxQb3NzaWJsZU51Z1Bvcyk7Cn0KCmxldCBwb3NzaWJsZU51Z3MgPSBvcmlnaW5hbFRhZ1ZhbHVlLnJlcGxhY2UoL1tee10vZywgIiIpLmxlbmd0aDsKbGV0IHRvdGFsTnVnQnJlYWtzID0gb3JpZ2luYWxUYWdWYWx1ZS5yZXBsYWNlKC9bXlxuXS9nLCAiIikubGVuZ3RoOwpsZXQgYnJlYWtMZXZlbCA9IDA7CmxldCBudWdzVG9DaGVjayA9IFtdOwoKZm9yIChsZXQgaSA9IDA7IGkgPCBwb3NzaWJsZU51Z3M7IGkrKykKewogICAgbGV0IGluaXRpYWxOdWdQb3MgPSB0YWdWYWx1ZS5pbmRleE9mKCJ7IikgKyAxOwogICAgbGV0IHBvc3NpYmxlTnVnRW5kID0gdGFnVmFsdWUuaW5kZXhPZigifSIpOwogICAgbGV0IHBvc3NpYmxlTnVnID0gdGFnVmFsdWUuc3Vic3RyaW5nKGluaXRpYWxOdWdQb3MsIHBvc3NpYmxlTnVnRW5kKTsKCiAgICBpZiAocG9zc2libGVOdWcuaW5kZXhPZigiICIpID09IC0xICYmIC9cbi9nLnRlc3QocG9zc2libGVOdWcpICE9IHRydWUgJiYgcG9zc2libGVOdWcubGVuZ3RoID4gMCAmJiBwb3NzaWJsZU51Zy5pbmRleE9mKCI6IikgPT0gLTEpCiAgICB7CiAgICAgICAgbGV0IG51Z0JyZWFrcyA9IHRhZ1ZhbHVlLnN1YnN0cmluZygwLCB0YWdWYWx1ZS5pbmRleE9mKCJ7Iitwb3NzaWJsZU51ZysifSIpKS5yZXBsYWNlKC9bXlxuXS9nLCAiIikubGVuZ3RoOwogICAgICAgIGxldCBwdWJsaXNoQ2hlY2sgPSB0YWdWYWx1ZS5zdWJzdHJpbmcoaW5pdGlhbE51Z1BvcyAtIDYsIGluaXRpYWxOdWdQb3MgLSAyKTsKICAgICAgICBsZXQgbnVnUHVibGlzaCA9IG51bGw7CgogICAgICAgIGlmIChwdWJsaXNoQ2hlY2sgPT0gIi5udWciKQogICAgICAgIHsKICAgICAgICAgICAgbnVnUHVibGlzaCA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBicmVha0xldmVsICs9IG51Z0JyZWFrczsKCiAgICAgICAgbnVnQnJlYWtzID0gdG90YWxOdWdCcmVha3MgLSAodG90YWxOdWdCcmVha3MgLSBicmVha0xldmVsKTsKICAgICAgICAKICAgICAgICAvL0NIRUNLIElGICQgYmVmb3JlIG51Z2dldAogICAgICAgIGlmICh0YWdWYWx1ZS5zdWJzdHJpbmcoaW5pdGlhbE51Z1BvcyAtIDIsIGluaXRpYWxOdWdQb3MgLSAxKSAhPSAiJCIpCiAgICAgICAgewogICAgICAgICAgICBudWdzVG9DaGVjay5wdXNoKHtudWdOYW1lOiBwb3NzaWJsZU51ZywgbnVnU3RhcnQ6IG51Z0JyZWFrcyArIDEsIG51Z1B1Ymxpc2g6IG51Z1B1Ymxpc2h9KTsKICAgICAgICB9CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbGV0IG51Z0JyZWFrcyA9IHRhZ1ZhbHVlLnN1YnN0cmluZygwLCB0YWdWYWx1ZS5pbmRleE9mKCJ9IikpLnJlcGxhY2UoL1teXG5dL2csICIiKS5sZW5ndGg7CgogICAgICAgIGJyZWFrTGV2ZWwgKz0gbnVnQnJlYWtzOwoKICAgICAgICBudWdCcmVha3MgPSB0b3RhbE51Z0JyZWFrcyAtICh0b3RhbE51Z0JyZWFrcyAtIGJyZWFrTGV2ZWwpOwogICAgfQoKICAgIHRhZ1ZhbHVlID0gdGFnVmFsdWUuc3Vic3RyaW5nKHBvc3NpYmxlTnVnRW5kICsgMSk7Cn0KCnRoaXNCb3QubnVnZ2V0QnV0dG9uKHsgbnVnZ2V0OiBudWdzVG9DaGVjaywgYm90OiB0aGF0LmVkaXRlZEJvdCwgdGFnOiB0aGF0LmVkaXRlZFRhZywgdGFnVmFsdWU6IG9yaWdpbmFsVGFnVmFsdWV9KTsnAPyGpYcD2g4Nb25BQlB1Ymxpc2hlZAIEAPyGpYcD3TfBAUBjb25zb2xlLmxvZyh0aGF0LmFiLCB0YWdzLm51Z2dldFRvUHVibGlzaCkKCmlmICh0aGF0LmFiID09IHRhZ3MubnVnZ2V0VG9QdWJsaXNoKQp7CiAgICBvcy50b2FzdCgibnVnZ2V0IHB1Ymxpc2hlZCIpOwoKICAgIG1hc2tzLm51Z2dldFRvUHVibGlzaCA9IG51bGw7CgogICAgY29uZmlnQm90Lm1hc2tzLmFiVmVyc2lvbiA9IG51bGw7Cn0nAPyGpYcD2g4Qb25BbnlCb3RzQ2hhbmdlZAIEAPyGpYcDnzm3BEBpZiAoY29uZmlnQm90ICYmIHRoYXRbMF0uYm90LmlkICE9IHRoaXNCb3QuaWQpIAp7CiAgICBpZiAoIWNvbmZpZ0JvdC50YWdzLmVkaXRpbmdCb3QpIHJldHVybjsgLy8gSWdub3JlIGlmIHRoZSBjb25maWdCb3QgaXNuJ3QgcmVhZHkgeWV0LgoKICAgIGNvbnN0IGVkaXRlZEJvdElEID0gY29uZmlnQm90LnRhZ3MuZWRpdGluZ0JvdC5yZXBsYWNlKCLwn5SXIiwgIiIpOwoKICAgIGlmICghdGhhdC5maW5kKHggPT4geC5ib3QuaWQgPT0gZWRpdGVkQm90SUQpKSByZXR1cm47IC8vIElmIHRoZSBib3QgY2hhbmdlZCB3YXNuJ3QgYmVpbmcgZWRpdGVkIGJ5IHRoZSB1c2VyIGlnbm9yZSBpdC4KCiAgICBjb25zdCBlZGl0ZWRUYWcgPSBjb25maWdCb3QudGFncy5lZGl0aW5nVGFnOwogICAgY29uc3QgZWRpdGVkQm90ID0gZ2V0Qm90KCJpZCIsIGVkaXRlZEJvdElEKTsKCiAgICBpZiAoZWRpdGVkQm90ICYmIGVkaXRlZFRhZykgCiAgICB7CiAgICAgICAgc2hvdXQoIm51Z2dldFJlc2V0Iik7CgogICAgICAgIHRoaXNCb3QubnVnZ2V0UGFyc2UoeyBlZGl0ZWRCb3QsIGVkaXRlZFRhZyB9KTsKICAgIH0KfScA/IalhwPaDghvbkNyZWF0ZQIEAPyGpYcD1T1MQHRhZ3MubGlzdGVuaW5nID0gZmFsc2U7CgovL3NldFRhZ01hc2sodGhpc0JvdCwgImxpc3RlbmluZyIsIHRydWUsICJsb2NhbCIpOycA/IalhwPaDg1wYWNrYWdlTnVnZ2V0AgQA/IalhwOiPvkGQGNvbnN0IHRhcmdldEJvdCA9IGdldEJvdCgiaWQiLCB0aGF0LmJvdCk7CmNvbnN0IHRhZ1RleHQgPSB0YXJnZXRCb3QucmF3W3RoYXQudGFnXTsKCmlmIChjb25maWdCb3QudGFncy5jdXJzb3JTdGFydEluZGV4IHx8IGNvbmZpZ0JvdC50YWdzLmN1cnNvckVuZEluZGV4KQp7CiAgICBsZXQgc3RhcnRQb3MgPSBjb25maWdCb3QudGFncy5jdXJzb3JTdGFydEluZGV4OwogICAgbGV0IGVuZFBvcyA9IGNvbmZpZ0JvdC50YWdzLmN1cnNvckVuZEluZGV4OwoKICAgIGlmIChzdGFydFBvcyA9PSBlbmRQb3MpCiAgICB7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgZWxzZSBpZiAoc3RhcnRQb3MgPiBlbmRQb3MpCiAgICB7CiAgICAgICAgbGV0IG5ld1N0YXJ0UG9zID0gZW5kUG9zOwogICAgICAgIGxldCBuZXdFbmRQb3MgPSBzdGFydFBvczsKCiAgICAgICAgc3RhcnRQb3MgPSBuZXdTdGFydFBvczsKICAgICAgICBlbmRQb3MgPSBuZXdFbmRQb3M7CiAgICB9CgogICAgbGV0IGRhdGEgPSB0YWdUZXh0LnN1YnN0cmluZyhzdGFydFBvcywgZW5kUG9zICsgMSk7CgogICAgc2hvdXQoImFiMVB1Ymxpc2hOdWdnZXQiLCB7bnVnOiB0aGF0Lm51Z2dldCwgZGF0YTogZGF0YX0pOwoKICAgIG9zLnRvYXN0KCJudWcgaXMgcHVibGlzaGluZyIsIDEwKTsKCiAgICBsZXQgdGFyZ2V0TnVnID0gIi5udWcgeyIgKyB0aGF0Lm51Z2dldCArICJ9IjsgCiAgICBsZXQgbnVnUG9zID0gdGFyZ2V0Qm90LnJhd1t0aGF0LnRhZ10uaW5kZXhPZih0YXJnZXROdWcpOwoKICAgIGRlbGV0ZVRhZ1RleHQodGFyZ2V0Qm90LCB0aGF0LnRhZywgbnVnUG9zLCB0YXJnZXROdWcubGVuZ3RoKTsKfQplbHNlCnsKICAgIG9zLnRvYXN0KCJjYW5ub3QgcmVhZCBudWdnZXQgdG8gYmUgcHVibGlzaGVkIikKfScA/IalhwPaDghyZW1lbWJlcgIEAPyGpYcDnEUo8J+Ul2U1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNycA/IalhwPaDgZzZWFyY2gCBAD8hqWHA8NFKPCflJdkODM3MTQ0NC05MTU4LTQ0MzYtOGZjNy04NGNjOTFiN2Y1MjUnAPyGpYcD2g4Fc3RvcmUCBAD8hqWHA+pFKPCflJc3NmFmMDQ5MS0zOTE5LTQ5ODQtYWE4Mi0yMmM3NDJmNDI2M2YnAPyGpYcD2g4JbGlzdGVuaW5nAgQA/IalhwORRgVmYWxzZScBBGJvdHMkYjMwYzZjNWQtYTRmNy00MjY2LWJhMzgtMzkzZGM5NWUxZWNiAScA/IalhwOXRgZzeXN0ZW0CBAD8hqWHA5hGE2FiLTEuaW50ZXJmYWNlLm1lbnUnAPyGpYcDl0YEZm9ybQIEAPyGpYcDrEYHbm90aGluZycA/IalhwOXRgtkZXNjcmlwdGlvbgIEAPyGpYcDtEYmVGhpcyBza2lsbCBpcyBkZXNpZ25lZCBmb3IgbWVudSBzdHVmZi4oAPyGpYcDl0YMYWIxSW50ZXJmYWNlAXgnAPyGpYcDl0YLYWIxT3Blbk1lbnUCBAD8hqWHA9xGxApAY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAiYWIxTWVudSI7CgpsZXQgbWVudVR5cGUgPSB0aGF0ID8gImFiMSIgKyB0aGF0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGhhdC5zbGljZSgxKSArICJNZW51IjogImFiMUNvcmVNZW51IjsgLy9zZXQgdXAgYSBjaGVjayB0byBzZWUgd2hhdCB0eXBlIG9mIG1lbnUgc2hvdWxkIGJlIG9jY3VyaW5nIFtjb3JlLCBib3QsIGdyaWQsIGluc3RdCmxldCBtZW51U2tpbGxzID0gZ2V0Qm90cyhtZW51VHlwZSArICJBY3Rpb24iKTsKbGV0IG1heE9wdGlvbnMgPSBtZW51VHlwZSA9PSAiaW5zdCIgPyA3IDogNTsKbGV0IGFiMU1lbnVCdXR0b24gPSB7fTsKCmFiMU1lbnVCdXR0b24uYWIxTWVudSA9IHRydWU7CmFiMU1lbnVCdXR0b24ucmVtZW1iZXIgPSB0YWdzLnJlbWVtYmVyOwphYjFNZW51QnV0dG9uLm1hbmlmZXN0YXRpb24gPSB0YWdzLm1hbmlmZXN0YXRpb247CmFiMU1lbnVCdXR0b24uYWIxTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CmFiMU1lbnVCdXR0b24ub25DbGljayA9IGBAIGxpbmtzLmJhc2VTa2lsbC4ke21lbnVUeXBlICsgIkFjdGlvbiJ9KCk7YDsKCmZvciAobGV0IGkgPSAwOyBpIDwgbWVudVNraWxscy5sZW5ndGg7IGkrKykvL0FERCBMT0dJQyBGT1IgTU9SRSBPUFRJT05TIFRIQU4gNSA6IG1heE9wdGlvbnMKewogICAgbGV0IGN1cnJlbnRTa2lsbCA9IG1lbnVTa2lsbHNbaV07CgogICAgYWIxTWVudUJ1dHRvbi5iYXNlU2tpbGwgPSAi8J+UlyIgKyBjdXJyZW50U2tpbGwuaWQ7CiAgICBhYjFNZW51QnV0dG9uLmxhYmVsID0gY3VycmVudFNraWxsLnRhZ3NbbWVudVR5cGUgKyAiTGFiZWwiXTsKICAgIGFiMU1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSBjdXJyZW50U2tpbGwudGFnc1ttZW51VHlwZSArICJJY29uIl07CiAgICBhYjFNZW51QnV0dG9uLm9uQ3JlYXRlID0gY3VycmVudFNraWxsLnRhZ3NbbWVudVR5cGUgKyAiT25HZW5lcmF0ZSJdOwogICAgYWIxTWVudUJ1dHRvbi5hYjFNZW51U29ydE9yZGVyID0gY3VycmVudFNraWxsLnRhZ3NbbWVudVR5cGUgKyAiU29ydE9yZGVyIl07CiAgICBhYjFNZW51QnV0dG9uLmNvbG9yID0gY3VycmVudFNraWxsLnRhZ3NbbWVudVR5cGUgKyAiQ29sb3IiXSA/IGN1cnJlbnRTa2lsbC50YWdzW21lbnVUeXBlICsgIkNvbG9yIl0gOiBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUJhc2VDb2xvcjsKCiAgICB0aGlzQm90LmFiMUNyZWF0ZU1lbnVCdXR0b24oYWIxTWVudUJ1dHRvbik7Cn0KCnRoaXNCb3QubWFza3Mub25HcmlkQ2xpY2sgPSAiQCBzaG91dCgnYWIxTWVudVJlZnJlc2gnKTsgbGlua3MubWFuaWZlc3RhdGlvbi5hYjFDbGljaygpOyI7JwD8hqWHA5dGE2FiMUNyZWF0ZU1lbnVCdXR0b24CBAD8hqWHA59RlgNAbGV0IGFkZGl0aW9uYWxUYWdzID0gdGhhdDsKbGV0IG5ld01lbnVCdXR0b24gPSB7fTsKCm5ld01lbnVCdXR0b24uc3BhY2UgPSAidGVtcExvY2FsIjsKbmV3TWVudUJ1dHRvbi5jb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxQmFzZUNvbG9yOwpuZXdNZW51QnV0dG9uLmxhYmVsQWxpZ25tZW50ID0gImxlZnQiOwpuZXdNZW51QnV0dG9uLm1lbnVJdGVtU3R5bGUgPSB7ICJib3JkZXItcmFkaXVzIjoiOHB4IiwgIm1hcmdpbi10b3AiOiIzcHgifTsKCmZvciAoY29uc3QgdGFnIGluIGFkZGl0aW9uYWxUYWdzKQp7CiAgICBuZXdNZW51QnV0dG9uW3RhZ10gPSBhZGRpdGlvbmFsVGFnc1t0YWddOwp9CgpuZXdNZW51QnV0dG9uID0gY3JlYXRlKG5ld01lbnVCdXR0b24pOwoKcmV0dXJuIG5ld01lbnVCdXR0b247JwD8hqWHA5dGDmFiMU1lbnVSZWZyZXNoAgQA/IalhwO2VD5AY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSBudWxsOwoKbWFza3Mub25HcmlkQ2xpY2sgPSBudWxsOycA/IalhwOXRghyZW1lbWJlcgIEAPyGpYcD9VQo8J+Ul2U1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNycA/IalhwOXRg1tYW5pZmVzdGF0aW9uAgQA/IalhwOcVSjwn5SXZGNhNWQ5ODctYzRkOC00NmU0LWI2MGMtZGFhN2IyZjRkZGFkJwD8hqWHA5dGEmFiMUVudmlyb25tZW50TWVudQIEAPyGpYcDw1XEL0BzaG91dCgiYWIxTWVudVJlZnJlc2giKTsKCmNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gImFiMU1lbnUiOwoKbGV0IGFiMU1lbnVCdXR0b24gPSB7fTsKCmFiMU1lbnVCdXR0b24uYWIxTWVudSA9IHRydWU7CmFiMU1lbnVCdXR0b24uYWIxTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CmFiMU1lbnVCdXR0b24ubWFuaWZlc3RhdGlvbiA9IHRhZ3MubWFuaWZlc3RhdGlvbjsKYWIxTWVudUJ1dHRvbi5yZW1lbWJlciA9IHRhZ3MucmVtZW1iZXI7CmFiMU1lbnVCdXR0b24ubGVhcm4gPSB0YWdzLmxlYXJuOwoKZm9yIChsZXQgaSA9IDA7IGkgPCAxMjsgaSsrKQp7CiAgICBzd2l0Y2ggKGkpCiAgICB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBhYjFNZW51QnV0dG9uLmxhYmVsID0gImhpZGUiOwogICAgICAgICAgICBhYjFNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gInZpc2liaWxpdHlfb2ZmIjsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5vbkNsaWNrID0gYEAgZGVzdHJveShsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiMUJvdCk7CiAgICAgICAgICAgIGxpbmtzLm1hbmlmZXN0YXRpb24ubWFza3MuYWIxQm90ID0gbnVsbDsKICAgICAgICAgICAgYDsKCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMToKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5sYWJlbCA9ICJjb2xvciI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAicGFsZXR0ZSI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24ub25DbGljayA9IGBAIG9zLnNob3dJbnB1dEZvclRhZyhsaW5rcy5yZW1lbWJlciwgImFiMUJhc2VDb2xvciIsIHsKICAgICAgICAgICAgdHlwZTogJ2NvbG9yJywKICAgICAgICAgICAgdGl0bGU6ICdwaWNrIGEgY29sb3InCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAKICAgICAgICAgICAgZGVzdHJveShsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiMUJvdCk7CiAgICAgICAgICAgIGxpbmtzLm1hbmlmZXN0YXRpb24ubWFza3MuYWIxQm90ID0gbnVsbDsKICAgICAgICAgICAgYDsKCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5sYWJlbCA9ICJzbGVlcCI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAibmlnaHRzX3N0YXkiOwogICAgICAgICAgICBhYjFNZW51QnV0dG9uLm9uQ2xpY2sgPSBgQGRlc3Ryb3kobGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYjFCb3QpOwoKICAgICAgICAgICAgbGlua3MubWFuaWZlc3RhdGlvbi5tYXNrcy5hYjFCb3QgPSBudWxsOwogICAgICAgICAgICBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUF3YWtlU3RhdGUgPSBmYWxzZTsKICAgICAgICAgICAgYDsKCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5sYWJlbCA9ICJjaGF0IjsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJjaGF0IjsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5vbkNsaWNrID0gYEAgb3Muc2hvd0NoYXQoKTtgOwoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBhYjFNZW51QnV0dG9uLmxhYmVsID0gIm51Z2dldHMiOwogICAgICAgICAgICBhYjFNZW51QnV0dG9uLm51Z01hbmFnZXIgPSB0YWdzLm51Z2dldDsKCiAgICAgICAgICAgIGlmIChsaW5rcy5udWdnZXQudGFncy5saXN0ZW5pbmcpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGFiMU1lbnVCdXR0b24ub25DbGljayA9ICJAIHNob3V0KCdhYjFNZW51UmVmcmVzaCcpOyBsaW5rcy5tYW5pZmVzdGF0aW9uLmFiMUNsaWNrKCk7IHNldFRhZ01hc2sobGlua3MubnVnTWFuYWdlciwgJ2xpc3RlbmluZycsIG51bGwpOyI7CiAgICAgICAgICAgICAgICBhYjFNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImNoZWNrX2JveCI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBhYjFNZW51QnV0dG9uLm9uQ2xpY2sgPSAiQCBzaG91dCgnYWIxTWVudVJlZnJlc2gnKTsgbGlua3MubWFuaWZlc3RhdGlvbi5hYjFDbGljaygpOyBzZXRUYWdNYXNrKGxpbmtzLm51Z01hbmFnZXIsICdsaXN0ZW5pbmcnLCB0cnVlLCAnbG9jYWwnKTsiOwogICAgICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJjaGVja19ib3hfb3V0bGluZV9ibGFuayI7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgNToKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5sYWJlbCA9ICJzeXN0ZW1Qb3J0YWw9dHJ1ZSI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAic2V0dGluZ3NfYXBwbGljYXRpb25zIjsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5vbkNsaWNrID0gYEAgY29uZmlnQm90LnRhZ3Muc3lzdGVtUG9ydGFsID0gdHJ1ZTtgOwoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA2OgogICAgICAgICAgICBpZiAoIWxpbmtzLmdwdCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24ubGFiZWwgPSAiZWRpdCBhYi0xIHByb21wdCI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiZWRpdF9ub3RlIjsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5ncHRCb3QgPSB0YWdzLmdwdDsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5vbkNsaWNrID0gYEAgbGlua3MuZ3B0Qm90LmVkaXRQcm9tcHQoKTtgOwoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA3OgogICAgICAgICAgICBhYjFNZW51QnV0dG9uLmxhYmVsID0gImdyaWQgc25hcCI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUdyaWRTbmFwU3RhdGUgPyAiY2hlY2tfYm94IiA6ICJjaGVja19ib3hfb3V0bGluZV9ibGFuayI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24ub25DbGljayA9IGBAIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxR3JpZFNuYXBTdGF0ZSA9ICFsaW5rcy5yZW1lbWJlci50YWdzLmFiMUdyaWRTbmFwU3RhdGU7CiAgICAgICAgICAgIAogICAgICAgICAgICB0YWdzLmZvcm1BZGRyZXNzID0gbGlua3MucmVtZW1iZXIudGFncy5hYjFHcmlkU25hcFN0YXRlID8gImNoZWNrX2JveCIgOiAiY2hlY2tfYm94X291dGxpbmVfYmxhbmsiOwogICAgICAgICAgICBgOwoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA4OgogICAgICAgICAgICBhYjFNZW51QnV0dG9uLmxhYmVsID0gImJvdCBzbmFwIjsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxQm90U25hcFN0YXRlID8gImNoZWNrX2JveCIgOiAiY2hlY2tfYm94X291dGxpbmVfYmxhbmsiOwogICAgICAgICAgICBhYjFNZW51QnV0dG9uLm9uQ2xpY2sgPSBgQCBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUJvdFNuYXBTdGF0ZSA9ICFsaW5rcy5yZW1lbWJlci50YWdzLmFiMUJvdFNuYXBTdGF0ZTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHRhZ3MuZm9ybUFkZHJlc3MgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUJvdFNuYXBTdGF0ZSA/ICJjaGVja19ib3giIDogImNoZWNrX2JveF9vdXRsaW5lX2JsYW5rIjsKICAgICAgICAgICAgYDsKCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgOToKICAgICAgICAgICAgaWYgKCFsaW5rcy50ZXN0cykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24ubGFiZWwgPSAicmVjb3JkIHRlc3QiOwogICAgICAgICAgICBhYjFNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gInNjaWVuY2UiOwogICAgICAgICAgICBhYjFNZW51QnV0dG9uLm9uS2V5RG93biA9ICJAICI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24ub25LZXlVcCA9ICJAICI7CiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24ub25DbGljayA9IGBAIGxldCBzaGlmdENoZWNrID0gb3MuZ2V0SW5wdXRTdGF0ZSgia2V5Ym9hcmQiLCAiU2hpZnQiKTsKICAgICAgICAgICAgbGV0IGN1cnJlbnRJbnN0ID0gb3MuZ2V0Q3VycmVudEluc3QoKTsKICAgICAgICAgICAgc2hvdXQoJ2FiMVJlY29yZFRlc3QnKTsKICAgICAgICAgICAgc2hvdXQoJ2FiMU1lbnVSZWZyZXNoJyk7CiAgICAgICAgICAgIGA7CgogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICBpZiAoIWxpbmtzLnRlc3RzKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5sYWJlbCA9ICJyZWNvcmQgdHJhY2UiOwogICAgICAgICAgICBhYjFNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gInRpbWVsaW5lIjsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5vbktleURvd24gPSAiQCAiOwogICAgICAgICAgICBhYjFNZW51QnV0dG9uLm9uS2V5VXAgPSAiQCAiOwogICAgICAgICAgICBhYjFNZW51QnV0dG9uLm9uQ2xpY2sgPSBgQCBsZXQgc2hpZnRDaGVjayA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7CiAgICAgICAgICAgIGxldCBjdXJyZW50SW5zdCA9IG9zLmdldEN1cnJlbnRJbnN0KCk7CiAgICAgICAgICAgIHNob3V0KCdhYjFSZWNvcmRUcmFjZScpOwogICAgICAgICAgICBzaG91dCgnYWIxTWVudVJlZnJlc2gnKTsKICAgICAgICAgICAgYDsKCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgIC8vVVBEQVRFIExBQkVMCiAgICAgICAgICAgIGFiMU1lbnVCdXR0b24ubGFiZWwgPSAiZGVsZXRlIGFiLTEiOwogICAgICAgICAgICBhYjFNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImRlbGV0ZV9mb3JldmVyIjsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5jb2xvciA9ICIjRDY2RDVFIjsKICAgICAgICAgICAgYWIxTWVudUJ1dHRvbi5vbkNsaWNrID0gYEAgbGV0IGFsbEJvdHMgPSBnZXRCb3RzKCJzcGFjZSIsICJzaGFyZWQiKTsKCiAgICAgICAgICAgIGRlc3Ryb3kobGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYjFCb3QpOwogICAgICAgICAgICAKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbGxCb3RzLmxlbmd0aDsgaSsrKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoYWxsQm90c1tpXS50YWdzLnN5c3RlbSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZiAoYWxsQm90c1tpXS50YWdzLnN5c3RlbS5pbmNsdWRlcygiYWItMSIpKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgZGVzdHJveShhbGxCb3RzW2ldKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYDsKCiAgICAgICAgICAgIGJyZWFrOyAgICAgICAgICAKICAgIH0KCiAgICBhYjFNZW51QnV0dG9uLmFiMU1lbnVTb3J0T3JkZXIgPSBpOwoKICAgIHRoaXNCb3QuYWIxQ3JlYXRlTWVudUJ1dHRvbihhYjFNZW51QnV0dG9uKTsKfQoKdGhpc0JvdC5tYXNrcy5vbkdyaWRDbGljayA9ICJAIHNob3V0KCdhYjFNZW51UmVmcmVzaCcpOyBsaW5rcy5tYW5pZmVzdGF0aW9uLmFiMUNsaWNrKCk7IjsKCi8vIGFiMU1lbnVCdXR0b24ubGFiZWwgPSAiY29sbGFiIHBvdiI7Ci8vIC8vQ0hFQ0sgRk9SIElDT04KLy8gYWIxTWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJ2aXNpYmlsaXR5X29mZiI7Ci8vIGFiMU1lbnVCdXR0b24ub25DbGljayA9ICJAIG9zLnRvYXN0KCd3b3JrIGluIHByb2dyZXNzJykiOwoKLy8gYWIxTWVudUJ1dHRvbi5sYWJlbCA9ICJudWdnZXRzIjsKLy8gLy9DSEVDSyBGT1IgSUNPTgovLyBhYjFNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImNoZWNrX2JveCI7Ci8vIGFiMU1lbnVCdXR0b24ub25DbGljayA9ICJAIG9zLnRvYXN0KCd3b3JrIGluIHByb2dyZXNzJykiOycA/IalhwOXRgVsZWFybgIEAPyGpYcDiIUBKPCflJc2NjU3Yjg2NS1lOTgzLTQ0MDEtOWZjOS1mNTQxOGQxOGE3ZjcnAPyGpYcDl0YDZ3B0AgQA/IalhwOvhQEo8J+Ul2VjODVjMWQ2LTlmMWEtNDBkNC04MmUxLTViZDY4MDM0OWMyNycA/IalhwOXRglhYjFJZ25vcmUCBAD8hqWHA9aFAQR0cnVlKAD8hqWHA5dGDWFiMUJvdFZlcnNpb24BfRMnAPyGpYcDl0YSYWIxSW5pdGlhbEJvb3RNZW51AgQA/IalhwPchQHpCUBjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9ICJhYjFJbml0aWFsTWVudSI7CgptYXNrcy5hYjFNZW51UmVmcmVzaCA9ICJAIG1hc2tzLm9uR3JpZENsaWNrID0gbnVsbDsiOwptYXNrcy5vbkdyaWRDbGljayA9ICJAIG1hc2tzLm9uR3JpZENsaWNrID0gbnVsbDsgY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSBudWxsOyI7CgpsZXQgbWVudUJ1dHRvbiA9IHt9OwoKbWVudUJ1dHRvbi5hYjFJbml0aWFsTWVudSA9IHRydWU7Cm1lbnVCdXR0b24uZ3JpZENsaWNrID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwptZW51QnV0dG9uLmFiMU1lbnVSZWZyZXNoID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwptZW51QnV0dG9uCm1lbnVCdXR0b24ubGVhcm4gPSB0YWdzLmxlYXJuOwptZW51QnV0dG9uLm1hbmlmZXN0YXRpb24gPSB0YWdzLm1hbmlmZXN0YXRpb247Cm1lbnVCdXR0b24uc2VhcmNoID0gdGFncy5zZWFyY2g7Cm1lbnVCdXR0b24uYXNrID0gdGFncy5hc2s7Cm1lbnVCdXR0b24ubGFiZWwgPSAiYnVpbGQiOwptZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImN1YmUiOwptZW51QnV0dG9uLmNvbG9yID0gIiM5MDhCRkMiOwptZW51QnV0dG9uLm9uQ2xpY2sgPSBgQCBzaG91dCgiYWIxTWVudVJlZnJlc2giKTsKCmxpbmtzLm1hbmlmZXN0YXRpb24uYWIxQ2xpY2soKTtgOwoKLy90aGlzQm90LmFiMUNyZWF0ZU1lbnVCdXR0b24obWVudUJ1dHRvbik7CgptZW51QnV0dG9uLmxhYmVsID0gImFzayBhYjEiOwptZW51QnV0dG9uLmZvcm0gPSAiaW5wdXQiOwptZW51QnV0dG9uLmNvbG9yID0gIiM5MDhCRkMiOwptZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImN1YmUiOwptZW51QnV0dG9uLm9uU3VibWl0ID0gYEAgc2hvdXQoImFiMU1lbnVSZWZyZXNoIik7CgogICAgbGlua3MuYXNrLmFiMUNvcmVNZW51QWN0aW9uKHRoYXQudGV4dCk7YDsKCnRoaXNCb3QuYWIxQ3JlYXRlTWVudUJ1dHRvbihtZW51QnV0dG9uKTsKCm1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAicXJfY29kZV9zY2FubmVyIjsKbWVudUJ1dHRvbi5mb3JtID0gbnVsbDsKbWVudUJ1dHRvbi5sYWJlbCA9ICJzY2FuIjsKbWVudUJ1dHRvbi5jb2xvciA9ICIjOTA4QkZDIjsKbWVudUJ1dHRvbi5vbkNsaWNrID0gYEAgc2hvdXQoImFiMU1lbnVSZWZyZXNoIik7Cgpjb25maWdCb3QudGFncy5wcmFjdGljZVBlcm1pdFNjYW4gPSB0cnVlOwoKb3Mub3BlblFSQ29kZVNjYW5uZXIoKTtgOwoKdGhpc0JvdC5hYjFDcmVhdGVNZW51QnV0dG9uKG1lbnVCdXR0b24pOycA/IalhwOXRgZzZWFyY2gCBAD8hqWHA8aPASjwn5SXZDgzNzE0NDQtOTE1OC00NDM2LThmYzctODRjYzkxYjdmNTI1JwD8hqWHA5dGBm51Z2dldAIEAPyGpYcD7Y8BKPCflJc0YWFmNjk5ZS1hYmJmLTQ0YTgtODVlMS02OGNiYjVkZjBlMWYnAPyGpYcDl0YFdGVzdHMCBAD8hqWHA5SQASjwn5SXYjgzZDk3MmItMDUzNS00MDUxLWI1ODktNDFjZWRhODUzNWYxJwD8hqWHA5dGD29uUG9ydGFsQ2hhbmdlZAIEAPyGpYcDu5ABcEBpZiAodGhhdC5wb3J0YWwgPT0gInN5c3RlbVBvcnRhbCIgJiYgIXRoYXQuZGltZW5zaW9uICYmICFsaW5rcy50ZXN0cykKewogICAgbGlua3MubGVhcm4uYWIxQWRhcHQoImFiMVRlc3RzIik7Cn0nAPyGpYcDl0YDYXNrAgQA/IalhwOskQEo8J+Ul2VjODVjMWQ2LTlmMWEtNDBkNC04MmUxLTViZDY4MDM0OWMyNycBBGJvdHMkZGNhNWQ5ODctYzRkOC00NmU0LWI2MGMtZGFhN2IyZjRkZGFkAScA/IalhwPTkQEGc3lzdGVtAgQA/IalhwPUkQEcYWItMS5pbnRlcmZhY2UubWFuaWZlc3RhdGlvbicA/IalhwPTkQEEZm9ybQIEAPyGpYcD8ZEBB25vdGhpbmcoAPyGpYcD05EBDGFiMUludGVyZmFjZQF4JwD8hqWHA9ORAQtkZXNjcmlwdGlvbgIEAPyGpYcD+pEBOlRoaXMgc2tpbGwgY29udHJvbHMgdGhlIGFjdHVhbCBib3QgZm9yIHRoZSBhYi0xIGludGVyZmFjZS4nAPyGpYcD05EBCm9uQm90QWRkZWQCBAD8hqWHA7WSAbcBQC8vTU9WRSBUTyBXSEVOIE1FTlUgSVMgT1BFTkVEIEZPUiBGSVJTVCBUSU1FPz8/ICBPUiBXSEVOIFNVTU1PTkVEPwpsaW5rcy5sZWFybi5hYjFBZGFwdCgiYWIxQWN0aW9uIik7CgpsaW5rcy5sZWFybi5hYjFBZGFwdCgiYWIxRmFjdG9yeSIpOwoKLy9saW5rcy5sZWFybi5hYjFBZGFwdCgiYWIxRXhwZXJpbWVudGFsIik7JwD8hqWHA9ORAQVsZWFybgIEAPyGpYcD7ZMBKPCflJc2NjU3Yjg2NS1lOTgzLTQ0MDEtOWZjOS1mNTQxOGQxOGE3ZjcnAPyGpYcD05EBD29uUG9ydGFsQ2hhbmdlZAIEAPyGpYcDlJQBxgVAaWYgKCFsaW5rcy5yZW1lbWJlci50YWdzLmFiMUF3YWtlU3RhdGUgfHwgdGhhdC5wb3J0YWwgPT0gInRhZ1BvcnRhbCIpCnsKICAgIHJldHVybjsKfQoKbGV0IHBvcnRhbEFycmF5ID0gWyJtaW5pR3JpZFBvcnRhbCIsICJncmlkUG9ydGFsIiwgIm1hcFBvcnRhbCIsICJtaW5pTWFwUG9ydGFsIiwgImxlZnRXcmlzdFBvcnRhbCIsICJyaWdodFdyaXN0UG9ydGFsIl07CgppZiAocG9ydGFsQXJyYXkuaW5kZXhPZih0aGF0LnBvcnRhbCkgIT0gLTEgJiYgdGhhdC5kaW1lbnNpb24pCnsKICAgIHRoaXNCb3QuYWIxTWFuaWZlc3RCb3Qoe2RpbWVuc2lvbjogdGhhdC5kaW1lbnNpb24sIHBvc2l0aW9uOnt4OjAseTowfX0pOwp9CmVsc2UgaWYgKHBvcnRhbEFycmF5LmluZGV4T2YodGhhdC5wb3J0YWwpID09IC0xICYmICF0aGF0LmRpbWVuc2lvbiAmJiB0aGF0LnBvcnRhbCAhPSAibWVudVBvcnRhbCIpCnsKICAgIGxldCBzdW1tb25EaW1lbnNpb24gPSBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgPyBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgOiBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsOwoKICAgIHRoaXNCb3QuYWIxTWFuaWZlc3RCb3Qoe2RpbWVuc2lvbjogc3VtbW9uRGltZW5zaW9uLCBwb3NpdGlvbjp7eDowLHk6MH19KTsKfQplbHNlIGlmICh0aGF0LnBvcnRhbCAhPSAibWVudVBvcnRhbCIpCnsKICAgIGRlc3Ryb3kobGlua3MuYWIxQm90KTsKfScA/IalhwPTkQEIcmVtZW1iZXICBAD8hqWHA9uZASjwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwD8hqWHA9ORAQ5hYjFNYW5pZmVzdEJvdAIEAPyGpYcDgpoBmAlAaWYgKHRhZ3MuYWIxQm90KQp7CiAgICBkZXN0cm95KGxpbmtzLmFiMUJvdCk7Cn0KCmxldCBhYjEgPSB7fTsKCmFiMS5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwphYjEuY29sb3IgPSAiY2xlYXIiOwphYjEub25DbGljayA9ICJAIGxpbmtzLm1hbmFnZXIuYWIxQ2xpY2soKTsiOwphYjEuZGltZW5zaW9uID0gdGhhdC5kaW1lbnNpb247CmFiMVt0aGF0LmRpbWVuc2lvbl0gPSB0cnVlOwphYjFbdGhhdC5kaW1lbnNpb24gKyAiWCJdID0gdGhhdC5wb3NpdGlvbi54OwphYjFbdGhhdC5kaW1lbnNpb24gKyAiWSJdID0gdGhhdC5wb3NpdGlvbi55OwphYjEuc3Ryb2tlQ29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUJhc2VDb2xvcjsKYWIxLmxpbmVDb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxQmFzZUNvbG9yOwphYjEubWFuYWdlciA9ICLwn5SXIiArIHRoaXNCb3QuaWQ7CmFiMS5hbmltYXRlQm90ID0gYEAgY29uc3Qgcm90WiA9IHRhZ3MuZGltZW5zaW9uICsgIlJvdGF0aW9uWiI7CmxldCB0YXJnZXRTY2FsZSA9IDAuNjU7CgppZiAodGFncy5zY2FsZSA8PSAwLjY1MSkKewogICAgdGFyZ2V0U2NhbGUgPSAwLjk1Owp9Cgphd2FpdCBhbmltYXRlVGFnKHRoaXNCb3QsCnsKICAgIGZyb21WYWx1ZTogewogICAgICAgIFtyb3RaXTogMCwKICAgICAgICBzY2FsZTogdGFncy5zY2FsZQogICAgfSwKICAgIHRvVmFsdWU6IHsKICAgICAgICBbcm90Wl06IDMuMTUsLy82LjMsCiAgICAgICAgc2NhbGU6IHRhcmdldFNjYWxlCiAgICB9LAogICAgZWFzaW5nOiB7CiAgICAgICAgdHlwZTogInNpbnVzb2lkYWwiLAogICAgICAgIG1vZGU6ICJpbm91dCIKICAgIH0sCiAgICBkdXJhdGlvbjogMgp9KS5jYXRjaChlID0+IHt9KTsKYDsKYWIxLm9uQ3JlYXRlID0gYEAgdGhpc0JvdC5hbmltYXRlQm90KCk7CgptYXNrcy5pbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHRoaXNCb3QuYW5pbWF0ZUJvdCgpLCAyMDAwKTsKYDsKYWIxLm9uRGVzdHJveSA9IGBACmNsZWFySW50ZXJ2YWwodGFncy5pbnRlcnZhbCk7CgpzaG91dCgiYWIxTWVudVJlZnJlc2giKTsKYDsKYWIxLmRyYWdnYWJsZSA9IGZhbHNlOwphYjEuc2NhbGUgPSAwLjk7CgpsZXQgYWIxTWFuaWZlc3RlZCA9IGF3YWl0IGNyZWF0ZShhYjEpOwoKbWFza3MuYWIxQm90ID0gIvCflJciICsgYWIxTWFuaWZlc3RlZC5pZDsnAPyGpYcD05EBEGFiMU1hbmlmZXN0U3RhdGUCBAD8hqWHA5ejAQZBc2xlZXAnAPyGpYcD05EBHWFiMU1hbmlmZXN0U3RhdGVBc2xlZXBPbkVudGVyAgQA/IalhwOeowFZQGRlc3Ryb3kobGlua3MuYWIxQm90KTsKCm1hc2tzLmFiMUJvdCA9IG51bGw7CgpsaW5rcy5yZW1lbWJlci50YWdzLmFiMUF3YWtlU3RhdGUgPSBmYWxzZTsnAPyGpYcD05EBC29uR3JpZENsaWNrAgQA/IalhwP4owGKCEBpZiAoIWxpbmtzLnJlbWVtYmVyLnRhZ3MuYWIxQXdha2VTdGF0ZSkKewogICAgcmV0dXJuOwp9CgpzaG91dCgiYWIxTWVudVJlZnJlc2giKTsKCmxldCBmb290cHJpbnQgPSB7fTsKCmZvb3RwcmludC5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwpmb290cHJpbnRbdGhhdC5kaW1lbnNpb25dID0gdHJ1ZTsKZm9vdHByaW50LmRpbWVuc2lvbiA9IHRoYXQuZGltZW5zaW9uOwpmb290cHJpbnRbdGhhdC5kaW1lbnNpb24gKyAiWCJdID0gdGhhdC5wb3NpdGlvbi54Owpmb290cHJpbnRbdGhhdC5kaW1lbnNpb24gKyAiWSJdID0gdGhhdC5wb3NpdGlvbi55Owpmb290cHJpbnQuc2NhbGVaID0gMC4wMTsKZm9vdHByaW50Lm9uQ2xpY2sgPSBgQCB0YWdzW3RhZ3MuZGltZW5zaW9uXSA9IGZhbHNlOwoKbGlua3MubWFuYWdlci5hYjFNYW5pZmVzdEJvdCh0YWdzLnBvc2l0aW9uSW5mbyk7CmA7CmZvb3RwcmludC5wb3NpdGlvbkluZm8gPSB0aGF0Owpmb290cHJpbnQuY29sb3IgPSAiY2xlYXIiOwpmb290cHJpbnQuc3Ryb2tlQ29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUJhc2VDb2xvcjsKZm9vdHByaW50LmRyYWdnYWJsZSA9IGZhbHNlOwpmb290cHJpbnQubWFuYWdlciA9ICLwn5SXIiArIHRoaXNCb3QuaWQ7CmZvb3RwcmludC5vbkNyZWF0ZSA9IGBAIHNldFRpbWVvdXQoKCkgPT4gZGVzdHJveSh0aGlzQm90KSwgODAwKTsKCiAgICBhd2FpdCBhbmltYXRlVGFnKHRoaXNCb3QsIHsKICAgICAgICBmcm9tVmFsdWU6IHsKICAgICAgICAgICAgc2NhbGVYOiAwLjEsCiAgICAgICAgICAgIHNjYWxlWTogMC4xCiAgICAgICAgfSwKICAgICAgICB0b1ZhbHVlOiB7CiAgICAgICAgICAgIHNjYWxlWDogMS4xLAogICAgICAgICAgICBzY2FsZVk6IDEuMQogICAgICAgIH0sCiAgICAgICAgZHVyYXRpb246IDAuNSwKICAgICAgICBlYXNpbmc6IHsKICAgICAgICAgICAgdHlwZTogImVsYXN0aWMiLAogICAgICAgICAgICBtb2RlOiAib3V0IgogICAgICAgIH0KICAgIH0pLmNhdGNoKGUgPT4ge30pOwpgOwoKY3JlYXRlKGZvb3RwcmludCk7JwD8hqWHA9ORAQRtZW51AgQA/IalhwOBrAEo8J+Ul2IzMGM2YzVkLWE0ZjctNDI2Ni1iYTM4LTM5M2RjOTVlMWVjYicA/IalhwPTkQEIYWIxQ2xpY2sCBAD8hqWHA6isAZkJQGlmICghbGlua3MuYWIxQm90KQp7CiAgICByZXR1cm47Cn0KCmNvbnN0IG1lbnVUeXBlID0gdGhhdCA/IHRoYXQubWVudSA6ICJjb3JlIjsKY29uc3Qgc3RhdGUgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJTaGlmdCIpOwoKaWYgKGxpbmtzLmFiMUJvdC50YWdzLmludGVydmFsIHx8IHN0YXRlKQp7CiAgICBjbGVhckludGVydmFsKGxpbmtzLmFiMUJvdC50YWdzLmludGVydmFsKTsKCiAgICBsaW5rcy5hYjFCb3QubWFza3MuaW50ZXJ2YWwgPSBudWxsOwoKICAgIGNsZWFyQW5pbWF0aW9ucyhsaW5rcy5hYjFCb3QpOwoKICAgIGNvbnN0IHJvdFogPSBsaW5rcy5hYjFCb3QudGFncy5kaW1lbnNpb24gKyAiUm90YXRpb25aIjsKCiAgICBpZiAoc3RhdGUgJiYgbWVudVR5cGUgIT0gIm11bHRpcGxlQm90IikKICAgIHsKICAgICAgICBsaW5rcy5tZW51LmFiMUVudmlyb25tZW50TWVudSgpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIGxpbmtzLm1lbnUuYWIxT3Blbk1lbnUobWVudVR5cGUpOwogICAgfQoKICAgIGF3YWl0IGFuaW1hdGVUYWcobGlua3MuYWIxQm90LAogICAgewogICAgICAgIGZyb21WYWx1ZTogewogICAgICAgICAgICBbcm90Wl06IGxpbmtzLmFiMUJvdC50YWdzW3JvdFpdLAogICAgICAgICAgICBzY2FsZTogbGlua3MuYWIxQm90LnRhZ3Muc2NhbGUKICAgICAgICB9LAogICAgICAgIHRvVmFsdWU6IHsKICAgICAgICAgICAgW3JvdFpdOiAwLAogICAgICAgICAgICBzY2FsZTogMC45CiAgICAgICAgfSwKICAgICAgICBlYXNpbmc6IHsKICAgICAgICAgICAgdHlwZTogInNpbnVzb2lkYWwiLAogICAgICAgICAgICBtb2RlOiAiaW5vdXQiCiAgICAgICAgfSwKICAgICAgICBkdXJhdGlvbjogMC41CiAgICB9KS5jYXRjaChlID0+IHt9KTsKfQplbHNlCnsKICAgIGxpbmtzLmFiMUJvdC5hbmltYXRlQm90KCk7CgogICAgbGlua3MuYWIxQm90Lm1hc2tzLmxpbmVUbyA9IG51bGw7CgogICAgaWYgKGxpbmtzLmFiMUJvdC50YWdzLmFybSkKICAgIHsKICAgICAgICBkZXN0cm95KGxpbmtzLmFiMUJvdC5saW5rcy5hcm0pOwogICAgfQoKICAgIHNob3V0KCJhYjFNZW51UmVmcmVzaCIpOwoKICAgIGxpbmtzLmFiMUJvdC5tYXNrcy5pbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IGxpbmtzLmFiMUJvdC5hbmltYXRlQm90KCksIDIwMDApOwp9CicA/IalhwPTkQEcYWIxTWFuaWZlc3RTdGF0ZUF3YWtlT25FbnRlcgIEAPyGpYcDwrUB9gFAbGlua3MucmVtZW1iZXIudGFncy5hYjFBd2FrZVN0YXRlID0gdHJ1ZTsKCmxldCBkaW1lbnNpb24gPSBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgPyBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgOiBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsOwoKaWYgKCFkaW1lbnNpb24pCnsKICAgIHJldHVybjsKfQoKdGhpc0JvdC5hYjFNYW5pZmVzdEJvdCh7ZGltZW5zaW9uOiBkaW1lbnNpb24sIHBvc2l0aW9uOiB7eDogMCwgeTogMH19KTsnAPyGpYcD05EBDG9uQW55Qm90RHJhZwIEAPyGpYcDubcBrAdAaWYgKHRoYXQuYm90ICE9IGxpbmtzLmFiMUJvdCkgcmV0dXJuOwoKaWYgKGxpbmtzLmFiMUJvdC50YWdzLmFybSkKewogICAgZGVzdHJveShsaW5rcy5hYjFCb3QubGlua3MuYXJtKTsKfQoKaWYgKCF0aGF0LmJvdC50YWdzLmludGVydmFsKQp7CiAgICB0aGlzQm90LmFiMUNsaWNrKCk7Cn0KCmxldCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7CmxldCBhcm0gPSB7fTsKCmFybS5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwphcm1bdGhhdC5mcm9tLmRpbWVuc2lvbl0gPSB0cnVlOwphcm0uZGltZW5zaW9uID0gdGhhdC5mcm9tLmRpbWVuc2lvbjsKYXJtLnNjYWxlID0gMC45Owphcm0uc2NhbGVaID0gMC4wMTsKYXJtLmNvbG9yID0gImNsZWFyIjsKYXJtLnN0cm9rZUNvbG9yID0gbGlua3MucmVtZW1iZXIudGFncy5hYjFCYXNlQ29sb3I7CmFybS5saW5lQ29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUJhc2VDb2xvcjsKYXJtLmxpbmVUbyA9IHRoYXQuYm90LmlkOwphcm0ubWFuYWdlciA9ICLwn5SXIiArIHRoaXNCb3QuaWQ7CmFybS5vbkNsaWNrID0gYEAgZGVzdHJveSh0aGlzQm90KTsKCmxpbmtzLm1hbmFnZXIuYWIxTWFuaWZlc3RCb3Qoe2RpbWVuc2lvbjogdGFncy5kaW1lbnNpb24sIHBvc2l0aW9uOnt4OnRhZ3NbdGFncy5kaW1lbnNpb24gKyAiWCJdLHk6dGFnc1t0YWdzLmRpbWVuc2lvbiArICJZIl19fSk7YDsKCmlmIChzdGF0ZSkKewogICAgYXJtLm11bHRpU2VsZWN0ID0gdHJ1ZTsKICAgIGFybS5mb3JtID0gInNwaGVyZSI7CiAgICBhcm0uY29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiMUJhc2VDb2xvcjsKfQoKbGV0IG5ld0FybSA9IGF3YWl0IGNyZWF0ZShhcm0pOwoKbGlua3MuYWIxQm90Lm1hc2tzLmFybSA9ICLwn5SXIiArIG5ld0FybS5pZDsKCm9zLnJlcGxhY2VEcmFnQm90KG5ld0FybSk7JwD8hqWHA9ORARFvbkFueUJvdERyb3BFbnRlcgIEAPyGpYcD4r4BxQdAaWYgKCF0YWdzLmFiMUJvdCkgcmV0dXJuOwppZiAobGlua3MuYWIxQm90LmxpbmtzLmFybSAhPSB0aGF0LmRyYWdCb3QpIHJldHVybjsKCmlmIChsaW5rcy5hYjFCb3QubGlua3MuYXJtLnRhZ3MubXVsdGlTZWxlY3QpCnsKICAgIGlmIChBcnJheS5pc0FycmF5KGxpbmtzLmFiMUJvdC50YWdzLmxpbmVUbykpCiAgICB7CiAgICAgICAgbGlua3MuYWIxQm90Lm1hc2tzLmxpbmVUby5wdXNoKHRoYXQudG8uYm90LmlkKTsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBsaW5rcy5hYjFCb3QubWFza3MubGluZVRvID0gW3RoYXQudG8uYm90LmlkXTsKICAgIH0KCiAgICBsZXQgbmV3TGluazsKCiAgICBpZiAoIWxpbmtzLmFiMUJvdC5saW5rcy5hcm0udGFncy5zZWxlY3RlZEJvdHMpCiAgICB7CiAgICAgICAgbmV3TGluayA9IGdldExpbmsodGhhdC50by5ib3QpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIGxldCBwcmV2aW91c0xpbmtCb3RzID0gbGlua3MuYWIxQm90LmxpbmtzLmFybS5saW5rcy5zZWxlY3RlZEJvdHM7CgogICAgICAgIGlmICghQXJyYXkuaXNBcnJheShwcmV2aW91c0xpbmtCb3RzKSkKICAgICAgICB7CiAgICAgICAgICAgIHByZXZpb3VzTGlua0JvdHMgPSBbcHJldmlvdXNMaW5rQm90c10KICAgICAgICB9CgogICAgICAgIHByZXZpb3VzTGlua0JvdHMucHVzaCh0aGF0LnRvLmJvdCk7CgogICAgICAgIG5ld0xpbmsgPSBnZXRMaW5rKHByZXZpb3VzTGlua0JvdHMpOwogICAgfQoKICAgIGxpbmtzLmFiMUJvdC5saW5rcy5hcm0udGFncy5zZWxlY3RlZEJvdHMgPSBuZXdMaW5rOwp9CmVsc2UKewogICAgbGlua3MuYWIxQm90LmxpbmtzLmFybS5tYXNrcy5zdHJva2VDb2xvciA9ICJjbGVhciI7CiAgICBsaW5rcy5hYjFCb3QubGlua3MuYXJtLm1hc2tzLmxpbmVUbyA9IGZhbHNlOwoKICAgIGxpbmtzLmFiMUJvdC5tYXNrcy5saW5lVG8gPSB0aGF0LnRvLmJvdC5pZDsKfScA/IalhwPTkQEQb25BbnlCb3REcm9wRXhpdAIEAPyGpYcDqMYBpQJAaWYgKCF0YWdzLmFiMUJvdCkgcmV0dXJuOwppZiAobGlua3MuYWIxQm90LmxpbmtzLmFybSAhPSB0aGF0LmRyYWdCb3QpIHJldHVybjsKCmlmICghbGlua3MuYWIxQm90LmxpbmtzLmFybS4udGFncy5tdWx0aVNlbGVjdCkKewogICAgbGlua3MuYWIxQm90LmxpbmtzLmFybS5tYXNrcy5zdHJva2VDb2xvciA9IG51bGw7CiAgICBsaW5rcy5hYjFCb3QubGlua3MuYXJtLm1hc2tzLmxpbmVUbyA9IG51bGw7CgogICAgbGlua3MuYWIxQm90Lm1hc2tzLmxpbmVUbyA9IGxpbmtzLmFiMUJvdC5saW5rcy5hcm0uaWQ7Cn0KCicA/IalhwPTkQEMb25BbnlCb3REcm9wAgQA/IalhwPOyAHqBUBpZiAoIXRhZ3MuYWIxQm90KSByZXR1cm47CmlmIChsaW5rcy5hYjFCb3QubGlua3MuYXJtICE9IHRoYXQuZHJhZ0JvdCkgcmV0dXJuOwoKaWYgKGxpbmtzLmFiMUJvdC5saW5rcy5hcm0udGFncy5tdWx0aVNlbGVjdCkKewogICAgbGlua3MucmVtZW1iZXIubWFza3MuYWIxTXVsdGlwbGVCb3RGb2N1cyA9IGxpbmtzLmFiMUJvdC5saW5rcy5hcm0udGFncy5zZWxlY3RlZEJvdHM7CgogICAgdGhpc0JvdC5hYjFDbGljayh7bWVudTogIm11bHRpcGxlQm90In0pOwoKICAgIGRlc3Ryb3kobGlua3MuYWIxQm90LmxpbmtzLmFybSk7Cn0KZWxzZSBpZiAodGhhdC50by5ib3QpCnsKICAgIGlmICh0aGF0LnRvLmJvdCA9PSBsaW5rcy5hYjFCb3QpCiAgICB7CiAgICAgICAgbGlua3MubWVudS5hYjFFbnZpcm9ubWVudE1lbnUoKTsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBsaW5rcy5yZW1lbWJlci5tYXNrcy5hYjFCb3RGb2N1cyA9ICLwn5SXIiArIHRoYXQudG8uYm90LmlkOwoKICAgICAgICB0aGlzQm90LmFiMUNsaWNrKHttZW51OiAiYm90In0pOwogICAgfQoKICAgIGRlc3Ryb3kobGlua3MuYWIxQm90LmxpbmtzLmFybSk7Cn0KZWxzZQp7CiAgICBsaW5rcy5yZW1lbWJlci5tYXNrcy5hYjFHcmlkRm9jdXMgPSB7ZGltZW5zaW9uOiB0aGF0LnRvLmRpbWVuc2lvbiwgcG9zaXRpb246IHt4OiB0aGF0LnRvLngsIHk6IHRoYXQudG8ueX19OwoKICAgIHRoaXNCb3QuYWIxQ2xpY2soe21lbnU6ICJncmlkIn0pOwp9JwD8hqWHA9ORAQlhYjFJZ25vcmUCBAD8hqWHA7fOAQR0cnVlKAD8hqWHA9ORAQ1hYjFCb3RWZXJzaW9uAX0TAA=="}]}