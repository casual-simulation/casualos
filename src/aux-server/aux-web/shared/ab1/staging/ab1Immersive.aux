{"version":2,"updates":[{"id":0,"timestamp":1681415633207,"update":"AWbfrZHqDAAnAQRib3RzJGM0ODkxOThhLWY4OTktNGJlNi1iMWEwLWY0MjdkZjJmZjMzZAEnAN+tkeoMAAZzeXN0ZW0CBADfrZHqDAEWYWItMS5pbW1lcnNpdmUuaW1tZXJzZScA362R6gwAD29uUG9ydGFsQ2hhbmdlZAIEAN+tkeoMGHZAaWYgKHRoYXQuZGltZW5zaW9uID09IHRhZ3Mucm9vdERpbWVuc2lvbiB8fCB0aGF0LmRpbWVuc2lvbiA9PSAibWFpblNjZW5lIikKewogICAgdGhpc0JvdC5pbml0aWFsaXplKCk7CgogICAgcmV0dXJuOwp9JwDfrZHqDAAEZm9ybQIEAN+tkeoMjwEHbm90aGluZycA362R6gwADGFiMUltbWVyc2l2ZQIEAN+tkeoMlwEEdHJ1ZScA362R6gwADmluaXRpYWxpemVNYXRoAgQA362R6gycAemPAUAvLyA9PT09PT09PT09Ci8vIG1hdGggdXRpbHMKLy8gPT09PT09PT09PQpnbG9iYWxUaGlzLm1hdGhVdGlscyA9IHt9OwoKbWF0aFV0aWxzLmNsYW1wID0gKHZhbHVlLCBtaW4sIG1heCkgPT4gewoJcmV0dXJuIE1hdGgubWF4KG1pbiwgTWF0aC5taW4obWF4LCB2YWx1ZSkpOwp9CgptYXRoVXRpbHMuZm1vZCA9IChhLGIpID0+IHsgCglyZXR1cm4gTnVtYmVyKChhIC0gKE1hdGguZmxvb3IoYSAvIGIpICogYikpLnRvUHJlY2lzaW9uKDgpKTsgCn0KCm1hdGhVdGlscy53cmFwVG8yUGkgPSAoYSkgPT4geyAKCWEgPSBtYXRoVXRpbHMuZm1vZChhLCBNYXRoLlBJICogMik7CglyZXR1cm4gYTsKfQoKbWF0aFV0aWxzLmZsaXBZWiA9ICh2LCBzaWduKSA9PiB7CiAgICBjb25zdCB5ID0gdi55OwogICAgY29uc3QgeiA9IHYuejsKICAgIHYueiA9IHk7CiAgICB2LnkgPSBzaWduID8gLXogOiB6Owp9CgovLyA9PT09PT09PT09Ci8vIHZlY3RvcjMKLy8gPT09PT09PT09PQpnbG9iYWxUaGlzLnZlY3RvcjMgPSB7fTsKCnZlY3RvcjMuemVybyA9ICgpID0+IHsKCXJldHVybiB7eDogMCwgeTogMCwgejogMH0KfQoKdmVjdG9yMy51cCA9ICgpID0+IHsKCXJldHVybiB7eDogMCwgeTogMSwgejogMH0KfQoKdmVjdG9yMy5vbmUgPSAoKSA9PiB7CglyZXR1cm4ge3g6IDEsIHk6IDEsIHo6IDF9Cn0KCnZlY3RvcjMuYXBwbHlRdWF0ZXJuaW9uID0gKHYsIHEpID0+IHsKCQljb25zdCB4ID0gdi54LCB5ID0gdi55LCB6ID0gdi56OwoJCWNvbnN0IHF4ID0gcS54LCBxeSA9IHEueSwgcXogPSBxLnosIHF3ID0gcS53OwoKCQkvLyBjYWxjdWxhdGUgcXVhdCAqIHZlY3RvcgoJCWNvbnN0IGl4ID0gcXcgKiB4ICsgcXkgKiB6IC0gcXogKiB5OwoJCWNvbnN0IGl5ID0gcXcgKiB5ICsgcXogKiB4IC0gcXggKiB6OwoJCWNvbnN0IGl6ID0gcXcgKiB6ICsgcXggKiB5IC0gcXkgKiB4OwoJCWNvbnN0IGl3ID0gLSBxeCAqIHggLSBxeSAqIHkgLSBxeiAqIHo7CgoJCS8vIGNhbGN1bGF0ZSByZXN1bHQgKiBpbnZlcnNlIHF1YXQKCQl2LnggPSBpeCAqIHF3ICsgaXcgKiAtIHF4ICsgaXkgKiAtIHF6IC0gaXogKiAtIHF5OwoJCXYueSA9IGl5ICogcXcgKyBpdyAqIC0gcXkgKyBpeiAqIC0gcXggLSBpeCAqIC0gcXo7CgkJdi56ID0gaXogKiBxdyArIGl3ICogLSBxeiArIGl4ICogLSBxeSAtIGl5ICogLSBxeDsKCgkJcmV0dXJuIHY7Cn0KCnZlY3RvcjMubGVuZ3RoU3EgPSAodikgPT4gewogICAgcmV0dXJuIHYueCAqIHYueCArIHYueSAqIHYueSArIHYueiAqIHYuejsKfQoKdmVjdG9yMy5kb3QgPSAodjEsIHYyKSA9PiB7CiAgICByZXR1cm4gdjEueCAqIHYyLnggKyB2MS55ICogdjIueSArIHYxLnogKiB2Mi56Owp9Cgp2ZWN0b3IzLmFuZ2xlID0gKHYxLCB2MikgPT4gewoJCWNvbnN0IGRlbm9taW5hdG9yID0gTWF0aC5zcXJ0KCB2ZWN0b3IzLmxlbmd0aFNxKHYxKSAqIHZlY3RvcjMubGVuZ3RoU3EodjIpICk7CgkJaWYgKCBkZW5vbWluYXRvciA9PT0gMCApIHJldHVybiBNYXRoLlBJIC8gMjsKCgkJY29uc3QgdGhldGEgPSB2ZWN0b3IzLmRvdCh2MSwgdjIpIC8gZGVub21pbmF0b3I7CgkJLy8gY2xhbXAsIHRvIGhhbmRsZSBudW1lcmljYWwgcHJvYmxlbXMKCQlyZXR1cm4gTWF0aC5hY29zKG1hdGhVdGlscy5jbGFtcCh0aGV0YSwgLSAxLCAxKSk7Cn0KCnZlY3RvcjMubGVycCA9ICh2MSwgdjIsIHQpID0+IHsKICAgIHJldHVybiB7CiAgICAgICAgeDogdjEueCArICh2Mi54IC0gdjEueCkgKiB0LAoJCXk6IHYxLnkgKyAodjIueSAtIHYxLnkpICogdCwKCQl6OiB2MS56ICsgKHYyLnogLSB2MS56KSAqIHQKICAgIH0KfQoKdmVjdG9yMy5sZW5ndGggPSAodikgPT4gewoJcmV0dXJuIE1hdGguc3FydCh2LnggKiB2LnggKyB2LnkgKiB2LnkgKyB2LnogKiB2LnopOwp9Cgp2ZWN0b3IzLmxlbmd0aFNxID0gKHYpID0+IHsKCXJldHVybiB2LnggKiB2LnggKyB2LnkgKiB2LnkgKyB2LnogKiB2Lno7Cn0KCnZlY3RvcjMuYXBwbHlNYXRyaXg0ID0gKHYsIG0pID0+IHsKCWNvbnN0IHggPSB2LngsIHkgPSB2LnksIHogPSB2Lno7Cgljb25zdCB3ID0gMSAvIChtWzNdICogeCArIG1bN10gKiB5ICsgbVsxMV0gKiB6ICsgbVsxNV0pOwoKCXYueCA9IChtWzBdICogeCArIG1bNF0gKiB5ICsgbVs4XSAqIHogKyBtWzEyXSkgKiB3OwoJdi55ID0gKG1bMV0gKiB4ICsgbVs1XSAqIHkgKyBtWzldICogeiArIG1bMTNdKSAqIHc7Cgl2LnogPSAobVsyXSAqIHggKyBtWzZdICogeSArIG1bMTBdICogeiArIG1bMTRdKSAqIHc7CgoJcmV0dXJuIHY7Cn0KCnZlY3RvcjMubXVsdGlwbHlTY2FsYXIgPSAodiwgcykgPT4gewoJdi54ICo9IHM7Cgl2LnkgKj0gczsKCXYueiAqPSBzOwoKCXJldHVybiB2Owp9Cgp2ZWN0b3IzLmNyb3NzVmVjdG9ycyA9IChhLCBiKSA9PiB7Cgljb25zdCB2ID0gdmVjdG9yMy56ZXJvKCk7Cgljb25zdCBheCA9IGEueCwgYXkgPSBhLnksIGF6ID0gYS56OwoJY29uc3QgYnggPSBiLngsIGJ5ID0gYi55LCBieiA9IGIuejsKCgl2LnggPSBheSAqIGJ6IC0gYXogKiBieTsKCXYueSA9IGF6ICogYnggLSBheCAqIGJ6OwoJdi56ID0gYXggKiBieSAtIGF5ICogYng7CglyZXR1cm4gdjsKfQoKdmVjdG9yMy5hcHBseUV1bGVyID0gKHYsIGV1bGVyLCBvcmRlciA9ICdYWVonKSA9PiB7CglyZXR1cm4gdmVjdG9yMy5hcHBseVF1YXRlcm5pb24odiwgcXVhdGVybmlvbi5mcm9tRXVsZXIoZXVsZXIsIG9yZGVyKSk7Cn0KCnZlY3RvcjMuYXBwbHlBeGlzQW5nbGUgPSAodiwgYXhpcywgYW5nbGUpID0+IHsKCXJldHVybiB2ZWN0b3IzLmFwcGx5UXVhdGVybmlvbiggdiwgcXVhdGVybmlvbi5zZXRGcm9tQXhpc0FuZ2xlKCBheGlzLCBhbmdsZSApICk7Cn0KCnZlY3RvcjMuc2V0RnJvbVJvdGF0aW9uTWF0cml4ID0gKG0sIG9yZGVyID0gJ1hZWicpID0+IHsKCS8vIGFzc3VtZXMgdGhlIHVwcGVyIDN4MyBvZiBtIGlzIGEgcHVyZSByb3RhdGlvbiBtYXRyaXggKGkuZSwgdW5zY2FsZWQpCgkvLyBjb25zb2xlLmxvZyhgW3ZlY3RvcjMuc2V0RnJvbVJvdGF0aW9uTWF0cml4XSAxLiBtYXRyaXhgLCBKU09OLnN0cmluZ2lmeShtKSk7Cgljb25zdCBtMTEgPSBtWzBdLCBtMTIgPSBtWzRdLCBtMTMgPSBtWzhdOwoJY29uc3QgbTIxID0gbVsxXSwgbTIyID0gbVs1XSwgbTIzID0gbVs5XTsKCWNvbnN0IG0zMSA9IG1bMl0sIG0zMiA9IG1bNl0sIG0zMyA9IG1bMTBdOwoJY29uc3QgdiA9IHZlY3RvcjMuemVybygpOwoKCXN3aXRjaCAob3JkZXIpIHsKCQljYXNlICdYWVonOgoJCQl2LnkgPSBNYXRoLmFzaW4obWF0aFV0aWxzLmNsYW1wKG0xMywgLSAxLCAxKSk7CgoJCQlpZiAoTWF0aC5hYnMobTEzKSA8IDAuOTk5OTk5OSkgewoJCQkJdi54ID0gTWF0aC5hdGFuMigtIG0yMywgbTMzKTsKCQkJCXYueiA9IE1hdGguYXRhbjIoLSBtMTIsIG0xMSk7CgkJCX0gZWxzZSB7CgkJCQl2LnggPSBNYXRoLmF0YW4yKG0zMiwgbTIyKTsKCQkJCXYueiA9IDA7CgkJCX0KCQkJLy8gY29uc29sZS5sb2coYFt2ZWN0b3IzLnNldEZyb21Sb3RhdGlvbk1hdHJpeF0gMi4gWFlaIHN3aXp6bGVgLCBKU09OLnN0cmluZ2lmeSh2KSk7CgkJCWJyZWFrOwoJCWNhc2UgJ1lYWic6CgkJCXYueCA9IE1hdGguYXNpbigtIG1hdGhVdGlscy5jbGFtcChtMjMsIC0gMSwgMSkpOwoKCQkJaWYgKE1hdGguYWJzKG0yMykgPCAwLjk5OTk5OTkpIHsKCQkJCXYueSA9IE1hdGguYXRhbjIobTEzLCBtMzMpOwoJCQkJdi56ID0gTWF0aC5hdGFuMihtMjEsIG0yMik7CgkJCX0gZWxzZSB7CgkJCQl2LnkgPSBNYXRoLmF0YW4yKC0gbTMxLCBtMTEpOwoJCQkJdi56ID0gMDsKCQkJfQoJCQlicmVhazsKCQljYXNlICdaWFknOgoJCQl2LnggPSBNYXRoLmFzaW4obWF0aFV0aWxzLmNsYW1wKG0zMiwgLSAxLCAxKSk7CgoJCQlpZiAoTWF0aC5hYnMobTMyKSA8IDAuOTk5OTk5OSkgewoJCQkJdi55ID0gTWF0aC5hdGFuMigtIG0zMSwgbTMzKTsKCQkJCXYueiA9IE1hdGguYXRhbjIoLSBtMTIsIG0yMik7CgkJCX0gZWxzZSB7CgkJCQl2LnkgPSAwOwoJCQkJdi56ID0gTWF0aC5hdGFuMihtMjEsIG0xMSk7CgkJCX0KCQkJYnJlYWs7CgkJY2FzZSAnWllYJzoKCQkJdi55ID0gTWF0aC5hc2luKC0gbWF0aFV0aWxzLmNsYW1wKG0zMSwgLSAxLCAxKSk7CgoJCQlpZiAoTWF0aC5hYnMobTMxKSA8IDAuOTk5OTk5OSkgewoJCQkJdi54ID0gTWF0aC5hdGFuMihtMzIsIG0zMyk7CgkJCQl2LnogPSBNYXRoLmF0YW4yKG0yMSwgbTExKTsKCQkJfSBlbHNlIHsKCQkJCXYueCA9IDA7CgkJCQl2LnogPSBNYXRoLmF0YW4yKC0gbTEyLCBtMjIpOwoJCQl9CgkJCWJyZWFrOwoJCWNhc2UgJ1laWCc6CgkJCXYueiA9IE1hdGguYXNpbihtYXRoVXRpbHMuY2xhbXAobTIxLCAtIDEsIDEpKTsKCgkJCWlmIChNYXRoLmFicyhtMjEpIDwgMC45OTk5OTk5KSB7CgkJCQl2LnggPSBNYXRoLmF0YW4yKC0gbTIzLCBtMjIpOwoJCQkJdi55ID0gTWF0aC5hdGFuMigtIG0zMSwgbTExKTsKCQkJfSBlbHNlIHsKCQkJCXYueCA9IDA7CgkJCQl2LnkgPSBNYXRoLmF0YW4yKG0xMywgbTMzKTsKCQkJfQoJCQlicmVhazsKCQljYXNlICdYWlknOgoJCQl2LnogPSBNYXRoLmFzaW4oLSBtYXRoVXRpbHMuY2xhbXAobTEyLCAtIDEsIDEpKTsKCgkJCWlmIChNYXRoLmFicyhtMTIpIDwgMC45OTk5OTk5KSB7CgkJCQl2LnggPSBNYXRoLmF0YW4yKG0zMiwgbTIyKTsKCQkJCXYueSA9IE1hdGguYXRhbjIobTEzLCBtMTEpOwoJCQl9IGVsc2UgewoJCQkJdi54ID0gTWF0aC5hdGFuMigtIG0yMywgbTMzKTsKCQkJCXYueSA9IDA7CgkJCX0KCQkJYnJlYWs7CgkJZGVmYXVsdDoKCQkJY29uc29sZS53YXJuKCdbdmVjdG9yMy5zZXRGcm9tUm90YXRpb25NYXRyaXhdIGVuY291bnRlcmVkIGFuIHVua25vd24gb3JkZXI6ICcgKyBvcmRlcik7Cgl9CgoJcmV0dXJuIHY7Cn0KCnZlY3RvcjMuc2V0RnJvbVF1YXRlcm5pb24gPSAocSwgb3JkZXIgPSAnWFlaJykgPT4gewoJY29uc3QgbSA9IG1hdHJpeDQuY29tcG9zZSh2ZWN0b3IzLnplcm8oKSwgcSwgdmVjdG9yMy5vbmUoKSk7CglyZXR1cm4gdmVjdG9yMy5zZXRGcm9tUm90YXRpb25NYXRyaXgobSwgb3JkZXIpOwp9Cgp2ZWN0b3IzLmxvY2FsVG9Xb3JsZCA9ICh2ZWN0b3IsIG1hdHJpeFdvcmxkKSA9PiB7CglyZXR1cm4gdmVjdG9yMy5hcHBseU1hdHJpeDQodmVjdG9yLCBtYXRyaXhXb3JsZCk7Cn0KCnZlY3RvcjMud29ybGRUb0xvY2FsID0gKHZlY3RvciwgbWF0cml4V29ybGQpID0+IHsKCWNvbnN0IGludmVyc2VNYXRyaXggPSBtYXRyaXg0LmludmVydChbLi4ubWF0cml4V29ybGRdKTsKCXJldHVybiB2ZWN0b3IzLmFwcGx5TWF0cml4NCh2ZWN0b3IsIGludmVyc2VNYXRyaXgpOwp9CgovLyA9PT09PT09PT09Ci8vIHF1YXRlcm5pb24KLy8gPT09PT09PT09PQpnbG9iYWxUaGlzLnF1YXRlcm5pb24gPSB7fTsKCnF1YXRlcm5pb24uaWRlbnRpdHkgPSAoKSA9PiB7CglyZXR1cm4ge3g6IDAsIHk6IDAsIHo6IDAsIHc6IDF9Owp9CgpxdWF0ZXJuaW9uLnNldEZyb21Sb3RhdGlvbk1hdHJpeCA9IChxLCBtKSA9PiB7CgkvLyBodHRwOi8vd3d3LmV1Y2xpZGVhbnNwYWNlLmNvbS9tYXRocy9nZW9tZXRyeS9yb3RhdGlvbnMvY29udmVyc2lvbnMvbWF0cml4VG9RdWF0ZXJuaW9uL2luZGV4Lmh0bQoJLy8gYXNzdW1lcyB0aGUgdXBwZXIgM3gzIG9mIG0gaXMgYSBwdXJlIHJvdGF0aW9uIG1hdHJpeCAoaS5lLCB1bnNjYWxlZCkKCgljb25zdCBtMTEgPSBtWyAwIF0sIG0xMiA9IG1bIDQgXSwgbTEzID0gbVsgOCBdOwoJY29uc3QgbTIxID0gbVsgMSBdLCBtMjIgPSBtWyA1IF0sIG0yMyA9IG1bIDkgXTsKCWNvbnN0IG0zMSA9IG1bIDIgXSwgbTMyID0gbVsgNiBdLCBtMzMgPSBtWyAxMCBdOwoKCWNvbnN0IHRyYWNlID0gbTExICsgbTIyICsgbTMzOwoKCWlmICggdHJhY2UgPiAwICkgewoJCWNvbnN0IHMgPSAwLjUgLyBNYXRoLnNxcnQoIHRyYWNlICsgMS4wICk7CgoJCXEudyA9IDAuMjUgLyBzOwoJCXEueCA9ICggbTMyIC0gbTIzICkgKiBzOwoJCXEueSA9ICggbTEzIC0gbTMxICkgKiBzOwoJCXEueiA9ICggbTIxIC0gbTEyICkgKiBzOwoJfSBlbHNlIGlmICggbTExID4gbTIyICYmIG0xMSA+IG0zMyApIHsKCQljb25zdCBzID0gMi4wICogTWF0aC5zcXJ0KCAxLjAgKyBtMTEgLSBtMjIgLSBtMzMgKTsKCgkJcS53ID0gKCBtMzIgLSBtMjMgKSAvIHM7CgkJcS54ID0gMC4yNSAqIHM7CgkJcS55ID0gKCBtMTIgKyBtMjEgKSAvIHM7CgkJcS56ID0gKCBtMTMgKyBtMzEgKSAvIHM7Cgl9IGVsc2UgaWYgKCBtMjIgPiBtMzMgKSB7CgkJY29uc3QgcyA9IDIuMCAqIE1hdGguc3FydCggMS4wICsgbTIyIC0gbTExIC0gbTMzICk7CgoJCXEudyA9ICggbTEzIC0gbTMxICkgLyBzOwoJCXEueCA9ICggbTEyICsgbTIxICkgLyBzOwoJCXEueSA9IDAuMjUgKiBzOwoJCXEueiA9ICggbTIzICsgbTMyICkgLyBzOwoJfSBlbHNlIHsKCQljb25zdCBzID0gMi4wICogTWF0aC5zcXJ0KCAxLjAgKyBtMzMgLSBtMTEgLSBtMjIgKTsKCgkJcS53ID0gKCBtMjEgLSBtMTIgKSAvIHM7CgkJcS54ID0gKCBtMTMgKyBtMzEgKSAvIHM7CgkJcS55ID0gKCBtMjMgKyBtMzIgKSAvIHM7CgkJcS56ID0gMC4yNSAqIHM7Cgl9CgoJcmV0dXJuIHE7Cn0JCgpxdWF0ZXJuaW9uLnNldEZyb21BeGlzQW5nbGUgPSAoYXhpcywgYW5nbGUpID0+IHsKCS8vIGh0dHA6Ly93d3cuZXVjbGlkZWFuc3BhY2UuY29tL21hdGhzL2dlb21ldHJ5L3JvdGF0aW9ucy9jb252ZXJzaW9ucy9hbmdsZVRvUXVhdGVybmlvbi9pbmRleC5odG0KCS8vIGFzc3VtZXMgYXhpcyBpcyBub3JtYWxpemVkCgljb25zdCBxID0gcXVhdGVybmlvbi5pZGVudGl0eSgpOwoJY29uc3QgaGFsZkFuZ2xlID0gYW5nbGUgLyAyLCBzID0gTWF0aC5zaW4oIGhhbGZBbmdsZSApOwoKCXEueCA9IGF4aXMueCAqIHM7CglxLnkgPSBheGlzLnkgKiBzOwoJcS56ID0gYXhpcy56ICogczsKCXEudyA9IE1hdGguY29zKGhhbGZBbmdsZSk7CgoJcmV0dXJuIHE7Cn0KCnF1YXRlcm5pb24uZnJvbUV1bGVyID0gKGV1bGVyLCBvcmRlciA9ICdYWVonKSA9PiB7Cgljb25zdCBxID0gcXVhdGVybmlvbi5pZGVudGl0eSgpOwoJY29uc3QgeCA9IGV1bGVyLngsIHkgPSBldWxlci55LCB6ID0gZXVsZXIuejsKCgkvLyBodHRwOi8vd3d3Lm1hdGh3b3Jrcy5jb20vbWF0bGFiY2VudHJhbC9maWxlZXhjaGFuZ2UvCgkvLyAJMjA2OTYtZnVuY3Rpb24tdG8tY29udmVydC1iZXR3ZWVuLWRjbS1ldWxlci1hbmdsZXMtcXVhdGVybmlvbnMtYW5kLWV1bGVyLXZlY3RvcnMvY29udGVudC9TcGluQ2FsYy5tCgljb25zdCBjMSA9IE1hdGguY29zKCB4IC8gMiApOwoJY29uc3QgYzIgPSBNYXRoLmNvcyggeSAvIDIgKTsKCWNvbnN0IGMzID0gTWF0aC5jb3MoIHogLyAyICk7CgoJY29uc3QgczEgPSBNYXRoLnNpbiggeCAvIDIgKTsKCWNvbnN0IHMyID0gTWF0aC5zaW4oIHkgLyAyICk7Cgljb25zdCBzMyA9IE1hdGguc2luKCB6IC8gMiApOwoKCXN3aXRjaCAoIG9yZGVyICkgewoJCWNhc2UgJ1hZWic6CgkJCXEueCA9IHMxICogYzIgKiBjMyArIGMxICogczIgKiBzMzsKCQkJcS55ID0gYzEgKiBzMiAqIGMzIC0gczEgKiBjMiAqIHMzOwoJCQlxLnogPSBjMSAqIGMyICogczMgKyBzMSAqIHMyICogYzM7CgkJCXEudyA9IGMxICogYzIgKiBjMyAtIHMxICogczIgKiBzMzsKCQkJYnJlYWs7CgkJY2FzZSAnWVhaJzoKCQkJcS54ID0gczEgKiBjMiAqIGMzICsgYzEgKiBzMiAqIHMzOwoJCQlxLnkgPSBjMSAqIHMyICogYzMgLSBzMSAqIGMyICogczM7CgkJCXEueiA9IGMxICogYzIgKiBzMyAtIHMxICogczIgKiBjMzsKCQkJcS53ID0gYzEgKiBjMiAqIGMzICsgczEgKiBzMiAqIHMzOwoJCQlicmVhazsKCQljYXNlICdaWFknOgoJCQlxLnggPSBzMSAqIGMyICogYzMgLSBjMSAqIHMyICogczM7CgkJCXEueSA9IGMxICogczIgKiBjMyArIHMxICogYzIgKiBzMzsKCQkJcS56ID0gYzEgKiBjMiAqIHMzICsgczEgKiBzMiAqIGMzOwoJCQlxLncgPSBjMSAqIGMyICogYzMgLSBzMSAqIHMyICogczM7CgkJCWJyZWFrOwoJCWNhc2UgJ1pZWCc6CgkJCXEueCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKCQkJcS55ID0gYzEgKiBzMiAqIGMzICsgczEgKiBjMiAqIHMzOwoJCQlxLnogPSBjMSAqIGMyICogczMgLSBzMSAqIHMyICogYzM7CgkJCXEudyA9IGMxICogYzIgKiBjMyArIHMxICogczIgKiBzMzsKCQkJYnJlYWs7CgkJY2FzZSAnWVpYJzoKCQkJcS54ID0gczEgKiBjMiAqIGMzICsgYzEgKiBzMiAqIHMzOwoJCQlxLnkgPSBjMSAqIHMyICogYzMgKyBzMSAqIGMyICogczM7CgkJCXEueiA9IGMxICogYzIgKiBzMyAtIHMxICogczIgKiBjMzsKCQkJcS53ID0gYzEgKiBjMiAqIGMzIC0gczEgKiBzMiAqIHMzOwoJCQlicmVhazsKCQljYXNlICdYWlknOgoJCQlxLnggPSBzMSAqIGMyICogYzMgLSBjMSAqIHMyICogczM7CgkJCXEueSA9IGMxICogczIgKiBjMyAtIHMxICogYzIgKiBzMzsKCQkJcS56ID0gYzEgKiBjMiAqIHMzICsgczEgKiBzMiAqIGMzOwoJCQlxLncgPSBjMSAqIGMyICogYzMgKyBzMSAqIHMyICogczM7CgkJCWJyZWFrOwoJCWRlZmF1bHQ6CgkJCWNvbnNvbGUud2FybiggJ1txdWF0ZXJuaW9uLmZyb21FdWxlcl0gZW5jb3VudGVyZWQgYW4gdW5rbm93biBvcmRlcjogJyArIG9yZGVyKTsKCX0KCglyZXR1cm4gcTsKfQoKcXVhdGVybmlvbi5tdWx0aXBseVF1YXRlcm5pb25zID0gKGEsIGIpID0+IHsKCS8vIGZyb20gaHR0cDovL3d3dy5ldWNsaWRlYW5zcGFjZS5jb20vbWF0aHMvYWxnZWJyYS9yZWFsTm9ybWVkQWxnZWJyYS9xdWF0ZXJuaW9ucy9jb2RlL2luZGV4Lmh0bQoJY29uc29sZS5sb2coYFtxdWF0ZXJuaW9uLm11bHRpcGx5UXVhdGVybmlvbnNdIGE6YCwgSlNPTi5zdHJpbmdpZnkoYSkpOwoJY29uc29sZS5sb2coYFtxdWF0ZXJuaW9uLm11bHRpcGx5UXVhdGVybmlvbnNdIGI6YCwgSlNPTi5zdHJpbmdpZnkoYikpOwoJY29uc3QgcSA9IHF1YXRlcm5pb24uaWRlbnRpdHkoKTsKCWNvbnN0IHFheCA9IGEueCwgcWF5ID0gYS55LCBxYXogPSBhLnosIHFhdyA9IGEudzsKCWNvbnN0IHFieCA9IGIueCwgcWJ5ID0gYi55LCBxYnogPSBiLnosIHFidyA9IGIudzsKCglxLnggPSBxYXggKiBxYncgKyBxYXcgKiBxYnggKyBxYXkgKiBxYnogLSBxYXogKiBxYnk7CglxLnkgPSBxYXkgKiBxYncgKyBxYXcgKiBxYnkgKyBxYXogKiBxYnggLSBxYXggKiBxYno7CglxLnogPSBxYXogKiBxYncgKyBxYXcgKiBxYnogKyBxYXggKiBxYnkgLSBxYXkgKiBxYng7CglxLncgPSBxYXcgKiBxYncgLSBxYXggKiBxYnggLSBxYXkgKiBxYnkgLSBxYXogKiBxYno7CgoJcmV0dXJuIHE7Cn0KCnF1YXRlcm5pb24ubGVuZ3RoID0gKHEpID0+IHsKCXJldHVybiBNYXRoLnNxcnQoIHEueCAqIHEueCArIHEueSAqIHEueSArIHEueiAqIHEueiArIHEudyAqIHEudyApOwp9CgpxdWF0ZXJuaW9uLm5vcm1hbGl6ZSA9IChxKSA9PiB7CglsZXQgbCA9IHF1YXRlcm5pb24ubGVuZ3RoKHEpOwoKCWlmIChsID09PSAwKSB7CgkJcS54ID0gMDsKCQlxLnkgPSAwOwoJCXEueiA9IDA7CgkJcS53ID0gMTsKCX0gZWxzZSB7CgkJbCA9IDEgLyBsOwoKCQlxLnggPSBxLnggKiBsOwoJCXEueSA9IHEueSAqIGw7CgkJcS56ID0gcS56ICogbDsKCQlxLncgPSBxLncgKiBsOwoJfQoKCXJldHVybiBxOwp9CgpxdWF0ZXJuaW9uLmludmVydCA9IChxKSA9PiB7CgkvLyBxdWF0ZXJuaW9uIGlzIGFzc3VtZWQgdG8gaGF2ZSB1bml0IGxlbmd0aAoJcmV0dXJuIHF1YXRlcm5pb24uY29uanVnYXRlKHEpOwp9CgpxdWF0ZXJuaW9uLmNvbmp1Z2F0ZSA9IChxKSA9PiB7CglxLnggKj0gLSAxOwoJcS55ICo9IC0gMTsKCXEueiAqPSAtIDE7CgoJcmV0dXJuIHE7Cn0KCi8vID09PT09PT09PT0KLy8gbWF0cml4NAovLyA9PT09PT09PT09Cmdsb2JhbFRoaXMubWF0cml4NCA9IHt9OwoKbWF0cml4NC5pZGVudGl0eSA9ICgpID0+IHsKCXJldHVybiBbCgkJMSwgMCwgMCwgMCwKCQkwLCAxLCAwLCAwLAoJCTAsIDAsIDEsIDAsCgkJMCwgMCwgMCwgMQoJXTsKfQoKbWF0cml4NC5tdWx0aXBseU1hdHJpY2VzID0gKG0sIGEsIGIpID0+IHsKCWNvbnN0IGExMSA9IGFbMF0sIGExMiA9IGFbNF0sIGExMyA9IGFbOF0sIGExNCA9IGFbMTJdOwoJY29uc3QgYTIxID0gYVsxXSwgYTIyID0gYVs1XSwgYTIzID0gYVs5XSwgYTI0ID0gYVsxM107Cgljb25zdCBhMzEgPSBhWzJdLCBhMzIgPSBhWzZdLCBhMzMgPSBhWzEwXSwgYTM0ID0gYVsxNF07Cgljb25zdCBhNDEgPSBhWzNdLCBhNDIgPSBhWzddLCBhNDMgPSBhWzExXSwgYTQ0ID0gYVsxNV07CgoJY29uc3QgYjExID0gYlswXSwgYjEyID0gYls0XSwgYjEzID0gYls4XSwgYjE0ID0gYlsxMl07Cgljb25zdCBiMjEgPSBiWzFdLCBiMjIgPSBiWzVdLCBiMjMgPSBiWzldLCBiMjQgPSBiWzEzXTsKCWNvbnN0IGIzMSA9IGJbMl0sIGIzMiA9IGJbNl0sIGIzMyA9IGJbMTBdLCBiMzQgPSBiWzE0XTsKCWNvbnN0IGI0MSA9IGJbM10sIGI0MiA9IGJbN10sIGI0MyA9IGJbMTFdLCBiNDQgPSBiWzE1XTsKCgltWzBdID0gYTExICogYjExICsgYTEyICogYjIxICsgYTEzICogYjMxICsgYTE0ICogYjQxOwoJbVs0XSA9IGExMSAqIGIxMiArIGExMiAqIGIyMiArIGExMyAqIGIzMiArIGExNCAqIGI0MjsKCW1bOF0gPSBhMTEgKiBiMTMgKyBhMTIgKiBiMjMgKyBhMTMgKiBiMzMgKyBhMTQgKiBiNDM7CgltWzEyXSA9IGExMSAqIGIxNCArIGExMiAqIGIyNCArIGExMyAqIGIzNCArIGExNCAqIGI0NDsKCgltWzFdID0gYTIxICogYjExICsgYTIyICogYjIxICsgYTIzICogYjMxICsgYTI0ICogYjQxOwoJbVs1XSA9IGEyMSAqIGIxMiArIGEyMiAqIGIyMiArIGEyMyAqIGIzMiArIGEyNCAqIGI0MjsKCW1bOV0gPSBhMjEgKiBiMTMgKyBhMjIgKiBiMjMgKyBhMjMgKiBiMzMgKyBhMjQgKiBiNDM7CgltWzEzXSA9IGEyMSAqIGIxNCArIGEyMiAqIGIyNCArIGEyMyAqIGIzNCArIGEyNCAqIGI0NDsKCgltWzJdID0gYTMxICogYjExICsgYTMyICogYjIxICsgYTMzICogYjMxICsgYTM0ICogYjQxOwoJbVs2XSA9IGEzMSAqIGIxMiArIGEzMiAqIGIyMiArIGEzMyAqIGIzMiArIGEzNCAqIGI0MjsKCW1bMTBdID0gYTMxICogYjEzICsgYTMyICogYjIzICsgYTMzICogYjMzICsgYTM0ICogYjQzOwoJbVsxNF0gPSBhMzEgKiBiMTQgKyBhMzIgKiBiMjQgKyBhMzMgKiBiMzQgKyBhMzQgKiBiNDQ7CgoJbVszXSA9IGE0MSAqIGIxMSArIGE0MiAqIGIyMSArIGE0MyAqIGIzMSArIGE0NCAqIGI0MTsKCW1bN10gPSBhNDEgKiBiMTIgKyBhNDIgKiBiMjIgKyBhNDMgKiBiMzIgKyBhNDQgKiBiNDI7CgltWzExXSA9IGE0MSAqIGIxMyArIGE0MiAqIGIyMyArIGE0MyAqIGIzMyArIGE0NCAqIGI0MzsKCW1bMTVdID0gYTQxICogYjE0ICsgYTQyICogCWIyNCArIGE0MyAqIGIzNCArIGE0NCAqIGI0NDsKCglyZXR1cm4gbTsKfQoKbWF0cml4NC5pbnZlcnQgPSAobSkgPT4gewoJLy8gYmFzZWQgb24gaHR0cDovL3d3dy5ldWNsaWRlYW5zcGFjZS5jb20vbWF0aHMvYWxnZWJyYS9tYXRyaXgvZnVuY3Rpb25zL2ludmVyc2UvZm91ckQvaW5kZXguaHRtCgljb25zdCBuMTEgPSBtWzBdLCBuMjEgPSBtWzFdLCBuMzEgPSBtWzJdLCBuNDEgPSBtWzNdOwoJY29uc3QgbjEyID0gbVs0XSwgbjIyID0gbVs1XSwgbjMyID0gbVs2XSwgbjQyID0gbVs3XTsKCWNvbnN0IG4xMyA9IG1bOF0sIG4yMyA9IG1bOV0sIG4zMyA9IG1bMTBdLCBuNDMgPSBtWzExXTsKCWNvbnN0IG4xNCA9IG1bMTJdLCBuMjQgPSBtWzEzXSwgbjM0ID0gbVsxNF0sIG40NCA9IG1bMTVdOwoKCWNvbnN0IHQxMSA9IG4yMyAqIG4zNCAqIG40MiAtIG4yNCAqIG4zMyAqIG40MiArIG4yNCAqIG4zMiAqIG40MyAtIG4yMiAqIG4zNCAqIG40MyAtIG4yMyAqIG4zMiAqIG40NCArIG4yMiAqIG4zMyAqIG40NDsKCWNvbnN0IHQxMiA9IG4xNCAqIG4zMyAqIG40MiAtIG4xMyAqIG4zNCAqIG40MiAtIG4xNCAqIG4zMiAqIG40MyArIG4xMiAqIG4zNCAqIG40MyArIG4xMyAqIG4zMiAqIG40NCAtIG4xMiAqIG4zMyAqIG40NDsKCWNvbnN0IHQxMyA9IG4xMyAqIG4yNCAqIG40MiAtIG4xNCAqIG4yMyAqIG40MiArIG4xNCAqIG4yMiAqIG40MyAtIG4xMiAqIG4yNCAqIG40MyAtIG4xMyAqIG4yMiAqIG40NCArIG4xMiAqIG4yMyAqIG40NDsKCWNvbnN0IHQxNCA9IG4xNCAqIG4yMyAqIG4zMiAtIG4xMyAqIG4yNCAqIG4zMiAtIG4xNCAqIG4yMiAqIG4zMyArIG4xMiAqIG4yNCAqIG4zMyArIG4xMyAqIG4yMiAqIG4zNCAtIG4xMiAqIG4yMyAqIG4zNDsKCgljb25zdCBkZXQgPSBuMTEgKiB0MTEgKyBuMjEgKiB0MTIgKyBuMzEgKiB0MTMgKyBuNDEgKiB0MTQ7CgoJaWYgKGRldCA9PT0gMCkgcmV0dXJuIFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXTsKCgljb25zdCBkZXRJbnYgPSAxIC8gZGV0OwoKCW1bMF0gPSB0MTEgKiBkZXRJbnY7CgltWzFdID0gKG4yNCAqIG4zMyAqIG40MSAtIG4yMyAqIG4zNCAqIG40MSAtIG4yNCAqIG4zMSAqIG40MyArIG4yMSAqIG4zNCAqIG40MyArIG4yMyAqIG4zMSAqIG40NCAtIG4yMSAqIG4zMyAqIG40NCkgKiBkZXRJbnY7CgltWzJdID0gKG4yMiAqIG4zNCAqIG40MSAtIG4yNCAqIG4zMiAqIG40MSArIG4yNCAqIG4zMSAqIG40MiAtIG4yMSAqIG4zNCAqIG40MiAtIG4yMiAqIG4zMSAqIG40NCArIG4yMSAqIG4zMiAqIG40NCkgKiBkZXRJbnY7CgltWzNdID0gKG4yMyAqIG4zMiAqIG40MSAtIG4yMiAqIG4zMyAqIG40MSAtIG4yMyAqIG4zMSAqIG40MiArIG4yMSAqIG4zMyAqIG40MiArIG4yMiAqIG4zMSAqIG40MyAtIG4yMSAqIG4zMiAqIG40MykgKiBkZXRJbnY7CgoJbVs0XSA9IHQxMiAqIGRldEludjsKCW1bNV0gPSAobjEzICogbjM0ICogbjQxIC0gbjE0ICogbjMzICogbjQxICsgbjE0ICogbjMxICogbjQzIC0gbjExICogbjM0ICogbjQzIC0gbjEzICogbjMxICogbjQ0ICsgbjExICogbjMzICogbjQ0KSAqIGRldEludjsKCW1bNl0gPSAobjE0ICogbjMyICogbjQxIC0gbjEyICogbjM0ICogbjQxIC0gbjE0ICogbjMxICogbjQyICsgbjExICogbjM0ICogbjQyICsgbjEyICogbjMxICogbjQ0IC0gbjExICogbjMyICogbjQ0KSAqIGRldEludjsKCW1bN10gPSAobjEyICogbjMzICogbjQxIC0gbjEzICogbjMyICogbjQxICsgbjEzICogbjMxICogbjQyIC0gbjExICogbjMzICogbjQyIC0gbjEyICogbjMxICogbjQzICsgbjExICogbjMyICogbjQzKSAqIGRldEludjsKCgltWzhdID0gdDEzICogZGV0SW52OwoJbVs5XSA9IChuMTQgKiBuMjMgKiBuNDEgLSBuMTMgKiBuMjQgKiBuNDEgLSBuMTQgKiBuMjEgKiBuNDMgKyBuMTEgKiBuMjQgKiBuNDMgKyBuMTMgKiBuMjEgKiBuNDQgLSBuMTEgKiBuMjMgKiBuNDQpICogZGV0SW52OwoJbVsxMF0gPSAobjEyICogbjI0ICogbjQxIC0gbjE0ICogbjIyICogbjQxICsgbjE0ICogbjIxICogbjQyIC0gbjExICogbjI0ICogbjQyIC0gbjEyICogbjIxICogbjQ0ICsgbjExICogbjIyICogbjQ0KSAqIGRldEludjsKCW1bMTFdID0gKG4xMyAqIG4yMiAqIG40MSAtIG4xMiAqIG4yMyAqIG40MSAtIG4xMyAqIG4yMSAqIG40MiArIG4xMSAqIG4yMyAqIG40MiArIG4xMiAqIG4yMSAqIG40MyAtIG4xMSAqIG4yMiAqIG40MykgKiBkZXRJbnY7CgoJbVsxMl0gPSB0MTQgKiBkZXRJbnY7CgltWzEzXSA9IChuMTMgKiBuMjQgKiBuMzEgLSBuMTQgKiBuMjMgKiBuMzEgKyBuMTQgKiBuMjEgKiBuMzMgLSBuMTEgKiBuMjQgKiBuMzMgLSBuMTMgKiBuMjEgKiBuMzQgKyBuMTEgKiBuMjMgKiBuMzQpICogZGV0SW52OwoJbVsxNF0gPSAobjE0ICogbjIyICogbjMxIC0gbjEyICogbjI0ICogbjMxIC0gbjE0ICogbjIxICogbjMyICsgbjExICogbjI0ICogbjMyICsgbjEyICogbjIxICogbjM0IC0gbjExICogbjIyICogbjM0KSAqIGRldEludjsKCW1bMTVdID0gKG4xMiAqIG4yMyAqIG4zMSAtIG4xMyAqIG4yMiAqIG4zMSArIG4xMyAqIG4yMSAqIG4zMiAtIG4xMSAqIG4yMyAqIG4zMiAtIG4xMiAqIG4yMSAqIG4zMyArIG4xMSAqIG4yMiAqIG4zMykgKiBkZXRJbnY7CgoJcmV0dXJuIG07Cn0KCm1hdHJpeDQuY29tcG9zZSA9IChwb3NpdGlvbiwgcXVhdGVybmlvbiwgc2NhbGUpID0+IHsKCWNvbnN0IG0gPSBtYXRyaXg0LmlkZW50aXR5KCk7CgoJY29uc3QgeCA9IHF1YXRlcm5pb24ueCwgeSA9IHF1YXRlcm5pb24ueSwgeiA9IHF1YXRlcm5pb24ueiwgdyA9IHF1YXRlcm5pb24udzsKCWNvbnN0IHgyID0geCArIHgsCXkyID0geSArIHksIHoyID0geiArIHo7Cgljb25zdCB4eCA9IHggKiB4MiwgeHkgPSB4ICogeTIsIHh6ID0geCAqIHoyOwoJY29uc3QgeXkgPSB5ICogeTIsIHl6ID0geSAqIHoyLCB6eiA9IHogKiB6MjsKCWNvbnN0IHd4ID0gdyAqIHgyLCB3eSA9IHcgKiB5Miwgd3ogPSB3ICogejI7CgoJY29uc3Qgc3ggPSBzY2FsZS54LCBzeSA9IHNjYWxlLnksIHN6ID0gc2NhbGUuejsKCgltWzBdID0gKCAxIC0gKCB5eSArIHp6ICkgKSAqIHN4OwoJbVsxXSA9ICggeHkgKyB3eiApICogc3g7CgltWzJdID0gKCB4eiAtIHd5ICkgKiBzeDsKCW1bM10gPSAwOwoKCW1bNF0gPSAoIHh5IC0gd3ogKSAqIHN5OwoJbVs1XSA9ICggMSAtICggeHggKyB6eiApICkgKiBzeTsKCW1bNl0gPSAoIHl6ICsgd3ggKSAqIHN5OwoJbVs3XSA9IDA7CgoJbVs4XSA9ICggeHogKyB3eSApICogc3o7CgltWzldID0gKCB5eiAtIHd4ICkgKiBzejsKCW1bMTBdID0gKCAxIC0gKCB4eCArIHl5ICkgKSAqIHN6OwoJbVsxMV0gPSAwOwoKCW1bMTJdID0gcG9zaXRpb24ueDsKCW1bMTNdID0gcG9zaXRpb24ueTsKCW1bMTRdID0gcG9zaXRpb24uejsKCW1bMTVdID0gMTsKCglyZXR1cm4gbTsKfQoKbWF0cml4NC5kZWNvbXBvc2UgPSAobSkgPT4gewoJY29uc3QgcCA9IHZlY3RvcjMuemVybygpOwoJY29uc3QgcSA9IHF1YXRlcm5pb24uaWRlbnRpdHkoKTsKCWNvbnN0IHMgPSB2ZWN0b3IzLnplcm8oKTsKCglsZXQgc3ggPSB2ZWN0b3IzLmxlbmd0aCh7eDogbVswXSwgeTogbVsxXSwgejogbVsyXX0pOwoJY29uc3Qgc3kgPSB2ZWN0b3IzLmxlbmd0aCh7eDogbVs0XSwgeTogbVs1XSwgejogbVs2XX0pOwoJY29uc3Qgc3ogPSB2ZWN0b3IzLmxlbmd0aCh7eDogbVs4XSwgeTogbVs5XSwgejogbVsxMF19KTsKCgkvLyBpZiBkZXRlcm1pbmUgaXMgbmVnYXRpdmUsIHdlIG5lZWQgdG8gaW52ZXJ0IG9uZSBzY2FsZQoJY29uc3QgZGV0ID0gbWF0cml4NC5kZXRlcm1pbmFudChtKTsKCWlmICggZGV0IDwgMCApIHN4ID0gLSBzeDsKCglwLnggPSBtWzEyXTsKCXAueSA9IG1bMTNdOwoJcC56ID0gbVsxNF07CgoJLy8gc2NhbGUgdGhlIHJvdGF0aW9uIHBhcnQKCWxldCBtMSA9IFsuLi5tXTsKCgljb25zdCBpbnZTWCA9IDEgLyBzeDsKCWNvbnN0IGludlNZID0gMSAvIHN5OwoJY29uc3QgaW52U1ogPSAxIC8gc3o7CgoJbTFbMF0gKj0gaW52U1g7CgltMVsxXSAqPSBpbnZTWDsKCW0xWzJdICo9IGludlNYOwoKCW0xWzRdICo9IGludlNZOwoJbTFbNV0gKj0gaW52U1k7CgltMVs2XSAqPSBpbnZTWTsKCgltMVs4XSAqPSBpbnZTWjsKCW0xWzldICo9IGludlNaOwoJbTFbMTBdICo9IGludlNaOwoKCXF1YXRlcm5pb24uc2V0RnJvbVJvdGF0aW9uTWF0cml4KHEsIG0xKTsKCglzLnggPSBzeDsKCXMueSA9IHN5OwoJcy56ID0gc3o7CgoJcmV0dXJuIHsKCQlwb3NpdGlvbjogcCwKCQlxdWF0ZXJuaW9uOiBxLAoJCXNjYWxlOiBzLAoJfQp9CgptYXRyaXg0LmRldGVybWluYW50ID0gKG0pID0+IHsKCWNvbnN0IG4xMSA9IG1bIDAgXSwgbjEyID0gbVsgNCBdLCBuMTMgPSBtWyA4IF0sIG4xNCA9IG1bIDEyIF07Cgljb25zdCBuMjEgPSBtWyAxIF0sIG4yMiA9IG1bIDUgXSwgbjIzID0gbVsgOSBdLCBuMjQgPSBtWyAxMyBdOwoJY29uc3QgbjMxID0gbVsgMiBdLCBuMzIgPSBtWyA2IF0sIG4zMyA9IG1bIDEwIF0sIG4zNCA9IG1bIDE0IF07Cgljb25zdCBuNDEgPSBtWyAzIF0sIG40MiA9IG1bIDcgXSwgbjQzID0gbVsgMTEgXSwgbjQ0ID0gbVsgMTUgXTsKCgkvL1RPRE86IG1ha2UgdGhpcyBtb3JlIGVmZmljaWVudAoJLy8oIGJhc2VkIG9uIGh0dHA6Ly93d3cuZXVjbGlkZWFuc3BhY2UuY29tL21hdGhzL2FsZ2VicmEvbWF0cml4L2Z1bmN0aW9ucy9pbnZlcnNlL2ZvdXJEL2luZGV4Lmh0bSApCglyZXR1cm4gKAoJCW40MSAqICgKCQkJKyBuMTQgKiBuMjMgKiBuMzIKCQkJCS0gbjEzICogbjI0ICogbjMyCgkJCQktIG4xNCAqIG4yMiAqIG4zMwoJCQkJKyBuMTIgKiBuMjQgKiBuMzMKCQkJCSsgbjEzICogbjIyICogbjM0CgkJCQktIG4xMiAqIG4yMyAqIG4zNAoJCSkgKwoJCW40MiAqICgKCQkJKyBuMTEgKiBuMjMgKiBuMzQKCQkJCS0gbjExICogbjI0ICogbjMzCgkJCQkrIG4xNCAqIG4yMSAqIG4zMwoJCQkJLSBuMTMgKiBuMjEgKiBuMzQKCQkJCSsgbjEzICogbjI0ICogbjMxCgkJCQktIG4xNCAqIG4yMyAqIG4zMQoJCSkgKwoJCW40MyAqICgKCQkJKyBuMTEgKiBuMjQgKiBuMzIKCQkJCS0gbjExICogbjIyICogbjM0CgkJCQktIG4xNCAqIG4yMSAqIG4zMgoJCQkJKyBuMTIgKiBuMjEgKiBuMzQKCQkJCSsgbjE0ICogbjIyICogbjMxCgkJCQktIG4xMiAqIG4yNCAqIG4zMQoJCSkgKwoJCW40NCAqICgKCQkJLSBuMTMgKiBuMjIgKiBuMzEKCQkJCS0gbjExICogbjIzICogbjMyCgkJCQkrIG4xMSAqIG4yMiAqIG4zMwoJCQkJKyBuMTMgKiBuMjEgKiBuMzIKCQkJCS0gbjEyICogbjIxICogbjMzCgkJCQkrIG4xMiAqIG4yMyAqIG4zMQoJCSkKCSk7Cn0KCm1hdHJpeDQubG9va0F0ID0gKG0sIGV5ZSwgdGFyZ2V0LCB1cCkgPT4gewoJbGV0IHgsIHksIHo7CgoJeiA9IG1hdGguc3VidHJhY3RWZWN0b3JzKHRhcmdldCwgZXllKTsKCglpZiAoIHZlY3RvcjMubGVuZ3RoU3EoeikgPT09IDAgKSB7CgkJLy8gZXllIGFuZCB0YXJnZXQgYXJlIGluIHRoZSBzYW1lIHBvc2l0aW9uCgkJei56ID0gMTsKCX0KCgl6ID0gbWF0aC5ub3JtYWxpemVWZWN0b3Ioeik7Cgl4ID0gdmVjdG9yMy5jcm9zc1ZlY3RvcnModXAsIHopOwoKCWlmICggdmVjdG9yMy5sZW5ndGhTcSh4KSA9PT0gMCApIHsKCQkvLyB1cCBhbmQgeiBhcmUgcGFyYWxsZWwKCQlpZiAoTWF0aC5hYnModXAueikgPT09IDEpIHsKCQkJei54ICs9IDAuMDAwMTsKCQl9IGVsc2UgewoJCQl6LnogKz0gMC4wMDAxOwoJCX0KCgkJeiA9IG1hdGgubm9ybWFsaXplVmVjdG9yKHopOwoJCXggPSB2ZWN0b3IzLmNyb3NzVmVjdG9ycyh1cCwgeik7Cgl9CgoJeCA9IG1hdGgubm9ybWFsaXplVmVjdG9yKHgpOwoJeSA9IHZlY3RvcjMuY3Jvc3NWZWN0b3JzKHosIHgpOwoKCW1bMF0gPSB4Lng7IG1bNF0gPSB5Lng7IG1bOF0gPSB6Lng7CgltWzFdID0geC55OyBtWzVdID0geS55OyBtWzldID0gei55OwoJbVsyXSA9IHguejsgbVs2XSA9IHkuejsgbVsxMF0gPSB6Lno7CgoJcmV0dXJuIG07Cn0KCm1hdHJpeDQubG9jYWxNYXRyaXhGcm9tQm90ID0gKGJvdCwgZGltZW5zaW9uKSA9PiB7Cgljb25zdCBwID0gewoJCXg6IGJvdC50YWdzW2RpbWVuc2lvbiArICJYIl0gPz8gMCwKCQl5OiBib3QudGFnc1tkaW1lbnNpb24gKyAiWSJdID8/IDAsCgkJejogYm90LnRhZ3NbZGltZW5zaW9uICsgIloiXSA/PyAwLAoJfTsKCWNvbnN0IHIgPSB7CgkJeDogYm90LnRhZ3NbZGltZW5zaW9uICsgIlJvdGF0aW9uWCJdID8/IDAsCgkJeTogYm90LnRhZ3NbZGltZW5zaW9uICsgIlJvdGF0aW9uWSJdID8/IDAsCgkJejogYm90LnRhZ3NbZGltZW5zaW9uICsgIlJvdGF0aW9uWiJdID8/IDAsCgl9OwoJY29uc3QgcSA9IHF1YXRlcm5pb24uZnJvbUV1bGVyKHIpOwoJY29uc3QgcyA9IHsKCQl4OiBib3QudGFnc1sic2NhbGVYIl0gPz8gMSwKCQl5OiBib3QudGFnc1sic2NhbGVZIl0gPz8gMSwKCQl6OiBib3QudGFnc1sic2NhbGVZIl0gPz8gMSwKCX07Cgljb25zdCBzY2FsYXIgPSBib3QudGFnc1sic2NhbGUiXSA/PyAxOwoJdmVjdG9yMy5tdWx0aXBseVNjYWxhcihzLCBzY2FsYXIpOwoKCXJldHVybiBtYXRyaXg0LmNvbXBvc2UocCwgcSwgcyk7Cn0KCm1hdHJpeDQud29ybGRNYXRyaXhGcm9tQm90ID0gKGJvdCwgZGltZW5zaW9uKSA9PiB7CglsZXQgbWF0cml4V29ybGQgPSBtYXRyaXg0LmlkZW50aXR5KCk7Cgljb25zdCBtYXRyaXhMb2NhbCA9IG1hdHJpeDQubG9jYWxNYXRyaXhGcm9tQm90KGJvdCwgZGltZW5zaW9uKTsKCgljb25zdCBwYXJlbnRJZCA9IGJvdC50YWdzLnRyYW5zZm9ybWVyOwoJbGV0IHBhcmVudCA9IHBhcmVudElkID8gZ2V0Qm90KCdpZCcsIHBhcmVudElkKSA6IG51bGw7CgoJaWYgKCFwYXJlbnQpIHsKCQltYXRyaXhXb3JsZCA9IG1hdHJpeExvY2FsOwoJfSBlbHNlIHsKCQljb25zdCBwYXJlbnRNYXRyaXhXb3JsZCA9IG1hdHJpeDQud29ybGRGcm9tQm90KHBhcmVudCwgZGltZW5zaW9uKTsKCQltYXRyaXhXb3JsZCA9IG1hdHJpeDQubXVsdGlwbHlNYXRyaWNlcyhtYXRyaXhXb3JsZCwgcGFyZW50TWF0cml4V29ybGQsIG1hdHJpeExvY2FsKTsKCX0KCglyZXR1cm4gbWF0cml4V29ybGQ7Cn0nAN+tkeoMAAppbml0aWFsaXplAgQA362R6gyGkQGxDkBpZiAodGFncy5pbml0aWFsaXplZCkgewogICAgcmV0dXJuOwp9CgptYXNrcy5pbml0aWFsaXplZCA9IHRydWU7CgpncmlkUG9ydGFsQm90LnRhZ3MucG9ydGFsQ2FtZXJhVHlwZSA9ICdwZXJzcGVjdGl2ZSc7CmxlZnRXcmlzdFBvcnRhbEJvdC50YWdzLnBvcnRhbEdyaWRTY2FsZSA9IDAuMDI1OwpyaWdodFdyaXN0UG9ydGFsQm90LnRhZ3MucG9ydGFsR3JpZFNjYWxlID0gMC4wMjU7CgovLyoqKiBETyBXRSBORUVEIFRISVM/Pz8gSW5pdGlhbGl6ZSBjb25maWcgYm90IHdpdGggY3VzdG9tIHRhZ3MgYW5kIGFjdGlvbnMuCmNvbmZpZ0JvdC50YWdzLmluVlIgPSBmYWxzZTsKCmNvbmZpZ0JvdC50YWdzLm9uRW50ZXJWUiA9IGBACiAgICB0YWdzLmluVlIgPSB0cnVlOwogICAgc2hvdXQoJ29uQUIxTGVmdFdyaXN0Jyk7CmA7CmNvbmZpZ0JvdC50YWdzLm9uRXhpdFZSID0gYEAKICAgIHRhZ3MuaW5WUiA9IGZhbHNlOwpgOwpjb25maWdCb3QudGFncy5pbkFSID0gZmFsc2U7CmNvbmZpZ0JvdC50YWdzLm9uRW50ZXJBUiA9IGBACiAgICB0YWdzLmluQVIgPSB0cnVlOwogICAgc2hvdXQoJ29uQUIxTGVmdFdyaXN0Jyk7CmA7CmNvbmZpZ0JvdC50YWdzLm9uRXhpdEFSID0gYEAKICAgIHRhZ3MuaW5BUiA9IGZhbHNlOwpgOwoKaWYgKG5hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL0FuZHJvaWR8aVBob25lfGlQYWR8V2luZG93cyBQaG9uZXxNb2JpbGUvaSkpIHsKICAgIGNvbmZpZ0JvdC50YWdzLmlzTW9iaWxlID0gdHJ1ZTsKfSBlbHNlIHsKICAgIGNvbmZpZ0JvdC50YWdzLmlzTW9iaWxlID0gZmFsc2U7Cn0KCi8vIENyZWF0ZSB0aGUgbWFpbiBzY2VuZSBkaW1lbnNpb24gYm90LgpnbG9iYWxUaGlzLm1haW5TY2VuZUJvdCA9IGNyZWF0ZSh7CiAgICBzcGFjZTogJ3RlbXBMb2NhbCcsCiAgICBmb3JtOiAnZGltZW5zaW9uJywKICAgIGZvcm1BZGRyZXNzOiB0YWdzLm1haW5TY2VuZURpbWVuc2lvbiwKICAgIFt0YWdzLnJvb3REaW1lbnNpb25dOiB0cnVlLAogICAgW2Ake3RhZ3Mucm9vdERpbWVuc2lvbn1YYF06IDAsCiAgICBbYCR7dGFncy5yb290RGltZW5zaW9ufVlgXTogMCwKICAgIFtgJHt0YWdzLnJvb3REaW1lbnNpb259WmBdOiAwLAogICAgW2Ake3RhZ3Mucm9vdERpbWVuc2lvbn1Sb3RhdGlvblhgXTogMCwKICAgIFtgJHt0YWdzLnJvb3REaW1lbnNpb259Um90YXRpb25ZYF06IDAsCiAgICBbYCR7dGFncy5yb290RGltZW5zaW9ufVJvdGF0aW9uWmBdOiAwLAogICAgc3lzdGVtOiAiYWItMS5pbW1lcnNpdmUudGVtcE1haW5TY2VuZUJvdCIKfSk7CgppZiAodGFncy5zaG93Q29tcGFzcyA9PT0gdHJ1ZSkgewogICAgY3JlYXRlKHsKICAgICAgICBzcGFjZTogJ3RlbXBMb2NhbCcsCiAgICAgICAgZm9ybTogJ3Nwcml0ZScsCiAgICAgICAgZm9ybUFkZHJlc3M6ICdodHRwczovL2J1aWxkZXItbHRtLWZpbGVzLnMzLmFtYXpvbmF3cy5jb20vMDE3NDRkNDc3NDNhYmI4MjcyNzViN2JiODY1ZjI2ZTQzODYwMzk3OThkOTc1M2Q1MjEzOTk1MTVkYzM3MGZhYi5wbmcnLAogICAgICAgIGRyYWdnYWJsZTogZmFsc2UsCiAgICAgICAgcG9pbnRhYmxlOiBmYWxzZSwKICAgICAgICBbdGFncy5tYWluU2NlbmVEaW1lbnNpb25dOiB0cnVlLAogICAgICAgIFtgJHt0YWdzLm1haW5TY2VuZURpbWVuc2lvbn1aYF06IC0xLjUsCiAgICAgICAgc2NhbGU6IDMsCiAgICAgICAgc3lzdGVtOiAiYWItMS5pbW1lcnNpdmUuY29tcGFzcyIKICAgIH0pOwp9CgpnbG9iYWxUaGlzLmltbWVyc2l2ZU1hbmFnZXIgPSB0aGlzQm90OwoKdGhpc0JvdC5jb21waWxlQ1NTKCk7Cgp0aGlzQm90Lm9uSW5pdGlhbGl6ZSgpOwoKbGlua3MuZnJ1c3R1bS5lbmFibGVGcnVzdHVtKCk7JwDfrZHqDAANcm9vdERpbWVuc2lvbgIEAN+tkeoMuJ8BB2ltbWVyc2UnAN+tkeoMABJtYWluU2NlbmVEaW1lbnNpb24CBADfrZHqDMCfAQRob21lJwDfrZHqDAAMb25Jbml0aWFsaXplAgQA362R6gzFnwHLEUB0aGlzQm90Lm1vdW50KCk7Cgp0aGlzQm90LmluaXRpYWxpemVNYXRoKCk7CgpnbG9iYWxUaGlzLnRyYW5zZm9ybSA9IHt9OwoKdHJhbnNmb3JtLmdldEJvdFBvc2l0aW9uID0gKGJvdCwgZGltZW5zaW9uKSA9PiB7CiAgICByZXR1cm4gewogICAgICAgIHg6IGJvdC50YWdzW2Ake2RpbWVuc2lvbn1YYF0sCiAgICAgICAgeTogYm90LnRhZ3NbYCR7ZGltZW5zaW9ufVlgXSwKICAgICAgICB6OiBib3QudGFnc1tgJHtkaW1lbnNpb259WmBdLAogICAgfQp9Cgp0cmFuc2Zvcm0uc2V0Qm90UG9zaXRpb24gPSAoYm90LCBkaW1lbnNpb24sIHBvc2l0aW9uKSA9PiB7CiAgICBib3QudGFnc1tgJHtkaW1lbnNpb259WGBdID0gcG9zaXRpb24ueDsKICAgIGJvdC50YWdzW2Ake2RpbWVuc2lvbn1ZYF0gPSBwb3NpdGlvbi55OwogICAgYm90LnRhZ3NbYCR7ZGltZW5zaW9ufVpgXSA9IHBvc2l0aW9uLno7Cn0KCnRyYW5zZm9ybS5nZXRCb3RSb3RhdGlvbiA9IChib3QsIGRpbWVuc2lvbikgPT4gewogICAgY29uc3Qgcm90YXRpb24gPSBib3QudGFnc1tgJHtkaW1lbnNpb259Um90YXRpb25gXTsKICAgIGlmIChyb3RhdGlvbikgewogICAgICAgIHJldHVybiByb3RhdGlvbjsKICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgeDogYm90LnRhZ3NbYCR7ZGltZW5zaW9ufVJvdGF0aW9uWGBdLAogICAgICAgICAgICB5OiBib3QudGFnc1tgJHtkaW1lbnNpb259Um90YXRpb25ZYF0sCiAgICAgICAgICAgIHo6IGJvdC50YWdzW2Ake2RpbWVuc2lvbn1Sb3RhdGlvblpgXSwKICAgICAgICB9CiAgICB9Cn0KCnRyYW5zZm9ybS5zZXRCb3RSb3RhdGlvbiA9IChib3QsIGRpbWVuc2lvbiwgcm90YXRpb24pID0+IHsKICAgIGlmIChyb3RhdGlvbi5xdWF0ZXJuaW9uKSB7CiAgICAgICAgYm90LnRhZ3NbYCR7ZGltZW5zaW9ufVJvdGF0aW9uYF0gPSByb3RhdGlvbjsKICAgICAgICBkZWxldGUgYm90LnRhZ3NbYCR7ZGltZW5zaW9ufVJvdGF0aW9uWGBdOwogICAgICAgIGRlbGV0ZSBib3QudGFnc1tgJHtkaW1lbnNpb259Um90YXRpb25ZYF07CiAgICAgICAgZGVsZXRlIGJvdC50YWdzW2Ake2RpbWVuc2lvbn1Sb3RhdGlvblpgXTsKICAgIH0gZWxzZSB7CiAgICAgICAgYm90LnRhZ3NbYCR7ZGltZW5zaW9ufVJvdGF0aW9uWGBdID0gcm90YXRpb24ueDsKICAgICAgICBib3QudGFnc1tgJHtkaW1lbnNpb259Um90YXRpb25ZYF0gPSByb3RhdGlvbi55OwogICAgICAgIGJvdC50YWdzW2Ake2RpbWVuc2lvbn1Sb3RhdGlvblpgXSA9IHJvdGF0aW9uLno7CiAgICB9Cn0KCnRyYW5zZm9ybS5nZXRCb3RTY2FsZSA9IChib3QpID0+IHsKICAgIHJldHVybiB7CiAgICAgICAgeDogYm90LnRhZ3NbYHNjYWxlWGBdLAogICAgICAgIHk6IGJvdC50YWdzW2BzY2FsZVlgXSwKICAgICAgICB6OiBib3QudGFnc1tgc2NhbGVaYF0sCiAgICB9Cn0KCnRyYW5zZm9ybS5zZXRCb3RTY2FsZSA9IChib3QsIHNjYWxlKSA9PiB7CiAgICBib3QudGFnc1tgc2NhbGVYYF0gPSBzY2FsZS54OwogICAgYm90LnRhZ3NbYHNjYWxlWWBdID0gc2NhbGUueTsKICAgIGJvdC50YWdzW2BzY2FsZVpgXSA9IHNjYWxlLno7Cn0KCnRyYW5zZm9ybS5sb29rQXRQb2ludCA9IChleWVCb3QsIGV5ZUJvdERpbWVuc2lvbiwgcG9pbnQpID0+IHsKICAgIGNvbnN0IHRhcmdldFBvcyA9IHsuLi5wb2ludH07CiAgICBjb25zdCBleWVQb3MgPSB0cmFuc2Zvcm0uZ2V0Qm90UG9zaXRpb24oZXllQm90LCBleWVCb3REaW1lbnNpb24pOwogICAgCiAgICBjb25zdCBkaXJlY3Rpb24gPSBtYXRoLnN1YnRyYWN0VmVjdG9ycyh0YXJnZXRQb3MsIGV5ZVBvcyk7CgogICAgY29uc3QgbG9va1JvdGF0aW9uID0gbmV3IFJvdGF0aW9uKHsKICAgICAgICBkaXJlY3Rpb24sCiAgICAgICAgdXB3YXJkczogbmV3IFZlY3RvcjMoMCwgMCwgMSksCiAgICAgICAgZXJyb3JIYW5kbGluZzogJ251ZGdlJywKICAgIH0pCgogICAgdHJhbnNmb3JtLnNldEJvdFJvdGF0aW9uKGV5ZUJvdCwgZXllQm90RGltZW5zaW9uLCBsb29rUm90YXRpb24pOwp9Cgp0cmFuc2Zvcm0ubG9va0F0Qm90ID0gKCBleWVCb3QsIGV5ZUJvdERpbWVuc2lvbiwgdGFyZ2V0Qm90LCB0YXJnZXREaW1lbnNpb24gKSA9PiB7CiAgICBjb25zdCB0YXJnZXRQb3MgPSB0cmFuc2Zvcm0uZ2V0Qm90UG9zaXRpb24oIHRhcmdldEJvdCwgdGFyZ2V0RGltZW5zaW9uICk7CiAgICB0cmFuc2Zvcm0ubG9va0F0UG9pbnQoZXllQm90LCBleWVCb3REaW1lbnNpb24sIHRhcmdldFBvcyk7Cn0nAN+tkeoMAApjb21waWxlQ1NTAgQA362R6gyRsQHRBEBnbG9iYWxUaGlzLmNvbXBpbGVDU1MgPSAoYm90cykgPT4gewogICAgYm90cyA9IEFycmF5LmlzQXJyYXkoYm90cykgPyBib3RzIDogW2JvdHNdOwoKICAgIGxldCBjc3MgPSBbXTsKCiAgICBmb3IgKGxldCBib3Qgb2YgYm90cykgewogICAgICAgIGZvciAobGV0IGtleSBpbiBib3QudGFncykgewogICAgICAgICAgICBpZiAoa2V5ICE9PSAnY29tcGlsZUNTUycgJiYga2V5LnRvTG93ZXJDYXNlKCkuZW5kc1dpdGgoJ2NzcycpKSB7CiAgICAgICAgICAgICAgICBpZiAodGFncy5kZWJ1ZykgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbY29tcGlsZUNTU10gZm91bmQgQ1NTIGtleTogJHtrZXl9YCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjc3MucHVzaChib3QudGFnc1trZXldKTsKICAgICAgICAgICAgfQogICAgICAgIH0KfQoKICAgIGNvbnN0IGNvbXBpbGVkID0gY3NzLmpvaW4oJ1xuXG4nKTsKICAgIGlmICh0YWdzLmRlYnVnKSB7CiAgICAgICAgY29uc29sZS5sb2coYFtjb21waWxlQ1NTXSBjb21waWxlZCBDU1M6XG5cbmAsIGNvbXBpbGVkKTsKICAgIH0KCiAgICByZXR1cm4gY29tcGlsZWQ7Cn07JwDfrZHqDAAOb25BQjFMZWZ0V3Jpc3QCBADfrZHqDOO1AaYDQGNvbmZpZ0JvdC50YWdzLmxlZnRXcmlzdFBvcnRhbCA9IHRhZ3MubGVmdFdyaXN0UG9ydGFsTmFtZQoKbGVmdFdyaXN0UG9ydGFsQm90LnRhZ3Mud3Jpc3RQb3J0YWxXaWR0aCA9IC0xOwpsZWZ0V3Jpc3RQb3J0YWxCb3QudGFncy53cmlzdFBvcnRhbEhlaWdodCA9IC0xOwoKLy8gQ29tcGFzcyBDYWxpYnJhdGlvbiBCdXR0b24KY3JlYXRlKHRoaXNCb3QuYnV0dG9uKHsKICAgIHNwYWNlOiAndGVtcExvY2FsJywKICAgIGRpbWVuc2lvbjogdGFncy5sZWZ0V3Jpc3RQb3J0YWxOYW1lLAogICAgZGltZW5zaW9uWDogNS41LAogICAgZGltZW5zaW9uWTogMywKICAgIGxhYmVsOiAnQ29tcGFzcyBDYWxpYnJhdGlvbicsCiAgICBvbkNsaWNrOiBgQAogICAgICAgIGltbWVyc2l2ZU1hbmFnZXIuY29tcGFzc0NhbGlicmF0aW9uKCk7CiAgICBgCn0pKTsnAN+tkeoMAAlvbkRlc3Ryb3kCBADfrZHqDIq5AYYBQGdsb2JhbFRoaXMuY29tcGlsZUNTUyA9IHVuZGVmaW5lZDsKZ2xvYmFsVGhpcy5tYXRoVXRpbHMgPSB1bmRlZmluZWQ7Cmdsb2JhbFRoaXMudHJhbnNmb3JtID0gdW5kZWZpbmVkOwoKY2xlYXJJbnRlcnZhbCh0YWdzLmludGVydmFsKTsnAN+tkeoMAANBcHACBADfrZHqDJG6AawKQGNvbnN0IGNzcyA9IGNvbXBpbGVDU1MoWyB0aGlzQm90IF0pOwpjb25zdCB7IHVzZVN0YXRlLCB1c2VDYWxsYmFjayB9ID0gb3MuYXBwSG9va3M7Cgpjb25zdCBFbnRlclhSQnV0dG9uID0gKHsgbW9kZSwgb25DbGljayB9KSA9PiB7CiAgICBpZiAobW9kZSAhPT0gJ3ZyJyAmJiBtb2RlICE9PSAnYXInKSB7CiAgICAgICAgY29uc29sZS53YXJuKGBbRW50ZXJYUkJ1dHRvbl0gVW5rbm93biBtb2RlICR7bW9kZX0sIGRlZmF1bHRpbmcgdG8gdnJgKTsKICAgICAgICBtb2RlID0gJ3ZyJzsKICAgIH0KCiAgICByZXR1cm4gKAogICAgICAgIDxidXR0b24gY2xhc3NOYW1lPSdlbnRlci14ci1idXR0b24nIG9uQ2xpY2s9e29uQ2xpY2t9PkVudGVyIHttb2RlLnRvVXBwZXJDYXNlKCl9PC9idXR0b24+CiAgICApCn0KCmNvbnN0IEFwcCA9ICgpID0+IHsKICAgIGNvbnN0IG9uRW50ZXJWUkNsaWNrID0gKCkgPT4gewogICAgICAgIG9zLmVuYWJsZVZSKCk7CiAgICB9CgogICAgY29uc3Qgb25FbnRlckFSQ2xpY2sgPSAoKSA9PiB7CiAgICAgICAgb3MuZW5hYmxlQVIoKTsKICAgIH0KCiAgICBsZXQgc3VwcG9ydHNBUiA9IG9zLmRldmljZSgpLnN1cHBvcnRzQVI7CiAgICBsZXQgc3VwcG9ydHNWUiA9IG9zLmRldmljZSgpLnN1cHBvcnRzVlI7CgogICAgcmV0dXJuICgKICAgICAgICA8PiAgCiAgICAgICAgICAgIDxzdHlsZT57Y3NzfTwvc3R5bGU+CiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdlbnRlci14ci1idXR0b25zJz4KICAgICAgICAgICAgICAgIHsgc3VwcG9ydHNBUiAmJgogICAgICAgICAgICAgICAgICAgIDxFbnRlclhSQnV0dG9uIG1vZGU9J2FyJyBvbkNsaWNrPXtvbkVudGVyQVJDbGlja30vPgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgeyBzdXBwb3J0c1ZSICYmIAogICAgICAgICAgICAgICAgICAgIDxFbnRlclhSQnV0dG9uIG1vZGU9J3ZyJyBvbkNsaWNrPXtvbkVudGVyVlJDbGlja30vPgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgeyBjb25maWdCb3QudGFncy5kZXZWUiAmJgogICAgICAgICAgICAgICAgICAgIDxFbnRlclhSQnV0dG9uIG1vZGU9J2FyJyBvbkNsaWNrPXtvbkVudGVyQVJDbGlja30vPgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgeyBjb25maWdCb3QudGFncy5kZXZWUiAmJiAKICAgICAgICAgICAgICAgICAgICA8RW50ZXJYUkJ1dHRvbiBtb2RlPSd2cicgb25DbGljaz17b25FbnRlclZSQ2xpY2t9Lz4KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIAogICAgICAgIDwvPgogICAgKQp9CgpyZXR1cm4gQXBwOycA362R6gwABW1vdW50AgQA362R6gy+xAGYAUBpZiAoIXRoaXNCb3QudmFycy5hcHBJbnN0YW5jZSkgewogICAgdGhpc0JvdC52YXJzLmFwcEluc3RhbmNlID0gdGhpc0JvdC5BcHAoKTsKICAgIGF3YWl0IG9zLnJlZ2lzdGVyQXBwKHRhZ3MuYXBwSWQsIHRoaXNCb3QpOwoKICAgIHRoaXNCb3QucmVmcmVzaCgpOwp9JwDfrZHqDAAHcmVmcmVzaAIEAN+tkeoM18UBW0Bjb25zdCBBcHAgPSB0aGlzQm90LnZhcnMuYXBwSW5zdGFuY2U7CgppZiAoQXBwKSB7CiAgICBvcy5jb21waWxlQXBwKHRhZ3MuYXBwSWQsIDxBcHAvPik7Cn0nAN+tkeoMAAd1bm1vdW50AgQA362R6gyzxgGRAUBpZiAodGhpc0JvdC52YXJzLmFwcEluc3RhbmNlKSB7CiAgICB0aGlzQm90LnZhcnMgPSB7fTsKICAgIGNsZWFyVGFnTWFza3NTdGFydGluZ1dpdGgodGhpc0JvdCwgJ2FwcF8nKTsKICAgIGF3YWl0IG9zLnVucmVnaXN0ZXJBcHAodGFncy5hcHBJZCk7Cn0nAN+tkeoMAAdBcHAuY3NzAgQA362R6gzFxwHfBC5lbnRlci14ci1idXR0b25zIHsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBmbGV4LWRpcmVjdGlvbjogcm93OwogICAgd2lkdGg6IDEwMCU7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIGNvbHVtbi1nYXA6IDQwcHg7CiAgICBib3R0b206IDE1dmg7Cn0KCi5lbnRlci14ci1idXR0b25zIGJ1dHRvbiB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsKICAgIGNvbG9yOiAjN0I2NEZGOwogICAgZm9udC1zaXplOiAxLjI1ZW07CiAgICBwYWRkaW5nOiAxNHB4IDI4cHg7CiAgICBib3JkZXItcmFkaXVzOiA2cHg7CiAgICBib3JkZXItc3R5bGU6IHNvbGlkOwogICAgYm9yZGVyLXdpZHRoOiAycHg7CiAgICBib3JkZXItY29sb3I6ICM3QjY0RkY7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICB1c2VyLXNlbGVjdDogbm9uZTsKfQoKQG1lZGlhIChob3ZlcikgewogICAgLmVudGVyLXhyLWJ1dHRvbnMgYnV0dG9uOmhvdmVyIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNjY2OwogICAgfQp9CgouZW50ZXIteHItYnV0dG9ucyBidXR0b246YWN0aXZlIHsKICAgIGJhY2tncm91bmQtY29sb3I6ICM4ODg7Cn0nAN+tkeoMAAVhcHBJZAIEAN+tkeoMpcwBA2FwcCcA362R6gwAG2xlZnRXcmlzdENhbGlicmF0aW9uQnV0dG9ucwIEAN+tkeoMqcwBBHRydWUnAN+tkeoMAAtzaG93Q29tcGFzcwIEAN+tkeoMrswBBHRydWUnAN+tkeoMAA9mcm9tVG9EaW1lbnNpb24CBADfrZHqDLPMAYQDQGNvbnN0IHsgYm90LCBmcm9tLCB0byB9ID0gdGhhdDsKCmJvdC50YWdzW2Zyb21dID0gbnVsbDsKYm90LnRhZ3NbdG9dID0gdHJ1ZTsKCmNvbnN0IGZyb21Qb3NpdGlvbiA9IHRyYW5zZm9ybS5nZXRCb3RQb3NpdGlvbihib3QsIGZyb20pOwpjb25zdCBmcm9tUm90YXRpb24gPSB0cmFuc2Zvcm0uZ2V0Qm90Um90YXRpb24oYm90LCBmcm9tKTsKY29uc3QgZnJvbVNjYWxlID0gdHJhbnNmb3JtLmdldEJvdFNjYWxlKGJvdCwgZnJvbSk7Cgp0cmFuc2Zvcm0uc2V0Qm90UG9zaXRpb24oYm90LCB0bywgZnJvbVBvc2l0aW9uKTsKdHJhbnNmb3JtLnNldEJvdFJvdGF0aW9uKGJvdCwgdG8sIGZyb21Sb3RhdGlvbik7CnRyYW5zZm9ybS5zZXRCb3RTY2FsZShib3QsIHRvLCBmcm9tU2NhbGUpOycA362R6gwADG9uQW55Qm90RHJhZwIEAN+tkeoMuM8BoQdAaWYgKCF0YWdzLmluaXRpYWxpemVkKQp7CiAgICByZXR1cm47Cn0KCmNvbnN0IGRpbSA9IHRoYXQuZnJvbS5kaW1lbnNpb247CmNvbnN0IGRyYWdCb3QgPSB0aGF0LmJvdDsKCi8vTUFZIE5FRUQgVE8gUkVGSU5FIFRISVMKY29uc3QgaXNGcm9tSGFuZGxlZERpbWVuc2lvbiA9IGRpbSA9PT0gJ2hvbWUnIHx8IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGltID09PSBtYWluU2NlbmVCb3QudGFncy5mb3JtQWRkcmVzcyB8fCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpbSA9PT0gdGFncy5sZWZ0V3Jpc3RQb3J0YWxOYW1lOwoKaWYgKCFpc0Zyb21IYW5kbGVkRGltZW5zaW9uKSB7CiAgICByZXR1cm47Cn0KCmNvbnN0IGlzVG9CZUlnbm9yZWQgPSBkcmFnQm90LnRhZ3MuaWdub3JlTWFpblNjZW5lSGFuZGxlcjsKaWYgKGlzVG9CZUlnbm9yZWQpIHsKICAgIHJldHVybjsKfQoKZHJhZ0JvdC50YWdzLm1haW5TY2VuZUhhbmRsZXJPYnNlcnZpbmcgPSB0cnVlOwoKaWYgKHRhZ3MuZGVidWcpIHsKICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX1dIGFkZCBkcm9wIGdyaWRzYCk7Cn0KCm9zLmFkZERyb3BHcmlkKAogICAgewogICAgICAgIHBvcnRhbEJvdDogbWFpblNjZW5lQm90LAogICAgICAgIHNob3dHcmlkOiBmYWxzZSwKICAgICAgICBwcmlvcml0eTogMTAwLAogICAgICAgIGJvdW5kczogeyB4OiAxMDAwMCwgeTogMTAwMDAgfQogICAgfSwKICAgIHsKICAgICAgICBwb3J0YWxCb3Q6IGNvbmZpZ0JvdCwKICAgICAgICBwb3J0YWxUYWc6ICdsZWZ0V3Jpc3RQb3J0YWwnLAogICAgICAgIHByaW9yaXR5OiAyMDAsCiAgICAgICAgc2hvd0dyaWQ6IHRydWUsCiAgICAgICAgcG9zaXRpb246IHsgeDogMywgeTogMiwgejogMCB9LAogICAgICAgIGJvdW5kczogeyB4OiAxMCwgeTogMTAgfQogICAgfQopCicA362R6gwADG9uQW55Qm90RHJvcAIEAN+tkeoM2tYBngVAaWYgKCF0YWdzLmluaXRpYWxpemVkKQp7CiAgICByZXR1cm47Cn0KCmNvbnN0IGRyYWdCb3QgPSB0aGF0LmJvdDsKCmlmIChkcmFnQm90LnRhZ3MubWFpblNjZW5lSGFuZGxlck9ic2VydmluZykgewogICAgaWYgKHRhZ3MuZGVidWcpIHsKICAgICAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19XSBvbiBoYW5kbGVkIGJvdCBkcm9wcGVkYCk7CiAgICB9CgogICAgZHJhZ0JvdC50YWdzLm1haW5TY2VuZUhhbmRsZXJPYnNlcnZpbmcgPSBudWxsOwogICAgCiAgICBjb25zdCBib3RJbkhvbWUgPSBkcmFnQm90LnRhZ3MuaG9tZSA9PT0gdHJ1ZTsKICAgIGNvbnN0IGJvdEluTWFpblNjZW5lID0gZHJhZ0JvdC50YWdzW21haW5TY2VuZUJvdC50YWdzLmZvcm1BZGRyZXNzXSA9PT0gdHJ1ZTsKCiAgICBpZiAoYm90SW5Ib21lICYmICFib3RJbk1haW5TY2VuZSkgewogICAgICAgIC8vIElmIGEgYm90IHRoYXQgd2FzIGJlaW5nIGhhbmRsZWQgc29tZWhvdyBlbmRzIHVwIGluIHRoZSBob21lIGRpbWVuc2lvbiwgdGhlbiBtb3ZlIGl0IGJhY2sgdG8gdGhlIG1haW5TY2VuZSBkaW1lbnNpb24uCiAgICAgICAgdGhpc0JvdC5mcm9tVG9EaW1lbnNpb24oeyBib3Q6IGRyYWdCb3QsIGZyb206ICdob21lJywgdG86IG1haW5TY2VuZUJvdC50YWdzLmZvcm1BZGRyZXNzIH0pOwogICAgfQp9JwDfrZHqDAALb25BbnlDcmVhdGUCBADfrZHqDPnbAesEQGlmICghdGFncy5pbml0aWFsaXplZCkKewogICAgcmV0dXJuOwp9Cgpjb25zdCB7IGJvdCB9ID0gdGhhdDsKCmxldCBpc0FCMUJvdCA9IGxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWIxQm90ID8gYm90LmlkID09PSBsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiMUJvdC5pZCA6IGZhbHNlOwpsZXQgaXNNZW51Qm90ID0gYm90LnRhZ3NbY29uZmlnQm90LnRhZ3MubWVudVBvcnRhbF0gPT09IHRydWUgPyB0cnVlIDogZmFsc2U7CgppZiAoZ2xvYmFsVGhpcy5tYWluU2NlbmVCb3QgJiYgIWlzTWVudUJvdCAmJiAhaXNBQjFCb3QgJiYgYm90LnRhZ3Muc3BhY2UgPT0gInNoYXJlZCIpIHsKICAgIGNvbnN0IGJvdEluSW1tZXJzZSA9IGJvdC50YWdzLmltbWVyc2UgPT09IHRydWU7CiAgICBjb25zdCBib3RJbk1haW5TY2VuZSA9IGJvdC50YWdzW21haW5TY2VuZUJvdC50YWdzLmZvcm1BZGRyZXNzXSA9PT0gdHJ1ZTsKICAgIAogICAgaWYgKGJvdEluSW1tZXJzZSAmJiAhYm90SW5NYWluU2NlbmUpIAogICAgewogICAgICAgIHRoaXNCb3QuZnJvbVRvRGltZW5zaW9uKHsgYm90LCBmcm9tOiAnaW1tZXJzZScsIHRvOiBtYWluU2NlbmVCb3QudGFncy5mb3JtQWRkcmVzcyB9KTsKICAgIH0KfScA362R6gwABWRlYnVnAgQA362R6gzl4AEEdHJ1ZSgA362R6gwAFG1vdmVCb3RzQ3JlYXRlZEJ5QUIxAX4oAN+tkeoMABZtb3ZlQm90c0NyZWF0ZWRCeU90aGVyAX4nAN+tkeoMAAZidXR0b24CBADfrZHqDOzgAZ8IQGNvbnN0IHsgCiAgICBzcGFjZT0gJ3RlbXBMb2NhbCcsCiAgICBsYWJlbCA9ICdCdXR0b24nLAogICAgb25DbGljayA9IGBAb3MudG9hc3QoJ2J1dHRvbiBjbGlja2VkJylgLAogICAgZGltZW5zaW9uLAogICAgZGltZW5zaW9uWCA9IDAsCiAgICBkaW1lbnNpb25ZID0gMCwKICAgIGRpbWVuc2lvblogPSAwLAogICAgb25BZGRlZCwKfSA9IHRoYXQ7Cgphc3NlcnQoZGltZW5zaW9uLCAnW2J1dHRvbl0gZGltZW5zaW9uIHBhcmFtZXRlciBpcyByZXF1aXJlZCcpOwoKY29uc3QgYnV0dG9uTW9kID0gewogICAgc3BhY2UsCiAgICBsYWJlbCwKICAgIG9uQnV0dG9uQ2xpY2s6IG9uQ2xpY2ssCiAgICBzY2FsZVg6IDEuOSwKICAgIHNjYWxlWTogMC45LAogICAgc2NhbGVaOiAwLjMsCiAgICBkcmFnZ2FibGU6IGZhbHNlLAogICAgW2RpbWVuc2lvbl06IHRydWUsCiAgICBbZGltZW5zaW9uICsgJ1gnXTogZGltZW5zaW9uWCwKICAgIFtkaW1lbnNpb24gKyAnWSddOiBkaW1lbnNpb25ZLAogICAgW2RpbWVuc2lvbiArICdaJ106IGRpbWVuc2lvblosCiAgICBvbkFkZGVkLAogICAgb25Cb3RBZGRlZDogYEAKICAgICAgICB3aGlzcGVyKHRoaXNCb3QsICdvbkFkZGVkJyk7CiAgICBgLAogICAgb25DbGljazogYEAKICAgICAgICB3aGlzcGVyKHRoaXNCb3QsICdvbkJ1dHRvbkNsaWNrJyk7CiAgICAgICAgbWFza3MuY29sb3IgPSBudWxsOwogICAgICAgIG1hc2tzLnNjYWxlWiA9IG51bGw7CiAgICBgLAogICAgb25Qb2ludGVyRG93bjogYEAKICAgICAgICBtYXNrcy5jb2xvciA9ICdyb3lhbGJsdWUnOwogICAgICAgIG1hc2tzLnNjYWxlWiA9IDAuMTsKICAgIGAsCiAgICBvblBvaW50ZXJVcDogYEAKICAgICAgICBtYXNrcy5zY2FsZVogPSBudWxsOwogICAgYCwKICAgIG9uUG9pbnRlckVudGVyOiBgQAogICAgICAgIG1hc2tzLmNvbG9yID0gJ3NreWJsdWUnOwogICAgYCwKICAgIG9uUG9pbnRlckV4aXQ6IGBACiAgICAgICAgbWFza3MuY29sb3IgPSBudWxsOwogICAgICAgIG1hc2tzLnNjYWxlWiA9IG51bGw7CiAgICBgLAp9CgpyZXR1cm4gWyBidXR0b25Nb2QgXTsnAN+tkeoMABJjb21wYXNzQ2FsaWJyYXRpb24CBADfrZHqDIzpAf8CQGlmICghZ2xvYmFsVGhpcy5tYWluU2NlbmVCb3QpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ0NvbXBhc3MgY2FsaWJyYXRpb24gbmVlZHMgbWFpblNjZW5lQm90IHRvIGJlIGxvYWRlZC4nKTsKICAgIHJldHVybjsKfQoKY29uc3QgZGltID0gb3MuZ2V0Q3VycmVudERpbWVuc2lvbigpOwpjb25zdCBjYW1Qb3MgPSBvcy5nZXRDYW1lcmFQb3NpdGlvbignZ3JpZCcpOwoKbWFpblNjZW5lQm90LnRhZ3NbYCR7ZGltfVhgXSA9IGNhbVBvcy54OwptYWluU2NlbmVCb3QudGFnc1tgJHtkaW19WWBdID0gY2FtUG9zLnk7Cgpjb25zdCBjYW1Sb3QgPSBvcy5nZXRDYW1lcmFSb3RhdGlvbignZ3JpZCcpOwptYWluU2NlbmVCb3QudGFnc1tgJHtkaW19Um90YXRpb25aYF0gPSBjYW1Sb3QuejsoAN+tkeoMAA1hYjFCb3RWZXJzaW9uAX0MJwDfrZHqDAAJYWIxSWdub3JlAgQA362R6gyN7AEEdHJ1ZScA362R6gwAB2ZydXN0dW0CBADfrZHqDJLsASjwn5SXZjg1YWQwYTAtMjA0ZC00YmNkLWIyMTgtN2EyMzM3NGI1MDk4JwDfrZHqDAANbWFuaWZlc3RhdGlvbgIEAN+tkeoMuewBKPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAN+tkeoMAApvbkJvdEFkZGVkAgQA362R6gzg7AG4AUBhd2FpdCBvcy5zbGVlcCg1MDApOwoKbGV0IHN1cHBvcnRzQVIgPSBvcy5kZXZpY2UoKS5zdXBwb3J0c0FSOwpsZXQgc3VwcG9ydHNWUiA9IG9zLmRldmljZSgpLnN1cHBvcnRzVlI7CgppZiAoc3VwcG9ydHNBUiB8fCBzdXBwb3J0c1ZSKQp7CiAgICBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsID0gImltbWVyc2l2ZSI7Cn0nAN+tkeoMABNsZWZ0V3Jpc3RQb3J0YWxOYW1lAgQA362R6gyZ7gEOYWIxV3Jpc3RQb3J0YWwnAQRib3RzJGY4NWFkMGEwLTIwNGQtNGJjZC1iMjE4LTdhMjMzNzRiNTA5OAEnAN+tkeoMqO4BD19fZnJ1c3R1bVVwZGF0ZQIEAN+tkeoMqe4B4QtAaWYgKCAhZ2xvYmFsVGhpcy5tYXRyaXg0IHx8ICFnbG9iYWxUaGlzLnRyYW5zZm9ybSApIHsKICAgIC8vIE5lZWQgdG8gd2FpdCBmb3IgdGhlIG1hdGggYW5kIHRyYW5zZm9ybSBsaWJyYXJpZXMgdG8gYmUgbG9hZGVkLgogICAgcmV0dXJuOwp9Cgpjb25zdCBjYW1Qb3MgPSB7CiAgICB4OiBncmlkUG9ydGFsQm90LnRhZ3MuY2FtZXJhUG9zaXRpb25YLAogICAgeTogZ3JpZFBvcnRhbEJvdC50YWdzLmNhbWVyYVBvc2l0aW9uWSwKICAgIHo6IGdyaWRQb3J0YWxCb3QudGFncy5jYW1lcmFQb3NpdGlvblosCn07Cgpjb25zdCBjYW1Sb3QgPSBuZXcgUm90YXRpb24oewogICAgZXVsZXI6IHsKICAgICAgICB4OiBncmlkUG9ydGFsQm90LnRhZ3MuY2FtZXJhUm90YXRpb25YLAogICAgICAgIHk6IGdyaWRQb3J0YWxCb3QudGFncy5jYW1lcmFSb3RhdGlvblksCiAgICAgICAgejogZ3JpZFBvcnRhbEJvdC50YWdzLmNhbWVyYVJvdGF0aW9uWiwKICAgIH0KfSk7Cgpjb25zdCBmcnVzdHVtRGltID0gdGFncy5jdXJyZW50RGltZW5zaW9uOwoKaWYgKCBnbG9iYWxUaGlzLm1haW5TY2VuZUJvdCAmJiBmcnVzdHVtRGltID09PSBsaW5rcy5pbW1lcnNpdmVNYW5hZ2VyLnRhZ3MubWFpblNjZW5lRGltZW5zaW9uICkgewogICAgLy8gVHJhbnNsYXRlIGNhbWVyYSdzIGdyaWRQb3J0YWwgcG9zaXRpb24gdG8gYmUgaW4gbWFpblNjZW5lIGxvY2FsIHNwYWNlLgogICAgY29uc3QgbXNNYXRyaXggPSBtYXRyaXg0LndvcmxkTWF0cml4RnJvbUJvdCggbWFpblNjZW5lQm90LCAnaG9tZScgKTsKICAgIGNvbnN0IGNhbUxvY2FsUG9zID0gdmVjdG9yMy53b3JsZFRvTG9jYWwoIHsuLi5jYW1Qb3N9LCBtc01hdHJpeCApOwogICAgdHJhbnNmb3JtLnNldEJvdFBvc2l0aW9uKCB0aGlzQm90LCBmcnVzdHVtRGltLCBjYW1Mb2NhbFBvcyApOwoKICAgIC8vIEZpbmQgcG9pbnQgaW4gZnJvbnQgb2YgY2FtZXJhIHRoYXQgd2UgY2FuOgogICAgLy8gMS4gVHJhbnNsYXRlIHRvIG1haW5TY2VuZSBsb2NhbCBzcGFjZS4KICAgIC8vIDIuIENhbGN1bGF0ZSBhIGxvb2sgcm90YXRpb24gd2l0aC4KICAgIGNvbnN0IGNhbUZvcndhcmQgPSBtYXRoLmdldEZvcndhcmREaXJlY3Rpb24oIGNhbVJvdCApOwogICAgbGV0IGxvb2tQb2ludCA9IG1hdGguYWRkVmVjdG9ycyggey4uLmNhbVBvc30sIG1hdGguc2NhbGVWZWN0b3IoIGNhbUZvcndhcmQsIDQpICk7CiAgICBsb29rUG9pbnQgPSB2ZWN0b3IzLndvcmxkVG9Mb2NhbCggey4uLmxvb2tQb2ludH0sIG1zTWF0cml4ICk7CgogICAgdHJhbnNmb3JtLmxvb2tBdFBvaW50KHRoaXNCb3QsIGZydXN0dW1EaW0sIGxvb2tQb2ludCk7Cn0gZWxzZSB7CiAgICAvLyBVc2UgY2FtZXJhJ3MgZ3JpZFBvcnRhbCBwb3NpdGlvbiBhcy1pcy4KICAgIHRyYW5zZm9ybS5zZXRCb3RQb3NpdGlvbiggdGhpc0JvdCwgZnJ1c3R1bURpbSwgY2FtUG9zICk7CiAgICB0cmFuc2Zvcm0uc2V0Qm90Um90YXRpb24oIHRoaXNCb3QsIGZydXN0dW1EaW0sIGNhbVJvdCApOwp9CicA362R6gyo7gEKX19vbkNyZWF0ZQIEAN+tkeoMi/oBWkBtYXNrcy5pbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHdoaXNwZXIodGhpc0JvdCwgJ2ZydXN0dW1VcGRhdGUnKSwgdGFncy51cGRhdGVSYXRlTVMpOygA362R6gyo7gELX19vbkRlc3Ryb3kBficA362R6gyo7gERX19vblBvcnRhbENoYW5nZWQCBADfrZHqDOf6AYYEQGlmICh0aGF0LnBvcnRhbCA9PT0gJ2dyaWRQb3J0YWwnKSB7CiAgICBpZiAodGhhdC5kaW1lbnNpb24gPT09ICdpbW1lcnNlJykgewogICAgICAgIC8vIFJlbWFwIGhvbWUgZGltZW5zaW9uIHRvIG1haW5TY2VuZURpbWVuc2lvbi4KICAgICAgICAvLyBUaGUgaG9tZSBkaW1lbnNpb25zIGlzIG9ubHkgdXNlZCB0byB0aGUgbWFpblNjZW5lRGltZW5zaW9uIHRvIG1vdmUKICAgICAgICAvLyBhcm91bmQgaW4gc28gd2UgZG9udCB3YW50IHRvIG1vdmUgb3VyIGZydXN0dW0gdGhlcmUsIHdlIHdhbnQgdG8ga2VlcCBwdXQgaXQgaW4gbWFpblNjZW5lRGltZW5zaW9uLgogICAgICAgIHRoYXQuZGltZW5zaW9uID0gbGlua3MuaW1tZXJzaXZlTWFuYWdlci50YWdzLm1haW5TY2VuZURpbWVuc2lvbjsKICAgIH0KCiAgICB0YWdzW3RhZ3MuY3VycmVudERpbWVuc2lvbl0gPSBudWxsOwogICAgdGFncy5jdXJyZW50RGltZW5zaW9uID0gdGhhdC5kaW1lbnNpb247CiAgICB0YWdzW3RoYXQuZGltZW5zaW9uXSA9IHRydWU7Cn0nAN+tkeoMqO4BDl9fdXBkYXRlUmF0ZU1TAgQA362R6gzu/gEDMjUwJwDfrZHqDKjuAQphYklET3JpZ2luAgQA362R6gzy/gELcmMteHItYWxwaGEnAN+tkeoMqO4BDWF1eENvZGVPcmlnaW4CBADfrZHqDP7+AQVyYy14cicA362R6gyo7gEOZGlzYWJsZUZydXN0dW0CBADfrZHqDIT/AdQCQC8vIFtSeWFuXSBOZWVkIHRvIGluY2x1ZGUgc2FtZSBzbGVlcCB0aW1lIGFzIGVuYWJsZUZydXN0dW0gdG8gZW5zdXJlIGl0IHJ1bnMgaW4KLy8gdGhlIHNhbWUgb3JkZXIgaWYgYm90aCBhcmUgY2FsbGVkLgphd2FpdCBvcy5zbGVlcCg1MDApOwoKLy8gRGVzdHJveSBwcmV2aW91cyBmcnVzdHVtIGlmIGl0IGV4aXN0cy4KaWYgKG1hc2tzLmZydXN0dW1Cb3RJZCkgewogICAgY29uc29sZS5sb2coYFtyZW1vdGVGcnVzdHVtXSBkaXNhYmxlIGZydXN0dW1gKTsKICAgIGRlc3Ryb3koZ2V0Qm90KCdpZCcsIG1hc2tzLmZydXN0dW1Cb3RJZCkpOwogICAgbWFza3MuZnJ1c3R1bUJvdElkID0gbnVsbDsKfScA362R6gyo7gENZW5hYmxlRnJ1c3R1bQIEAN+tkeoM2YEC6QtAbGV0IHByZXZpb3VzRnJ1c3R1bUJvdCA9IG1hc2tzLmZydXN0dW1Cb3RJZCA/IGdldEJvdCgnaWQnLCBtYXNrcy5mcnVzdHVtQm90SWQpIDogbnVsbDsKaWYgKHByZXZpb3VzRnJ1c3R1bUJvdCkgewogICAgLy8gRnJ1c3R1bSBib3QgaXMgYWxyZWFkeSBhY3RpdmUuCiAgICByZXR1cm47Cn0KCmNvbnNvbGUubG9nKGBbcmVtb3RlRnJ1c3R1bV0gZW5hYmxlIGZydXN0dW1gKTsKCi8vIFtSeWFuXSBGb3Igc29tZSByZWFzb24gd2FpdGluZyBoYWxmIGEgc2Vjb25kIGhlcmUgZml4ZXMgYSBidWcKLy8gdGhhdCBjYXVzZXMgQVVYIHRvIHB1dCB0aGUgZmlyc3QgdXNlcidzIGZydXN0dW0gaW4gdGhlICJzaGFyZWQiIHNwYWNlLgphd2FpdCBvcy5zbGVlcCg1MDApOwoKY29uc3QgZGltID0gbGlua3MuaW1tZXJzaXZlTWFuYWdlci50YWdzLm1haW5TY2VuZURpbWVuc2lvbjsKY29uc3QgZnJ1c3R1bU1vZCA9IHt9OwoKZnJ1c3R1bU1vZC5zcGFjZSA9ICJ0ZW1wU2hhcmVkIjsKZnJ1c3R1bU1vZC5mbWZydXN0dW0gPSB0cnVlOwpmcnVzdHVtTW9kLmZydXN0dW1JRCA9IGNvbmZpZ0JvdC5pZDsKZnJ1c3R1bU1vZC5mb3JtID0gImZydXN0dW0iOwpmcnVzdHVtTW9kLnBvaW50YWJsZSA9IGZhbHNlOwpmcnVzdHVtTW9kLm1haW5TY2VuZURpbWVuc2lvbiA9IGxpbmtzLmltbWVyc2l2ZU1hbmFnZXIudGFncy5tYWluU2NlbmVEaW1lbnNpb247CmZydXN0dW1Nb2QuY3VycmVudERpbWVuc2lvbiA9IGRpbTsKCmZydXN0dW1Nb2RbZGltXSA9IHRydWU7CmZydXN0dW1Nb2RbZGltKyJSb3RhdGlvbiJdID0gYPCflIEwLDAsMCwxYDsKZnJ1c3R1bU1vZFtkaW0rIlgiXSA9IGdyaWRQb3J0YWxCb3QudGFncy5jYW1lcmFQb3NpdGlvblg7CmZydXN0dW1Nb2RbZGltKyJZIl0gPSBncmlkUG9ydGFsQm90LnRhZ3MuY2FtZXJhUG9zaXRpb25ZOwpmcnVzdHVtTW9kW2RpbSsiWiJdID0gZ3JpZFBvcnRhbEJvdC50YWdzLmNhbWVyYVBvc2l0aW9uWjsKZnJ1c3R1bU1vZC5pbW1lcnNpdmVNYW5hZ2VyID0gdGFncy5pbW1lcnNpdmVNYW5hZ2VyOwpmcnVzdHVtTW9kLnVwZGF0ZVJhdGVNUyA9IHRhZ3MuX191cGRhdGVSYXRlTVM7CmZydXN0dW1Nb2Qub25DcmVhdGUgPSB0YWdzLl9fb25DcmVhdGU7CmZydXN0dW1Nb2Qub25EZXN0cm95ID0gdGFncy5fX29uRGVzdHJveTsKZnJ1c3R1bU1vZC5mcnVzdHVtVXBkYXRlID0gdGFncy5fX2ZydXN0dW1VcGRhdGU7CmZydXN0dW1Nb2Qub25Qb3J0YWxDaGFuZ2VkID0gdGFncy5fX29uUG9ydGFsQ2hhbmdlZDsKCmNvbnN0IGZydXN0dW1Cb3QgPSBjcmVhdGUoZnJ1c3R1bU1vZCk7CgovLyBTdG9yZSBpZCBvZiBmcnVzdHVtIGJvdCBsb2NhbGx5LCBzbyB0aGF0IHdlIG1heSBkZXN0cm95IGl0IGxhdGVyIGlmIG5lZWRlZC4KbWFza3MuZnJ1c3R1bUJvdElkID0gZnJ1c3R1bUJvdC5pZDsKCi8vIE1ha2UgaW52aXNpYmxlIHRvIGxvY2FsIHVzZXIuCmZydXN0dW1Cb3QubWFza3MuZm9ybSA9ICdub25lJzsKZnJ1c3R1bUJvdC5tYXNrcy5jb2xvciA9ICdjbGVhcic7JwDfrZHqDKjuARJtYWluU2NlbmVEaW1lbnNpb24CBADfrZHqDMGNAgltYWluU2NlbmUnAN+tkeoMqO4BBnN5c3RlbQIEAN+tkeoMy40CHGFiLTEuaW1tZXJzaXZlLnJlbW90ZUZydXN0dW0nAN+tkeoMqO4BBHJjeHICBADfrZHqDOiNAgR0cnVlJwDfrZHqDKjuAQRmb3JtAgQA362R6gztjQIHbm90aGluZygA362R6gyo7gENYWIxQm90VmVyc2lvbgF9DCcA362R6gyo7gEMYWIxSW1tZXJzaXZlAgQA362R6gz2jQIEdHJ1ZScA362R6gyo7gEJYWIxSWdub3JlAgQA362R6gz7jQIEdHJ1ZSgA362R6gyo7gEHZnJ1c3R1bQF+JwDfrZHqDKjuARBpbW1lcnNpdmVNYW5hZ2VyAgQA362R6gyBjgIo8J+Ul2M0ODkxOThhLWY4OTktNGJlNi1iMWEwLWY0MjdkZjJmZjMzZAA="}]}