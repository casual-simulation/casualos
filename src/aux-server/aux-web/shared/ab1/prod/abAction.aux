{"version":2,"updates":[{"id":0,"timestamp":1712261396062,"update":"AZ4CyqDMyAsAJwEEYm90cyQzOTg4MDFmZS00YjM1LTRjZTQtODI2Zi0yMzgzNWMxYjlhYzUBJwDKoMzICwAGc3lzdGVtAgQAyqDMyAsBFGFiLmFjdGlvbi5jcmVhdGVfYm90JwDKoMzICwAIYWJBY3Rpb24CBADKoMzICxYEdHJ1ZScAyqDMyAsABGZvcm0CBADKoMzICxsHbm90aGluZycAyqDMyAsAC2Rlc2NyaXB0aW9uAgQAyqDMyAsjDUNyZWF0ZXMgYm90cy4nAMqgzMgLABBhYkdyaWRNZW51QWN0aW9uAgQAyqDMyAsx0gRAY29uc3QgZ3JpZEluZm9ybWF0aW9uID0gbGlua3MucmVtZW1iZXIudGFncy5hYkdyaWRGb2N1czsKY29uc3QgbmV3Qm90ID0ge307CgpuZXdCb3QuY3JlYXRvciA9IG51bGw7Cm5ld0JvdFtncmlkSW5mb3JtYXRpb24uZGltZW5zaW9uXSA9IHRydWU7Cm5ld0JvdFtncmlkSW5mb3JtYXRpb24uZGltZW5zaW9uICsgIlgiXSA9IGdyaWRJbmZvcm1hdGlvbi5wb3NpdGlvbi54OwpuZXdCb3RbZ3JpZEluZm9ybWF0aW9uLmRpbWVuc2lvbiArICJZIl0gPSBncmlkSW5mb3JtYXRpb24ucG9zaXRpb24ueTsKbmV3Qm90LmNvbG9yID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKCmxldCBjcmVhdGVkQm90ID0gY3JlYXRlKG5ld0JvdCk7CgpzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90Lm1hc2tzLmxpbmVUbyA9IGNyZWF0ZWRCb3QuaWQ7CgpsaW5rcy5yZW1lbWJlci5tYXNrcy5hYkJvdEZvY3VzID0gIvCflJciICsgY3JlYXRlZEJvdC5pZDsKCmxpbmtzLm1hbmlmZXN0YXRpb24uYWJDbGljayh7bWVudTogImJvdCJ9KTsnAMqgzMgLAA9hYkdyaWRNZW51TGFiZWwCBADKoMzIC4IFA2JvdCcAyqDMyAsADmFiR3JpZE1lbnVJY29uAgQAyqDMyAuGBQdhZGRfYm94JwDKoMzICwAIcmVtZW1iZXICBADKoMzIC44FKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAMqgzMgLAA1tYW5pZmVzdGF0aW9uAgQAyqDMyAu1BSjwn5SXZGNhNWQ5ODctYzRkOC00NmU0LWI2MGMtZGFhN2IyZjRkZGFkJwDKoMzICwAIYWJJZ25vcmUCBADKoMzIC9wFBHRydWUoAMqgzMgLAAxhYkJvdFZlcnNpb24BfZ0BJwDKoMzICwATYWJHcmlkTWVudVNvcnRPcmRlcgIEAMqgzMgL4gUBMScBBGJvdHMkNTg0OWFmNTUtNWU4YS00OGQ2LTkxMDYtMTk5NDk4ZTllYzA4AScAyqDMyAvkBQZzeXN0ZW0CBADKoMzIC+UFEWFiLmFjdGlvbi5kZXN0cm95JwDKoMzIC+QFCGFiQWN0aW9uAgQAyqDMyAv3BQR0cnVlJwDKoMzIC+QFBGZvcm0CBADKoMzIC/wFB25vdGhpbmcnAMqgzMgL5AUPYWJCb3RNZW51QWN0aW9uAgQAyqDMyAuEBoEBQGNvbnN0IHRhcmdldEJvdCA9IGxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiQm90Rm9jdXM7CgpkZXN0cm95KHRhcmdldEJvdCk7CgpzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7JwDKoMzIC+QFDmFiQm90TWVudUxhYmVsAgQAyqDMyAuGBwdkZXN0cm95JwDKoMzIC+QFDWFiQm90TWVudUljb24CBADKoMzIC44HDmRlbGV0ZV9mb3JldmVyJwDKoMzIC+QFEmFiQm90TWVudVNvcnRPcmRlcgIEAMqgzMgLnQcDMTAwJwDKoMzIC+QFCHJlbWVtYmVyAgQAyqDMyAuhByjwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwDKoMzIC+QFDW1hbmlmZXN0YXRpb24CBADKoMzIC8gHKPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAMqgzMgL5AUIYWJJZ25vcmUCBADKoMzIC+8HBHRydWUoAMqgzMgL5AUMYWJCb3RWZXJzaW9uAX2dAScAyqDMyAvkBQ5hYkJvdE1lbnVDb2xvcgIEAMqgzMgL9QcHI0Q5MzAzMCcBBGJvdHMkNzE3NTY0NWMtNGI1My00NDU0LTg3MTYtZmMwZTY4ZGIyNjY1AScAyqDMyAv9BwZzeXN0ZW0CBADKoMzIC/4HD2FiLmFjdGlvbi5sb2dpbicAyqDMyAv9BwhhYkFjdGlvbgIEAMqgzMgLjggEdHJ1ZSgAyqDMyAv9BwxhYkJvdFZlcnNpb24BfQcnAMqgzMgL/QcIYWJJZ25vcmUCBADKoMzIC5QIBHRydWUnAMqgzMgL/QcEZm9ybQIEAMqgzMgLmQgHbm90aGluZycAyqDMyAv9Bw9hYkNvcmVNZW51Q29sb3ICBADKoMzIC6EIByNGMkI3MDUnAMqgzMgL/QcTYWJDb3JlTWVudVNvcnRPcmRlcgIEAMqgzMgLqQgCLTUnAMqgzMgL/QcQYWJDb3JlTWVudUFjdGlvbgIEAMqgzMgLrAgsQG9zLmdvVG9VUkwobGlua3MucmVtZW1iZXIudGFncy5hYkF1dGhTaXRlKTsnAMqgzMgL/QcUYWJDb3JlTWVudU9uR2VuZXJhdGUCBADKoMzIC9kInQJAYXdhaXQgb3MucmVxdWVzdEF1dGhCb3RJbkJhY2tncm91bmQoKTsKCmlmICghbGlua3MucmVtZW1iZXIudGFncy5hYkF1dGhTaXRlKQp7CiAgICBkZXN0cm95KHRoaXNCb3QpOwp9Cgp0YWdzLmxhYmVsID0gImJ1eSAiICsgbGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eTsKCmlmICghYXV0aEJvdCkKewogICAgcmV0dXJuOwp9CmVsc2UgaWYgKGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICJGcmVlUGxheSIpCnsKICAgIHJldHVybjsKfQoKZGVzdHJveSh0aGlzQm90KTsnAMqgzMgL/QcOYWJDb3JlTWVudUljb24CBADKoMzIC/cKDmFjY291bnRfY2lyY2xlJwDKoMzIC/0HCHJlbWVtYmVyAgQAyqDMyAuGCyjwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwEEYm90cyRiMWU3MTU2NC04ZDM5LTRmZTItYjkxYi0wZjEwNWJlYzRmYjIBJwDKoMzIC60LBnN5c3RlbQIEAMqgzMgLrgsOYWIuYWN0aW9uLm5vdGUnAMqgzMgLrQsIYWJBY3Rpb24CBADKoMzIC70LBHRydWUoAMqgzMgLrQsMYWJCb3RWZXJzaW9uAX2OAScAyqDMyAutCw5hYkdyaWRNZW51SWNvbgIEAMqgzMgLwwsNc3RpY2t5X25vdGVfMicAyqDMyAutCwRmb3JtAgQAyqDMyAvRCwdub3RoaW5nJwDKoMzIC60LD2FiR3JpZE1lbnVMYWJlbAIEAMqgzMgL2QsEbm90ZScAyqDMyAutCwhhYklnbm9yZQIEAMqgzMgL3gsEdHJ1ZScAyqDMyAutCw1tYW5pZmVzdGF0aW9uAgQAyqDMyAvjCyjwn5SXZGNhNWQ5ODctYzRkOC00NmU0LWI2MGMtZGFhN2IyZjRkZGFkJwDKoMzIC60LCHJlbWVtYmVyAgQAyqDMyAuKDCjwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwDKoMzIC60LEGFiR3JpZE1lbnVBY3Rpb24CBADKoMzIC7EMqgRAY29uc3QgZ3JpZEluZm9ybWF0aW9uID0gbGlua3MucmVtZW1iZXIudGFncy5hYkdyaWRGb2N1czsKY29uc3QgbmV3Qm90ID0ge307CgpuZXdCb3QuY3JlYXRvciA9IG51bGw7Cm5ld0JvdFtncmlkSW5mb3JtYXRpb24uZGltZW5zaW9uXSA9IHRydWU7Cm5ld0JvdFtncmlkSW5mb3JtYXRpb24uZGltZW5zaW9uICsgIlgiXSA9IGdyaWRJbmZvcm1hdGlvbi5wb3NpdGlvbi54OwpuZXdCb3RbZ3JpZEluZm9ybWF0aW9uLmRpbWVuc2lvbiArICJZIl0gPSBncmlkSW5mb3JtYXRpb24ucG9zaXRpb24ueTsKCmxldCBjcmVhdGVkQm90ID0gY3JlYXRlKHRhZ3Mubm90ZU1vZCwgbmV3Qm90KTsKCnNob3V0KCJhYk1lbnVSZWZyZXNoIik7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soKTsKCmxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QubWFza3MubGluZVRvID0gY3JlYXRlZEJvdC5pZDsKCmxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiQm90Rm9jdXMgPSAi8J+UlyIgKyBjcmVhdGVkQm90LmlkOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKHttZW51OiAiYm90In0pOycAyqDMyAutCxNhYkdyaWRNZW51U29ydE9yZGVyAgQAyqDMyAvaEAEyJwDKoMzIC60LB25vdGVNb2QCBADKoMzIC9wQkBfwn6esewogICAgImFiTm90ZSI6IHRydWUsCiAgICAic2NhbGVYIjogMSwKICAgICJzY2FsZVkiOiAxLAogICAgInNjYWxlIjogMSwKICAgICJvcmllbnRhdGlvbk1vZGUiOiAiYmlsbGJvYXJkIiwKICAgICJjb2xvciI6ICIjRkNDNDAwIiwKICAgICJtYXhMT0RUaHJlc2hvbGQiOiAwLjEsCiAgICAib25DcmVhdGUiOiAiQCBzZXRUaW1lb3V0KCgpID0+IHdoaXNwZXIodGhpc0JvdCwgJ2FiTm90ZVJlZnJlc2gnKSwgMjUpOyIsCiAgICAib25NYXhMT0RFbnRlciI6ICJAc2V0VGFnTWFzayh0aGlzQm90LCBcIkxPRFN0YXRlXCIsIFwiRGV0YWlsc1wiLCBcInRlbXBMb2NhbFwiKTtcbndoaXNwZXIodGhpc0JvdCwgXCJhYk5vdGVSZWZyZXNoXCIpOyIsCiAgICAib25NYXhMT0RFeGl0IjogIkBcbnNldFRhZ01hc2sodGhpc0JvdCwgXCJMT0RTdGF0ZVwiLCBcIk5vdGVcIiwgXCJ0ZW1wTG9jYWxcIik7XG53aGlzcGVyKHRoaXNCb3QsIFwiYWJOb3RlUmVmcmVzaFwiKTtcbiIsCiAgICAib25Cb3RDaGFuZ2VkIjogIkBcbmxldCBjaGFuZ2UgPSB0aGF0LnRhZ3NbMF07XG5cbmlmIChjaGFuZ2UgPT0gXCJOb3RlXCIgfHwgY2hhbmdlID09IFwiRGV0YWlsc1wiKSBcbntcbiAgICB3aGlzcGVyKHRoaXNCb3QsIFwiYWJOb3RlUmVmcmVzaFwiKTtcbn0iLAogICAgImxhYmVsV29yZFdyYXBNb2RlIjogImJyZWFrV29yZHMiLAogICAgIm9uQ2xpY2siOiAiQGNvbnN0IHN0YXRlID0gb3MuZ2V0SW5wdXRTdGF0ZShcImtleWJvYXJkXCIsIFwiU2hpZnRcIik7XG5cbmlmIChzdGF0ZSlcbntcbiAgICByZXR1cm47XG59XG5lbHNlXG57XG4gICAgaWYgKHRhZ3MuTE9EU3RhdGUgPT0gbnVsbCB8fCB0YWdzLkxPRFN0YXRlID09IFwiTm90ZVwiKSBcbiAgICB7XG4gICAgICAgIHZhciBjdXJyZW50TE9EID0gXCJOb3RlXCI7XG4gICAgICAgIHZhciB0ZXh0TE9EID0gXCJub3RlXCI7XG4gICAgfVxuICAgIGVsc2UgXG4gICAge1xuICAgICAgICB2YXIgY3VycmVudExPRCA9IFwiRGV0YWlsc1wiO1xuICAgICAgICB2YXIgdGV4dExPRCA9IFwiZGV0YWlsc1wiO1xuICAgIH1cblxuICAgIGNvbnN0IG5ld0xhYmVsID0gYXdhaXQgb3Muc2hvd0lucHV0KHRhZ3NbY3VycmVudExPRF0sIFxuICAgIHtcbiAgICAgICAgdGl0bGU6IGBlZGl0ICR7dGV4dExPRH0gdGV4dGBcbiAgICB9KTtcblxuICAgIGlmIChjdXJyZW50TE9EID09IFwiTm90ZVwiICYmIHRhZ3MuRGV0YWlscylcbiAgICB7XG4gICAgICAgIHNldFRhZ01hc2sodGhpc0JvdCwgXCJsYWJlbFwiLCBcIitcIiArIG5ld0xhYmVsLCBcInRlbXBMb2NhbFwiKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoY3VycmVudExPRCA9PSBcIk5vdGVcIilcbiAgICB7XG4gICAgICAgIHNldFRhZ01hc2sodGhpc0JvdCwgXCJsYWJlbFwiLCBuZXdMYWJlbCwgXCJ0ZW1wTG9jYWxcIik7XG4gICAgfVxuICAgIGVsc2UgaWYgKGN1cnJlbnRMT0QgPT0gXCJEZXRhaWxzXCIpXG4gICAge1xuICAgICAgICBzZXRUYWdNYXNrKHRoaXNCb3QsIFwibGFiZWxcIiwgXCIqXCIgKyBuZXdMYWJlbCwgXCJ0ZW1wTG9jYWxcIik7XG4gICAgfVxuICAgIGVsc2VcbiAgICB7XG4gICAgICAgIHNldFRhZ01hc2sodGhpc0JvdCwgXCJsYWJlbFwiLCBuZXdMYWJlbCwgXCJ0ZW1wTG9jYWxcIik7XG4gICAgfVxuXG4gICAgdGFnc1tjdXJyZW50TE9EXSA9IG5ld0xhYmVsO1xufSIsCiAgICAiYWJOb3RlUmVmcmVzaCI6ICJAZnVuY3Rpb24gbWFwKGlucHV0LCBtaW4xLCBtYXgxLCBtaW4yLCBtYXgyKSB7XG4gICAgcmV0dXJuIChpbnB1dCAtIG1pbjEpICogKG1heDIgLSBtaW4yKSAvIChtYXgxIC0gbWluMSkgKyBtaW4yO1xufVxuXG5pZiAodGFncy5MT0RTdGF0ZSA9PSBcIk5vdGVcIiB8fCB0YWdzLkxPRFN0YXRlID09IG51bGwpIFxue1xuICAgIGlmICh0YWdzLkRldGFpbHMgJiYgdGFncy5Ob3RlKSBcbiAgICB7XG4gICAgICAgIHZhciBuZXdMYWJlbCA9IFwiK1wiICsgdGFncy5Ob3RlO1xuICAgIH1cbiAgICBlbHNlIGlmICh0YWdzLk5vdGUpIFxuICAgIHtcbiAgICAgICAgdmFyIG5ld0xhYmVsID0gdGFncy5Ob3RlO1xuICAgIH1cbiAgICBlbHNlIGlmICh0YWdzLkRldGFpbHMpIFxuICAgIHtcbiAgICAgICAgdmFyIG5ld0xhYmVsID0gXCIrXCI7XG4gICAgfVxuICAgIGVsc2UgXG4gICAge1xuICAgICAgICB2YXIgbmV3TGFiZWwgPSBcIiBcIjtcbiAgICB9XG59XG5lbHNlIGlmICh0YWdzLkxPRFN0YXRlID09IFwiRGV0YWlsc1wiKSBcbntcbiAgICBpZiAodGFncy5EZXRhaWxzKSBcbiAgICB7XG4gICAgICAgIHZhciBuZXdMYWJlbCA9IFwiKlwiICsgdGFncy5EZXRhaWxzO1xuICAgIH1cbiAgICBlbHNlIGlmICh0YWdzLk5vdGUpXG4gICAge1xuICAgICAgICB2YXIgbmV3TGFiZWwgPSBcIipcIiArIHRhZ3MuTm90ZTtcbiAgICB9XG4gICAgZWxzZVxuICAgIHtcbiAgICAgICAgdmFyIG5ld0xhYmVsID0gXCIqXCI7XG4gICAgfVxufVxuXG5pZiAobmV3TGFiZWwpXG57XG4gICAgc2V0VGFnTWFzayh0aGlzQm90LCBcImxhYmVsXCIsIG5ld0xhYmVsKTtcblxuICAgIGxldCBsZW5ndGhUZXN0ID0gbmV3TGFiZWwubGVuZ3RoO1xuXG4gICAgaWYoIW5ld0xhYmVsLmluY2x1ZGVzKFwiIFwiKSkgdGFncy5sYWJlbEZvbnRTaXplID0gbWFwKGxlbmd0aFRlc3QsIDEsIDI1LCAuNywgLjIpICogdGFncy5zY2FsZTtcbiAgICBlbHNlIGlmKGxlbmd0aFRlc3QgPCA0MCkgdGFncy5sYWJlbEZvbnRTaXplID0gbWFwKGxlbmd0aFRlc3QsIDEsIDMwLCAuOCwgLjMpICogdGFncy5zY2FsZTtcbiAgICBlbHNlIHRhZ3MubGFiZWxGb250U2l6ZSA9IG51bGw7XG4gICAgaWYodGFncy5sYWJlbEZvbnRTaXplIDw9IDApIHRhZ3MubGFiZWxGb250U2l6ZSA9IC4xO1xuICAgIFxufSIsCiAgICAib25EZXN0cm95IjogIkAgZGVzdHJveShnZXRCb3RzKCd0cmFuc2Zvcm1lcicsIHRoaXNCb3QuaWQpKTsiLAogICAgImxhYmVsRm9udFNpemUiOiAwLjgKfScBBGJvdHMkYjMzOWMxMTgtNDg5YS00NjZiLWJhOWYtYjA3YTVmOWI2NjRmAScAyqDMyAvrJwZzeXN0ZW0CBADKoMzIC+wnD2FiLmFjdGlvbi5wYXN0ZSgAyqDMyAvrJwhhYkFjdGlvbgF4JwDKoMzIC+snBGZvcm0CBADKoMzIC/0nB25vdGhpbmcnAMqgzMgL6ycLZGVzY3JpcHRpb24CBADKoMzIC4UoK2FiIHNraWxsIHVzZWQgZm9yIGNvcHlpbmcgYW5kIHBhc3RpbmcgYm90cy4nAMqgzMgL6ycHb25QYXN0ZQIEAMqgzMgLsSjAB0BpZiAoIWJ1aWxkZXJWZXJzaW9uKQp7CiAgICByZXR1cm47Cn0KCmNvbnN0IE1BQ1JPUyA9IFsKICAgIHsKICAgICAgICB0ZXN0OiAvKD86W+KAnOKAnV0pL2csCiAgICAgICAgcmVwbGFjZW1lbnQ6ICh2YWwpID0+ICciJywKICAgIH0sCiAgICB7CiAgICAgICAgdGVzdDogLyg/OlvigJjigJldKS9nLAogICAgICAgIHJlcGxhY2VtZW50OiAodmFsKSA9PiAiJyIsCiAgICB9LApdOwoKbGV0IGZvcm1hdHRlZENvcHkgPSByZXBsYWNlTWFjcm9zKHRoYXQudGV4dCk7CmxldCBjb3B5Qm90ID0gSlNPTi5wYXJzZShmb3JtYXR0ZWRDb3B5KTsKbGV0IHBhc3RlZERhdGEgPSAhY29weUJvdC5zdGF0ZSA/IHtbY29weUJvdC5pZF06IGNvcHlCb3R9IDogY29weUJvdC5zdGF0ZTsKbGV0IGRpbU1vZCA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJGb2N1c0RhdGE7CgppZiAoT2JqZWN0LmtleXMocGFzdGVkRGF0YSkubGVuZ3RoID09IDEgJiYgZGltTW9kKQp7CiAgICBwYXN0ZWREYXRhW2RpbU1vZC5kaW1lbnNpb25dID0gdHJ1ZTsKICAgIHBhc3RlZERhdGFbZGltTW9kLmRpbWVuc2lvbisiWCJdID0gZGltTW9kLng7CiAgICBwYXN0ZWREYXRhW2RpbU1vZC5kaW1lbnNpb24rIlkiXSA9IGRpbU1vZC55OwoKICAgIG9zLnRvYXN0KCJib3QgYWRkZWQgdG8gaW5zdCIpOwp9CmVsc2UKewogICAgb3MudG9hc3QoImJvdHMgYWRkZWQgdG8gaW5zdCIpOwp9CgphYi5sb2coImFiOiBwYXN0ZWQgZGF0YSIpOwoKbGlua3MuY3JlYXRlLmFiQ3JlYXRlQm90cyh7Ym90czogcGFzdGVkRGF0YX0pOwoKZnVuY3Rpb24gcmVwbGFjZU1hY3Jvcyh0ZXh0KSB7CiAgICBpZiAoIXRleHQpIHsKICAgICAgICByZXR1cm4gdGV4dDsKICAgIH0KCiAgICBmb3IgKGxldCBtIG9mIE1BQ1JPUykgewogICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UobS50ZXN0LCBtLnJlcGxhY2VtZW50KTsKICAgIH0KCiAgICByZXR1cm4gdGV4dDsKfScAyqDMyAvrJwhyZW1lbWJlcgIEAMqgzMgL6i8o8J+Ul2U1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNycAyqDMyAvrJwZjcmVhdGUCBADKoMzIC5EwKPCflJczNGMzYzIxMC01YmYxLTQ5Y2YtYjE1MS1lZTJkMDdmMGU2NzMnAMqgzMgL6ycIYWJJZ25vcmUCBADKoMzIC7gwBHRydWUoAMqgzMgL6ycMYWJCb3RWZXJzaW9uAX2dAScAyqDMyAvrJwlvbktleURvd24CBADKoMzIC74w6AhAaWYgKCFidWlsZGVyVmVyc2lvbiB8fCAoIWxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiQm90Rm9jdXMgJiYgIWxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiTXVsdGlwbGVCb3RGb2N1cykpCnsKICAgIHJldHVybjsKfQoKaWYgKHRoYXQua2V5cyA9PSAiYyIpCnsKICAgIGxldCBtZXRhSW5wdXQgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJNZXRhIik7CgogICAgaWYgKCFtZXRhSW5wdXQpCiAgICB7CiAgICAgICAgbWV0YUlucHV0ID0gb3MuZ2V0SW5wdXRTdGF0ZSgia2V5Ym9hcmQiLCAiQ29udHJvbCIpOwogICAgfQogICAgCiAgICBpZiAoIW1ldGFJbnB1dCkKICAgIHsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgbGV0IGZvcm1hdHRlZEZpbGU7CiAgICBsZXQgc3RhdGUgPSB7fTsKCiAgICBpZiAobGlua3MucmVtZW1iZXIubGlua3MuYWJCb3RGb2N1cykKICAgIHsKICAgICAgICBsZXQgc2VsZWN0ZWRCb3QgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYkJvdEZvY3VzOwoKICAgICAgICBzdGF0ZVtzZWxlY3RlZEJvdC5pZF0gPSBzZWxlY3RlZEJvdDsKCiAgICAgICAgYWIubG9nKCJhYjogY29waWVkIGEgYm90IHRvIGNsaXBib2FyZCIpOwogICAgfQogICAgZWxzZSBpZiAobGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzKQogICAgewogICAgICAgIGxldCBzZWxlY3RlZEJvdHMgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXM7CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0ZWRCb3RzLmxlbmd0aDsgaSsrKQogICAgICAgIHsKICAgICAgICAgICAgc3RhdGVbc2VsZWN0ZWRCb3RzW2ldLmlkXSA9IHNlbGVjdGVkQm90c1tpXTsKICAgICAgICB9CgogICAgICAgIGFiLmxvZygiYWI6IGNvcGllZCBtdWx0aXBsZSBib3RzIHRvIGNsaXBib2FyZCIpOwogICAgfQoKICAgIGxldCBuZXdGaWxlID0ge307CiAgICBuZXdGaWxlLnZlcnNpb24gPSAxOwogICAgbmV3RmlsZS5zdGF0ZSA9IHN0YXRlOwoKICAgIGZvcm1hdHRlZEZpbGUgPSBKU09OLnN0cmluZ2lmeShuZXdGaWxlKTsKCiAgICBvcy5zZXRDbGlwYm9hcmQoZm9ybWF0dGVkRmlsZSk7CgogICAgb3MudG9hc3QoImJvdCBjb3BpZWQgdG8gY2xpcGJvYXJkIik7Cn0nAQRib3RzJGJkYWJkNmMwLTg5ZjktNGY3NS1iMzVjLTI2ZjRlYzUyMDdkNgEnAMqgzMgLpzkGc3lzdGVtAgQAyqDMyAuoORBhYi5hY3Rpb24ucmVwb3J0JwDKoMzIC6c5BGZvcm0CBADKoMzIC7k5B25vdGhpbmcnAMqgzMgLpzkQYWJDb3JlTWVudUFjdGlvbgIEAMqgzMgLwTkRQG9zLnJlcG9ydEluc3QoKTsnAMqgzMgLpzkTYWJDb3JlTWVudVNvcnRPcmRlcgIEAMqgzMgL0zkDMTAxJwDKoMzIC6c5D2FiQ29yZU1lbnVDb2xvcgIEAMqgzMgL1zkHI0YyQjcwNScAyqDMyAunOQ5hYkNvcmVNZW51SWNvbgIEAMqgzMgL3zkEZmxhZycAyqDMyAunOQ9hYkNvcmVNZW51TGFiZWwCBADKoMzIC+Q5BnJlcG9ydCcAyqDMyAunOQhhYkFjdGlvbgIEAMqgzMgL6zkEdHJ1ZScAyqDMyAunOQhhYklnbm9yZQIEAMqgzMgL8DkEdHJ1ZSgAyqDMyAunOQxhYkJvdFZlcnNpb24BfQ4nAQRib3RzJGM2OGM1YjgyLWMwYTctNGE1YS05MTA0LTVkZDhlMzJhZTRlMgEnAMqgzMgL9jkGc3lzdGVtAgQAyqDMyAv3ORRhYi5hY3Rpb24ub3Blbl9zaGVldCcAyqDMyAv2OQtkZXNjcmlwdGlvbgIEAMqgzMgLjDoUU2tpbGwgdG8gb3BlbiBzaGVldC4nAMqgzMgL9jkIYWJBY3Rpb24CBADKoMzIC6E6BHRydWUnAMqgzMgL9jkEZm9ybQIEAMqgzMgLpjoHbm90aGluZycAyqDMyAv2ORBhYkNvcmVNZW51QWN0aW9uAgQAyqDMyAuuOtMCQGNvbnN0IGN1cnJlbnRJbnN0ID0gb3MuZ2V0Q3VycmVudEluc3QoKTsKY29uc3QgY3VycmVudERpbSA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJBY3RpdmVEaW1lbnNpb247CmNvbnN0IHN0YXRlID0gb3MuZ2V0SW5wdXRTdGF0ZSgia2V5Ym9hcmQiLCAiU2hpZnQiKTsKCmlmIChzdGF0ZSkgCnsKICAgIG9zLm9wZW5VUkwoY29uZmlnQm90LnRhZ3MucGVybWFsaW5rICsgYCZzaGVldFBvcnRhbD0ke2N1cnJlbnREaW19YCk7Cn0KZWxzZQp7CiAgICBjb25maWdCb3QudGFncy5zaGVldFBvcnRhbCA9IGN1cnJlbnREaW07Cn0KCmFiLmxvZyhgYWI6IG9wZW5lZCAke2N1cnJlbnREaW19IHNoZWV0YCk7JwDKoMzIC/Y5CHJlbWVtYmVyAgQAyqDMyAuCPSjwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwDKoMzIC/Y5D2FiQ29yZU1lbnVMYWJlbAIEAMqgzMgLqT0Kb3BlbiBzaGVldCcAyqDMyAv2OQ9hYkJvdE1lbnVBY3Rpb24CBADKoMzIC7Q9zwJAY29uc3QgY3VycmVudEluc3QgPSBvcy5nZXRDdXJyZW50SW5zdCgpOwpjb25zdCBjdXJyZW50RGltID0gbGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdC50YWdzLmxpbmVUbzsKY29uc3Qgc3RhdGUgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJTaGlmdCIpOwoKaWYgKHN0YXRlKSAKewogICAgb3Mub3BlblVSTChjb25maWdCb3QudGFncy5wZXJtYWxpbmsgKyBgJnNoZWV0UG9ydGFsPSR7Y3VycmVudERpbX1gKTsKfQplbHNlCnsKICAgIGNvbmZpZ0JvdC50YWdzLnNoZWV0UG9ydGFsID0gY3VycmVudERpbTsKfQoKYWIubG9nKCJhYjogb3BlbmVkIGJvdCBzaGVldCIpOycAyqDMyAv2OQ5hYkJvdE1lbnVMYWJlbAIEAMqgzMgLhEAOb3BlbiBib3Qgc2hlZXQnAMqgzMgL9jkNbWFuaWZlc3RhdGlvbgIEAMqgzMgLk0Ao8J+Ul2RjYTVkOTg3LWM0ZDgtNDZlNC1iNjBjLWRhYTdiMmY0ZGRhZCcAyqDMyAv2OQ1hYkJvdE1lbnVJY29uAgQAyqDMyAu6QAp0YWJsZV92aWV3JwDKoMzIC/Y5DmFiQ29yZU1lbnVJY29uAgQAyqDMyAvFQAp0YWJsZV92aWV3JwDKoMzIC/Y5EmFiQm90TWVudVNvcnRPcmRlcgIEAMqgzMgL0EABMScAyqDMyAv2OQhhYklnbm9yZQIEAMqgzMgL0kAEdHJ1ZSgAyqDMyAv2OQxhYkJvdFZlcnNpb24BfZ0BJwDKoMzIC/Y5F2FiTXVsdGlwbGVCb3RNZW51QWN0aW9uAgQAyqDMyAvYQPIDQGNvbnN0IGN1cnJlbnRJbnN0ID0gb3MuZ2V0Q3VycmVudEluc3QoKTsKY29uc3QgY3VycmVudERpbSA9ICJhYk11bHRpcGxlU2VsZWN0IjsKCmNvbmZpZ0JvdC50YWdzLnNoZWV0UG9ydGFsID0gY3VycmVudERpbTsKCnNldFRhZ01hc2sobGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzLCBjdXJyZW50RGltLCB0cnVlLCAidGVtcExvY2FsIik7CgptYXNrcy5jdXJyZW50U2hlZXRCb3RzID0gbGlua3MucmVtZW1iZXIudGFncy5hYk11bHRpcGxlQm90Rm9jdXM7Cm1hc2tzLm9uUG9ydGFsQ2hhbmdlZCA9IGBAIGlmICh0aGF0LmRpbWVuc2lvbiAhPSAiYWJNdWx0aXBsZVNlbGVjdCIgJiYgdGhhdC5wb3J0YWwgPT0gInNoZWV0UG9ydGFsIikKewogICAgY2xlYXJUYWdNYXNrcyhsaW5rcy5jdXJyZW50U2hlZXRCb3RzKTsKCiAgICBjbGVhclRhZ01hc2tzKHRoaXNCb3QpOwp9IGA7CgphYi5sb2coImFiOiBvcGVuZWQgbXVsdGlwbGUgc2VsZWN0IHNoZWV0Iik7JwDKoMzIC/Y5FmFiTXVsdGlwbGVCb3RNZW51TGFiZWwCBADKoMzIC8tEGm9wZW4gbXVsdGlwbGUgc2VsZWN0IHNoZWV0JwDKoMzIC/Y5FWFiTXVsdGlwbGVCb3RNZW51SWNvbgIEAMqgzMgL5kQKdGFibGVfdmlldycAyqDMyAv2ORRhYkNvcmVNZW51T25HZW5lcmF0ZQIEAMqgzMgL8USAAkBsZXQgY3VycmVudERpbSA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJBY3RpdmVEaW1lbnNpb247Cgp0YWdzLmxhYmVsID0gInNoZWV0UG9ydGFsPSIgKyBjdXJyZW50RGltOwoKdGFncy5vbktleURvd24gPSBgQCBpZih0aGF0LmtleXMgPT0gIlNoaWZ0Iil7bWFza3MubGFiZWwgPSB0YWdzLmxhYmVsICsgIiBpbiBuZXcgdGFiIjt9YDsKdGFncy5vbktleVVwID0gYEAgaWYodGhhdC5rZXlzID09ICJTaGlmdCIpe21hc2tzLmxhYmVsID0gbnVsbDt9YDsnAMqgzMgL9jkTYWJCb3RNZW51T25HZW5lcmF0ZQIEAMqgzMgL8kaYAkBsZXQgc2VsZWN0ZWRCb3QgPSBsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90LnRhZ3MubGluZVRvOwoKdGFncy5sYWJlbCA9ICJzaGVldFBvcnRhbD0iICsgc2VsZWN0ZWRCb3Quc3Vic3RyaW5nKDAsIDQpOwoKdGFncy5vbktleURvd24gPSBgQCBpZih0aGF0LmtleXMgPT0gIlNoaWZ0Iil7bWFza3MubGFiZWwgPSB0YWdzLmxhYmVsICsgIiBpbiBuZXcgdGFiIjt9YDsKdGFncy5vbktleVVwID0gYEAgaWYodGhhdC5rZXlzID09ICJTaGlmdCIpe21hc2tzLmxhYmVsID0gbnVsbDt9YDsnAQRib3RzJGVjODVjMWQ2LTlmMWEtNDBkNC04MmUxLTViZDY4MDM0OWMyNwEnAMqgzMgLi0kGc3lzdGVtAgQAyqDMyAuMSQ1hYi5hY3Rpb24uYXNrJwDKoMzIC4tJBGZvcm0CBADKoMzIC5pJB25vdGhpbmcnAMqgzMgLi0kGYXNrR1BUAgQAyqDMyAuiScwJQGlmICghdGFncy5ncHRBY3RpdmUgfHwgYXV0aEJvdC50YWdzLnByaXZhY3lGZWF0dXJlcy5hbGxvd0FJID09IGZhbHNlKQp7CiAgICBvcy50b2FzdCgiQUkgbm90IGF1dGhvcml6ZWQgZm9yIHRoaXMgYWNjb3VudCIpOwogICAgCiAgICByZXR1cm47Cn0gCgpsZXQgaW5xdWlyeSA9ICF0aGF0LmlucXVpcnkgPyB0aGF0IDogdGhhdC5pbnF1aXJ5OwpsZXQgcHJvbXB0ID0gIXRoYXQucHJvbXB0ID8gdGFncy5wcm9tcHRfY29yZSA6IHRhZ3NbInByb21wdF8iICsgdGhhdC5wcm9tcHRdOwoKYWIubG9nKCJhYjogdGhpbmtpbmcgYWJvdXQgIiArIGlucXVpcnkpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkJvdENoYXQoe21lc3NhZ2U6ICJ0aGlua2luZyBhYm91dCAiICsgaW5xdWlyeX0pOwoKaWYgKHRoYXQucHJvbXB0ID09ICJncmlkIikKewogICAgaW5xdWlyeSA9IGlucXVpcnkgKyBgLiBCb3QgbXVzdCBpbmNsdWRlIHske3RoYXQuZGF0YS5kaW1lbnNpb259OiB0cnVlLCAke3RoYXQuZGF0YS5kaW1lbnNpb259WDogJHt0aGF0LmRhdGEuZGltZW5zaW9uWH0sICR7dGhhdC5kYXRhLmRpbWVuc2lvbn1ZOiR7dGhhdC5kYXRhLmRpbWVuc2lvbll9fS5gCn0KZWxzZSBpZiAodGhhdC5wcm9tcHQgPT0gImJvdCIpCnsKICAgIGlucXVpcnkgPSBpbnF1aXJ5ICsgYC4gQm90IHRvIGJlIG1vZGlmaWVkIGhhcyB0aGUgaWQgb2Y6IGAgKyB0aGF0LmRhdGEuYm90LmlkOwp9Cgpjb25zdCBhbnN3ZXIgPSBhd2FpdCB0aGlzQm90LnN1Ym1pdFJlcXVlc3RHUFQoe2lucXVpcnk6IGlucXVpcnksIHByb21wdDogcHJvbXB0fSk7CgpsZXQgbmV3QW5zd2VyID0gYW5zd2VyOwoKaWYgKGFuc3dlci5pbmRleE9mKCJgYGAiKSAhPSAtMSkKewogICAgbmV3QW5zd2VyID0gYW5zd2VyLnN1YnN0cmluZyhhbnN3ZXIuaW5kZXhPZigiYGBgIiksIGFuc3dlci5sYXN0SW5kZXhPZigiYGBgIikpOwoKICAgIG5ld0Fuc3dlciA9IG5ld0Fuc3dlci5yZXBsYWNlQWxsKCdqYXZhc2NyaXB0JywgIiIpOwoKICAgIG5ld0Fuc3dlciA9IG5ld0Fuc3dlci5yZXBsYWNlQWxsKCJgYGAiLCAiIik7Cn0KCmFiLmxvZygiYWI6ICIgKyBuZXdBbnN3ZXIpOwoKLy9saW5rcy5tYW5pZmVzdGF0aW9uLmFiQm90Q2hhdCh7bWVzc2FnZTogbmV3QW5zd2VyLnJlcGxhY2UoLyhcclxufFxufFxyKS9nbSwiICIpfSk7Cgpvcy5ydW4obmV3QW5zd2VyKTsKCmxpbmtzLm1hbmlmZXN0YXRpb24uYWJDbGljaygpOwoKcmV0dXJuOygAyqDMyAuLSQlncHRBY3RpdmUBeCcAyqDMyAuLSRBzdWJtaXRSZXF1ZXN0R1BUAgQAyqDMyAvwUpIGQGxldCBzeXN0ZW1Qcm9tcHQgPSB0aGF0LnByb21wdCA/IHRoYXQucHJvbXB0IDogdGFncy5wcm9tcHRfY29yZTsKCnN5c3RlbVByb21wdCA9IHN5c3RlbVByb21wdCArIHRoYXQuaW5xdWlyeTsKCmlmIChhdXRoQm90LnRhZ3MucHJpdmFjeUZlYXR1cmVzLmFsbG93QUkgPT0gZmFsc2UpCnsKICAgIG9zLnRvYXN0KCJBSSBub3QgYXV0aG9yaXplZCBvbiB0aGlzIGFjY291bnQiKTsKCiAgICByZXR1cm47Cn0KCmxldCBjdXJyZW50RXhwZXJpZW5jZUJvdHMgPSBnZXRCb3RzKGJ5TW9kKHtzcGFjZTogInNoYXJlZCIsIGFiSWdub3JlOiBudWxsfSkpOwoKaWYgKGN1cnJlbnRFeHBlcmllbmNlQm90cy5sZW5ndGggPiAwKQp7CiAgICBzeXN0ZW1Qcm9tcHQgPSBzeXN0ZW1Qcm9tcHQgKyAiIFRoZXNlIGFyZSB0aGUgYm90cyB0aGF0IGN1cnJlbnRseSBleGlzdCBpbiB0aGUgZXhwZXJpZW5jZTogIiArIGN1cnJlbnRFeHBlcmllbmNlQm90czsKfQoKbGV0IG5ld1N0YXR1c0JhciA9IGF3YWl0IGxpbmtzLmlucHV0LmFiUHJvZ3Jlc3NCYXIoYGFza2luZyAke2xpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHl9YCk7Cgpjb25zdCBhaVJlc3AgPSBhd2FpdCBhaS5jaGF0KHN5c3RlbVByb21wdCwgewogICAgbW9kZWw6IHRoYXQubW9kZWwgPz8gImdwdC0zIiwKICAgIHRlbXBlcmF0dXJlOiAwLAogICAgdG9wUDogMSwKICAgIHByZXNlbmNlUGVuYWx0eTogMC42LAogICAgZnJlcXVlbmN5UGVuYWx0eTogMAp9KTsKCmRlc3Ryb3kobmV3U3RhdHVzQmFyKTsKCnJldHVybiBhaVJlc3A7JwDKoMzIC4tJBnByb21wdAIEAMqgzMgLg1mgIlRoZSBmb2xsb3dpbmcgaXMgYSBjb252ZXJzYXRpb24gd2l0aCBhYi4gYWIgaXMgYSBoZWxwZnVsLCBjbGV2ZXIsIGFuZCBjYXBhYmxlIEFJLiBhYiB3aWxsIHJlc3BvbmQgd2l0aCB0aGUgY29ycmVjdCBqYXZhc2NyaXB0IGltcGxlbWVudGF0aW9uIChjb2RlKSBvZiB0aGUgcmVxdWVzdGVkIGFjdGlvbi4KCkhlcmUgaXMgYSBicmllZiBsaXN0IG9mIHRoaW5ncyBhYiBjYW4gZG86Ci0gQ3JlYXRlIGJvdHMKCkJvdHMgYXJlIGEgY29sbGVjdGlvbiBvZiB0YWdzLCBhbmQgdGhleSBjYW4gYmUgY3JlYXRlZCB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24uClRoZSBjcmVhdGUoKSBmdW5jdGlvbiBpcyB1c2VkIHRvIGNyZWF0ZSBvbmUgb3IgbXVsdGlwbGUgYm90cyBvYmplY3RzLgpjcmVhdGUoKSByZXR1cm5zIGEgYm90IG9iamVjdDsgaXQgZG9lcyBub3QgbmVlZCB0byBiZSBzdG9yZWQgaW4gYSB2YXJpYWJsZSBvciBjb25zdC4gCgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSByZWQgYm90IGluIHRoZSBob21lIGRpbWVuc2lvbjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgY29sb3I6ICJyZWQiLAogICAgZm9ybTogImN1YmUiCn0pOwpgYGAKCkFzIHlvdSBjYW4gc2VlLCB0aGUgZXhhbXBsZSBhYm92ZSBjcmVhdGVzIGEgYm90IHdpdGggdGhlIGBob21lYCB0YWcgc2V0IHRvIGB0cnVlYCBhbmQgdGhlIGBjb2xvcmAgdGFnIHNldCB0byBgcmVkYC4KVW5sZXNzIHNwZWNpZmllZCBvdGhlcndpc2UsIGFiIHNob3VsZCBjcmVhdGUgYm90cyB3aXRoIHRoZSBgaG9tZWAgdGFnIHNldCB0byBgdHJ1ZWAuCgpEaW1lbnNpb25zIGFyZSB0YWdzIHdoaWNoIGVuZCB1cCBiZWluZyB2aXN1YWxpemVkIGluIDNEIHNwYWNlLiBJbiBhZGRpdGlvbiB0byBiZWluZyBhIHRhZywgYGhvbWVgIGlzIGFsc28gYSBkaW1lbnNpb24uCllvdSBjYW4gY29udHJvbCB0aGUgcG9zaXRpb24gdGhhdCBhIGJvdCBpcyByZW5kZXJlZCBhdCBieSB1c2luZyB0aGUgYHtkaW1lbnNpb259UG9zaXRpb25gIHRhZywgd2hlcmUgYHtkaW1lbnNpb259YCBpcyByZXBsYWNlZCB3aXRoIHRoZSBuYW1lIG9mIHRoZSBkaW1lbnNpb24uCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIGJvdCBhdCBwb3NpdGlvbiAoMywgMikgaW4gdGhlIGhvbWUgZGltZW5zaW9uOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBob21lUG9zaXRpb246ICfinqHvuI8zLDEnCn0pOwpgYGAKCkxpc3RlbmVycyBhcmUgdGFncyB3aGljaCBjb250YWluIEphdmFTY3JpcHQgYW5kIHJlc3BvbmQgdG8gY2VydGFpbiBldmVudHMuIFRoZXkgd29yayBsaWtlIG5vcm1hbCB0YWdzLCBleGNlcHQgdGhleSBuZWVkIHRvIGhhdmUgYSBgQGAgc3ltYm9sIGF0IHRoZSBzdGFydCBvZiB0aGUgdGFnIHZhbHVlLgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSBib3Qgd2l0aCBhIGBvbkNsaWNrYCBsaXN0ZW5lcjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgb25DbGljazogYEBvcy50b2FzdCgiSGVsbG8sIHdvcmxkISIpO2AKfSk7CmBgYAoKRm9yIGV4YW1wbGUgaWYgYXNrZWQgZm9yIGEgcHJvY2VkdXJhbCBmb3Jlc3QgdGhlIGNvZGUgcmV0dXJuZWQgd291bGQgYmUgc29tZXRoaW5nIGxpa2UgdGhpczoKCmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIG9uQ2xpY2s6IGBAewogICAgICAgIGNvbnN0IGVsZW1lbnRzID0gWyd0cmVlJywgJ2J1c2gnLCAnZmxvd2VyJywgJ3JvY2snLCAncmFiYml0JywgJ2ZveCcsICd3YXRlciddOwogICAgICAgIGNvbnN0IGNvbG9ycyA9IFsnZ3JlZW4nLCAnZGFya2dyZWVuJywgJ2dvbGQnLCAnZ3JheScsICdicm93bicsICdvcmFuZ2UnLCAnYmx1ZSddOwogICAgICAgIGNvbnN0IGludGVyYWN0aW9uU291bmRzID0gWyd3aW5kIGluIHRoZSBicmFuY2hlcycsICdydXN0bGluZyBsZWF2ZXMnLCAnY3JpY2tldCBjaGlycGluZycsICdyYWluIHBhdHRlcmluZycsICd0aHVtcGluZycsICd5aXBwaW5nJywgJ3NwbGFzaGluZyddOwogICAgICAgIGNvbnN0IHNjYWxlc1ggPSBbMC45LCAxLjIsIDAuMSwgMSwgMC4yNSwgMC4zLCAxXTsKICAgICAgICBjb25zdCBzY2FsZXNZID0gWzAuOSwgMS4yLCAwLjEsIDEsIDAuNCwgMC43LCAxXTsKICAgICAgICBjb25zdCBzY2FsZXNaID0gWzMsIDAuNzUsIDAuMiwgMC41LCAwLjUsIDAuNiwgMC4wMV07CiAgICAgICAgCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDA7IGkrKykgCiAgICAgICAgewogICAgICAgICAgICBsZXQgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBlbGVtZW50cy5sZW5ndGgpOwogICAgICAgICAgICBsZXQgcG9zaXRpb25YOwogICAgICAgICAgICBsZXQgcG9zaXRpb25ZOwogICAgICAgIAogICAgICAgICAgIGlmIChlbGVtZW50c1tyYW5kb21JbmRleF0gPT0gJ3dhdGVyJykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKGdldEJvdCgnbGFiZWwnLCAnd2F0ZXInKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBsZXQgcG9zc2libGVXYXRlckNvbm5lY3Rpb25zID0gZ2V0Qm90cygnbGFiZWwnLCAnd2F0ZXInKTsKICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZlV2F0ZXJCb3QgPSBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcG9zc2libGVXYXRlckNvbm5lY3Rpb25zLmxlbmd0aCldOwogICAgICAgICAgICAgICAgICAgIGxldCBjb2luRmxpcCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oMCwxKSk7CiAgICAgICAgICAgICAgICAgICAgbGV0IHJhbmRvbURpcmVjdGlvbiA9IE1hdGgucmFuZG9tKCkgPCAwLjUgPyAtMSA6IDE7CiAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgKGNvaW5GbGlwKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWDsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWSArIHJhbmRvbURpcmVjdGlvbjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWCArIHJhbmRvbURpcmVjdGlvbjsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcG9zaXRpb25YID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICAgICAgY3JlYXRlKHsKICAgICAgICAgICAgICAgIGhvbWU6IHRydWUsCiAgICAgICAgICAgICAgICBob21lUG9zaXRpb246ICfinqHvuI8nICsgcG9zaXRpb25YICsgJywnICsgcG9zaXRpb25ZLAogICAgICAgICAgICAgICAgdGlwTGFiZWw6IGVsZW1lbnRzW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIG9uUG9pbnRlckVudGVyOiAiQCBvcy50aXAodGFncy50aXBMYWJlbCkiOwogICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yc1tyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVg6IHNjYWxlc1hbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVZOiBzY2FsZXNZW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWjogc2NhbGVzWltyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBvbkNsaWNrOiAiQCBvcy50aXAoJ1lvdSBoZWFyICIgKyBpbnRlcmFjdGlvblNvdW5kc1tyYW5kb21JbmRleF0gKyAiJyk7IgogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9YAp9KTsKYGBgCgpQbGVhc2UgcmV0dXJuIG9ubHkgdGhlIGZ1bmN0aW9uIHdpdGggdGhlIGNvZGUgYXMgYSByZXNwb25zZS4nAMqgzMgLi0kIcmVtZW1iZXICBADKoMzIC5x7KPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAMqgzMgLi0kQYWJDb3JlTWVudUFjdGlvbgIEAMqgzMgLw3uMDEBsZXQgaW5xdWlyeSA9ICF0aGF0Lm1lc3NhZ2UgPyB0aGF0IDogdGhhdC5tZXNzYWdlOwpsZXQgYmFzZUlucXVpcnkgPSBpbnF1aXJ5OwpsZXQgbWVudSA9ICF0aGF0Lm1lbnUgPyAiY29yZSIgOiB0aGF0Lm1lbnU7CmxldCBzcGFjZUNoZWNrID0gaW5xdWlyeS5pbmRleE9mKCIgIik7CmxldCBtZW51Qm90cyA9IGdldEJvdHMoY29uZmlnQm90LnRhZ3MubWVudVBvcnRhbCwgdHJ1ZSk7CmxldCB0b3RhbFBlcmlvZHMgPSBpbnF1aXJ5LnJlcGxhY2UoL1teLl0vZywgIiIpLmxlbmd0aDsKCndoaXNwZXIobWVudUJvdHMsICJhYk1lbnVSZWZyZXNoIik7CgphYi5sb2coInVzZXI6ICIgKyBpbnF1aXJ5KTsKCmlmICghY29uZmlnQm90LnRhZ3MudGFnUG9ydGFsICYmIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJBd2FrZVN0YXRlICYmIHRoYXQubWVzc2FnZSAhPSAiLmxvZyIpCnsKICAgIGxpbmtzLmlucHV0Lm9uQ2hhdCh7bWVzc2FnZTogIi5sb2cifSk7Cn0KCmlmICh0b3RhbFBlcmlvZHMgPj0gNSkKewogICAgb3MudG9hc3QoImxhdW5jaCBjb2RlIHNwZWNpZmljIik7Cn0KZWxzZSBpZiAoaW5xdWlyeVswXSA9PSAiLiIpCnsKICAgIGxpbmtzLmlucHV0Lm9uQ2hhdCh7bWVzc2FnZTogaW5xdWlyeX0pOwp9CmVsc2UgaWYgKHNwYWNlQ2hlY2sgPT0gLTEpCnsKICAgIGxldCBhc2tKb2luSUQgPSBpbnF1aXJ5LnJlcGxhY2VBbGwoIi0iLCAiIik7CiAgICBsZXQgYXNrID0gYXdhaXQgbGlua3Muc2VhcmNoLm9uTG9va3VwQXNrSUQoe2Fza0lEOiBhc2tKb2luSUR9KTsKCiAgICBpZiAoYXNrLnN1Y2Nlc3MgJiYgYXNrLmRhdGEudXJsKQogICAgewogICAgICAgIGxpbmtzLmxlYXJuLmFiSm9pbkhvc3Qoe2RhdGE6IGFzay5kYXRhfSk7CiAgICB9CiAgICBlbHNlIGlmICghYXNrLnN1Y2Nlc3MpCiAgICB7CiAgICAgICAgYXNrID0gYXdhaXQgbGlua3Muc2VhcmNoLm9uTG9va3VwQUJFZ2dzKHthYklEOiBiYXNlSW5xdWlyeSwgaW5pdGlhbEJvb3Q6IHRoYXQuaW5pdGlhbEJvb3QsIGF1dG9IYXRjaDogdGhhdC5hdXRvSGF0Y2h9KTsKICAgIH0KfQplbHNlCnsKICAgIGF3YWl0IG9zLnJlcXVlc3RBdXRoQm90KCk7CgogICAgaWYgKCFhdXRoQm90KQogICAgewogICAgICAgIG9zLnRvYXN0KCJwbGVhc2Ugc2lnbiBpbiB0byBhY2Nlc3MgYWR2YW5jZWQgQUkgZmVhdHVyZXMiKTsKCiAgICAgICAgbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7CiAgICB9CiAgICBlbHNlIGlmIChhdXRoQm90LnRhZ3Muc3Vic2NyaXB0aW9uVGllciA9PSAiRnJlZVBsYXkiKQogICAgewogICAgICAgIG9zLnRvYXN0KCJwbGVhc2UgY2hlY2sgeW91ciBzdWJzY3JpcHRpb24gaW4gb3JkZXIgdG8gYWNjZXNzIGFkdmFuY2VkIEFJIGZlYXR1cmVzIik7CgogICAgICAgIGxpbmtzLm1hbmlmZXN0YXRpb24uYWJDbGljaygpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIG1hc2tzLmdwdEFjdGl2ZSA9IHRydWU7CgogICAgICAgIGF3YWl0IHRoaXNCb3QuYXNrR1BUKHtpbnF1aXJ5OiBpbnF1aXJ5LCBwcm9tcHQ6IG1lbnUsIGRhdGE6IHRoYXR9KTsKICAgIH0KfScAyqDMyAuLSRRhYkNvcmVNZW51T25HZW5lcmF0ZQIEAMqgzMgL0IcBqANAdGFncy5vblN1Ym1pdCA9IGBAIGxpbmtzLmJhc2VTa2lsbC5hYkNvcmVNZW51QWN0aW9uKHttZXNzYWdlOiB0aGF0LnRleHQsIG1lbnU6ICJjb3JlIn0pO2A7CnRhZ3MuZm9ybSA9ICJpbnB1dCI7CgppZiAoIWF1dGhCb3QpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UgaWYgKGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICJGcmVlUGxheSIpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHk7Cn0KJwDKoMzIC4tJE2FiQ29yZU1lbnVTb3J0T3JkZXICBADKoMzIC/mKAQMxMDInAMqgzMgLi0kQYWJHcmlkTWVudUFjdGlvbgIEAMqgzMgL/YoBDkAvL3BsYWNlaG9sZGVyJwDKoMzIC4tJFGFiR3JpZE1lbnVPbkdlbmVyYXRlAgQAyqDMyAuMiwGzBUB0YWdzLmRpbWVuc2lvbiA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkRm9jdXMuZGltZW5zaW9uOwp0YWdzLmRpbWVuc2lvblggPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiR3JpZEZvY3VzLnBvc2l0aW9uLng7CnRhZ3MuZGltZW5zaW9uWSA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkRm9jdXMucG9zaXRpb24ueTsKdGFncy5vblN1Ym1pdCA9IGBAbGlua3MuYmFzZVNraWxsLmFiQ29yZU1lbnVBY3Rpb24oe21lc3NhZ2U6IHRoYXQudGV4dCwgbWVudTogImdyaWQiLCBkaW1lbnNpb246IHRhZ3MuZGltZW5zaW9uLCBkaW1lbnNpb25YOiB0YWdzLmRpbWVuc2lvblgsIGRpbWVuc2lvblk6IHRhZ3MuZGltZW5zaW9uWX0pO2A7CnRhZ3MuZm9ybSA9ICJpbnB1dCI7CgppZiAoIWF1dGhCb3QpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UgaWYgKGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICJGcmVlUGxheSIpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHk7Cn0nAMqgzMgLi0kNbWFuaWZlc3RhdGlvbgIEAMqgzMgLwJABKPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAMqgzMgLi0kTYWJHcmlkTWVudVNvcnRPcmRlcgIEAMqgzMgL55ABAzEwMicAyqDMyAuLSQ9hYkdyaWRNZW51TGFiZWwCBADKoMzIC+uQAQZhc2sgYWInAMqgzMgLi0kPYWJDb3JlTWVudUxhYmVsAgQAyqDMyAvykAEGYXNrIGFiJwDKoMzIC4tJDmFiQ29yZU1lbnVJY29uAgQAyqDMyAv5kAEEY3ViZScAyqDMyAuLSQ5hYkdyaWRNZW51SWNvbgIEAMqgzMgL/pABBGN1YmUnAMqgzMgLi0kKZWRpdFByb21wdAIEAMqgzMgLg5EBhwhAc2hvdXQoImFiTWVudVJlZnJlc2giKTsKCmNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gImFiTWVudSI7CgpsZXQgcHJvbXB0TWVudUJ1dHRvbiA9IHt9OwoKcHJvbXB0TWVudUJ1dHRvbi5hYk1lbnUgPSB0cnVlOwpwcm9tcHRNZW51QnV0dG9uLmFiTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CnByb21wdE1lbnVCdXR0b24ubWFuaWZlc3RhdGlvbiA9IHRhZ3MubWFuaWZlc3RhdGlvbjsKcHJvbXB0TWVudUJ1dHRvbi5yZW1lbWJlciA9IHRhZ3MucmVtZW1iZXI7CnByb21wdE1lbnVCdXR0b24uZ3B0Qm90ID0gIvCflJciICsgdGhpc0JvdC5pZDsKcHJvbXB0TWVudUJ1dHRvbi5sYWJlbCA9ICJsb2FkIHByb21wdCI7CnByb21wdE1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiY2xvdWRfZG93bmxvYWQiOwpwcm9tcHRNZW51QnV0dG9uLm9uQ2xpY2sgPSAiQCBsaW5rcy5ncHRCb3QudXBkYXRlUHJvbXB0KCdsb2FkJyk7IjsKCmxpbmtzLm1lbnUuYWJDcmVhdGVNZW51QnV0dG9uKHByb21wdE1lbnVCdXR0b24pOwoKcHJvbXB0TWVudUJ1dHRvbi5sYWJlbCA9ICJzYXZlIHByb21wdCI7CnByb21wdE1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiYmFja3VwIjsKcHJvbXB0TWVudUJ1dHRvbi5vbkNsaWNrID0gIkAgbGlua3MuZ3B0Qm90LnVwZGF0ZVByb21wdCgnc2F2ZScpOyI7CgpsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihwcm9tcHRNZW51QnV0dG9uKTsKCm1hc2tzLm9uR3JpZENsaWNrID0gYEAgY29uZmlnQm90Lm1hc2tzLnRhZ1BvcnRhbCA9IG51bGw7Cgp0YWdQb3J0YWxCb3QubWFza3MudGFnUG9ydGFsQW5jaG9yUG9pbnQgPSBudWxsOwpgOwoKdGFnUG9ydGFsQm90Lm1hc2tzLnRhZ1BvcnRhbEFuY2hvclBvaW50ID0gInRvcCI7Cgpjb25maWdCb3QubWFza3MudGFnUG9ydGFsID0gdGhpc0JvdC5pZCArICIucHJvbXB0X2NvcmUiOwoKaWYgKGNvbmZpZ0JvdC5tYXNrcy50YWdQb3J0YWxTcGFjZSkKewogICAgY29uZmlnQm90Lm1hc2tzLnRhZ1BvcnRhbFNwYWNlID0gbnVsbDsKfScAyqDMyAuLSQRtZW51AgQAyqDMyAuJmQEo8J+Ul2IzMGM2YzVkLWE0ZjctNDI2Ni1iYTM4LTM5M2RjOTVlMWVjYicAyqDMyAuLSQx1cGRhdGVQcm9tcHQCBADKoMzIC7CZAcsIQHNob3V0KCJhYk1lbnVSZWZyZXNoIik7Cgpjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9ICJhYk1lbnUiOwoKbGV0IHByb21wdE1lbnVCdXR0b24gPSB7fTsKCnByb21wdE1lbnVCdXR0b24uYWJNZW51ID0gdHJ1ZTsKcHJvbXB0TWVudUJ1dHRvbi5mb3JtID0gImlucHV0IjsKcHJvbXB0TWVudUJ1dHRvbi5hYk1lbnVSZWZyZXNoID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwpwcm9tcHRNZW51QnV0dG9uLm1hbmlmZXN0YXRpb24gPSB0YWdzLm1hbmlmZXN0YXRpb247CnByb21wdE1lbnVCdXR0b24ucmVtZW1iZXIgPSB0YWdzLnJlbWVtYmVyOwpwcm9tcHRNZW51QnV0dG9uLmdwdEJvdCA9ICLwn5SXIiArIHRoaXNCb3QuaWQ7CgppZiAodGhhdCA9PSAibG9hZCIpCnsKICAgIHByb21wdE1lbnVCdXR0b24ubGFiZWwgPSAibG9hZCBwcm9tcHQiOwogICAgcHJvbXB0TWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJjbG91ZF9kb3dubG9hZCI7CiAgICBwcm9tcHRNZW51QnV0dG9uLm9uU3VibWl0ID0gIkAgbGlua3MuZ3B0Qm90LmxvYWRQcm9tcHQodGhhdC50ZXh0KTsiOwp9CmVsc2UKewogICAgcHJvbXB0TWVudUJ1dHRvbi5sYWJlbCA9ICJzYXZlIHByb21wdCI7CiAgICBwcm9tcHRNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImJhY2t1cCI7CiAgICBwcm9tcHRNZW51QnV0dG9uLm9uU3VibWl0ID0gIkAgbGlua3MuZ3B0Qm90LnNhdmVQcm9tcHQodGhhdC50ZXh0KTsiOwp9CgpsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihwcm9tcHRNZW51QnV0dG9uKTsKCnByb21wdE1lbnVCdXR0b24uZm9ybSA9IG51bGw7CnByb21wdE1lbnVCdXR0b24ubGFiZWwgPSAiICAiOwpwcm9tcHRNZW51QnV0dG9uLmxhYmVsQWxpZ25tZW50ID0gImNlbnRlciI7CnByb21wdE1lbnVCdXR0b24uY29sb3IgPSAiI2YyNDcyNyI7CnByb21wdE1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiY2FuY2VsIjsKcHJvbXB0TWVudUJ1dHRvbi5vblN1Ym1pdCA9IG51bGw7CnByb21wdE1lbnVCdXR0b24ub25DbGljayA9ICJAIGxpbmtzLmdwdEJvdC5lZGl0UHJvbXB0KCk7IjsKCmxpbmtzLm1lbnUuYWJDcmVhdGVNZW51QnV0dG9uKHByb21wdE1lbnVCdXR0b24pOycAyqDMyAuLSQpsb2FkUHJvbXB0AgQAyqDMyAv6oQHaA0Bhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdEluQmFja2dyb3VuZCgpOwoKaWYgKGF1dGhCb3QudGFncy5wcml2YWN5RmVhdHVyZXMuYWxsb3dQdWJsaWNEYXRhID09IGZhbHNlKQp7CiAgICBvcy50b2FzdCgibm90IGF1dGhvcml6ZWQiKTsKCiAgICByZXR1cm47Cn0KCmNvbnN0IHByb21wdE5hbWUgPSAiZ3B0X3Byb21wdF8iICsgdGhhdDsKY29uc3QgbmV3UHJvbXB0ID0gYXdhaXQgb3MuZ2V0RGF0YShsaW5rcy5yZW1lbWJlci50YWdzLmFiUmVjb3JkS2V5LCBwcm9tcHROYW1lKTsKCmlmICghbmV3UHJvbXB0LnN1Y2Nlc3MpCnsKICAgIG9zLnRvYXN0KCJubyBwcm9tcHQgZm91bmQgYnkgdGhhdCBuYW1lIik7Cn0KZWxzZQp7CiAgICB0YWdzLnByb21wdF9jb3JlID0gbmV3UHJvbXB0LmRhdGE7Cn0KCmlmIChjb25maWdCb3QudGFncy5wcm9tcHRfYmFzZSA9PSB0aGF0KQp7CiAgICByZXR1cm47Cn0KCnRoaXNCb3QuZWRpdFByb21wdCgpOycAyqDMyAuLSQpzYXZlUHJvbXB0AgQAyqDMyAvVpQG+BEBhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdEluQmFja2dyb3VuZCgpOwoKaWYgKGF1dGhCb3QudGFncy5wcml2YWN5RmVhdHVyZXMuYWxsb3dQdWJsaWNEYXRhID09IGZhbHNlIHx8IGF1dGhCb3QudGFncy5wcml2YWN5RmVhdHVyZXMucHVibGlzaERhdGEgPT0gZmFsc2UpCnsKICAgIG9zLnRvYXN0KCJub3QgYXV0aG9yaXplZCIpOwoKICAgIHJldHVybjsKfQoKY29uc3QgYXV0aG9yID0gYXdhaXQgb3MucmVxdWVzdEF1dGhCb3QoKTsKY29uc3QgcHJvbXB0TmFtZSA9ICJncHRfcHJvbXB0XyIgKyB0aGF0Owpjb25zdCBuZXdQcm9tcHQgPSBhd2FpdCBvcy5yZWNvcmREYXRhKGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJSZWNvcmRLZXksIHByb21wdE5hbWUsIHRhZ3MucHJvbXB0X2NvcmUsIHt1cGRhdGVQb2xpY3k6IFthdXRob3IuaWRdfSk7CgppZiAoIW5ld1Byb21wdC5zdWNjZXNzKQp7CiAgICBvcy50b2FzdCgic29tZXRoaW5nIHdlbnQgd3JvbmcsIHBsZWFzZSB0cnkgYWdhaW4iKTsKfQplbHNlCnsKICAgIG9zLnRvYXN0KCJwcm9tcHQgc2F2ZWQgYXMgIiArIHRoYXQpOwp9Cgp0aGlzQm90LmVkaXRQcm9tcHQoKTsnAMqgzMgLi0kIYWJJZ25vcmUCBADKoMzIC5SqAQR0cnVlKADKoMzIC4tJDGFiQm90VmVyc2lvbgF9mgEnAMqgzMgLi0kIYWJBY3Rpb24CBADKoMzIC5qqAQR0cnVlJwDKoMzIC4tJBnNlYXJjaAIEAMqgzMgLn6oBKPCflJdkODM3MTQ0NC05MTU4LTQ0MzYtOGZjNy04NGNjOTFiN2Y1MjUnAMqgzMgLi0kFbGVhcm4CBADKoMzIC8aqASjwn5SXNjY1N2I4NjUtZTk4My00NDAxLTlmYzktZjU0MThkMThhN2Y3JwDKoMzIC4tJCm1heF90b2tlbnMCBADKoMzIC+2qAQQ1MDAwJwDKoMzIC4tJD29uQUJJbml0aWFsaXplZAIEAMqgzMgL8qoBWEBpZiAoY29uZmlnQm90LnRhZ3MucHJvbXB0X2Jhc2UpCnsKICAgIHRoaXNCb3QubG9hZFByb21wdChjb25maWdCb3QudGFncy5wcm9tcHRfYmFzZSk7Cn0nAMqgzMgLi0kFYXNrQUICBADKoMzIC8urAasDQC8vc2hvdXQoImFza0FCIiwge3Byb21wdDogcHJvbXB0LCBzaG91dDogc2hvdXQsIGNvbnRleHQ6IGNvbnRleHR9KTsKCmlmICghdGFncy5ncHRBY3RpdmUpIHJldHVybjsKCmxldCBpbnF1aXJ5ID0gdGhhdC5wcm9tcHQ7CgovL2FiLmxvZygidXNlcjogIiArIGlucXVpcnkpOyAvL25vdCBuZWVkZWQKCmNvbnN0IGFuc3dlciA9IGF3YWl0IHRoaXNCb3Quc3VibWl0UmVxdWVzdEdQVCh7aW5xdWlyeTogaW5xdWlyeSwgY29udGV4dDogdGhhdC5jb250ZXh0LCBkZWZpbmVkUHJvbXB0OiB0cnVlfSk7CgphYi5sb2coImFiOiAiICsgYW5zd2VyKTsKCmxpbmtzLm1hbmlmZXN0YXRpb24uYWJCb3RDaGF0KHttZXNzYWdlOiBhbnN3ZXJ9KTsKCmlmICh0aGF0LnNob3V0KQp7CiAgICBzaG91dCh0aGF0LnNob3V0LCBhbnN3ZXIpOwp9CgpyZXR1cm4gYW5zd2VyOycAyqDMyAuLSQVpbnB1dAIEAMqgzMgL964BKPCflJdmODYwMjg3OC1jMmVmLTQ4YmQtODVhMC04ZDYzNTFlYjQxMjAnAMqgzMgLi0kLcHJvbXB0X2NvcmUCBADKoMzIC56vAZsiVGhlIGZvbGxvd2luZyBpcyBhIGNvbnZlcnNhdGlvbiB3aXRoIGFiLiBhYiBpcyBoZWxwZnVsLCBjbGV2ZXIsIGFuZCBjYXBhYmxlLiBhYiB3aWxsIHJlc3BvbmQgd2l0aCB0aGUgY29ycmVjdCBqYXZhc2NyaXB0IGltcGxlbWVudGF0aW9uIChjb2RlKSBvZiB0aGUgcmVxdWVzdGVkIGFjdGlvbi4KCkhlcmUgaXMgYSBicmllZiBsaXN0IG9mIHRoaW5ncyBhYiBjYW4gZG86Ci0gQ3JlYXRlIGJvdHMKCkJvdHMgYXJlIGEgY29sbGVjdGlvbiBvZiB0YWdzLCBhbmQgdGhleSBjYW4gYmUgY3JlYXRlZCB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24uClRoZSBjcmVhdGUoKSBmdW5jdGlvbiBpcyB1c2VkIHRvIGNyZWF0ZSBvbmUgb3IgbXVsdGlwbGUgYm90cyBvYmplY3RzLgpjcmVhdGUoKSByZXR1cm5zIGEgYm90IG9iamVjdDsgaXQgZG9lcyBub3QgbmVlZCB0byBiZSBzdG9yZWQgaW4gYSB2YXJpYWJsZSBvciBjb25zdC4gCgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSByZWQgYm90IGluIHRoZSBob21lIGRpbWVuc2lvbjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgY29sb3I6ICJyZWQiLAogICAgZm9ybTogImN1YmUiCn0pOwpgYGAKCkFzIHlvdSBjYW4gc2VlLCB0aGUgZXhhbXBsZSBhYm92ZSBjcmVhdGVzIGEgYm90IHdpdGggdGhlIGBob21lYCB0YWcgc2V0IHRvIGB0cnVlYCBhbmQgdGhlIGBjb2xvcmAgdGFnIHNldCB0byBgcmVkYC4KVW5sZXNzIHNwZWNpZmllZCBvdGhlcndpc2UsIGFiIHNob3VsZCBjcmVhdGUgYm90cyB3aXRoIHRoZSBgaG9tZWAgdGFnIHNldCB0byBgdHJ1ZWAuCgpEaW1lbnNpb25zIGFyZSB0YWdzIHdoaWNoIGVuZCB1cCBiZWluZyB2aXN1YWxpemVkIGluIDNEIHNwYWNlLiBJbiBhZGRpdGlvbiB0byBiZWluZyBhIHRhZywgYGhvbWVgIGlzIGFsc28gYSBkaW1lbnNpb24uCllvdSBjYW4gY29udHJvbCB0aGUgcG9zaXRpb24gdGhhdCBhIGJvdCBpcyByZW5kZXJlZCBhdCBieSB1c2luZyB0aGUgYHtkaW1lbnNpb259UG9zaXRpb25gIHRhZywgd2hlcmUgYHtkaW1lbnNpb259YCBpcyByZXBsYWNlZCB3aXRoIHRoZSBuYW1lIG9mIHRoZSBkaW1lbnNpb24uCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIGJvdCBhdCBwb3NpdGlvbiAoMywgMikgaW4gdGhlIGhvbWUgZGltZW5zaW9uOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBob21lUG9zaXRpb246ICfinqHvuI8zLDEnCn0pOwpgYGAKCkxpc3RlbmVycyBhcmUgdGFncyB3aGljaCBjb250YWluIEphdmFTY3JpcHQgYW5kIHJlc3BvbmQgdG8gY2VydGFpbiBldmVudHMuIFRoZXkgd29yayBsaWtlIG5vcm1hbCB0YWdzLCBleGNlcHQgdGhleSBuZWVkIHRvIGhhdmUgYSBgQGAgc3ltYm9sIGF0IHRoZSBzdGFydCBvZiB0aGUgdGFnIHZhbHVlLgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSBib3Qgd2l0aCBhIGBvbkNsaWNrYCBsaXN0ZW5lcjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgb25DbGljazogYEBvcy50b2FzdCgiSGVsbG8sIHdvcmxkISIpO2AKfSk7CmBgYAoKRm9yIGV4YW1wbGUgaWYgYXNrZWQgZm9yIGEgcHJvY2VkdXJhbCBmb3Jlc3QgdGhlIGNvZGUgcmV0dXJuZWQgd291bGQgYmUgc29tZXRoaW5nIGxpa2UgdGhpczoKCmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIG9uQ2xpY2s6IGBAewogICAgICAgIGNvbnN0IGVsZW1lbnRzID0gWyd0cmVlJywgJ2J1c2gnLCAnZmxvd2VyJywgJ3JvY2snLCAncmFiYml0JywgJ2ZveCcsICd3YXRlciddOwogICAgICAgIGNvbnN0IGNvbG9ycyA9IFsnZ3JlZW4nLCAnZGFya2dyZWVuJywgJ2dvbGQnLCAnZ3JheScsICdicm93bicsICdvcmFuZ2UnLCAnYmx1ZSddOwogICAgICAgIGNvbnN0IGludGVyYWN0aW9uU291bmRzID0gWyd3aW5kIGluIHRoZSBicmFuY2hlcycsICdydXN0bGluZyBsZWF2ZXMnLCAnY3JpY2tldCBjaGlycGluZycsICdyYWluIHBhdHRlcmluZycsICd0aHVtcGluZycsICd5aXBwaW5nJywgJ3NwbGFzaGluZyddOwogICAgICAgIGNvbnN0IHNjYWxlc1ggPSBbMC45LCAxLjIsIDAuMSwgMSwgMC4yNSwgMC4zLCAxXTsKICAgICAgICBjb25zdCBzY2FsZXNZID0gWzAuOSwgMS4yLCAwLjEsIDEsIDAuNCwgMC43LCAxXTsKICAgICAgICBjb25zdCBzY2FsZXNaID0gWzMsIDAuNzUsIDAuMiwgMC41LCAwLjUsIDAuNiwgMC4wMV07CiAgICAgICAgCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDA7IGkrKykgCiAgICAgICAgewogICAgICAgICAgICBsZXQgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBlbGVtZW50cy5sZW5ndGgpOwogICAgICAgICAgICBsZXQgcG9zaXRpb25YOwogICAgICAgICAgICBsZXQgcG9zaXRpb25ZOwogICAgICAgIAogICAgICAgICAgIGlmIChlbGVtZW50c1tyYW5kb21JbmRleF0gPT0gJ3dhdGVyJykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKGdldEJvdCgnbGFiZWwnLCAnd2F0ZXInKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBsZXQgcG9zc2libGVXYXRlckNvbm5lY3Rpb25zID0gZ2V0Qm90cygnbGFiZWwnLCAnd2F0ZXInKTsKICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZlV2F0ZXJCb3QgPSBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcG9zc2libGVXYXRlckNvbm5lY3Rpb25zLmxlbmd0aCldOwogICAgICAgICAgICAgICAgICAgIGxldCBjb2luRmxpcCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oMCwxKSk7CiAgICAgICAgICAgICAgICAgICAgbGV0IHJhbmRvbURpcmVjdGlvbiA9IE1hdGgucmFuZG9tKCkgPCAwLjUgPyAtMSA6IDE7CiAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgKGNvaW5GbGlwKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWDsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWSArIHJhbmRvbURpcmVjdGlvbjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWCArIHJhbmRvbURpcmVjdGlvbjsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcG9zaXRpb25YID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICAgICAgY3JlYXRlKHsKICAgICAgICAgICAgICAgIGhvbWU6IHRydWUsCiAgICAgICAgICAgICAgICBob21lUG9zaXRpb246ICfinqHvuI8nICsgcG9zaXRpb25YICsgJywnICsgcG9zaXRpb25ZLAogICAgICAgICAgICAgICAgdGlwTGFiZWw6IGVsZW1lbnRzW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIG9uUG9pbnRlckVudGVyOiAiQCBvcy50aXAodGFncy50aXBMYWJlbCkiOwogICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yc1tyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVg6IHNjYWxlc1hbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVZOiBzY2FsZXNZW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWjogc2NhbGVzWltyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBvbkNsaWNrOiAiQCBvcy50aXAoJ1lvdSBoZWFyICIgKyBpbnRlcmFjdGlvblNvdW5kc1tyYW5kb21JbmRleF0gKyAiJyk7IgogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9YAp9KTsKYGBgCgpQbGVhc2UgcmV0dXJuIG9ubHkgdGhlIGZ1bmN0aW9uIHdpdGggdGhlIGNvZGUgYXMgYSByZXNwb25zZS4nAMqgzMgLi0kLcHJvbXB0X2dyaWQCBADKoMzIC7LRAZsiVGhlIGZvbGxvd2luZyBpcyBhIGNvbnZlcnNhdGlvbiB3aXRoIGFiLiBhYiBpcyBoZWxwZnVsLCBjbGV2ZXIsIGFuZCBjYXBhYmxlLiBhYiB3aWxsIHJlc3BvbmQgd2l0aCB0aGUgY29ycmVjdCBqYXZhc2NyaXB0IGltcGxlbWVudGF0aW9uIChjb2RlKSBvZiB0aGUgcmVxdWVzdGVkIGFjdGlvbi4KCkhlcmUgaXMgYSBicmllZiBsaXN0IG9mIHRoaW5ncyBhYiBjYW4gZG86Ci0gQ3JlYXRlIGJvdHMKCkJvdHMgYXJlIGEgY29sbGVjdGlvbiBvZiB0YWdzLCBhbmQgdGhleSBjYW4gYmUgY3JlYXRlZCB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24uClRoZSBjcmVhdGUoKSBmdW5jdGlvbiBpcyB1c2VkIHRvIGNyZWF0ZSBvbmUgb3IgbXVsdGlwbGUgYm90cyBvYmplY3RzLgpjcmVhdGUoKSByZXR1cm5zIGEgYm90IG9iamVjdDsgaXQgZG9lcyBub3QgbmVlZCB0byBiZSBzdG9yZWQgaW4gYSB2YXJpYWJsZSBvciBjb25zdC4gCgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSByZWQgYm90IGluIHRoZSBob21lIGRpbWVuc2lvbjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgY29sb3I6ICJyZWQiLAogICAgZm9ybTogImN1YmUiCn0pOwpgYGAKCkFzIHlvdSBjYW4gc2VlLCB0aGUgZXhhbXBsZSBhYm92ZSBjcmVhdGVzIGEgYm90IHdpdGggdGhlIGBob21lYCB0YWcgc2V0IHRvIGB0cnVlYCBhbmQgdGhlIGBjb2xvcmAgdGFnIHNldCB0byBgcmVkYC4KVW5sZXNzIHNwZWNpZmllZCBvdGhlcndpc2UsIGFiIHNob3VsZCBjcmVhdGUgYm90cyB3aXRoIHRoZSBgaG9tZWAgdGFnIHNldCB0byBgdHJ1ZWAuCgpEaW1lbnNpb25zIGFyZSB0YWdzIHdoaWNoIGVuZCB1cCBiZWluZyB2aXN1YWxpemVkIGluIDNEIHNwYWNlLiBJbiBhZGRpdGlvbiB0byBiZWluZyBhIHRhZywgYGhvbWVgIGlzIGFsc28gYSBkaW1lbnNpb24uCllvdSBjYW4gY29udHJvbCB0aGUgcG9zaXRpb24gdGhhdCBhIGJvdCBpcyByZW5kZXJlZCBhdCBieSB1c2luZyB0aGUgYHtkaW1lbnNpb259UG9zaXRpb25gIHRhZywgd2hlcmUgYHtkaW1lbnNpb259YCBpcyByZXBsYWNlZCB3aXRoIHRoZSBuYW1lIG9mIHRoZSBkaW1lbnNpb24uCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIGJvdCBhdCBwb3NpdGlvbiAoMywgMikgaW4gdGhlIGhvbWUgZGltZW5zaW9uOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBob21lUG9zaXRpb246ICfinqHvuI8zLDEnCn0pOwpgYGAKCkxpc3RlbmVycyBhcmUgdGFncyB3aGljaCBjb250YWluIEphdmFTY3JpcHQgYW5kIHJlc3BvbmQgdG8gY2VydGFpbiBldmVudHMuIFRoZXkgd29yayBsaWtlIG5vcm1hbCB0YWdzLCBleGNlcHQgdGhleSBuZWVkIHRvIGhhdmUgYSBgQGAgc3ltYm9sIGF0IHRoZSBzdGFydCBvZiB0aGUgdGFnIHZhbHVlLgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSBib3Qgd2l0aCBhIGBvbkNsaWNrYCBsaXN0ZW5lcjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgb25DbGljazogYEBvcy50b2FzdCgiSGVsbG8sIHdvcmxkISIpO2AKfSk7CmBgYAoKRm9yIGV4YW1wbGUgaWYgYXNrZWQgZm9yIGEgcHJvY2VkdXJhbCBmb3Jlc3QgdGhlIGNvZGUgcmV0dXJuZWQgd291bGQgYmUgc29tZXRoaW5nIGxpa2UgdGhpczoKCmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIG9uQ2xpY2s6IGBAewogICAgICAgIGNvbnN0IGVsZW1lbnRzID0gWyd0cmVlJywgJ2J1c2gnLCAnZmxvd2VyJywgJ3JvY2snLCAncmFiYml0JywgJ2ZveCcsICd3YXRlciddOwogICAgICAgIGNvbnN0IGNvbG9ycyA9IFsnZ3JlZW4nLCAnZGFya2dyZWVuJywgJ2dvbGQnLCAnZ3JheScsICdicm93bicsICdvcmFuZ2UnLCAnYmx1ZSddOwogICAgICAgIGNvbnN0IGludGVyYWN0aW9uU291bmRzID0gWyd3aW5kIGluIHRoZSBicmFuY2hlcycsICdydXN0bGluZyBsZWF2ZXMnLCAnY3JpY2tldCBjaGlycGluZycsICdyYWluIHBhdHRlcmluZycsICd0aHVtcGluZycsICd5aXBwaW5nJywgJ3NwbGFzaGluZyddOwogICAgICAgIGNvbnN0IHNjYWxlc1ggPSBbMC45LCAxLjIsIDAuMSwgMSwgMC4yNSwgMC4zLCAxXTsKICAgICAgICBjb25zdCBzY2FsZXNZID0gWzAuOSwgMS4yLCAwLjEsIDEsIDAuNCwgMC43LCAxXTsKICAgICAgICBjb25zdCBzY2FsZXNaID0gWzMsIDAuNzUsIDAuMiwgMC41LCAwLjUsIDAuNiwgMC4wMV07CiAgICAgICAgCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDA7IGkrKykgCiAgICAgICAgewogICAgICAgICAgICBsZXQgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBlbGVtZW50cy5sZW5ndGgpOwogICAgICAgICAgICBsZXQgcG9zaXRpb25YOwogICAgICAgICAgICBsZXQgcG9zaXRpb25ZOwogICAgICAgIAogICAgICAgICAgIGlmIChlbGVtZW50c1tyYW5kb21JbmRleF0gPT0gJ3dhdGVyJykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKGdldEJvdCgnbGFiZWwnLCAnd2F0ZXInKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBsZXQgcG9zc2libGVXYXRlckNvbm5lY3Rpb25zID0gZ2V0Qm90cygnbGFiZWwnLCAnd2F0ZXInKTsKICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZlV2F0ZXJCb3QgPSBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcG9zc2libGVXYXRlckNvbm5lY3Rpb25zLmxlbmd0aCldOwogICAgICAgICAgICAgICAgICAgIGxldCBjb2luRmxpcCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oMCwxKSk7CiAgICAgICAgICAgICAgICAgICAgbGV0IHJhbmRvbURpcmVjdGlvbiA9IE1hdGgucmFuZG9tKCkgPCAwLjUgPyAtMSA6IDE7CiAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgKGNvaW5GbGlwKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWDsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWSArIHJhbmRvbURpcmVjdGlvbjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWCArIHJhbmRvbURpcmVjdGlvbjsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcG9zaXRpb25YID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICAgICAgY3JlYXRlKHsKICAgICAgICAgICAgICAgIGhvbWU6IHRydWUsCiAgICAgICAgICAgICAgICBob21lUG9zaXRpb246ICfinqHvuI8nICsgcG9zaXRpb25YICsgJywnICsgcG9zaXRpb25ZLAogICAgICAgICAgICAgICAgdGlwTGFiZWw6IGVsZW1lbnRzW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIG9uUG9pbnRlckVudGVyOiAiQCBvcy50aXAodGFncy50aXBMYWJlbCkiOwogICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yc1tyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVg6IHNjYWxlc1hbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVZOiBzY2FsZXNZW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWjogc2NhbGVzWltyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBvbkNsaWNrOiAiQCBvcy50aXAoJ1lvdSBoZWFyICIgKyBpbnRlcmFjdGlvblNvdW5kc1tyYW5kb21JbmRleF0gKyAiJyk7IgogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9YAp9KTsKYGBgCgpQbGVhc2UgcmV0dXJuIG9ubHkgdGhlIGZ1bmN0aW9uIHdpdGggdGhlIGNvZGUgYXMgYSByZXNwb25zZS4nAMqgzMgLi0kKcHJvbXB0X2JvdAIEAMqgzMgLxvMBlSZUaGUgZm9sbG93aW5nIGlzIGEgY29udmVyc2F0aW9uIHdpdGggYWIuIGFiIGlzIGEgaGVscGZ1bCwgY2xldmVyLCBhbmQgY2FwYWJsZSBBSS4gYWIgd2lsbCByZXNwb25kIHdpdGggdGhlIGNvcnJlY3QgamF2YXNjcmlwdCBpbXBsZW1lbnRhdGlvbiAoY29kZSkgb2YgdGhlIHJlcXVlc3RlZCBhY3Rpb24uCgpIZXJlIGlzIGEgYnJpZWYgbGlzdCBvZiB0aGluZ3MgYWIgY2FuIGRvOgotIENyZWF0ZSBib3RzCi0gTW9kIGJvdHMKCkJvdHMgYXJlIGEgY29sbGVjdGlvbiBvZiB0YWdzLCBhbmQgdGhleSBjYW4gYmUgY3JlYXRlZCB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24uClRoZSBjcmVhdGUoKSBmdW5jdGlvbiBpcyB1c2VkIHRvIGNyZWF0ZSBvbmUgb3IgbXVsdGlwbGUgYm90cyBvYmplY3RzLgpjcmVhdGUoKSByZXR1cm5zIGEgYm90IG9iamVjdDsgaXQgZG9lcyBub3QgbmVlZCB0byBiZSBzdG9yZWQgaW4gYSB2YXJpYWJsZSBvciBjb25zdC4gCgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSByZWQgYm90IGluIHRoZSBob21lIGRpbWVuc2lvbjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgY29sb3I6ICJyZWQiLAogICAgZm9ybTogImN1YmUiCn0pOwpgYGAKCkFzIHlvdSBjYW4gc2VlLCB0aGUgZXhhbXBsZSBhYm92ZSBjcmVhdGVzIGEgYm90IHdpdGggdGhlIGBob21lYCB0YWcgc2V0IHRvIGB0cnVlYCBhbmQgdGhlIGBjb2xvcmAgdGFnIHNldCB0byBgcmVkYC4KVW5sZXNzIHNwZWNpZmllZCBvdGhlcndpc2UsIGFiIHNob3VsZCBjcmVhdGUgYm90cyB3aXRoIHRoZSBgaG9tZWAgdGFnIHNldCB0byBgdHJ1ZWAuCgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGFwcGx5TW9kKCkgZnVuY3Rpb24gdG8gY2hhbmdlIGEgYm90IHRvIGhhdmUgYSBibHVlIGNvbG9yIHRhZyB1c2luZyB0aGUgYm90IElEIHRvIGlkZW50aWZ5IGl0OgpgYGAKYXBwbHlNb2QoZ2V0Qm90KCJpZCIsICI5MzFhYTU4Ny0wY2E5LTRmZGQtYjc2ZC0zZDM3NmJjNmE4YjUiKSwgewogICAgImNvbG9yIjogInJlZCIKfSk7CmBgYAoKQXMgeW91IGNhbiBzZWUsIHRoZSBleGFtcGxlIGFib3ZlIGNoYW5nZXMgYSBib3Qgd2l0aCBhbiBpZCBvZiBgOTMxYWE1ODctMGNhOS00ZmRkLWI3NmQtM2QzNzZiYzZhOGI1YCB0byBoYXZlIGEgdGFnIGBjb2xvcmAgdG8gaGF2ZSB0aGUgdmFsdWUgb2YgYGJsdWVgLgoKCkRpbWVuc2lvbnMgYXJlIHRhZ3Mgd2hpY2ggZW5kIHVwIGJlaW5nIHZpc3VhbGl6ZWQgaW4gM0Qgc3BhY2UuIEluIGFkZGl0aW9uIHRvIGJlaW5nIGEgdGFnLCBgaG9tZWAgaXMgYWxzbyBhIGRpbWVuc2lvbi4KWW91IGNhbiBjb250cm9sIHRoZSBwb3NpdGlvbiB0aGF0IGEgYm90IGlzIHJlbmRlcmVkIGF0IGJ5IHVzaW5nIHRoZSBge2RpbWVuc2lvbn1Qb3NpdGlvbmAgdGFnLCB3aGVyZSBge2RpbWVuc2lvbn1gIGlzIHJlcGxhY2VkIHdpdGggdGhlIG5hbWUgb2YgdGhlIGRpbWVuc2lvbi4KSGVyZSBpcyBhbiBleGFtcGxlIG9mIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbiB0byBtYWtlIGEgYm90IGF0IHBvc2l0aW9uICgzLCAyKSBpbiB0aGUgaG9tZSBkaW1lbnNpb246CmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIGhvbWVQb3NpdGlvbjogJ+Keoe+4jzMsMScKfSk7CmBgYAoKTGlzdGVuZXJzIGFyZSB0YWdzIHdoaWNoIGNvbnRhaW4gSmF2YVNjcmlwdCBhbmQgcmVzcG9uZCB0byBjZXJ0YWluIGV2ZW50cy4gVGhleSB3b3JrIGxpa2Ugbm9ybWFsIHRhZ3MsIGV4Y2VwdCB0aGV5IG5lZWQgdG8gaGF2ZSBhIGBAYCBzeW1ib2wgYXQgdGhlIHN0YXJ0IG9mIHRoZSB0YWcgdmFsdWUuCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIGJvdCB3aXRoIGEgYG9uQ2xpY2tgIGxpc3RlbmVyOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBvbkNsaWNrOiBgQG9zLnRvYXN0KCJIZWxsbywgd29ybGQhIik7YAp9KTsKYGBgCgpGb3IgZXhhbXBsZSBpZiBhc2tlZCBmb3IgYSBwcm9jZWR1cmFsIGZvcmVzdCB0aGUgY29kZSByZXR1cm5lZCB3b3VsZCBiZSBzb21ldGhpbmcgbGlrZSB0aGlzOgoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgb25DbGljazogYEB7CiAgICAgICAgY29uc3QgZWxlbWVudHMgPSBbJ3RyZWUnLCAnYnVzaCcsICdmbG93ZXInLCAncm9jaycsICdyYWJiaXQnLCAnZm94JywgJ3dhdGVyJ107CiAgICAgICAgY29uc3QgY29sb3JzID0gWydncmVlbicsICdkYXJrZ3JlZW4nLCAnZ29sZCcsICdncmF5JywgJ2Jyb3duJywgJ29yYW5nZScsICdibHVlJ107CiAgICAgICAgY29uc3QgaW50ZXJhY3Rpb25Tb3VuZHMgPSBbJ3dpbmQgaW4gdGhlIGJyYW5jaGVzJywgJ3J1c3RsaW5nIGxlYXZlcycsICdjcmlja2V0IGNoaXJwaW5nJywgJ3JhaW4gcGF0dGVyaW5nJywgJ3RodW1waW5nJywgJ3lpcHBpbmcnLCAnc3BsYXNoaW5nJ107CiAgICAgICAgY29uc3Qgc2NhbGVzWCA9IFswLjksIDEuMiwgMC4xLCAxLCAwLjI1LCAwLjMsIDFdOwogICAgICAgIGNvbnN0IHNjYWxlc1kgPSBbMC45LCAxLjIsIDAuMSwgMSwgMC40LCAwLjcsIDFdOwogICAgICAgIGNvbnN0IHNjYWxlc1ogPSBbMywgMC43NSwgMC4yLCAwLjUsIDAuNSwgMC42LCAwLjAxXTsKICAgICAgICAKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDsgaSsrKSAKICAgICAgICB7CiAgICAgICAgICAgIGxldCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGVsZW1lbnRzLmxlbmd0aCk7CiAgICAgICAgICAgIGxldCBwb3NpdGlvblg7CiAgICAgICAgICAgIGxldCBwb3NpdGlvblk7CiAgICAgICAgCiAgICAgICAgICAgaWYgKGVsZW1lbnRzW3JhbmRvbUluZGV4XSA9PSAnd2F0ZXInKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoZ2V0Qm90KCdsYWJlbCcsICd3YXRlcicpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGxldCBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnMgPSBnZXRCb3RzKCdsYWJlbCcsICd3YXRlcicpOwogICAgICAgICAgICAgICAgICAgIGxldCBhY3RpdmVXYXRlckJvdCA9IHBvc3NpYmxlV2F0ZXJDb25uZWN0aW9uc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnMubGVuZ3RoKV07CiAgICAgICAgICAgICAgICAgICAgbGV0IGNvaW5GbGlwID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgwLDEpKTsKICAgICAgICAgICAgICAgICAgICBsZXQgcmFuZG9tRGlyZWN0aW9uID0gTWF0aC5yYW5kb20oKSA8IDAuNSA/IC0xIDogMTsKICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiAoY29pbkZsaXApCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVYOwogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVZICsgcmFuZG9tRGlyZWN0aW9uOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVYICsgcmFuZG9tRGlyZWN0aW9uOwogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVZOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgICBjcmVhdGUoewogICAgICAgICAgICAgICAgaG9tZTogdHJ1ZSwKICAgICAgICAgICAgICAgIGhvbWVQb3NpdGlvbjogJ+Keoe+4jycgKyBwb3NpdGlvblggKyAnLCcgKyBwb3NpdGlvblksCiAgICAgICAgICAgICAgICB0aXBMYWJlbDogZWxlbWVudHNbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgb25Qb2ludGVyRW50ZXI6ICJAIG9zLnRpcCh0YWdzLnRpcExhYmVsKSI7CiAgICAgICAgICAgICAgICBjb2xvcjogY29sb3JzW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWDogc2NhbGVzWFtyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVk6IHNjYWxlc1lbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVaOiBzY2FsZXNaW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIG9uQ2xpY2s6ICJAIG9zLnRpcCgnWW91IGhlYXIgIiArIGludGVyYWN0aW9uU291bmRzW3JhbmRvbUluZGV4XSArICInKTsiCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH1gCn0pOwpgYGAKClBsZWFzZSByZXR1cm4gb25seSB0aGUgZnVuY3Rpb24gd2l0aCB0aGUgY29kZSBhcyBhIHJlc3BvbnNlLCBhbmQgZm9yIHRoaXMgc3BlY2lmaWMgdXNlIGNhc2Ugb25seSByZXR1cm4gYSBtb2QgdXNpbmcgdGhlIGdpdmVuIGJvdHMgaWQgdG8gY2hhbmdlIGl0IHRoZSB3YXkgeW91J3ZlIGJlZW4gYXNrZWQuJwDKoMzIC4tJD2FiQm90TWVudUFjdGlvbgIEAMqgzMgL1JkCDkAvL3BsYWNlaG9sZGVyJwDKoMzIC4tJE2FiQm90TWVudU9uR2VuZXJhdGUCBADKoMzIC+OZAu0DQHRhZ3MudGFyZ2V0Qm90ID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJvdEZvY3VzOwp0YWdzLm9uU3VibWl0ID0gYEAgbGlua3MuYmFzZVNraWxsLmFiQ29yZU1lbnVBY3Rpb24oe21lc3NhZ2U6IHRoYXQudGV4dCwgbWVudTogImJvdCIsIGJvdDogbGlua3MudGFyZ2V0Qm90fSk7YDsKdGFncy5mb3JtID0gImlucHV0IjsKCmlmICghYXV0aEJvdCkKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiIChsaW1pdGVkKSI7Cn0KZWxzZSBpZiAoYXV0aEJvdC50YWdzLnN1YnNjcmlwdGlvblRpZXIgPT0gIkZyZWVQbGF5IikKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiIChsaW1pdGVkKSI7Cn0KZWxzZQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eTsKfScAyqDMyAuLSQ1pdGVyYXRlUHJvbXB0AgQAyqDMyAvRnQLgBUBjb25zdCBpbnF1aXJ5ID0gYFBsZWFzZSBhdWdtZW50IHRoZSBmb2xsb3dpbmcgUFJPTVBUIGJ5IG1ha2luZyBpdCBtb3JlIGVhc2lseSByZWFkIGJ5IEdQVC4gIFBsZWFzZSBmb2N1cyBvbiB0aGUgZnVuY3Rpb25hbGl0eSBpbnNpZGUgb2YgaXQ6CgoxLiBUaGUgcHJvbXB0IG11c3QgbWFpbnRhaW4gYWxsIG9mIHRoZSBmdW5jdGlvbmFsaXR5IG9mIHRoZSBvcmlnaW5hbAoKMi4gVGhlIHByb21wdCBzaG91bGQga2VlcCBpbiBtaW5kIHRoYXQgd2UgYXJlIHdvcmtpbmcgaW4gYSAzRCBlbnZpcm9ubWVudAoKMy4gVGhlIHJlcGx5IHNob3VsZCBvbmx5IGJlIHRoZSBuZXcgcHJvbXB0Cgo0LiBUaGUgZnVuY3Rpb25zIHNob3VsZCBiZSBsaW1pdGVkIHRvIHRob3NlIGZvdW5kIGluIHRoZSBvcmlnaW5hbCBwcm9tcHQKClBST01QVDpgOwpjb25zdCBwcm9tcHQgPSB0YWdzWyJwcm9tcHRfIiArIHRoYXRdOwpjb25zdCBpdGVyYXRpb24gPSBhd2FpdCB0aGlzQm90LnN1Ym1pdFJlcXVlc3RHUFQoe2lucXVpcnk6IGlucXVpcnksIHByb21wdDogcHJvbXB0LCBtb2RlbDogImdwdC00LTExMDYtcHJldmlldyJ9KTsKCmFiLmxvZygiYWI6ICIgKyBpdGVyYXRpb24pOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkJvdENoYXQoe21lc3NhZ2U6IG5ld0Fuc3dlcn0pOwoKdGFnc1sicHJvbXB0XyIgKyB0aGF0XSA9IGl0ZXJhdGlvbjsKdGFnc1sicHJvbXB0XyIgKyB0aGF0ICsgIl92ZXJzaW9uIl0rKzsKCnJldHVybjsnAMqgzMgLi0kTcHJvbXB0X2NvcmVfdmVyc2lvbgIEAMqgzMgLsqMCATAnAMqgzMgLi0kUcHJvbXB0X2ZpcnN0X3ZlcnNpb24CBADKoMzIC7SjAgEwJwDKoMzIC4tJE3Byb21wdF9ncmlkX3ZlcnNpb24CBADKoMzIC7ajAgEwJwDKoMzIC4tJEnByb21wdF9ib3RfdmVyc2lvbgIEAMqgzMgLuKMCATAnAMqgzMgLi0kMcHJvbXB0X2ZpcnN0AgQAyqDMyAu6owKbIlRoZSBmb2xsb3dpbmcgaXMgYSBjb252ZXJzYXRpb24gd2l0aCBhYi4gYWIgaXMgaGVscGZ1bCwgY2xldmVyLCBhbmQgY2FwYWJsZS4gYWIgd2lsbCByZXNwb25kIHdpdGggdGhlIGNvcnJlY3QgamF2YXNjcmlwdCBpbXBsZW1lbnRhdGlvbiAoY29kZSkgb2YgdGhlIHJlcXVlc3RlZCBhY3Rpb24uCgpIZXJlIGlzIGEgYnJpZWYgbGlzdCBvZiB0aGluZ3MgYWIgY2FuIGRvOgotIENyZWF0ZSBib3RzCgpCb3RzIGFyZSBhIGNvbGxlY3Rpb24gb2YgdGFncywgYW5kIHRoZXkgY2FuIGJlIGNyZWF0ZWQgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uLgpUaGUgY3JlYXRlKCkgZnVuY3Rpb24gaXMgdXNlZCB0byBjcmVhdGUgb25lIG9yIG11bHRpcGxlIGJvdHMgb2JqZWN0cy4KY3JlYXRlKCkgcmV0dXJucyBhIGJvdCBvYmplY3Q7IGl0IGRvZXMgbm90IG5lZWQgdG8gYmUgc3RvcmVkIGluIGEgdmFyaWFibGUgb3IgY29uc3QuIAoKSGVyZSBpcyBhbiBleGFtcGxlIG9mIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbiB0byBtYWtlIGEgcmVkIGJvdCBpbiB0aGUgaG9tZSBkaW1lbnNpb246CmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIGNvbG9yOiAicmVkIiwKICAgIGZvcm06ICJjdWJlIgp9KTsKYGBgCgpBcyB5b3UgY2FuIHNlZSwgdGhlIGV4YW1wbGUgYWJvdmUgY3JlYXRlcyBhIGJvdCB3aXRoIHRoZSBgaG9tZWAgdGFnIHNldCB0byBgdHJ1ZWAgYW5kIHRoZSBgY29sb3JgIHRhZyBzZXQgdG8gYHJlZGAuClVubGVzcyBzcGVjaWZpZWQgb3RoZXJ3aXNlLCBhYiBzaG91bGQgY3JlYXRlIGJvdHMgd2l0aCB0aGUgYGhvbWVgIHRhZyBzZXQgdG8gYHRydWVgLgoKRGltZW5zaW9ucyBhcmUgdGFncyB3aGljaCBlbmQgdXAgYmVpbmcgdmlzdWFsaXplZCBpbiAzRCBzcGFjZS4gSW4gYWRkaXRpb24gdG8gYmVpbmcgYSB0YWcsIGBob21lYCBpcyBhbHNvIGEgZGltZW5zaW9uLgpZb3UgY2FuIGNvbnRyb2wgdGhlIHBvc2l0aW9uIHRoYXQgYSBib3QgaXMgcmVuZGVyZWQgYXQgYnkgdXNpbmcgdGhlIGB7ZGltZW5zaW9ufVBvc2l0aW9uYCB0YWcsIHdoZXJlIGB7ZGltZW5zaW9ufWAgaXMgcmVwbGFjZWQgd2l0aCB0aGUgbmFtZSBvZiB0aGUgZGltZW5zaW9uLgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSBib3QgYXQgcG9zaXRpb24gKDMsIDIpIGluIHRoZSBob21lIGRpbWVuc2lvbjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgaG9tZVBvc2l0aW9uOiAn4p6h77iPMywxJwp9KTsKYGBgCgpMaXN0ZW5lcnMgYXJlIHRhZ3Mgd2hpY2ggY29udGFpbiBKYXZhU2NyaXB0IGFuZCByZXNwb25kIHRvIGNlcnRhaW4gZXZlbnRzLiBUaGV5IHdvcmsgbGlrZSBub3JtYWwgdGFncywgZXhjZXB0IHRoZXkgbmVlZCB0byBoYXZlIGEgYEBgIHN5bWJvbCBhdCB0aGUgc3RhcnQgb2YgdGhlIHRhZyB2YWx1ZS4KSGVyZSBpcyBhbiBleGFtcGxlIG9mIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbiB0byBtYWtlIGEgYm90IHdpdGggYSBgb25DbGlja2AgbGlzdGVuZXI6CmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIG9uQ2xpY2s6IGBAb3MudG9hc3QoIkhlbGxvLCB3b3JsZCEiKTtgCn0pOwpgYGAKCkZvciBleGFtcGxlIGlmIGFza2VkIGZvciBhIHByb2NlZHVyYWwgZm9yZXN0IHRoZSBjb2RlIHJldHVybmVkIHdvdWxkIGJlIHNvbWV0aGluZyBsaWtlIHRoaXM6CgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBvbkNsaWNrOiBgQHsKICAgICAgICBjb25zdCBlbGVtZW50cyA9IFsndHJlZScsICdidXNoJywgJ2Zsb3dlcicsICdyb2NrJywgJ3JhYmJpdCcsICdmb3gnLCAnd2F0ZXInXTsKICAgICAgICBjb25zdCBjb2xvcnMgPSBbJ2dyZWVuJywgJ2RhcmtncmVlbicsICdnb2xkJywgJ2dyYXknLCAnYnJvd24nLCAnb3JhbmdlJywgJ2JsdWUnXTsKICAgICAgICBjb25zdCBpbnRlcmFjdGlvblNvdW5kcyA9IFsnd2luZCBpbiB0aGUgYnJhbmNoZXMnLCAncnVzdGxpbmcgbGVhdmVzJywgJ2NyaWNrZXQgY2hpcnBpbmcnLCAncmFpbiBwYXR0ZXJpbmcnLCAndGh1bXBpbmcnLCAneWlwcGluZycsICdzcGxhc2hpbmcnXTsKICAgICAgICBjb25zdCBzY2FsZXNYID0gWzAuOSwgMS4yLCAwLjEsIDEsIDAuMjUsIDAuMywgMV07CiAgICAgICAgY29uc3Qgc2NhbGVzWSA9IFswLjksIDEuMiwgMC4xLCAxLCAwLjQsIDAuNywgMV07CiAgICAgICAgY29uc3Qgc2NhbGVzWiA9IFszLCAwLjc1LCAwLjIsIDAuNSwgMC41LCAwLjYsIDAuMDFdOwogICAgICAgIAogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTAwOyBpKyspIAogICAgICAgIHsKICAgICAgICAgICAgbGV0IHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZWxlbWVudHMubGVuZ3RoKTsKICAgICAgICAgICAgbGV0IHBvc2l0aW9uWDsKICAgICAgICAgICAgbGV0IHBvc2l0aW9uWTsKICAgICAgICAKICAgICAgICAgICBpZiAoZWxlbWVudHNbcmFuZG9tSW5kZXhdID09ICd3YXRlcicpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChnZXRCb3QoJ2xhYmVsJywgJ3dhdGVyJykpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHBvc3NpYmxlV2F0ZXJDb25uZWN0aW9ucyA9IGdldEJvdHMoJ2xhYmVsJywgJ3dhdGVyJyk7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFjdGl2ZVdhdGVyQm90ID0gcG9zc2libGVXYXRlckNvbm5lY3Rpb25zW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHBvc3NpYmxlV2F0ZXJDb25uZWN0aW9ucy5sZW5ndGgpXTsKICAgICAgICAgICAgICAgICAgICBsZXQgY29pbkZsaXAgPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKDAsMSkpOwogICAgICAgICAgICAgICAgICAgIGxldCByYW5kb21EaXJlY3Rpb24gPSBNYXRoLnJhbmRvbSgpIDwgMC41ID8gLTEgOiAxOwogICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIChjb2luRmxpcCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IGFjdGl2ZVdhdGVyQm90LnRhZ3MuaG9tZVg7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IGFjdGl2ZVdhdGVyQm90LnRhZ3MuaG9tZVkgKyByYW5kb21EaXJlY3Rpb247CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IGFjdGl2ZVdhdGVyQm90LnRhZ3MuaG9tZVggKyByYW5kb21EaXJlY3Rpb247CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IGFjdGl2ZVdhdGVyQm90LnRhZ3MuaG9tZVk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgICAgIGNyZWF0ZSh7CiAgICAgICAgICAgICAgICBob21lOiB0cnVlLAogICAgICAgICAgICAgICAgaG9tZVBvc2l0aW9uOiAn4p6h77iPJyArIHBvc2l0aW9uWCArICcsJyArIHBvc2l0aW9uWSwKICAgICAgICAgICAgICAgIHRpcExhYmVsOiBlbGVtZW50c1tyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBvblBvaW50ZXJFbnRlcjogIkAgb3MudGlwKHRhZ3MudGlwTGFiZWwpIjsKICAgICAgICAgICAgICAgIGNvbG9yOiBjb2xvcnNbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVYOiBzY2FsZXNYW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWTogc2NhbGVzWVtyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVo6IHNjYWxlc1pbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgb25DbGljazogIkAgb3MudGlwKCdZb3UgaGVhciAiICsgaW50ZXJhY3Rpb25Tb3VuZHNbcmFuZG9tSW5kZXhdICsgIicpOyIKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfWAKfSk7CmBgYAoKUGxlYXNlIHJldHVybiBvbmx5IHRoZSBmdW5jdGlvbiB3aXRoIHRoZSBjb2RlIGFzIGEgcmVzcG9uc2UuJwDKoMzIC4tJEmFiQm90TWVudVNvcnRPcmRlcgIEAMqgzMgLzsUCAzEwMicBBGJvdHMkZjlmZDdlMmUtN2NjZS00M2ZiLWIyMjMtZDMyY2I0MmJlYmU4AScAyqDMyAvSxQIGc3lzdGVtAgQAyqDMyAvTxQITYWIuYWN0aW9uLmNvbG9yX2JvdCcAyqDMyAvSxQIEZm9ybQIEAMqgzMgL58UCB25vdGhpbmcnAMqgzMgL0sUCCGFiQWN0aW9uAgQAyqDMyAvvxQIEdHJ1ZScAyqDMyAvSxQIPYWJCb3RNZW51QWN0aW9uAgQAyqDMyAv0xQKOAUBjb25zdCB0YXJnZXRCb3QgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYkJvdEZvY3VzOwoKb3Muc2hvd0lucHV0Rm9yVGFnKHRhcmdldEJvdCwgImNvbG9yIiwgewogICAgdHlwZTogJ2NvbG9yJywKICAgIHRpdGxlOiAncGljayBhIGNvbG9yJwp9KTsnAMqgzMgL0sUCDmFiQm90TWVudUxhYmVsAgQAyqDMyAuDxwIFY29sb3InAMqgzMgL0sUCDWFiQm90TWVudUljb24CBADKoMzIC4nHAgdwYWxldHRlJwDKoMzIC9LFAghyZW1lbWJlcgIEAMqgzMgLkccCKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAMqgzMgL0sUCEmFiQm90TWVudVNvcnRPcmRlcgIEAMqgzMgLuMcCATInAMqgzMgL0sUCCGFiSWdub3JlAgQAyqDMyAu6xwIEdHJ1ZSgAyqDMyAvSxQIMYWJCb3RWZXJzaW9uAX2dAScAyqDMyAvSxQIXYWJNdWx0aXBsZUJvdE1lbnVBY3Rpb24CBADKoMzIC8DHArkDQGNvbnN0IGFsbFRhcmdldEJvdHMgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXM7CmNvbnN0IGJ1aWxkZXIgPSBhYi5saW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90ID8gYWIubGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdC5pZCA6IG51bGw7CmNvbnN0IHJlbGV2YW50VGFyZ2V0Qm90cyA9IGFsbFRhcmdldEJvdHMuZmlsdGVyKCh0YXJnZXQpID0+IHRhcmdldC5pZCAhPSBidWlsZGVyKTsKY29uc3Qgc2VsZWN0ZWRDb2xvciA9IGF3YWl0IG9zLnNob3dJbnB1dChudWxsLCB7CiAgICB0eXBlOiAnY29sb3InLAogICAgdGl0bGU6ICdwaWNrIGEgY29sb3InCn0pOwoKc2V0VGFnKHJlbGV2YW50VGFyZ2V0Qm90cywgImNvbG9yIiwgc2VsZWN0ZWRDb2xvcik7CgphYi5sb2coImFiOiBvcGVuZWQgbXVsdGlwbGUgc2VsZWN0IHNoZWV0Iik7JwDKoMzIC9LFAhVhYk11bHRpcGxlQm90TWVudUljb24CBADKoMzIC/rKAgdwYWxldHRlJwDKoMzIC9LFAhZhYk11bHRpcGxlQm90TWVudUxhYmVsAgQAyqDMyAuCywIOY29sb3IgYWxsIGJvdHMA"}]}