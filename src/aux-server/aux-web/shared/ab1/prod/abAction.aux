{"version":2,"updates":[{"id":0,"timestamp":1729779085504,"update":"Aa8C7beivQMAJwEEYm90cyQzOTg4MDFmZS00YjM1LTRjZTQtODI2Zi0yMzgzNWMxYjlhYzUBJwDtt6K9AwAGc3lzdGVtAgQA7beivQMBFGFiLmFjdGlvbi5jcmVhdGVfYm90JwDtt6K9AwAIYWJBY3Rpb24CBADtt6K9AxYEdHJ1ZScA7beivQMABGZvcm0CBADtt6K9AxsHbm90aGluZycA7beivQMAC2Rlc2NyaXB0aW9uAgQA7beivQMjDUNyZWF0ZXMgYm90cy4nAO23or0DABBhYkdyaWRNZW51QWN0aW9uAgQA7beivQMxqwVAY29uc3QgZ3JpZEluZm9ybWF0aW9uID0gbGlua3MucmVtZW1iZXIudGFncy5hYkdyaWRGb2N1czsKY29uc3QgbmV3Qm90ID0ge307CgpuZXdCb3QuY3JlYXRvciA9IG51bGw7Cm5ld0JvdFtncmlkSW5mb3JtYXRpb24uZGltZW5zaW9uXSA9IHRydWU7Cm5ld0JvdFtncmlkSW5mb3JtYXRpb24uZGltZW5zaW9uICsgIlgiXSA9IGdyaWRJbmZvcm1hdGlvbi5wb3NpdGlvbi54OwpuZXdCb3RbZ3JpZEluZm9ybWF0aW9uLmRpbWVuc2lvbiArICJZIl0gPSBncmlkSW5mb3JtYXRpb24ucG9zaXRpb24ueTsKbmV3Qm90LmNvbG9yID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKCmxldCBjcmVhdGVkQm90ID0gY3JlYXRlKG5ld0JvdCk7CgpzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90Lm1hc2tzLmxpbmVDb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3I7CmxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QubWFza3MubGluZVRvID0gY3JlYXRlZEJvdC5pZDsKCmxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiQm90Rm9jdXMgPSAi8J+UlyIgKyBjcmVhdGVkQm90LmlkOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKHttZW51OiAiYm90In0pOycA7beivQMAD2FiR3JpZE1lbnVMYWJlbAIEAO23or0D2wUDYm90JwDtt6K9AwAOYWJHcmlkTWVudUljb24CBADtt6K9A98FB2FkZF9ib3gnAO23or0DAAhyZW1lbWJlcgIEAO23or0D5wUo8J+Ul2U1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNycA7beivQMADW1hbmlmZXN0YXRpb24CBADtt6K9A44GKPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAO23or0DAAhhYklnbm9yZQIEAO23or0DtQYEdHJ1ZScA7beivQMAE2FiR3JpZE1lbnVTb3J0T3JkZXICBADtt6K9A7oGATEnAO23or0DAAlhYlZlcnNpb24CBADtt6K9A7wGFDkuNjUuMS4xNzI5Nzc5MDg1NTAwJwEEYm90cyQ1ODQ5YWY1NS01ZThhLTQ4ZDYtOTEwNi0xOTk0OThlOWVjMDgBJwDtt6K9A9EGBnN5c3RlbQIEAO23or0D0gYRYWIuYWN0aW9uLmRlc3Ryb3knAO23or0D0QYIYWJBY3Rpb24CBADtt6K9A+QGBHRydWUnAO23or0D0QYEZm9ybQIEAO23or0D6QYHbm90aGluZycA7beivQPRBg9hYkJvdE1lbnVBY3Rpb24CBADtt6K9A/EGgQFAY29uc3QgdGFyZ2V0Qm90ID0gbGlua3MucmVtZW1iZXIubGlua3MuYWJCb3RGb2N1czsKCmRlc3Ryb3kodGFyZ2V0Qm90KTsKCnNob3V0KCJhYk1lbnVSZWZyZXNoIik7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soKTsnAO23or0D0QYOYWJCb3RNZW51TGFiZWwCBADtt6K9A/MHB2Rlc3Ryb3knAO23or0D0QYNYWJCb3RNZW51SWNvbgIEAO23or0D+wcOZGVsZXRlX2ZvcmV2ZXInAO23or0D0QYSYWJCb3RNZW51U29ydE9yZGVyAgQA7beivQOKCAMxMDAnAO23or0D0QYIcmVtZW1iZXICBADtt6K9A44IKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAO23or0D0QYNbWFuaWZlc3RhdGlvbgIEAO23or0DtQgo8J+Ul2RjYTVkOTg3LWM0ZDgtNDZlNC1iNjBjLWRhYTdiMmY0ZGRhZCcA7beivQPRBghhYklnbm9yZQIEAO23or0D3AgEdHJ1ZScA7beivQPRBg5hYkJvdE1lbnVDb2xvcgIEAO23or0D4QgHI0Q5MzAzMCcA7beivQPRBhdhYk11bHRpcGxlQm90TWVudUFjdGlvbgIEAO23or0D6QjMAkBjb25zdCBhbGxUYXJnZXRCb3RzID0gbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzOwpjb25zdCBidWlsZGVyID0gYWIubGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdCA/IGFiLmxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QuaWQgOiBudWxsOwpjb25zdCByZWxldmFudFRhcmdldEJvdHMgPSBhbGxUYXJnZXRCb3RzLmZpbHRlcigodGFyZ2V0KSA9PiB0YXJnZXQuaWQgIT0gYnVpbGRlcik7CgpkZXN0cm95KHJlbGV2YW50VGFyZ2V0Qm90cyk7CgpzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7JwDtt6K9A9EGFWFiTXVsdGlwbGVCb3RNZW51SWNvbgIEAO23or0DtgsOZGVsZXRlX2ZvcmV2ZXInAO23or0D0QYWYWJNdWx0aXBsZUJvdE1lbnVMYWJlbAIEAO23or0DxQsHZGVzdHJveScA7beivQPRBhphYk11bHRpcGxlQm90TWVudVNvcnRPcmRlcgIEAO23or0DzQsDMTAwJwDtt6K9A9EGFmFiTXVsdGlwbGVCb3RNZW51Q29sb3ICBADtt6K9A9ELByNEOTMwMzAnAO23or0D0QYJYWJWZXJzaW9uAgQA7beivQPZCxQ5LjY1LjEuMTcyOTc3OTA4NTUwMCcBBGJvdHMkNzE3NTY0NWMtNGI1My00NDU0LTg3MTYtZmMwZTY4ZGIyNjY1AScA7beivQPuCwZzeXN0ZW0CBADtt6K9A+8LD2FiLmFjdGlvbi5sb2dpbicA7beivQPuCwhhYkFjdGlvbgIEAO23or0D/wsEdHJ1ZScA7beivQPuCwhhYklnbm9yZQIEAO23or0DhAwEdHJ1ZScA7beivQPuCwRmb3JtAgQA7beivQOJDAdub3RoaW5nJwDtt6K9A+4LD2FiQ29yZU1lbnVDb2xvcgIEAO23or0DkQwHI0YyQjcwNScA7beivQPuCxNhYkNvcmVNZW51U29ydE9yZGVyAgQA7beivQOZDAItNScA7beivQPuCxBhYkNvcmVNZW51QWN0aW9uAgQA7beivQOcDCxAb3MuZ29Ub1VSTChsaW5rcy5yZW1lbWJlci50YWdzLmFiQXV0aFNpdGUpOycA7beivQPuCxRhYkNvcmVNZW51T25HZW5lcmF0ZQIEAO23or0DyQydAkBhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdEluQmFja2dyb3VuZCgpOwoKaWYgKCFsaW5rcy5yZW1lbWJlci50YWdzLmFiQXV0aFNpdGUpCnsKICAgIGRlc3Ryb3kodGhpc0JvdCk7Cn0KCnRhZ3MubGFiZWwgPSAiYnV5ICIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5OwoKaWYgKCFhdXRoQm90KQp7CiAgICByZXR1cm47Cn0KZWxzZSBpZiAoYXV0aEJvdC50YWdzLnN1YnNjcmlwdGlvblRpZXIgPT0gIkZyZWVQbGF5IikKewogICAgcmV0dXJuOwp9CgpkZXN0cm95KHRoaXNCb3QpOycA7beivQPuCw5hYkNvcmVNZW51SWNvbgIEAO23or0D5w4OYWNjb3VudF9jaXJjbGUnAO23or0D7gsIcmVtZW1iZXICBADtt6K9A/YOKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAO23or0D7gsJYWJWZXJzaW9uAgQA7beivQOdDxQ5LjY1LjEuMTcyOTc3OTA4NTUwMCcBBGJvdHMkYjMzOWMxMTgtNDg5YS00NjZiLWJhOWYtYjA3YTVmOWI2NjRmAScA7beivQOyDwZzeXN0ZW0CBADtt6K9A7MPD2FiLmFjdGlvbi5wYXN0ZSgA7beivQOyDwhhYkFjdGlvbgF4JwDtt6K9A7IPBGZvcm0CBADtt6K9A8QPB25vdGhpbmcnAO23or0Dsg8LZGVzY3JpcHRpb24CBADtt6K9A8wPK2FiIHNraWxsIHVzZWQgZm9yIGNvcHlpbmcgYW5kIHBhc3RpbmcgYm90cy4nAO23or0Dsg8Hb25QYXN0ZQIEAO23or0D+A/iB0BpZiAoIWJ1aWxkZXJWZXJzaW9uKQp7CiAgICByZXR1cm47Cn0KCmNvbnN0IE1BQ1JPUyA9IFsKICAgIHsKICAgICAgICB0ZXN0OiAvKD86W+KAnOKAnV0pL2csCiAgICAgICAgcmVwbGFjZW1lbnQ6ICh2YWwpID0+ICciJywKICAgIH0sCiAgICB7CiAgICAgICAgdGVzdDogLyg/OlvigJjigJldKS9nLAogICAgICAgIHJlcGxhY2VtZW50OiAodmFsKSA9PiAiJyIsCiAgICB9LApdOwoKbGV0IGZvcm1hdHRlZENvcHkgPSByZXBsYWNlTWFjcm9zKHRoYXQudGV4dCk7CmxldCBjb3B5Qm90ID0gSlNPTi5wYXJzZShmb3JtYXR0ZWRDb3B5KTsKbGV0IHBhc3RlZERhdGEgPSAhY29weUJvdC5zdGF0ZSA/IHtbY29weUJvdC5pZF06IGNvcHlCb3R9IDogY29weUJvdC5zdGF0ZTsKbGV0IGRpbU1vZCA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJGb2N1c0RhdGE7CgppZiAoT2JqZWN0LmtleXMocGFzdGVkRGF0YSkubGVuZ3RoID09IDEgJiYgZGltTW9kKQp7CiAgICBwYXN0ZWREYXRhW2RpbU1vZC5kaW1lbnNpb25dID0gdHJ1ZTsKICAgIHBhc3RlZERhdGFbZGltTW9kLmRpbWVuc2lvbisiWCJdID0gZGltTW9kLng7CiAgICBwYXN0ZWREYXRhW2RpbU1vZC5kaW1lbnNpb24rIlkiXSA9IGRpbU1vZC55OwoKICAgIG9zLnRvYXN0KCJib3QgYWRkZWQgdG8gaW5zdCIpOwp9CmVsc2UKewogICAgb3MudG9hc3QoImJvdHMgYWRkZWQgdG8gaW5zdCIpOwp9CgphYi5sb2coYWJSZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogcGFzdGVkIGRhdGEiKTsKCmxpbmtzLmNyZWF0ZS5hYkNyZWF0ZUJvdHMoe2JvdHM6IHBhc3RlZERhdGF9KTsKCmZ1bmN0aW9uIHJlcGxhY2VNYWNyb3ModGV4dCkgewogICAgaWYgKCF0ZXh0KSB7CiAgICAgICAgcmV0dXJuIHRleHQ7CiAgICB9CgogICAgZm9yIChsZXQgbSBvZiBNQUNST1MpIHsKICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKG0udGVzdCwgbS5yZXBsYWNlbWVudCk7CiAgICB9CgogICAgcmV0dXJuIHRleHQ7Cn0nAO23or0Dsg8IcmVtZW1iZXICBADtt6K9A9MXKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAO23or0Dsg8GY3JlYXRlAgQA7beivQP6Fyjwn5SXMzRjM2MyMTAtNWJmMS00OWNmLWIxNTEtZWUyZDA3ZjBlNjczJwDtt6K9A7IPCGFiSWdub3JlAgQA7beivQOhGAR0cnVlJwDtt6K9A7IPCW9uS2V5RG93bgIEAO23or0DphisCUBpZiAoIWJ1aWxkZXJWZXJzaW9uIHx8ICghbGlua3MucmVtZW1iZXIubGlua3MuYWJCb3RGb2N1cyAmJiAhbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzKSkKewogICAgcmV0dXJuOwp9CgppZiAodGhhdC5rZXlzID09ICJjIikKewogICAgbGV0IG1ldGFJbnB1dCA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIk1ldGEiKTsKCiAgICBpZiAoIW1ldGFJbnB1dCkKICAgIHsKICAgICAgICBtZXRhSW5wdXQgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJDb250cm9sIik7CiAgICB9CiAgICAKICAgIGlmICghbWV0YUlucHV0KQogICAgewogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBsZXQgZm9ybWF0dGVkRmlsZTsKICAgIGxldCBzdGF0ZSA9IHt9OwoKICAgIGlmIChsaW5rcy5yZW1lbWJlci5saW5rcy5hYkJvdEZvY3VzKQogICAgewogICAgICAgIGxldCBzZWxlY3RlZEJvdCA9IGxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiQm90Rm9jdXM7CgogICAgICAgIHN0YXRlW3NlbGVjdGVkQm90LmlkXSA9IHNlbGVjdGVkQm90OwoKICAgICAgICBhYi5sb2coYWJSZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogY29waWVkIGEgYm90IHRvIGNsaXBib2FyZCIpOwogICAgfQogICAgZWxzZSBpZiAobGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzKQogICAgewogICAgICAgIGxldCBzZWxlY3RlZEJvdHMgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXM7CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0ZWRCb3RzLmxlbmd0aDsgaSsrKQogICAgICAgIHsKICAgICAgICAgICAgc3RhdGVbc2VsZWN0ZWRCb3RzW2ldLmlkXSA9IHNlbGVjdGVkQm90c1tpXTsKICAgICAgICB9CgogICAgICAgIGFiLmxvZyhhYlJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiBjb3BpZWQgbXVsdGlwbGUgYm90cyB0byBjbGlwYm9hcmQiKTsKICAgIH0KCiAgICBsZXQgbmV3RmlsZSA9IHt9OwogICAgbmV3RmlsZS52ZXJzaW9uID0gMTsKICAgIG5ld0ZpbGUuc3RhdGUgPSBzdGF0ZTsKCiAgICBmb3JtYXR0ZWRGaWxlID0gSlNPTi5zdHJpbmdpZnkobmV3RmlsZSk7CgogICAgb3Muc2V0Q2xpcGJvYXJkKGZvcm1hdHRlZEZpbGUpOwoKICAgIG9zLnRvYXN0KCJib3QgY29waWVkIHRvIGNsaXBib2FyZCIpOwp9JwDtt6K9A7IPCWFiVmVyc2lvbgIEAO23or0D0yEUOS42NS4xLjE3Mjk3NzkwODU1MDAnAQRib3RzJGJkYWJkNmMwLTg5ZjktNGY3NS1iMzVjLTI2ZjRlYzUyMDdkNgEnAO23or0D6CEGc3lzdGVtAgQA7beivQPpIRBhYi5hY3Rpb24ucmVwb3J0JwDtt6K9A+ghBGZvcm0CBADtt6K9A/ohB25vdGhpbmcnAO23or0D6CEQYWJDb3JlTWVudUFjdGlvbgIEAO23or0DgiIRQG9zLnJlcG9ydEluc3QoKTsnAO23or0D6CETYWJDb3JlTWVudVNvcnRPcmRlcgIEAO23or0DlCIDMTAxJwDtt6K9A+ghDmFiQ29yZU1lbnVJY29uAgQA7beivQOYIgRmbGFnJwDtt6K9A+ghD2FiQ29yZU1lbnVMYWJlbAIEAO23or0DnSIGcmVwb3J0JwDtt6K9A+ghCGFiQWN0aW9uAgQA7beivQOkIgR0cnVlJwDtt6K9A+ghCGFiSWdub3JlAgQA7beivQOpIgR0cnVlJwDtt6K9A+ghFGFiQ29yZU1lbnVPbkdlbmVyYXRlAgQA7beivQOuIkZAaWYgKGNvbmZpZ0JvdC50YWdzLnN0YXRpY0luc3QgIT0gdW5kZWZpbmVkKQp7CiAgICBkZXN0cm95KHRoaXNCb3QpOwp9JwDtt6K9A+ghCWFiVmVyc2lvbgIEAO23or0D9SIUOS42NS4xLjE3Mjk3NzkwODU1MDAnAQRib3RzJGM2OGM1YjgyLWMwYTctNGE1YS05MTA0LTVkZDhlMzJhZTRlMgEnAO23or0DiiMGc3lzdGVtAgQA7beivQOLIxBhYi5hY3Rpb24ucG9ydGFsJwDtt6K9A4ojC2Rlc2NyaXB0aW9uAgQA7beivQOcIxRTa2lsbCB0byBvcGVuIHNoZWV0LicA7beivQOKIwhhYkFjdGlvbgIEAO23or0DsSMEdHJ1ZScA7beivQOKIwRmb3JtAgQA7beivQO2Iwdub3RoaW5nJwDtt6K9A4ojEGFiQ29yZU1lbnVBY3Rpb24CBADtt6K9A74jhB9Ac2hvdXQoImFiUG9ydGFsTWVudVJlZnJlc2giKTsKCmNvbnN0IGFjdGl2ZU1lbnUgPSBjb25maWdCb3QudGFncy5tZW51UG9ydGFsOwpjb25zdCBhY3RpdmVEaW1lbnNpb24gPSB0aGF0LmJvdC50YWdzLmN1cnJlbnREaW1lbnNpb247CmNvbnN0IGFjdGl2ZVBvcnRhbCA9IHRoYXQuYm90LnRhZ3MuY3VycmVudFBvcnRhbDsKCi8vIHRoYXQuYm90Lm1hc2tzW2FjdGl2ZU1lbnVdID0gZmFsc2U7CnRoYXQuYm90Lm1hc2tzLmFiUG9ydGFsTWVudVJlZnJlc2ggPSAiQCBjbGVhclRhZ01hc2tzKHRoaXNCb3QpOyI7CnRoYXQuYm90Lm1hc2tzLmZvcm1BZGRyZXNzID0gImFycm93X2Ryb3BfZG93biI7CnRoYXQuYm90Lm1hc2tzLm9uQ2xpY2sgPSBgQCBzaG91dCgiYWJQb3J0YWxNZW51UmVmcmVzaCIpO2A7CnRoYXQuYm90Lm1hc2tzLm1lbnVJdGVtU3R5bGUgPSB7ImJvcmRlci1yYWRpdXMiOiI4cHggOHB4IDAgMCIsICJtYXJnaW4tdG9wIjoiM3B4In07Cgpjb25zdCBwZXJtYWxpbmtVUkwgPSBjb25maWdCb3QudGFncy5wZXJtYWxpbms7CmNvbnN0IGFjdGl2ZUluc3QgPSBvcy5nZXRDdXJyZW50SW5zdCgpOwpjb25zdCBhY3RpdmVCaW9zID0gY29uZmlnQm90LnRhZ3Mub3duZXIgPyAiJm93bmVyPSIgKyBjb25maWdCb3QudGFncy5vd25lciA6IGZhbHNlOwpjb25zdCBmaXJzdEluZGV4ID0gcGVybWFsaW5rVVJMLmluZGV4T2YoIiYiKTsKY29uc3QgaW5pdGlhbFVSTCA9IHBlcm1hbGlua1VSTC5zdWJzdHJpbmcoMCwgZmlyc3RJbmRleCk7CmNvbnN0IHVwZGF0ZWRVUkwgPSBhY3RpdmVCaW9zICE9IGZhbHNlID8gaW5pdGlhbFVSTCArICImaW5zdD0iICsgYWN0aXZlSW5zdCA6IGluaXRpYWxVUkw7CmNvbnN0IG1lbnVCb3QgPSB7fTsKCm1lbnVCb3Quc3BhY2UgPSAidGVtcExvY2FsIjsKbWVudUJvdC5kaW1lbnNpb24gPSBhY3RpdmVNZW51OwptZW51Qm90W2FjdGl2ZU1lbnVdID0gdHJ1ZTsKbWVudUJvdC5hYlBvcnRhbE1lbnVSZWZyZXNoID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwptZW51Qm90LmFiTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7Cm1lbnVCb3Qub25LZXlEb3duID0gYEAgaWYodGhhdC5rZXlzID09ICJTaGlmdCIpe21hc2tzLmxhYmVsID0gdGFncy5sYWJlbCArICIgaW4gbmV3IHRhYiI7fWA7Cm1lbnVCb3Qub25LZXlVcCA9IGBAIGlmKHRoYXQua2V5cyA9PSAiU2hpZnQiKXttYXNrcy5sYWJlbCA9IG51bGw7fWA7Cm1lbnVCb3QubWFuYWdlciA9IGdldExpbmsodGhhdC5ib3QpOwptZW51Qm90LnNraWxsQm90ID0gZ2V0TGluayh0aGlzQm90KTsKbWVudUJvdC50YXJnZXRVUkwgPSB1cGRhdGVkVVJMOwoKbWVudUJvdC5sYWJlbCA9ICJtYXAgcG9ydGFsIjsKbWVudUJvdC5mb3JtQWRkcmVzcyA9ICJwdWJsaWMiOwptZW51Qm90Lm9uQ2xpY2sgPSBgQCBzaG91dCgiYWJQb3J0YWxNZW51UmVmcmVzaCIpOwoKY29uc3Qgc3RhdGUgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJTaGlmdCIpOwoKaWYoc3RhdGUpCnsKICAgIG9zLm9wZW5VUkwodGFncy50YXJnZXRVUkwgKyAiJm1hcFBvcnRhbD0ke2FjdGl2ZURpbWVuc2lvbiA9PSAiYmx1ZXByaW50IiA/ICJob21lIiA6IGFjdGl2ZURpbWVuc2lvbn0iKTsKfQplbHNlCnsKICAgIGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA9ICIke2FjdGl2ZURpbWVuc2lvbiA9PSAiYmx1ZXByaW50IiA/ICJob21lIiA6IGFjdGl2ZURpbWVuc2lvbn0iOzsKfWA7Cm1lbnVCb3RbYWN0aXZlTWVudSArICJTb3J0T3JkZXIiXSA9IDAuMjsKbWVudUJvdC5tZW51SXRlbVN0eWxlID0geyJib3JkZXItcmFkaXVzIjoiMCIsICJtYXJnaW4tdG9wIjoiMHB4In07CgppZiAoYWN0aXZlUG9ydGFsICE9ICJtYXAiKQp7CiAgICAvL21hcCBwb3J0YWwgYnV0dG9uCiAgICBsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihtZW51Qm90KTsKfQoKbWVudUJvdC5sYWJlbCA9ICJncmlkIHBvcnRhbCI7Cm1lbnVCb3QuZm9ybUFkZHJlc3MgPSAiY3ViZSI7Cm1lbnVCb3Qub25DbGljayA9IGBAIHNob3V0KCJhYlBvcnRhbE1lbnVSZWZyZXNoIik7IAoKY29uc3Qgc3RhdGUgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJTaGlmdCIpOwoKaWYoc3RhdGUpCnsKICAgIG9zLm9wZW5VUkwodGFncy50YXJnZXRVUkwgKyAiJmdyaWRQb3J0YWw9JHthY3RpdmVEaW1lbnNpb24gPT0gImJsdWVwcmludCIgPyAiaG9tZSIgOiBhY3RpdmVEaW1lbnNpb259Iik7Cn0gCmVsc2UKewogICAgY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbCA9ICIke2FjdGl2ZURpbWVuc2lvbiA9PSAiYmx1ZXByaW50IiA/ICJob21lIiA6IGFjdGl2ZURpbWVuc2lvbn0iOyBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgPSBudWxsOwp9YDsKbWVudUJvdFthY3RpdmVNZW51ICsgIlNvcnRPcmRlciJdID0gMC4yOwoKaWYgKGFjdGl2ZVBvcnRhbCAhPSAiZ3JpZCIgfHwgYWN0aXZlRGltZW5zaW9uID09ICJibHVlcHJpbnQiKQp7CiAgICAvL2dyaWQgcG9ydGFsIGJ1dHRvbgogICAgbGlua3MubWVudS5hYkNyZWF0ZU1lbnVCdXR0b24obWVudUJvdCk7Cn0KCm1lbnVCb3QubGFiZWwgPSAiYmx1ZXByaW50IHBvcnRhbCI7Cm1lbnVCb3QuZm9ybUFkZHJlc3MgPSAiYXJjaGl0ZWN0dXJlIjsKbWVudUJvdC5vbkNsaWNrID0gYEAgc2hvdXQoImFiUG9ydGFsTWVudVJlZnJlc2giKTsgCgpjb25zdCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7CgppZihzdGF0ZSkKewogICAgb3Mub3BlblVSTCh0YWdzLnRhcmdldFVSTCArICImZ3JpZFBvcnRhbD1ibHVlcHJpbnQiKTsKfSAKZWxzZQp7CiAgICBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsID0gImJsdWVwcmludCI7IGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA9IG51bGw7Cn0KCmxpbmtzLnNraWxsQm90LmFiQmx1ZXByaW50KCk7YDsKbWVudUJvdFthY3RpdmVNZW51ICsgIlNvcnRPcmRlciJdID0gMC4zOwoKaWYgKGFjdGl2ZURpbWVuc2lvbiAhPSAiYmx1ZXByaW50IikKewogICAgLy9ibHVlcHJpbnQgcG9ydGFsIGJ1dHRvbgogICAgbGlua3MubWVudS5hYkNyZWF0ZU1lbnVCdXR0b24obWVudUJvdCk7Cn0KCm1lbnVCb3QubGFiZWwgPSAic2hlZXQgcG9ydGFsIjsKbWVudUJvdC5mb3JtQWRkcmVzcyA9ICJ0YWJsZV92aWV3IjsKbWVudUJvdC5vbkNsaWNrID0gYEAgc2hvdXQoImFiUG9ydGFsTWVudVJlZnJlc2giKTsKCmNvbnN0IHN0YXRlID0gb3MuZ2V0SW5wdXRTdGF0ZSgia2V5Ym9hcmQiLCAiU2hpZnQiKTsKCmlmKHN0YXRlKQp7CiAgICBvcy5vcGVuVVJMKHRhZ3MudGFyZ2V0VVJMICsgIiZzaGVldFBvcnRhbD0ke2FjdGl2ZURpbWVuc2lvbn0iKTsKfSAKZWxzZQp7IAogICAgY29uZmlnQm90LnRhZ3Muc2hlZXRQb3J0YWwgPSAiJHthY3RpdmVEaW1lbnNpb259IjsKfWA7Cm1lbnVCb3RbYWN0aXZlTWVudSArICJTb3J0T3JkZXIiXSA9IDAuMTsKCi8vc2hlZXQgcG9ydGFsIGJ1dHRvbgpsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihtZW51Qm90KTsKCm1lbnVCb3QubGFiZWwgPSAic3lzdGVtIHBvcnRhbCI7Cm1lbnVCb3QuZm9ybUFkZHJlc3MgPSAic2V0dGluZ3NfYXBwbGljYXRpb25zIjsKbWVudUJvdC5vbkNsaWNrID0gYEAgc2hvdXQoImFiUG9ydGFsTWVudVJlZnJlc2giKTsKCmNvbnN0IHN0YXRlID0gb3MuZ2V0SW5wdXRTdGF0ZSgia2V5Ym9hcmQiLCAiU2hpZnQiKTsKCmlmKHN0YXRlKQp7CiAgICBvcy5vcGVuVVJMKHRhZ3MudGFyZ2V0VVJMICsgIiZzeXN0ZW1Qb3J0YWw9dHJ1ZSIpOwp9IAplbHNlCnsgCiAgICBjb25maWdCb3QudGFncy5zeXN0ZW1Qb3J0YWwgPSB0cnVlOwp9YDsKbWVudUJvdFthY3RpdmVNZW51ICsgIlNvcnRPcmRlciJdID0gMC40OwptZW51Qm90Lm1lbnVJdGVtU3R5bGUgPSB7ImJvcmRlci1yYWRpdXMiOiIwIDAgOHB4IDhweCJ9OwoKLy9zeXN0ZW0gcG9ydGFsIGJ1dHRvbgpsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihtZW51Qm90KTsnAO23or0DiiMIcmVtZW1iZXICBADtt6K9A8NCKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAO23or0DiiMPYWJDb3JlTWVudUxhYmVsAgQA7beivQPqQhBjdXJyZW50IHBvcnRhbDogJwDtt6K9A4ojD2FiQm90TWVudUFjdGlvbgIEAO23or0D+0LxAkBjb25zdCBjdXJyZW50SW5zdCA9IG9zLmdldEN1cnJlbnRJbnN0KCk7CmNvbnN0IGN1cnJlbnREaW0gPSBsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90LnRhZ3MubGluZVRvOwpjb25zdCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7CgppZiAoc3RhdGUpIAp7CiAgICBvcy5vcGVuVVJMKGNvbmZpZ0JvdC50YWdzLnBlcm1hbGluayArIGAmc2hlZXRQb3J0YWw9JHtjdXJyZW50RGltfWApOwp9CmVsc2UKewogICAgY29uZmlnQm90LnRhZ3Muc2hlZXRQb3J0YWwgPSBjdXJyZW50RGltOwp9CgphYi5sb2coYWJSZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogb3BlbmVkIGJvdCBzaGVldCIpOycA7beivQOKIw5hYkJvdE1lbnVMYWJlbAIEAO23or0D7UUOb3BlbiBib3Qgc2hlZXQnAO23or0DiiMNbWFuaWZlc3RhdGlvbgIEAO23or0D/EUo8J+Ul2RjYTVkOTg3LWM0ZDgtNDZlNC1iNjBjLWRhYTdiMmY0ZGRhZCcA7beivQOKIw1hYkJvdE1lbnVJY29uAgQA7beivQOjRgp0YWJsZV92aWV3JwDtt6K9A4ojDmFiQ29yZU1lbnVJY29uAgQA7beivQOuRgthcnJvd19yaWdodCcA7beivQOKIxJhYkJvdE1lbnVTb3J0T3JkZXICBADtt6K9A7pGATEnAO23or0DiiMIYWJJZ25vcmUCBADtt6K9A7xGBHRydWUnAO23or0DiiMXYWJNdWx0aXBsZUJvdE1lbnVBY3Rpb24CBADtt6K9A8FGlARAY29uc3QgY3VycmVudEluc3QgPSBvcy5nZXRDdXJyZW50SW5zdCgpOwpjb25zdCBjdXJyZW50RGltID0gImFiTXVsdGlwbGVTZWxlY3QiOwoKY29uZmlnQm90LnRhZ3Muc2hlZXRQb3J0YWwgPSBjdXJyZW50RGltOwoKc2V0VGFnTWFzayhsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXMsIGN1cnJlbnREaW0sIHRydWUsICJ0ZW1wTG9jYWwiKTsKCm1hc2tzLmN1cnJlbnRTaGVldEJvdHMgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiTXVsdGlwbGVCb3RGb2N1czsKbWFza3Mub25Qb3J0YWxDaGFuZ2VkID0gYEAgaWYgKHRoYXQuZGltZW5zaW9uICE9ICJhYk11bHRpcGxlU2VsZWN0IiAmJiB0aGF0LnBvcnRhbCA9PSAic2hlZXRQb3J0YWwiKQp7CiAgICBjbGVhclRhZ01hc2tzKGxpbmtzLmN1cnJlbnRTaGVldEJvdHMpOwoKICAgIGNsZWFyVGFnTWFza3ModGhpc0JvdCk7Cn0gYDsKCmFiLmxvZyhhYlJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiBvcGVuZWQgbXVsdGlwbGUgc2VsZWN0IHNoZWV0Iik7JwDtt6K9A4ojFmFiTXVsdGlwbGVCb3RNZW51TGFiZWwCBADtt6K9A9ZKGm9wZW4gbXVsdGlwbGUgc2VsZWN0IHNoZWV0JwDtt6K9A4ojFWFiTXVsdGlwbGVCb3RNZW51SWNvbgIEAO23or0D8UoKdGFibGVfdmlldycA7beivQOKIxRhYkNvcmVNZW51T25HZW5lcmF0ZQIEAO23or0D/EqqAkBjb25zdCBjdXJyZW50RGltID0gbGlua3MucmVtZW1iZXIudGFncy5hYkFjdGl2ZURpbWVuc2lvbjsKY29uc3QgY3VycmVudFBvcnRhbCA9IGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA/ICJtYXAiIDogY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbCA9PSAiYmx1ZXByaW50IiA/ICJibHVlcHJpbnQiIDoiZ3JpZCI7Cgp0YWdzLmxhYmVsID0gYG1vZGU6ICR7Y3VycmVudFBvcnRhbH0gcG9ydGFsYDsKdGFncy5jdXJyZW50RGltZW5zaW9uID0gY3VycmVudERpbTsKdGFncy5jdXJyZW50UG9ydGFsID0gY3VycmVudFBvcnRhbDsnAO23or0DiiMTYWJCb3RNZW51T25HZW5lcmF0ZQIEAO23or0Dp02YAkBsZXQgc2VsZWN0ZWRCb3QgPSBsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90LnRhZ3MubGluZVRvOwoKdGFncy5sYWJlbCA9ICJzaGVldFBvcnRhbD0iICsgc2VsZWN0ZWRCb3Quc3Vic3RyaW5nKDAsIDQpOwoKdGFncy5vbktleURvd24gPSBgQCBpZih0aGF0LmtleXMgPT0gIlNoaWZ0Iil7bWFza3MubGFiZWwgPSB0YWdzLmxhYmVsICsgIiBpbiBuZXcgdGFiIjt9YDsKdGFncy5vbktleVVwID0gYEAgaWYodGhhdC5rZXlzID09ICJTaGlmdCIpe21hc2tzLmxhYmVsID0gbnVsbDt9YDsnAO23or0DiiMaYWJNdWx0aXBsZUJvdE1lbnVTb3J0T3JkZXICBADtt6K9A8BPATAnAO23or0DiiMEbWVudQIEAO23or0Dwk8o8J+Ul2IzMGM2YzVkLWE0ZjctNDI2Ni1iYTM4LTM5M2RjOTVlMWVjYicA7beivQOKIwlhYlZlcnNpb24CBADtt6K9A+lPFDkuNjUuMS4xNzI5Nzc5MDg1NTAwJwDtt6K9A4ojC2FiQmx1ZXByaW50AgQA7beivQP+T/sDQGNvbnN0IGJhY2tncm91bmRDb2xvciA9IGxpbmtzLnJlbWVtYmVyPy50YWdzLmFiQmx1ZXByaW50Q29sb3IgPz8gIiMxNzg1QjUiOwoKaWYgKGJhY2tncm91bmRDb2xvciA9PSBncmlkUG9ydGFsQm90Lm1hc2tzLnBvcnRhbENvbG9yKQp7CiAgICByZXR1cm47Cn0KCmdyaWRQb3J0YWxCb3QubWFza3MucG9ydGFsQ29sb3IgPSBiYWNrZ3JvdW5kQ29sb3I7CgptYXNrcy5vblBvcnRhbENoYW5nZWQgPSBgQCBpZiAodGhhdC5wb3J0YWwgPT0gImdyaWRQb3J0YWwiICYmIHRoYXQuZGltZW5zaW9uICE9ICJibHVlcHJpbnQiKXsKICAgIC8vIGxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiQmFzZUNvbG9yID0gbnVsbDsKICAgIC8vIGxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiQmFzZVN0cm9rZUNvbG9yID0gbnVsbDsKCiAgICBncmlkUG9ydGFsQm90Lm1hc2tzLnBvcnRhbENvbG9yID0gbnVsbDsKCiAgICBtYXNrcy5vblBvcnRhbENoYW5nZWQgPSBudWxsOwp9YDsKCnNob3V0KCJhYk1lbnVSZWZyZXNoIik7JwDtt6K9A4ojC29uQW55Q3JlYXRlAgQA7beivQP6U3ZAaWYgKHRoYXQuYm90LnRhZ3MuYmx1ZXByaW50KQp7CiAgICB0aGF0LmJvdC50YWdzLnN0cm9rZUNvbG9yID0gIiNmZmZmZmYiOwogICAgdGhhdC5ib3QudGFncy5sYWJlbENvbG9yID0gIiNmZmZmZmYiOwp9JwDtt6K9A4ojD29uUG9ydGFsQ2hhbmdlZAIEAO23or0D8VRhQGlmICh0aGF0LnBvcnRhbCA9PSAiZ3JpZFBvcnRhbCIgJiYgdGhhdC5kaW1lbnNpb24gPT0gImJsdWVwcmludCIpCnsKICAgIHRoaXNCb3QuYWJCbHVlcHJpbnQoKTsKfScBBGJvdHMkZWM4NWMxZDYtOWYxYS00MGQ0LTgyZTEtNWJkNjgwMzQ5YzI3AScA7beivQPTVQZzeXN0ZW0CBADtt6K9A9RVDWFiLmFjdGlvbi5hc2snAO23or0D01UEZm9ybQIEAO23or0D4lUHbm90aGluZycA7beivQPTVQZhc2tHUFQCBADtt6K9A+pVhhRAaWYgKCF0YWdzLmdwdEFjdGl2ZSB8fCBhdXRoQm90LnRhZ3MucHJpdmFjeUZlYXR1cmVzLmFsbG93QUkgPT0gZmFsc2UpCnsKICAgIGNvbnN0IGFpTWVzc2FnZSA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWlfcmVqZWN0aW9uX21lc3NhZ2UgPz8gIkFJIG5vdCBhdXRob3JpemVkIGZvciB0aGlzIGFjY291bnQiOwoKICAgIG9zLnRvYXN0KGFpTWVzc2FnZSwgNyk7CgogICAgYWIubG9nKGFiUmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICAiOiAiICsgYWlNZXNzYWdlKTsKICAgIAogICAgcmV0dXJuOwp9IAoKLy8gY29uc29sZS5sb2coIkFTSyIsIHRoYXQpOwoKbGV0IGlucXVpcnkgPSB0aGF0LmlucXVpcnkgPz8gdGhhdDsKCmNvbnN0IHByb21wdCA9ICF0aGF0LnByb21wdCA/IHRhZ3MucHJvbXB0X2NvcmUgOiB0YWdzWyJwcm9tcHRfIiArIHRoYXQucHJvbXB0XTsKCmFiLmxvZyhhYlJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiB0aGlua2luZyBhYm91dCAiICsgaW5xdWlyeSk7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQm90Q2hhdCh7bWVzc2FnZTogInRoaW5raW5nIGFib3V0ICIgKyBpbnF1aXJ5fSk7CgppZiAodGhhdC5wcm9tcHQgPT0gImdyaWQiKQp7CiAgICBpbnF1aXJ5ID0gaW5xdWlyeSArIGAuIEJvdCBtdXN0IGluY2x1ZGUgeyR7dGhhdC5kYXRhLmRpbWVuc2lvbn06IHRydWUsICR7dGhhdC5kYXRhLmRpbWVuc2lvbn1YOiAke3RoYXQuZGF0YS5kaW1lbnNpb25YfSwgJHt0aGF0LmRhdGEuZGltZW5zaW9ufVk6JHt0aGF0LmRhdGEuZGltZW5zaW9uWX19LmAKfQplbHNlIGlmICh0aGF0LnByb21wdCA9PSAiYm90IikKewogICAgaW5xdWlyeSA9IGlucXVpcnkgKyBgLiBCb3QgdG8gYmUgbW9kaWZpZWQgaGFzIHRoZSBpZCBvZjogYCArIHRoYXQuZGF0YS5ib3QuaWQ7Cn0KZWxzZSBpZiAodGhhdC5wcm9tcHQgPT0gIm11bHRpcGxlQm90IikKewogICAgaW5xdWlyeSA9IGlucXVpcnkgKyBgLiBCb3RzIHRvIGJlIG1vZGlmaWVkIGhhdmUgdGhlIGZvbGxvd2luZyB0aGUgaWRzOiBgICsgdGhhdC5kYXRhLmJvdHM7Cn0KZWxzZSBpZiAodGhhdC5wcm9tcHQgPT0gImNvcmUiKQp7CiAgICAvL0NIRUNLIElGIElUIElTIENPTlZFUlNBVElPTkFMLCBhbmQgaWYgaXQgaXMgY2hhbmdlIFByb21wdAogICAgY29uc3QgY29udmVyc2F0aW9uUHJvbXB0ID0gdGFncy5jb252ZXJzYXRpb25Qcm9tcHQgKyBpbnF1aXJ5OwogICAgY29uc3QgYnVpbGRDaGVjayA9IGF3YWl0IGFpLmNoYXQoY29udmVyc2F0aW9uUHJvbXB0KTsKCiAgICBpZiAoYnVpbGRDaGVjayAhPSAidHJ1ZSIpCiAgICB7CiAgICAgICAgY29uc3QgY2hhdHRpbmdQcm9tcHQgPSBgWW91IGFyZSBhbiBBSSBidWlsZGVyIGFnZW50IGNhbGxlZCAke2FiUmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eX0gbWVhbnQgdG8gaGVscCBwZW9wbGUgYnVpbGQgYW5kIGxlYXJuIGluc2lkZSBvZiBjYXN1YWxPUyAoYSB3ZWIgYmFzZWQgamF2YXNjcmlwdCBhbmQgdHlwZXNjcmlwdCBlbnZpcm9ubWVudCkuCiAgICAgICAgCiAgICAgICAgUGxlYXNlIGJlIGtpbmQgY291cnRlb3VzIGFuZCBmcmllbmRseSB3aGlsZSB5b3UgYW5zd2VyIHRoZSBmb2xsb3dpbmcgaW5xdWlyeSB0byB0aGUgYmVzdCBvZiB5b3VyIGFiaWxpdHkuCiAgICAgICAgCiAgICAgICAgUlVMRVM6CiAgICAgICAgMS4gQWx3YXlzIGJlIHdhcm0gYW5kIGZyaWVuZGx5LgogICAgICAgIDIuIEJlIGFzIGhlbHBmdWwgYXMgeW91IGNhbiB3aXRob3V0IGludmVudGluZyBpZGVhcy4KICAgICAgICAzLiBCZSBlbmNvdXJhZ2luZy4KICAgICAgICAKICAgICAgICBJTlFVSVJZOiBgICsgaW5xdWlyeTsKICAgICAgICBjb25zdCBjaGF0dGluZyA9IGF3YWl0IGFpLmNoYXQoY2hhdHRpbmdQcm9tcHQpOwoKICAgICAgICBhYi5sb2coYWJSZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogIiArIGNoYXR0aW5nKTsKCiAgICAgICAgbGlua3MubWFuaWZlc3RhdGlvbi5hYkJvdENoYXQoe21lc3NhZ2U6IGNoYXR0aW5nLCBkdXJhdGlvbjogN30pOwoKICAgICAgICBsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soKTsKCiAgICAgICAgcmV0dXJuOwogICAgfQp9Cgpjb25zdCBhbnN3ZXIgPSBhd2FpdCB0aGlzQm90LnN1Ym1pdFJlcXVlc3RHUFQoe2lucXVpcnk6IGlucXVpcnksIHByb21wdDogcHJvbXB0fSk7CgpsZXQgbmV3QW5zd2VyID0gYW5zd2VyOwoKaWYgKGFuc3dlci5pbmRleE9mKCJgYGAiKSAhPSAtMSkKewogICAgbmV3QW5zd2VyID0gYW5zd2VyLnN1YnN0cmluZyhhbnN3ZXIuaW5kZXhPZigiYGBgIiksIGFuc3dlci5sYXN0SW5kZXhPZigiYGBgIikpOwoKICAgIG5ld0Fuc3dlciA9IG5ld0Fuc3dlci5yZXBsYWNlQWxsKCdqYXZhc2NyaXB0JywgIiIpOwoKICAgIG5ld0Fuc3dlciA9IG5ld0Fuc3dlci5yZXBsYWNlQWxsKCJgYGAiLCAiIik7Cn0KCmFiLmxvZyhhYlJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiAiICsgbmV3QW5zd2VyKTsKCm9zLnJ1bihuZXdBbnN3ZXIpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7CgpyZXR1cm47JwDtt6K9A9NVCWdwdEFjdGl2ZQIEAO23or0D8WkFZmFsc2UnAO23or0D01UQc3VibWl0UmVxdWVzdEdQVAIEAO23or0D92mTBkBsZXQgc3lzdGVtUHJvbXB0ID0gdGhhdC5wcm9tcHQgPyB0aGF0LnByb21wdCA6IHRhZ3MucHJvbXB0X2NvcmU7CgpzeXN0ZW1Qcm9tcHQgPSBzeXN0ZW1Qcm9tcHQgKyB0aGF0LmlucXVpcnk7CgppZiAoYXV0aEJvdC50YWdzLnByaXZhY3lGZWF0dXJlcy5hbGxvd0FJID09IGZhbHNlKQp7CiAgICBvcy50b2FzdCgiQUkgbm90IGF1dGhvcml6ZWQgb24gdGhpcyBhY2NvdW50Iik7CgogICAgcmV0dXJuOwp9CgpsZXQgY3VycmVudEV4cGVyaWVuY2VCb3RzID0gZ2V0Qm90cyhieU1vZCh7c3BhY2U6ICJzaGFyZWQiLCBhYklnbm9yZTogbnVsbH0pKTsKCmlmIChjdXJyZW50RXhwZXJpZW5jZUJvdHMubGVuZ3RoID4gMCkKewogICAgc3lzdGVtUHJvbXB0ID0gc3lzdGVtUHJvbXB0ICsgIiBUaGVzZSBhcmUgdGhlIGJvdHMgdGhhdCBjdXJyZW50bHkgZXhpc3QgaW4gdGhlIGV4cGVyaWVuY2U6ICIgKyBjdXJyZW50RXhwZXJpZW5jZUJvdHM7Cn0KCmxldCBuZXdTdGF0dXNCYXIgPSBhd2FpdCBsaW5rcy5pbnB1dC5hYlByb2dyZXNzQmFyKGBhc2tpbmcgJHtsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5fWApOwoKY29uc3QgYWlSZXNwID0gYXdhaXQgYWkuY2hhdChzeXN0ZW1Qcm9tcHQsIHsKICAgIG1vZGVsOiB0aGF0Lm1vZGVsID8/ICJncHQtNG8iLAogICAgdGVtcGVyYXR1cmU6IDAsCiAgICB0b3BQOiAxLAogICAgcHJlc2VuY2VQZW5hbHR5OiAwLjYsCiAgICBmcmVxdWVuY3lQZW5hbHR5OiAwCn0pOwoKZGVzdHJveShuZXdTdGF0dXNCYXIpOwoKcmV0dXJuIGFpUmVzcDsnAO23or0D01UGcHJvbXB0AgQA7beivQOLcKAiVGhlIGZvbGxvd2luZyBpcyBhIGNvbnZlcnNhdGlvbiB3aXRoIGFiLiBhYiBpcyBhIGhlbHBmdWwsIGNsZXZlciwgYW5kIGNhcGFibGUgQUkuIGFiIHdpbGwgcmVzcG9uZCB3aXRoIHRoZSBjb3JyZWN0IGphdmFzY3JpcHQgaW1wbGVtZW50YXRpb24gKGNvZGUpIG9mIHRoZSByZXF1ZXN0ZWQgYWN0aW9uLgoKSGVyZSBpcyBhIGJyaWVmIGxpc3Qgb2YgdGhpbmdzIGFiIGNhbiBkbzoKLSBDcmVhdGUgYm90cwoKQm90cyBhcmUgYSBjb2xsZWN0aW9uIG9mIHRhZ3MsIGFuZCB0aGV5IGNhbiBiZSBjcmVhdGVkIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbi4KVGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIGlzIHVzZWQgdG8gY3JlYXRlIG9uZSBvciBtdWx0aXBsZSBib3RzIG9iamVjdHMuCmNyZWF0ZSgpIHJldHVybnMgYSBib3Qgb2JqZWN0OyBpdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHN0b3JlZCBpbiBhIHZhcmlhYmxlIG9yIGNvbnN0LiAKCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIHJlZCBib3QgaW4gdGhlIGhvbWUgZGltZW5zaW9uOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBjb2xvcjogInJlZCIsCiAgICBmb3JtOiAiY3ViZSIKfSk7CmBgYAoKQXMgeW91IGNhbiBzZWUsIHRoZSBleGFtcGxlIGFib3ZlIGNyZWF0ZXMgYSBib3Qgd2l0aCB0aGUgYGhvbWVgIHRhZyBzZXQgdG8gYHRydWVgIGFuZCB0aGUgYGNvbG9yYCB0YWcgc2V0IHRvIGByZWRgLgpVbmxlc3Mgc3BlY2lmaWVkIG90aGVyd2lzZSwgYWIgc2hvdWxkIGNyZWF0ZSBib3RzIHdpdGggdGhlIGBob21lYCB0YWcgc2V0IHRvIGB0cnVlYC4KCkRpbWVuc2lvbnMgYXJlIHRhZ3Mgd2hpY2ggZW5kIHVwIGJlaW5nIHZpc3VhbGl6ZWQgaW4gM0Qgc3BhY2UuIEluIGFkZGl0aW9uIHRvIGJlaW5nIGEgdGFnLCBgaG9tZWAgaXMgYWxzbyBhIGRpbWVuc2lvbi4KWW91IGNhbiBjb250cm9sIHRoZSBwb3NpdGlvbiB0aGF0IGEgYm90IGlzIHJlbmRlcmVkIGF0IGJ5IHVzaW5nIHRoZSBge2RpbWVuc2lvbn1Qb3NpdGlvbmAgdGFnLCB3aGVyZSBge2RpbWVuc2lvbn1gIGlzIHJlcGxhY2VkIHdpdGggdGhlIG5hbWUgb2YgdGhlIGRpbWVuc2lvbi4KSGVyZSBpcyBhbiBleGFtcGxlIG9mIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbiB0byBtYWtlIGEgYm90IGF0IHBvc2l0aW9uICgzLCAyKSBpbiB0aGUgaG9tZSBkaW1lbnNpb246CmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIGhvbWVQb3NpdGlvbjogJ+Keoe+4jzMsMScKfSk7CmBgYAoKTGlzdGVuZXJzIGFyZSB0YWdzIHdoaWNoIGNvbnRhaW4gSmF2YVNjcmlwdCBhbmQgcmVzcG9uZCB0byBjZXJ0YWluIGV2ZW50cy4gVGhleSB3b3JrIGxpa2Ugbm9ybWFsIHRhZ3MsIGV4Y2VwdCB0aGV5IG5lZWQgdG8gaGF2ZSBhIGBAYCBzeW1ib2wgYXQgdGhlIHN0YXJ0IG9mIHRoZSB0YWcgdmFsdWUuCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIGJvdCB3aXRoIGEgYG9uQ2xpY2tgIGxpc3RlbmVyOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBvbkNsaWNrOiBgQG9zLnRvYXN0KCJIZWxsbywgd29ybGQhIik7YAp9KTsKYGBgCgpGb3IgZXhhbXBsZSBpZiBhc2tlZCBmb3IgYSBwcm9jZWR1cmFsIGZvcmVzdCB0aGUgY29kZSByZXR1cm5lZCB3b3VsZCBiZSBzb21ldGhpbmcgbGlrZSB0aGlzOgoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgb25DbGljazogYEB7CiAgICAgICAgY29uc3QgZWxlbWVudHMgPSBbJ3RyZWUnLCAnYnVzaCcsICdmbG93ZXInLCAncm9jaycsICdyYWJiaXQnLCAnZm94JywgJ3dhdGVyJ107CiAgICAgICAgY29uc3QgY29sb3JzID0gWydncmVlbicsICdkYXJrZ3JlZW4nLCAnZ29sZCcsICdncmF5JywgJ2Jyb3duJywgJ29yYW5nZScsICdibHVlJ107CiAgICAgICAgY29uc3QgaW50ZXJhY3Rpb25Tb3VuZHMgPSBbJ3dpbmQgaW4gdGhlIGJyYW5jaGVzJywgJ3J1c3RsaW5nIGxlYXZlcycsICdjcmlja2V0IGNoaXJwaW5nJywgJ3JhaW4gcGF0dGVyaW5nJywgJ3RodW1waW5nJywgJ3lpcHBpbmcnLCAnc3BsYXNoaW5nJ107CiAgICAgICAgY29uc3Qgc2NhbGVzWCA9IFswLjksIDEuMiwgMC4xLCAxLCAwLjI1LCAwLjMsIDFdOwogICAgICAgIGNvbnN0IHNjYWxlc1kgPSBbMC45LCAxLjIsIDAuMSwgMSwgMC40LCAwLjcsIDFdOwogICAgICAgIGNvbnN0IHNjYWxlc1ogPSBbMywgMC43NSwgMC4yLCAwLjUsIDAuNSwgMC42LCAwLjAxXTsKICAgICAgICAKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDsgaSsrKSAKICAgICAgICB7CiAgICAgICAgICAgIGxldCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGVsZW1lbnRzLmxlbmd0aCk7CiAgICAgICAgICAgIGxldCBwb3NpdGlvblg7CiAgICAgICAgICAgIGxldCBwb3NpdGlvblk7CiAgICAgICAgCiAgICAgICAgICAgaWYgKGVsZW1lbnRzW3JhbmRvbUluZGV4XSA9PSAnd2F0ZXInKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoZ2V0Qm90KCdsYWJlbCcsICd3YXRlcicpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGxldCBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnMgPSBnZXRCb3RzKCdsYWJlbCcsICd3YXRlcicpOwogICAgICAgICAgICAgICAgICAgIGxldCBhY3RpdmVXYXRlckJvdCA9IHBvc3NpYmxlV2F0ZXJDb25uZWN0aW9uc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnMubGVuZ3RoKV07CiAgICAgICAgICAgICAgICAgICAgbGV0IGNvaW5GbGlwID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgwLDEpKTsKICAgICAgICAgICAgICAgICAgICBsZXQgcmFuZG9tRGlyZWN0aW9uID0gTWF0aC5yYW5kb20oKSA8IDAuNSA/IC0xIDogMTsKICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiAoY29pbkZsaXApCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVYOwogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVZICsgcmFuZG9tRGlyZWN0aW9uOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVYICsgcmFuZG9tRGlyZWN0aW9uOwogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVZOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgICBjcmVhdGUoewogICAgICAgICAgICAgICAgaG9tZTogdHJ1ZSwKICAgICAgICAgICAgICAgIGhvbWVQb3NpdGlvbjogJ+Keoe+4jycgKyBwb3NpdGlvblggKyAnLCcgKyBwb3NpdGlvblksCiAgICAgICAgICAgICAgICB0aXBMYWJlbDogZWxlbWVudHNbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgb25Qb2ludGVyRW50ZXI6ICJAIG9zLnRpcCh0YWdzLnRpcExhYmVsKSI7CiAgICAgICAgICAgICAgICBjb2xvcjogY29sb3JzW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWDogc2NhbGVzWFtyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVk6IHNjYWxlc1lbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVaOiBzY2FsZXNaW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIG9uQ2xpY2s6ICJAIG9zLnRpcCgnWW91IGhlYXIgIiArIGludGVyYWN0aW9uU291bmRzW3JhbmRvbUluZGV4XSArICInKTsiCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH1gCn0pOwpgYGAKClBsZWFzZSByZXR1cm4gb25seSB0aGUgZnVuY3Rpb24gd2l0aCB0aGUgY29kZSBhcyBhIHJlc3BvbnNlLicA7beivQPTVQhyZW1lbWJlcgIEAO23or0DpJIBKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAO23or0D01UQYWJDb3JlTWVudUFjdGlvbgIEAO23or0Dy5IB7RdAY29uc3QgaW5xdWlyeSA9IHRoYXQubWVzc2FnZSA/PyB0aGF0Owpjb25zdCBiYXNlSW5xdWlyeSA9IGlucXVpcnk7CmNvbnN0IG1lbnUgPSB0aGF0Lm1lbnUgPz8gImNvcmUiOwpjb25zdCBzcGFjZUNoZWNrID0gaW5xdWlyeS5pbmRleE9mKCIgIik7CmNvbnN0IG1lbnVCb3RzID0gZ2V0Qm90cyhjb25maWdCb3QudGFncy5tZW51UG9ydGFsLCB0cnVlKTsKCndoaXNwZXIobWVudUJvdHMsICJhYk1lbnVSZWZyZXNoIik7CgphYi5sb2coInVzZXI6ICIgKyBpbnF1aXJ5KTsKCmlmICghY29uZmlnQm90LnRhZ3MudGFnUG9ydGFsICYmIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJBd2FrZVN0YXRlICYmIHRoYXQubWVzc2FnZSAhPSAiLmxvZyIpCnsKICAgIHNob3V0KCJzaG93Q29uc29sZSIpOwp9CgppZiAoc3BhY2VDaGVjayA9PSAtMSkKewogICAgY29uc3QgcXVvYXRhdGlvbkNoZWNrMSA9IGJhc2VJbnF1aXJ5LmluZGV4T2YoJyInKTsKICAgIGNvbnN0IHF1b2F0YXRpb25DaGVjazIgPSBiYXNlSW5xdWlyeS5sYXN0SW5kZXhPZignIicpOwogICAgY29uc3QgZGlyZWN0U2VhcmNoID0gcXVvYXRhdGlvbkNoZWNrMSA9PSAwICYmIHF1b2F0YXRpb25DaGVjazIgPT0gYmFzZUlucXVpcnkubGVuZ3RoIC0xOwogICAgY29uc3QgYXNrSm9pbklEID0gaW5xdWlyeS5yZXBsYWNlQWxsKCItIiwgIiIpOwoKICAgIGxldCBhc2sgPSAhZGlyZWN0U2VhcmNoID8gYXdhaXQgbGlua3Muc2VhcmNoLm9uTG9va3VwQXNrSUQoe2Fza0lEOiBhc2tKb2luSUR9KSA6IGZhbHNlOwogICAgCiAgICBpZiAoYXNrPy5zdWNjZXNzICYmIGFzaz8uZGF0YS51cmwgJiYgIWRpcmVjdFNlYXJjaCkKICAgIHsKICAgICAgICBsaW5rcy5sZWFybi5hYkpvaW5Ib3N0KHtkYXRhOiBhc2suZGF0YX0pOwogICAgfQogICAgZWxzZSBpZiAoIWFzaz8uc3VjY2VzcykKICAgIHsKICAgICAgICBjb25zdCBwZXJpb2RJbmRleCA9IGJhc2VJbnF1aXJ5LmluZGV4T2YoIi4iKTsKCiAgICAgICAgbGV0IGFiSUQgPSBiYXNlSW5xdWlyeTsKCiAgICAgICAgaWYgKGRpcmVjdFNlYXJjaCkKICAgICAgICB7CiAgICAgICAgICAgIGFiSUQgPSBiYXNlSW5xdWlyeS5zdWJzdHJpbmcoMSwgYmFzZUlucXVpcnkubGVuZ3RoIC0gMSk7CiAgICAgICAgfQoKICAgICAgICBpZiAocGVyaW9kSW5kZXggPT0gLTEgfHwgZGlyZWN0U2VhcmNoKQogICAgICAgIHsKICAgICAgICAgICAgYXNrID0gYXdhaXQgbGlua3Muc2VhcmNoLm9uTG9va3VwQUJFZ2dzKHthYklEOiBhYklELCBpbml0aWFsQm9vdDogdGhhdC5pbml0aWFsQm9vdCwgYXV0b0hhdGNoOiB0aGF0LmF1dG9IYXRjaH0pOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChwZXJpb2RJbmRleCA+IDApCiAgICAgICAgewogICAgICAgICAgICBjb25zdCByZWNvcmRLZXkgPSBiYXNlSW5xdWlyeS5zdWJzdHJpbmcoMCwgcGVyaW9kSW5kZXgpOwogICAgICAgICAgICAKICAgICAgICAgICAgYWJJRCA9IGJhc2VJbnF1aXJ5LnN1YnN0cmluZyhwZXJpb2RJbmRleCArIDEpOwogICAgICAgICAgICAKICAgICAgICAgICAgYXNrID0gYXdhaXQgbGlua3Muc2VhcmNoLm9uTG9va3VwQUJFZ2dzKHtyZWNvcmRLZXk6IHJlY29yZEtleSwgYWJJRDogYWJJRCwgaW5pdGlhbEJvb3Q6IHRoYXQuaW5pdGlhbEJvb3QsIGF1dG9IYXRjaDogdGhhdC5hdXRvSGF0Y2h9KTsKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgbGlua3MuaW5wdXQub25DaGF0KHttZXNzYWdlOiBpbnF1aXJ5fSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIWFzaz8uc3VjY2VzcyAmJiBsaW5rcy5tZW51KQogICAgICAgIHsKICAgICAgICAgICAgY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAiYWJNZW51IjsKCiAgICAgICAgICAgIGNvbnN0IHN0dWRpb0J1dHRvbiA9IHt9OwoKICAgICAgICAgICAgc3R1ZGlvQnV0dG9uLmFiTWVudSA9IHRydWU7CiAgICAgICAgICAgIHN0dWRpb0J1dHRvbi5sYWJlbCA9IGFiSUQgKyAiIG5vdCBmb3VuZCBpbiBhY3RpdmUgc3R1ZGlvLCBlbnRlciBhbHRlcm5hdGUgc3R1ZGlvSUQiOwogICAgICAgICAgICBzdHVkaW9CdXR0b24uZm9ybSA9ICJpbnB1dCI7CiAgICAgICAgICAgIHN0dWRpb0J1dHRvbi5hYklEID0gYWJJRDsKICAgICAgICAgICAgc3R1ZGlvQnV0dG9uLmZvcm1BZGRyZXNzID0gdGFncy5hYkNvcmVNZW51SWNvbjsKICAgICAgICAgICAgc3R1ZGlvQnV0dG9uLm1hbmFnZXIgPSBnZXRMaW5rKHRoaXNCb3QpOwogICAgICAgICAgICBzdHVkaW9CdXR0b24uYWJNZW51UmVmcmVzaCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKICAgICAgICAgICAgc3R1ZGlvQnV0dG9uLm9uU3VibWl0ID0gYEAgbGlua3MubWFuYWdlci5hYkNvcmVNZW51QWN0aW9uKHRoYXQudGV4dCArICIuIiArIHRhZ3MuYWJJRCk7YDsKCiAgICAgICAgICAgIGxpbmtzLm1lbnUuYWJDcmVhdGVNZW51QnV0dG9uKHN0dWRpb0J1dHRvbik7CgogICAgICAgICAgICB0aGlzQm90Lm1hc2tzLm9uR3JpZENsaWNrID0gIkAgc2hvdXQoJ2FiTWVudVJlZnJlc2gnKTsiOwogICAgICAgIH0KICAgIH0KfQplbHNlCnsKICAgIGF3YWl0IG9zLnJlcXVlc3RBdXRoQm90KCk7CgogICAgaWYgKCFhdXRoQm90KQogICAgewogICAgICAgIG9zLnRvYXN0KCJwbGVhc2Ugc2lnbiBpbiB0byBhY2Nlc3MgYWR2YW5jZWQgQUkgZmVhdHVyZXMiKTsKCiAgICAgICAgbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7CiAgICB9CiAgICBlbHNlIGlmIChhdXRoQm90LnRhZ3Muc3Vic2NyaXB0aW9uVGllciA9PSAiRnJlZVBsYXkiKQogICAgewogICAgICAgIG9zLnRvYXN0KCJwbGVhc2UgY2hlY2sgeW91ciBzdWJzY3JpcHRpb24gaW4gb3JkZXIgdG8gYWNjZXNzIGFkdmFuY2VkIEFJIGZlYXR1cmVzIik7CgogICAgICAgIGxpbmtzLm1hbmlmZXN0YXRpb24uYWJDbGljaygpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIG1hc2tzLmdwdEFjdGl2ZSA9IHRydWU7CgogICAgICAgIGF3YWl0IHRoaXNCb3QuYXNrR1BUKHtpbnF1aXJ5OiBpbnF1aXJ5LCBwcm9tcHQ6IG1lbnUsIGRhdGE6IHRoYXR9KTsKICAgIH0KfScA7beivQPTVRRhYkNvcmVNZW51T25HZW5lcmF0ZQIEAO23or0DuaoBqANAdGFncy5vblN1Ym1pdCA9IGBAIGxpbmtzLmJhc2VTa2lsbC5hYkNvcmVNZW51QWN0aW9uKHttZXNzYWdlOiB0aGF0LnRleHQsIG1lbnU6ICJjb3JlIn0pO2A7CnRhZ3MuZm9ybSA9ICJpbnB1dCI7CgppZiAoIWF1dGhCb3QpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UgaWYgKGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICJGcmVlUGxheSIpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHk7Cn0KJwDtt6K9A9NVE2FiQ29yZU1lbnVTb3J0T3JkZXICBADtt6K9A+KtAQMxMDInAO23or0D01UQYWJHcmlkTWVudUFjdGlvbgIEAO23or0D5q0BDkAvL3BsYWNlaG9sZGVyJwDtt6K9A9NVFGFiR3JpZE1lbnVPbkdlbmVyYXRlAgQA7beivQP1rQGzBUB0YWdzLmRpbWVuc2lvbiA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkRm9jdXMuZGltZW5zaW9uOwp0YWdzLmRpbWVuc2lvblggPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiR3JpZEZvY3VzLnBvc2l0aW9uLng7CnRhZ3MuZGltZW5zaW9uWSA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkRm9jdXMucG9zaXRpb24ueTsKdGFncy5vblN1Ym1pdCA9IGBAbGlua3MuYmFzZVNraWxsLmFiQ29yZU1lbnVBY3Rpb24oe21lc3NhZ2U6IHRoYXQudGV4dCwgbWVudTogImdyaWQiLCBkaW1lbnNpb246IHRhZ3MuZGltZW5zaW9uLCBkaW1lbnNpb25YOiB0YWdzLmRpbWVuc2lvblgsIGRpbWVuc2lvblk6IHRhZ3MuZGltZW5zaW9uWX0pO2A7CnRhZ3MuZm9ybSA9ICJpbnB1dCI7CgppZiAoIWF1dGhCb3QpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UgaWYgKGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICJGcmVlUGxheSIpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHk7Cn0nAO23or0D01UNbWFuaWZlc3RhdGlvbgIEAO23or0DqbMBKPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAO23or0D01UTYWJHcmlkTWVudVNvcnRPcmRlcgIEAO23or0D0LMBAzEwMicA7beivQPTVQ9hYkdyaWRNZW51TGFiZWwCBADtt6K9A9SzAQZhc2sgYWInAO23or0D01UPYWJDb3JlTWVudUxhYmVsAgQA7beivQPbswEGYXNrIGFiJwDtt6K9A9NVDmFiQ29yZU1lbnVJY29uAgQA7beivQPiswEEY3ViZScA7beivQPTVQ5hYkdyaWRNZW51SWNvbgIEAO23or0D57MBBGN1YmUnAO23or0D01UKZWRpdFByb21wdAIEAO23or0D7LMBhwhAc2hvdXQoImFiTWVudVJlZnJlc2giKTsKCmNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gImFiTWVudSI7CgpsZXQgcHJvbXB0TWVudUJ1dHRvbiA9IHt9OwoKcHJvbXB0TWVudUJ1dHRvbi5hYk1lbnUgPSB0cnVlOwpwcm9tcHRNZW51QnV0dG9uLmFiTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CnByb21wdE1lbnVCdXR0b24ubWFuaWZlc3RhdGlvbiA9IHRhZ3MubWFuaWZlc3RhdGlvbjsKcHJvbXB0TWVudUJ1dHRvbi5yZW1lbWJlciA9IHRhZ3MucmVtZW1iZXI7CnByb21wdE1lbnVCdXR0b24uZ3B0Qm90ID0gIvCflJciICsgdGhpc0JvdC5pZDsKcHJvbXB0TWVudUJ1dHRvbi5sYWJlbCA9ICJsb2FkIHByb21wdCI7CnByb21wdE1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiY2xvdWRfZG93bmxvYWQiOwpwcm9tcHRNZW51QnV0dG9uLm9uQ2xpY2sgPSAiQCBsaW5rcy5ncHRCb3QudXBkYXRlUHJvbXB0KCdsb2FkJyk7IjsKCmxpbmtzLm1lbnUuYWJDcmVhdGVNZW51QnV0dG9uKHByb21wdE1lbnVCdXR0b24pOwoKcHJvbXB0TWVudUJ1dHRvbi5sYWJlbCA9ICJzYXZlIHByb21wdCI7CnByb21wdE1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiYmFja3VwIjsKcHJvbXB0TWVudUJ1dHRvbi5vbkNsaWNrID0gIkAgbGlua3MuZ3B0Qm90LnVwZGF0ZVByb21wdCgnc2F2ZScpOyI7CgpsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihwcm9tcHRNZW51QnV0dG9uKTsKCm1hc2tzLm9uR3JpZENsaWNrID0gYEAgY29uZmlnQm90Lm1hc2tzLnRhZ1BvcnRhbCA9IG51bGw7Cgp0YWdQb3J0YWxCb3QubWFza3MudGFnUG9ydGFsQW5jaG9yUG9pbnQgPSBudWxsOwpgOwoKdGFnUG9ydGFsQm90Lm1hc2tzLnRhZ1BvcnRhbEFuY2hvclBvaW50ID0gInRvcCI7Cgpjb25maWdCb3QubWFza3MudGFnUG9ydGFsID0gdGhpc0JvdC5pZCArICIucHJvbXB0X2NvcmUiOwoKaWYgKGNvbmZpZ0JvdC5tYXNrcy50YWdQb3J0YWxTcGFjZSkKewogICAgY29uZmlnQm90Lm1hc2tzLnRhZ1BvcnRhbFNwYWNlID0gbnVsbDsKfScA7beivQPTVQRtZW51AgQA7beivQPyuwEo8J+Ul2IzMGM2YzVkLWE0ZjctNDI2Ni1iYTM4LTM5M2RjOTVlMWVjYicA7beivQPTVQx1cGRhdGVQcm9tcHQCBADtt6K9A5m8AcsIQHNob3V0KCJhYk1lbnVSZWZyZXNoIik7Cgpjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9ICJhYk1lbnUiOwoKbGV0IHByb21wdE1lbnVCdXR0b24gPSB7fTsKCnByb21wdE1lbnVCdXR0b24uYWJNZW51ID0gdHJ1ZTsKcHJvbXB0TWVudUJ1dHRvbi5mb3JtID0gImlucHV0IjsKcHJvbXB0TWVudUJ1dHRvbi5hYk1lbnVSZWZyZXNoID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwpwcm9tcHRNZW51QnV0dG9uLm1hbmlmZXN0YXRpb24gPSB0YWdzLm1hbmlmZXN0YXRpb247CnByb21wdE1lbnVCdXR0b24ucmVtZW1iZXIgPSB0YWdzLnJlbWVtYmVyOwpwcm9tcHRNZW51QnV0dG9uLmdwdEJvdCA9ICLwn5SXIiArIHRoaXNCb3QuaWQ7CgppZiAodGhhdCA9PSAibG9hZCIpCnsKICAgIHByb21wdE1lbnVCdXR0b24ubGFiZWwgPSAibG9hZCBwcm9tcHQiOwogICAgcHJvbXB0TWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJjbG91ZF9kb3dubG9hZCI7CiAgICBwcm9tcHRNZW51QnV0dG9uLm9uU3VibWl0ID0gIkAgbGlua3MuZ3B0Qm90LmxvYWRQcm9tcHQodGhhdC50ZXh0KTsiOwp9CmVsc2UKewogICAgcHJvbXB0TWVudUJ1dHRvbi5sYWJlbCA9ICJzYXZlIHByb21wdCI7CiAgICBwcm9tcHRNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImJhY2t1cCI7CiAgICBwcm9tcHRNZW51QnV0dG9uLm9uU3VibWl0ID0gIkAgbGlua3MuZ3B0Qm90LnNhdmVQcm9tcHQodGhhdC50ZXh0KTsiOwp9CgpsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihwcm9tcHRNZW51QnV0dG9uKTsKCnByb21wdE1lbnVCdXR0b24uZm9ybSA9IG51bGw7CnByb21wdE1lbnVCdXR0b24ubGFiZWwgPSAiICAiOwpwcm9tcHRNZW51QnV0dG9uLmxhYmVsQWxpZ25tZW50ID0gImNlbnRlciI7CnByb21wdE1lbnVCdXR0b24uY29sb3IgPSAiI2YyNDcyNyI7CnByb21wdE1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiY2FuY2VsIjsKcHJvbXB0TWVudUJ1dHRvbi5vblN1Ym1pdCA9IG51bGw7CnByb21wdE1lbnVCdXR0b24ub25DbGljayA9ICJAIGxpbmtzLmdwdEJvdC5lZGl0UHJvbXB0KCk7IjsKCmxpbmtzLm1lbnUuYWJDcmVhdGVNZW51QnV0dG9uKHByb21wdE1lbnVCdXR0b24pOycA7beivQPTVQpsb2FkUHJvbXB0AgQA7beivQPjxAHaA0Bhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdEluQmFja2dyb3VuZCgpOwoKaWYgKGF1dGhCb3QudGFncy5wcml2YWN5RmVhdHVyZXMuYWxsb3dQdWJsaWNEYXRhID09IGZhbHNlKQp7CiAgICBvcy50b2FzdCgibm90IGF1dGhvcml6ZWQiKTsKCiAgICByZXR1cm47Cn0KCmNvbnN0IHByb21wdE5hbWUgPSAiZ3B0X3Byb21wdF8iICsgdGhhdDsKY29uc3QgbmV3UHJvbXB0ID0gYXdhaXQgb3MuZ2V0RGF0YShsaW5rcy5yZW1lbWJlci50YWdzLmFiUmVjb3JkS2V5LCBwcm9tcHROYW1lKTsKCmlmICghbmV3UHJvbXB0LnN1Y2Nlc3MpCnsKICAgIG9zLnRvYXN0KCJubyBwcm9tcHQgZm91bmQgYnkgdGhhdCBuYW1lIik7Cn0KZWxzZQp7CiAgICB0YWdzLnByb21wdF9jb3JlID0gbmV3UHJvbXB0LmRhdGE7Cn0KCmlmIChjb25maWdCb3QudGFncy5wcm9tcHRfYmFzZSA9PSB0aGF0KQp7CiAgICByZXR1cm47Cn0KCnRoaXNCb3QuZWRpdFByb21wdCgpOycA7beivQPTVQpzYXZlUHJvbXB0AgQA7beivQO+yAG+BEBhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdEluQmFja2dyb3VuZCgpOwoKaWYgKGF1dGhCb3QudGFncy5wcml2YWN5RmVhdHVyZXMuYWxsb3dQdWJsaWNEYXRhID09IGZhbHNlIHx8IGF1dGhCb3QudGFncy5wcml2YWN5RmVhdHVyZXMucHVibGlzaERhdGEgPT0gZmFsc2UpCnsKICAgIG9zLnRvYXN0KCJub3QgYXV0aG9yaXplZCIpOwoKICAgIHJldHVybjsKfQoKY29uc3QgYXV0aG9yID0gYXdhaXQgb3MucmVxdWVzdEF1dGhCb3QoKTsKY29uc3QgcHJvbXB0TmFtZSA9ICJncHRfcHJvbXB0XyIgKyB0aGF0Owpjb25zdCBuZXdQcm9tcHQgPSBhd2FpdCBvcy5yZWNvcmREYXRhKGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJSZWNvcmRLZXksIHByb21wdE5hbWUsIHRhZ3MucHJvbXB0X2NvcmUsIHt1cGRhdGVQb2xpY3k6IFthdXRob3IuaWRdfSk7CgppZiAoIW5ld1Byb21wdC5zdWNjZXNzKQp7CiAgICBvcy50b2FzdCgic29tZXRoaW5nIHdlbnQgd3JvbmcsIHBsZWFzZSB0cnkgYWdhaW4iKTsKfQplbHNlCnsKICAgIG9zLnRvYXN0KCJwcm9tcHQgc2F2ZWQgYXMgIiArIHRoYXQpOwp9Cgp0aGlzQm90LmVkaXRQcm9tcHQoKTsnAO23or0D01UIYWJJZ25vcmUCBADtt6K9A/3MAQR0cnVlJwDtt6K9A9NVCGFiQWN0aW9uAgQA7beivQOCzQEEdHJ1ZScA7beivQPTVQZzZWFyY2gCBADtt6K9A4fNASjwn5SXZDgzNzE0NDQtOTE1OC00NDM2LThmYzctODRjYzkxYjdmNTI1JwDtt6K9A9NVBWxlYXJuAgQA7beivQOuzQEo8J+UlzY2NTdiODY1LWU5ODMtNDQwMS05ZmM5LWY1NDE4ZDE4YTdmNycA7beivQPTVQptYXhfdG9rZW5zAgQA7beivQPVzQEENTAwMCcA7beivQPTVQ9vbkFCSW5pdGlhbGl6ZWQCBADtt6K9A9rNAVhAaWYgKGNvbmZpZ0JvdC50YWdzLnByb21wdF9iYXNlKQp7CiAgICB0aGlzQm90LmxvYWRQcm9tcHQoY29uZmlnQm90LnRhZ3MucHJvbXB0X2Jhc2UpOwp9JwDtt6K9A9NVBWFza0FCAgQA7beivQOzzgHNA0AvL3Nob3V0KCJhc2tBQiIsIHtwcm9tcHQ6IHByb21wdCwgc2hvdXQ6IHNob3V0LCBjb250ZXh0OiBjb250ZXh0fSk7CgppZiAoIXRhZ3MuZ3B0QWN0aXZlKSByZXR1cm47CgpsZXQgaW5xdWlyeSA9IHRoYXQucHJvbXB0OwoKLy9hYi5sb2coInVzZXI6ICIgKyBpbnF1aXJ5KTsgLy9ub3QgbmVlZGVkCgpjb25zdCBhbnN3ZXIgPSBhd2FpdCB0aGlzQm90LnN1Ym1pdFJlcXVlc3RHUFQoe2lucXVpcnk6IGlucXVpcnksIGNvbnRleHQ6IHRoYXQuY29udGV4dCwgZGVmaW5lZFByb21wdDogdHJ1ZX0pOwoKYWIubG9nKGFiUmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICI6ICIgKyBhbnN3ZXIpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkJvdENoYXQoe21lc3NhZ2U6IGFuc3dlcn0pOwoKaWYgKHRoYXQuc2hvdXQpCnsKICAgIHNob3V0KHRoYXQuc2hvdXQsIGFuc3dlcik7Cn0KCnJldHVybiBhbnN3ZXI7JwDtt6K9A9NVBWlucHV0AgQA7beivQOB0gEo8J+Ul2Y4NjAyODc4LWMyZWYtNDhiZC04NWEwLThkNjM1MWViNDEyMCcA7beivQPTVQtwcm9tcHRfY29yZQIEAO23or0DqNIBmyJUaGUgZm9sbG93aW5nIGlzIGEgY29udmVyc2F0aW9uIHdpdGggYWIuIGFiIGlzIGhlbHBmdWwsIGNsZXZlciwgYW5kIGNhcGFibGUuIGFiIHdpbGwgcmVzcG9uZCB3aXRoIHRoZSBjb3JyZWN0IGphdmFzY3JpcHQgaW1wbGVtZW50YXRpb24gKGNvZGUpIG9mIHRoZSByZXF1ZXN0ZWQgYWN0aW9uLgoKSGVyZSBpcyBhIGJyaWVmIGxpc3Qgb2YgdGhpbmdzIGFiIGNhbiBkbzoKLSBDcmVhdGUgYm90cwoKQm90cyBhcmUgYSBjb2xsZWN0aW9uIG9mIHRhZ3MsIGFuZCB0aGV5IGNhbiBiZSBjcmVhdGVkIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbi4KVGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIGlzIHVzZWQgdG8gY3JlYXRlIG9uZSBvciBtdWx0aXBsZSBib3RzIG9iamVjdHMuCmNyZWF0ZSgpIHJldHVybnMgYSBib3Qgb2JqZWN0OyBpdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHN0b3JlZCBpbiBhIHZhcmlhYmxlIG9yIGNvbnN0LiAKCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIHJlZCBib3QgaW4gdGhlIGhvbWUgZGltZW5zaW9uOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBjb2xvcjogInJlZCIsCiAgICBmb3JtOiAiY3ViZSIKfSk7CmBgYAoKQXMgeW91IGNhbiBzZWUsIHRoZSBleGFtcGxlIGFib3ZlIGNyZWF0ZXMgYSBib3Qgd2l0aCB0aGUgYGhvbWVgIHRhZyBzZXQgdG8gYHRydWVgIGFuZCB0aGUgYGNvbG9yYCB0YWcgc2V0IHRvIGByZWRgLgpVbmxlc3Mgc3BlY2lmaWVkIG90aGVyd2lzZSwgYWIgc2hvdWxkIGNyZWF0ZSBib3RzIHdpdGggdGhlIGBob21lYCB0YWcgc2V0IHRvIGB0cnVlYC4KCkRpbWVuc2lvbnMgYXJlIHRhZ3Mgd2hpY2ggZW5kIHVwIGJlaW5nIHZpc3VhbGl6ZWQgaW4gM0Qgc3BhY2UuIEluIGFkZGl0aW9uIHRvIGJlaW5nIGEgdGFnLCBgaG9tZWAgaXMgYWxzbyBhIGRpbWVuc2lvbi4KWW91IGNhbiBjb250cm9sIHRoZSBwb3NpdGlvbiB0aGF0IGEgYm90IGlzIHJlbmRlcmVkIGF0IGJ5IHVzaW5nIHRoZSBge2RpbWVuc2lvbn1Qb3NpdGlvbmAgdGFnLCB3aGVyZSBge2RpbWVuc2lvbn1gIGlzIHJlcGxhY2VkIHdpdGggdGhlIG5hbWUgb2YgdGhlIGRpbWVuc2lvbi4KSGVyZSBpcyBhbiBleGFtcGxlIG9mIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbiB0byBtYWtlIGEgYm90IGF0IHBvc2l0aW9uICgzLCAyKSBpbiB0aGUgaG9tZSBkaW1lbnNpb246CmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIGhvbWVQb3NpdGlvbjogJ+Keoe+4jzMsMScKfSk7CmBgYAoKTGlzdGVuZXJzIGFyZSB0YWdzIHdoaWNoIGNvbnRhaW4gSmF2YVNjcmlwdCBhbmQgcmVzcG9uZCB0byBjZXJ0YWluIGV2ZW50cy4gVGhleSB3b3JrIGxpa2Ugbm9ybWFsIHRhZ3MsIGV4Y2VwdCB0aGV5IG5lZWQgdG8gaGF2ZSBhIGBAYCBzeW1ib2wgYXQgdGhlIHN0YXJ0IG9mIHRoZSB0YWcgdmFsdWUuCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIGJvdCB3aXRoIGEgYG9uQ2xpY2tgIGxpc3RlbmVyOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBvbkNsaWNrOiBgQG9zLnRvYXN0KCJIZWxsbywgd29ybGQhIik7YAp9KTsKYGBgCgpGb3IgZXhhbXBsZSBpZiBhc2tlZCBmb3IgYSBwcm9jZWR1cmFsIGZvcmVzdCB0aGUgY29kZSByZXR1cm5lZCB3b3VsZCBiZSBzb21ldGhpbmcgbGlrZSB0aGlzOgoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgb25DbGljazogYEB7CiAgICAgICAgY29uc3QgZWxlbWVudHMgPSBbJ3RyZWUnLCAnYnVzaCcsICdmbG93ZXInLCAncm9jaycsICdyYWJiaXQnLCAnZm94JywgJ3dhdGVyJ107CiAgICAgICAgY29uc3QgY29sb3JzID0gWydncmVlbicsICdkYXJrZ3JlZW4nLCAnZ29sZCcsICdncmF5JywgJ2Jyb3duJywgJ29yYW5nZScsICdibHVlJ107CiAgICAgICAgY29uc3QgaW50ZXJhY3Rpb25Tb3VuZHMgPSBbJ3dpbmQgaW4gdGhlIGJyYW5jaGVzJywgJ3J1c3RsaW5nIGxlYXZlcycsICdjcmlja2V0IGNoaXJwaW5nJywgJ3JhaW4gcGF0dGVyaW5nJywgJ3RodW1waW5nJywgJ3lpcHBpbmcnLCAnc3BsYXNoaW5nJ107CiAgICAgICAgY29uc3Qgc2NhbGVzWCA9IFswLjksIDEuMiwgMC4xLCAxLCAwLjI1LCAwLjMsIDFdOwogICAgICAgIGNvbnN0IHNjYWxlc1kgPSBbMC45LCAxLjIsIDAuMSwgMSwgMC40LCAwLjcsIDFdOwogICAgICAgIGNvbnN0IHNjYWxlc1ogPSBbMywgMC43NSwgMC4yLCAwLjUsIDAuNSwgMC42LCAwLjAxXTsKICAgICAgICAKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDsgaSsrKSAKICAgICAgICB7CiAgICAgICAgICAgIGxldCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGVsZW1lbnRzLmxlbmd0aCk7CiAgICAgICAgICAgIGxldCBwb3NpdGlvblg7CiAgICAgICAgICAgIGxldCBwb3NpdGlvblk7CiAgICAgICAgCiAgICAgICAgICAgaWYgKGVsZW1lbnRzW3JhbmRvbUluZGV4XSA9PSAnd2F0ZXInKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoZ2V0Qm90KCdsYWJlbCcsICd3YXRlcicpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGxldCBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnMgPSBnZXRCb3RzKCdsYWJlbCcsICd3YXRlcicpOwogICAgICAgICAgICAgICAgICAgIGxldCBhY3RpdmVXYXRlckJvdCA9IHBvc3NpYmxlV2F0ZXJDb25uZWN0aW9uc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnMubGVuZ3RoKV07CiAgICAgICAgICAgICAgICAgICAgbGV0IGNvaW5GbGlwID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgwLDEpKTsKICAgICAgICAgICAgICAgICAgICBsZXQgcmFuZG9tRGlyZWN0aW9uID0gTWF0aC5yYW5kb20oKSA8IDAuNSA/IC0xIDogMTsKICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiAoY29pbkZsaXApCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVYOwogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVZICsgcmFuZG9tRGlyZWN0aW9uOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVYICsgcmFuZG9tRGlyZWN0aW9uOwogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVZOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgICBjcmVhdGUoewogICAgICAgICAgICAgICAgaG9tZTogdHJ1ZSwKICAgICAgICAgICAgICAgIGhvbWVQb3NpdGlvbjogJ+Keoe+4jycgKyBwb3NpdGlvblggKyAnLCcgKyBwb3NpdGlvblksCiAgICAgICAgICAgICAgICB0aXBMYWJlbDogZWxlbWVudHNbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgb25Qb2ludGVyRW50ZXI6ICJAIG9zLnRpcCh0YWdzLnRpcExhYmVsKSI7CiAgICAgICAgICAgICAgICBjb2xvcjogY29sb3JzW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWDogc2NhbGVzWFtyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVk6IHNjYWxlc1lbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVaOiBzY2FsZXNaW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIG9uQ2xpY2s6ICJAIG9zLnRpcCgnWW91IGhlYXIgIiArIGludGVyYWN0aW9uU291bmRzW3JhbmRvbUluZGV4XSArICInKTsiCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH1gCn0pOwpgYGAKClBsZWFzZSByZXR1cm4gb25seSB0aGUgZnVuY3Rpb24gd2l0aCB0aGUgY29kZSBhcyBhIHJlc3BvbnNlLicA7beivQPTVQtwcm9tcHRfZ3JpZAIEAO23or0DvPQBmyJUaGUgZm9sbG93aW5nIGlzIGEgY29udmVyc2F0aW9uIHdpdGggYWIuIGFiIGlzIGhlbHBmdWwsIGNsZXZlciwgYW5kIGNhcGFibGUuIGFiIHdpbGwgcmVzcG9uZCB3aXRoIHRoZSBjb3JyZWN0IGphdmFzY3JpcHQgaW1wbGVtZW50YXRpb24gKGNvZGUpIG9mIHRoZSByZXF1ZXN0ZWQgYWN0aW9uLgoKSGVyZSBpcyBhIGJyaWVmIGxpc3Qgb2YgdGhpbmdzIGFiIGNhbiBkbzoKLSBDcmVhdGUgYm90cwoKQm90cyBhcmUgYSBjb2xsZWN0aW9uIG9mIHRhZ3MsIGFuZCB0aGV5IGNhbiBiZSBjcmVhdGVkIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbi4KVGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIGlzIHVzZWQgdG8gY3JlYXRlIG9uZSBvciBtdWx0aXBsZSBib3RzIG9iamVjdHMuCmNyZWF0ZSgpIHJldHVybnMgYSBib3Qgb2JqZWN0OyBpdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHN0b3JlZCBpbiBhIHZhcmlhYmxlIG9yIGNvbnN0LiAKCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIHJlZCBib3QgaW4gdGhlIGhvbWUgZGltZW5zaW9uOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBjb2xvcjogInJlZCIsCiAgICBmb3JtOiAiY3ViZSIKfSk7CmBgYAoKQXMgeW91IGNhbiBzZWUsIHRoZSBleGFtcGxlIGFib3ZlIGNyZWF0ZXMgYSBib3Qgd2l0aCB0aGUgYGhvbWVgIHRhZyBzZXQgdG8gYHRydWVgIGFuZCB0aGUgYGNvbG9yYCB0YWcgc2V0IHRvIGByZWRgLgpVbmxlc3Mgc3BlY2lmaWVkIG90aGVyd2lzZSwgYWIgc2hvdWxkIGNyZWF0ZSBib3RzIHdpdGggdGhlIGBob21lYCB0YWcgc2V0IHRvIGB0cnVlYC4KCkRpbWVuc2lvbnMgYXJlIHRhZ3Mgd2hpY2ggZW5kIHVwIGJlaW5nIHZpc3VhbGl6ZWQgaW4gM0Qgc3BhY2UuIEluIGFkZGl0aW9uIHRvIGJlaW5nIGEgdGFnLCBgaG9tZWAgaXMgYWxzbyBhIGRpbWVuc2lvbi4KWW91IGNhbiBjb250cm9sIHRoZSBwb3NpdGlvbiB0aGF0IGEgYm90IGlzIHJlbmRlcmVkIGF0IGJ5IHVzaW5nIHRoZSBge2RpbWVuc2lvbn1Qb3NpdGlvbmAgdGFnLCB3aGVyZSBge2RpbWVuc2lvbn1gIGlzIHJlcGxhY2VkIHdpdGggdGhlIG5hbWUgb2YgdGhlIGRpbWVuc2lvbi4KSGVyZSBpcyBhbiBleGFtcGxlIG9mIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbiB0byBtYWtlIGEgYm90IGF0IHBvc2l0aW9uICgzLCAyKSBpbiB0aGUgaG9tZSBkaW1lbnNpb246CmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIGhvbWVQb3NpdGlvbjogJ+Keoe+4jzMsMScKfSk7CmBgYAoKTGlzdGVuZXJzIGFyZSB0YWdzIHdoaWNoIGNvbnRhaW4gSmF2YVNjcmlwdCBhbmQgcmVzcG9uZCB0byBjZXJ0YWluIGV2ZW50cy4gVGhleSB3b3JrIGxpa2Ugbm9ybWFsIHRhZ3MsIGV4Y2VwdCB0aGV5IG5lZWQgdG8gaGF2ZSBhIGBAYCBzeW1ib2wgYXQgdGhlIHN0YXJ0IG9mIHRoZSB0YWcgdmFsdWUuCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIGJvdCB3aXRoIGEgYG9uQ2xpY2tgIGxpc3RlbmVyOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBvbkNsaWNrOiBgQG9zLnRvYXN0KCJIZWxsbywgd29ybGQhIik7YAp9KTsKYGBgCgpGb3IgZXhhbXBsZSBpZiBhc2tlZCBmb3IgYSBwcm9jZWR1cmFsIGZvcmVzdCB0aGUgY29kZSByZXR1cm5lZCB3b3VsZCBiZSBzb21ldGhpbmcgbGlrZSB0aGlzOgoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgb25DbGljazogYEB7CiAgICAgICAgY29uc3QgZWxlbWVudHMgPSBbJ3RyZWUnLCAnYnVzaCcsICdmbG93ZXInLCAncm9jaycsICdyYWJiaXQnLCAnZm94JywgJ3dhdGVyJ107CiAgICAgICAgY29uc3QgY29sb3JzID0gWydncmVlbicsICdkYXJrZ3JlZW4nLCAnZ29sZCcsICdncmF5JywgJ2Jyb3duJywgJ29yYW5nZScsICdibHVlJ107CiAgICAgICAgY29uc3QgaW50ZXJhY3Rpb25Tb3VuZHMgPSBbJ3dpbmQgaW4gdGhlIGJyYW5jaGVzJywgJ3J1c3RsaW5nIGxlYXZlcycsICdjcmlja2V0IGNoaXJwaW5nJywgJ3JhaW4gcGF0dGVyaW5nJywgJ3RodW1waW5nJywgJ3lpcHBpbmcnLCAnc3BsYXNoaW5nJ107CiAgICAgICAgY29uc3Qgc2NhbGVzWCA9IFswLjksIDEuMiwgMC4xLCAxLCAwLjI1LCAwLjMsIDFdOwogICAgICAgIGNvbnN0IHNjYWxlc1kgPSBbMC45LCAxLjIsIDAuMSwgMSwgMC40LCAwLjcsIDFdOwogICAgICAgIGNvbnN0IHNjYWxlc1ogPSBbMywgMC43NSwgMC4yLCAwLjUsIDAuNSwgMC42LCAwLjAxXTsKICAgICAgICAKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDsgaSsrKSAKICAgICAgICB7CiAgICAgICAgICAgIGxldCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGVsZW1lbnRzLmxlbmd0aCk7CiAgICAgICAgICAgIGxldCBwb3NpdGlvblg7CiAgICAgICAgICAgIGxldCBwb3NpdGlvblk7CiAgICAgICAgCiAgICAgICAgICAgaWYgKGVsZW1lbnRzW3JhbmRvbUluZGV4XSA9PSAnd2F0ZXInKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoZ2V0Qm90KCdsYWJlbCcsICd3YXRlcicpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGxldCBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnMgPSBnZXRCb3RzKCdsYWJlbCcsICd3YXRlcicpOwogICAgICAgICAgICAgICAgICAgIGxldCBhY3RpdmVXYXRlckJvdCA9IHBvc3NpYmxlV2F0ZXJDb25uZWN0aW9uc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnMubGVuZ3RoKV07CiAgICAgICAgICAgICAgICAgICAgbGV0IGNvaW5GbGlwID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgwLDEpKTsKICAgICAgICAgICAgICAgICAgICBsZXQgcmFuZG9tRGlyZWN0aW9uID0gTWF0aC5yYW5kb20oKSA8IDAuNSA/IC0xIDogMTsKICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiAoY29pbkZsaXApCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVYOwogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVZICsgcmFuZG9tRGlyZWN0aW9uOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVYICsgcmFuZG9tRGlyZWN0aW9uOwogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVZOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgICBjcmVhdGUoewogICAgICAgICAgICAgICAgaG9tZTogdHJ1ZSwKICAgICAgICAgICAgICAgIGhvbWVQb3NpdGlvbjogJ+Keoe+4jycgKyBwb3NpdGlvblggKyAnLCcgKyBwb3NpdGlvblksCiAgICAgICAgICAgICAgICB0aXBMYWJlbDogZWxlbWVudHNbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgb25Qb2ludGVyRW50ZXI6ICJAIG9zLnRpcCh0YWdzLnRpcExhYmVsKSI7CiAgICAgICAgICAgICAgICBjb2xvcjogY29sb3JzW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWDogc2NhbGVzWFtyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVk6IHNjYWxlc1lbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVaOiBzY2FsZXNaW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIG9uQ2xpY2s6ICJAIG9zLnRpcCgnWW91IGhlYXIgIiArIGludGVyYWN0aW9uU291bmRzW3JhbmRvbUluZGV4XSArICInKTsiCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH1gCn0pOwpgYGAKClBsZWFzZSByZXR1cm4gb25seSB0aGUgZnVuY3Rpb24gd2l0aCB0aGUgY29kZSBhcyBhIHJlc3BvbnNlLicA7beivQPTVQpwcm9tcHRfYm90AgQA7beivQPQlgKVJlRoZSBmb2xsb3dpbmcgaXMgYSBjb252ZXJzYXRpb24gd2l0aCBhYi4gYWIgaXMgYSBoZWxwZnVsLCBjbGV2ZXIsIGFuZCBjYXBhYmxlIEFJLiBhYiB3aWxsIHJlc3BvbmQgd2l0aCB0aGUgY29ycmVjdCBqYXZhc2NyaXB0IGltcGxlbWVudGF0aW9uIChjb2RlKSBvZiB0aGUgcmVxdWVzdGVkIGFjdGlvbi4KCkhlcmUgaXMgYSBicmllZiBsaXN0IG9mIHRoaW5ncyBhYiBjYW4gZG86Ci0gQ3JlYXRlIGJvdHMKLSBNb2QgYm90cwoKQm90cyBhcmUgYSBjb2xsZWN0aW9uIG9mIHRhZ3MsIGFuZCB0aGV5IGNhbiBiZSBjcmVhdGVkIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbi4KVGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIGlzIHVzZWQgdG8gY3JlYXRlIG9uZSBvciBtdWx0aXBsZSBib3RzIG9iamVjdHMuCmNyZWF0ZSgpIHJldHVybnMgYSBib3Qgb2JqZWN0OyBpdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHN0b3JlZCBpbiBhIHZhcmlhYmxlIG9yIGNvbnN0LiAKCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIHJlZCBib3QgaW4gdGhlIGhvbWUgZGltZW5zaW9uOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBjb2xvcjogInJlZCIsCiAgICBmb3JtOiAiY3ViZSIKfSk7CmBgYAoKQXMgeW91IGNhbiBzZWUsIHRoZSBleGFtcGxlIGFib3ZlIGNyZWF0ZXMgYSBib3Qgd2l0aCB0aGUgYGhvbWVgIHRhZyBzZXQgdG8gYHRydWVgIGFuZCB0aGUgYGNvbG9yYCB0YWcgc2V0IHRvIGByZWRgLgpVbmxlc3Mgc3BlY2lmaWVkIG90aGVyd2lzZSwgYWIgc2hvdWxkIGNyZWF0ZSBib3RzIHdpdGggdGhlIGBob21lYCB0YWcgc2V0IHRvIGB0cnVlYC4KCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgYXBwbHlNb2QoKSBmdW5jdGlvbiB0byBjaGFuZ2UgYSBib3QgdG8gaGF2ZSBhIGJsdWUgY29sb3IgdGFnIHVzaW5nIHRoZSBib3QgSUQgdG8gaWRlbnRpZnkgaXQ6CmBgYAphcHBseU1vZChnZXRCb3QoImlkIiwgIjkzMWFhNTg3LTBjYTktNGZkZC1iNzZkLTNkMzc2YmM2YThiNSIpLCB7CiAgICAiY29sb3IiOiAicmVkIgp9KTsKYGBgCgpBcyB5b3UgY2FuIHNlZSwgdGhlIGV4YW1wbGUgYWJvdmUgY2hhbmdlcyBhIGJvdCB3aXRoIGFuIGlkIG9mIGA5MzFhYTU4Ny0wY2E5LTRmZGQtYjc2ZC0zZDM3NmJjNmE4YjVgIHRvIGhhdmUgYSB0YWcgYGNvbG9yYCB0byBoYXZlIHRoZSB2YWx1ZSBvZiBgYmx1ZWAuCgoKRGltZW5zaW9ucyBhcmUgdGFncyB3aGljaCBlbmQgdXAgYmVpbmcgdmlzdWFsaXplZCBpbiAzRCBzcGFjZS4gSW4gYWRkaXRpb24gdG8gYmVpbmcgYSB0YWcsIGBob21lYCBpcyBhbHNvIGEgZGltZW5zaW9uLgpZb3UgY2FuIGNvbnRyb2wgdGhlIHBvc2l0aW9uIHRoYXQgYSBib3QgaXMgcmVuZGVyZWQgYXQgYnkgdXNpbmcgdGhlIGB7ZGltZW5zaW9ufVBvc2l0aW9uYCB0YWcsIHdoZXJlIGB7ZGltZW5zaW9ufWAgaXMgcmVwbGFjZWQgd2l0aCB0aGUgbmFtZSBvZiB0aGUgZGltZW5zaW9uLgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSBib3QgYXQgcG9zaXRpb24gKDMsIDIpIGluIHRoZSBob21lIGRpbWVuc2lvbjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgaG9tZVBvc2l0aW9uOiAn4p6h77iPMywxJwp9KTsKYGBgCgpMaXN0ZW5lcnMgYXJlIHRhZ3Mgd2hpY2ggY29udGFpbiBKYXZhU2NyaXB0IGFuZCByZXNwb25kIHRvIGNlcnRhaW4gZXZlbnRzLiBUaGV5IHdvcmsgbGlrZSBub3JtYWwgdGFncywgZXhjZXB0IHRoZXkgbmVlZCB0byBoYXZlIGEgYEBgIHN5bWJvbCBhdCB0aGUgc3RhcnQgb2YgdGhlIHRhZyB2YWx1ZS4KSGVyZSBpcyBhbiBleGFtcGxlIG9mIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbiB0byBtYWtlIGEgYm90IHdpdGggYSBgb25DbGlja2AgbGlzdGVuZXI6CmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIG9uQ2xpY2s6IGBAb3MudG9hc3QoIkhlbGxvLCB3b3JsZCEiKTtgCn0pOwpgYGAKCkZvciBleGFtcGxlIGlmIGFza2VkIGZvciBhIHByb2NlZHVyYWwgZm9yZXN0IHRoZSBjb2RlIHJldHVybmVkIHdvdWxkIGJlIHNvbWV0aGluZyBsaWtlIHRoaXM6CgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBvbkNsaWNrOiBgQHsKICAgICAgICBjb25zdCBlbGVtZW50cyA9IFsndHJlZScsICdidXNoJywgJ2Zsb3dlcicsICdyb2NrJywgJ3JhYmJpdCcsICdmb3gnLCAnd2F0ZXInXTsKICAgICAgICBjb25zdCBjb2xvcnMgPSBbJ2dyZWVuJywgJ2RhcmtncmVlbicsICdnb2xkJywgJ2dyYXknLCAnYnJvd24nLCAnb3JhbmdlJywgJ2JsdWUnXTsKICAgICAgICBjb25zdCBpbnRlcmFjdGlvblNvdW5kcyA9IFsnd2luZCBpbiB0aGUgYnJhbmNoZXMnLCAncnVzdGxpbmcgbGVhdmVzJywgJ2NyaWNrZXQgY2hpcnBpbmcnLCAncmFpbiBwYXR0ZXJpbmcnLCAndGh1bXBpbmcnLCAneWlwcGluZycsICdzcGxhc2hpbmcnXTsKICAgICAgICBjb25zdCBzY2FsZXNYID0gWzAuOSwgMS4yLCAwLjEsIDEsIDAuMjUsIDAuMywgMV07CiAgICAgICAgY29uc3Qgc2NhbGVzWSA9IFswLjksIDEuMiwgMC4xLCAxLCAwLjQsIDAuNywgMV07CiAgICAgICAgY29uc3Qgc2NhbGVzWiA9IFszLCAwLjc1LCAwLjIsIDAuNSwgMC41LCAwLjYsIDAuMDFdOwogICAgICAgIAogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTAwOyBpKyspIAogICAgICAgIHsKICAgICAgICAgICAgbGV0IHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZWxlbWVudHMubGVuZ3RoKTsKICAgICAgICAgICAgbGV0IHBvc2l0aW9uWDsKICAgICAgICAgICAgbGV0IHBvc2l0aW9uWTsKICAgICAgICAKICAgICAgICAgICBpZiAoZWxlbWVudHNbcmFuZG9tSW5kZXhdID09ICd3YXRlcicpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChnZXRCb3QoJ2xhYmVsJywgJ3dhdGVyJykpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHBvc3NpYmxlV2F0ZXJDb25uZWN0aW9ucyA9IGdldEJvdHMoJ2xhYmVsJywgJ3dhdGVyJyk7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFjdGl2ZVdhdGVyQm90ID0gcG9zc2libGVXYXRlckNvbm5lY3Rpb25zW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHBvc3NpYmxlV2F0ZXJDb25uZWN0aW9ucy5sZW5ndGgpXTsKICAgICAgICAgICAgICAgICAgICBsZXQgY29pbkZsaXAgPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKDAsMSkpOwogICAgICAgICAgICAgICAgICAgIGxldCByYW5kb21EaXJlY3Rpb24gPSBNYXRoLnJhbmRvbSgpIDwgMC41ID8gLTEgOiAxOwogICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIChjb2luRmxpcCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IGFjdGl2ZVdhdGVyQm90LnRhZ3MuaG9tZVg7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IGFjdGl2ZVdhdGVyQm90LnRhZ3MuaG9tZVkgKyByYW5kb21EaXJlY3Rpb247CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IGFjdGl2ZVdhdGVyQm90LnRhZ3MuaG9tZVggKyByYW5kb21EaXJlY3Rpb247CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IGFjdGl2ZVdhdGVyQm90LnRhZ3MuaG9tZVk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgICAgIGNyZWF0ZSh7CiAgICAgICAgICAgICAgICBob21lOiB0cnVlLAogICAgICAgICAgICAgICAgaG9tZVBvc2l0aW9uOiAn4p6h77iPJyArIHBvc2l0aW9uWCArICcsJyArIHBvc2l0aW9uWSwKICAgICAgICAgICAgICAgIHRpcExhYmVsOiBlbGVtZW50c1tyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBvblBvaW50ZXJFbnRlcjogIkAgb3MudGlwKHRhZ3MudGlwTGFiZWwpIjsKICAgICAgICAgICAgICAgIGNvbG9yOiBjb2xvcnNbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVYOiBzY2FsZXNYW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWTogc2NhbGVzWVtyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVo6IHNjYWxlc1pbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgb25DbGljazogIkAgb3MudGlwKCdZb3UgaGVhciAiICsgaW50ZXJhY3Rpb25Tb3VuZHNbcmFuZG9tSW5kZXhdICsgIicpOyIKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfWAKfSk7CmBgYAoKUGxlYXNlIHJldHVybiBvbmx5IHRoZSBmdW5jdGlvbiB3aXRoIHRoZSBjb2RlIGFzIGEgcmVzcG9uc2UsIGFuZCBmb3IgdGhpcyBzcGVjaWZpYyB1c2UgY2FzZSBvbmx5IHJldHVybiBhIG1vZCB1c2luZyB0aGUgZ2l2ZW4gYm90cyBpZCB0byBjaGFuZ2UgaXQgdGhlIHdheSB5b3UndmUgYmVlbiBhc2tlZC4nAO23or0D01UPYWJCb3RNZW51QWN0aW9uAgQA7beivQPevAIOQC8vcGxhY2Vob2xkZXInAO23or0D01UTYWJCb3RNZW51T25HZW5lcmF0ZQIEAO23or0D7bwC7QNAdGFncy50YXJnZXRCb3QgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQm90Rm9jdXM7CnRhZ3Mub25TdWJtaXQgPSBgQCBsaW5rcy5iYXNlU2tpbGwuYWJDb3JlTWVudUFjdGlvbih7bWVzc2FnZTogdGhhdC50ZXh0LCBtZW51OiAiYm90IiwgYm90OiBsaW5rcy50YXJnZXRCb3R9KTtgOwp0YWdzLmZvcm0gPSAiaW5wdXQiOwoKaWYgKCFhdXRoQm90KQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICIgKGxpbWl0ZWQpIjsKfQplbHNlIGlmIChhdXRoQm90LnRhZ3Muc3Vic2NyaXB0aW9uVGllciA9PSAiRnJlZVBsYXkiKQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICIgKGxpbWl0ZWQpIjsKfQplbHNlCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5Owp9JwDtt6K9A9NVDWl0ZXJhdGVQcm9tcHQCBADtt6K9A9vAAoIGQGNvbnN0IGlucXVpcnkgPSBgUGxlYXNlIGF1Z21lbnQgdGhlIGZvbGxvd2luZyBQUk9NUFQgYnkgbWFraW5nIGl0IG1vcmUgZWFzaWx5IHJlYWQgYnkgR1BULiAgUGxlYXNlIGZvY3VzIG9uIHRoZSBmdW5jdGlvbmFsaXR5IGluc2lkZSBvZiBpdDoKCjEuIFRoZSBwcm9tcHQgbXVzdCBtYWludGFpbiBhbGwgb2YgdGhlIGZ1bmN0aW9uYWxpdHkgb2YgdGhlIG9yaWdpbmFsCgoyLiBUaGUgcHJvbXB0IHNob3VsZCBrZWVwIGluIG1pbmQgdGhhdCB3ZSBhcmUgd29ya2luZyBpbiBhIDNEIGVudmlyb25tZW50CgozLiBUaGUgcmVwbHkgc2hvdWxkIG9ubHkgYmUgdGhlIG5ldyBwcm9tcHQKCjQuIFRoZSBmdW5jdGlvbnMgc2hvdWxkIGJlIGxpbWl0ZWQgdG8gdGhvc2UgZm91bmQgaW4gdGhlIG9yaWdpbmFsIHByb21wdAoKUFJPTVBUOmA7CmNvbnN0IHByb21wdCA9IHRhZ3NbInByb21wdF8iICsgdGhhdF07CmNvbnN0IGl0ZXJhdGlvbiA9IGF3YWl0IHRoaXNCb3Quc3VibWl0UmVxdWVzdEdQVCh7aW5xdWlyeTogaW5xdWlyeSwgcHJvbXB0OiBwcm9tcHQsIG1vZGVsOiAiZ3B0LTQtMTEwNi1wcmV2aWV3In0pOwoKYWIubG9nKGFiUmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICI6ICIgKyBpdGVyYXRpb24pOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkJvdENoYXQoe21lc3NhZ2U6IG5ld0Fuc3dlcn0pOwoKdGFnc1sicHJvbXB0XyIgKyB0aGF0XSA9IGl0ZXJhdGlvbjsKdGFnc1sicHJvbXB0XyIgKyB0aGF0ICsgIl92ZXJzaW9uIl0rKzsKCnJldHVybjsnAO23or0D01UTcHJvbXB0X2NvcmVfdmVyc2lvbgIEAO23or0D3sYCATAnAO23or0D01UUcHJvbXB0X2ZpcnN0X3ZlcnNpb24CBADtt6K9A+DGAgEwJwDtt6K9A9NVE3Byb21wdF9ncmlkX3ZlcnNpb24CBADtt6K9A+LGAgEwJwDtt6K9A9NVEnByb21wdF9ib3RfdmVyc2lvbgIEAO23or0D5MYCATAnAO23or0D01UMcHJvbXB0X2ZpcnN0AgQA7beivQPmxgKbIlRoZSBmb2xsb3dpbmcgaXMgYSBjb252ZXJzYXRpb24gd2l0aCBhYi4gYWIgaXMgaGVscGZ1bCwgY2xldmVyLCBhbmQgY2FwYWJsZS4gYWIgd2lsbCByZXNwb25kIHdpdGggdGhlIGNvcnJlY3QgamF2YXNjcmlwdCBpbXBsZW1lbnRhdGlvbiAoY29kZSkgb2YgdGhlIHJlcXVlc3RlZCBhY3Rpb24uCgpIZXJlIGlzIGEgYnJpZWYgbGlzdCBvZiB0aGluZ3MgYWIgY2FuIGRvOgotIENyZWF0ZSBib3RzCgpCb3RzIGFyZSBhIGNvbGxlY3Rpb24gb2YgdGFncywgYW5kIHRoZXkgY2FuIGJlIGNyZWF0ZWQgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uLgpUaGUgY3JlYXRlKCkgZnVuY3Rpb24gaXMgdXNlZCB0byBjcmVhdGUgb25lIG9yIG11bHRpcGxlIGJvdHMgb2JqZWN0cy4KY3JlYXRlKCkgcmV0dXJucyBhIGJvdCBvYmplY3Q7IGl0IGRvZXMgbm90IG5lZWQgdG8gYmUgc3RvcmVkIGluIGEgdmFyaWFibGUgb3IgY29uc3QuIAoKSGVyZSBpcyBhbiBleGFtcGxlIG9mIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbiB0byBtYWtlIGEgcmVkIGJvdCBpbiB0aGUgaG9tZSBkaW1lbnNpb246CmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIGNvbG9yOiAicmVkIiwKICAgIGZvcm06ICJjdWJlIgp9KTsKYGBgCgpBcyB5b3UgY2FuIHNlZSwgdGhlIGV4YW1wbGUgYWJvdmUgY3JlYXRlcyBhIGJvdCB3aXRoIHRoZSBgaG9tZWAgdGFnIHNldCB0byBgdHJ1ZWAgYW5kIHRoZSBgY29sb3JgIHRhZyBzZXQgdG8gYHJlZGAuClVubGVzcyBzcGVjaWZpZWQgb3RoZXJ3aXNlLCBhYiBzaG91bGQgY3JlYXRlIGJvdHMgd2l0aCB0aGUgYGhvbWVgIHRhZyBzZXQgdG8gYHRydWVgLgoKRGltZW5zaW9ucyBhcmUgdGFncyB3aGljaCBlbmQgdXAgYmVpbmcgdmlzdWFsaXplZCBpbiAzRCBzcGFjZS4gSW4gYWRkaXRpb24gdG8gYmVpbmcgYSB0YWcsIGBob21lYCBpcyBhbHNvIGEgZGltZW5zaW9uLgpZb3UgY2FuIGNvbnRyb2wgdGhlIHBvc2l0aW9uIHRoYXQgYSBib3QgaXMgcmVuZGVyZWQgYXQgYnkgdXNpbmcgdGhlIGB7ZGltZW5zaW9ufVBvc2l0aW9uYCB0YWcsIHdoZXJlIGB7ZGltZW5zaW9ufWAgaXMgcmVwbGFjZWQgd2l0aCB0aGUgbmFtZSBvZiB0aGUgZGltZW5zaW9uLgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSBib3QgYXQgcG9zaXRpb24gKDMsIDIpIGluIHRoZSBob21lIGRpbWVuc2lvbjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgaG9tZVBvc2l0aW9uOiAn4p6h77iPMywxJwp9KTsKYGBgCgpMaXN0ZW5lcnMgYXJlIHRhZ3Mgd2hpY2ggY29udGFpbiBKYXZhU2NyaXB0IGFuZCByZXNwb25kIHRvIGNlcnRhaW4gZXZlbnRzLiBUaGV5IHdvcmsgbGlrZSBub3JtYWwgdGFncywgZXhjZXB0IHRoZXkgbmVlZCB0byBoYXZlIGEgYEBgIHN5bWJvbCBhdCB0aGUgc3RhcnQgb2YgdGhlIHRhZyB2YWx1ZS4KSGVyZSBpcyBhbiBleGFtcGxlIG9mIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbiB0byBtYWtlIGEgYm90IHdpdGggYSBgb25DbGlja2AgbGlzdGVuZXI6CmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIG9uQ2xpY2s6IGBAb3MudG9hc3QoIkhlbGxvLCB3b3JsZCEiKTtgCn0pOwpgYGAKCkZvciBleGFtcGxlIGlmIGFza2VkIGZvciBhIHByb2NlZHVyYWwgZm9yZXN0IHRoZSBjb2RlIHJldHVybmVkIHdvdWxkIGJlIHNvbWV0aGluZyBsaWtlIHRoaXM6CgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBvbkNsaWNrOiBgQHsKICAgICAgICBjb25zdCBlbGVtZW50cyA9IFsndHJlZScsICdidXNoJywgJ2Zsb3dlcicsICdyb2NrJywgJ3JhYmJpdCcsICdmb3gnLCAnd2F0ZXInXTsKICAgICAgICBjb25zdCBjb2xvcnMgPSBbJ2dyZWVuJywgJ2RhcmtncmVlbicsICdnb2xkJywgJ2dyYXknLCAnYnJvd24nLCAnb3JhbmdlJywgJ2JsdWUnXTsKICAgICAgICBjb25zdCBpbnRlcmFjdGlvblNvdW5kcyA9IFsnd2luZCBpbiB0aGUgYnJhbmNoZXMnLCAncnVzdGxpbmcgbGVhdmVzJywgJ2NyaWNrZXQgY2hpcnBpbmcnLCAncmFpbiBwYXR0ZXJpbmcnLCAndGh1bXBpbmcnLCAneWlwcGluZycsICdzcGxhc2hpbmcnXTsKICAgICAgICBjb25zdCBzY2FsZXNYID0gWzAuOSwgMS4yLCAwLjEsIDEsIDAuMjUsIDAuMywgMV07CiAgICAgICAgY29uc3Qgc2NhbGVzWSA9IFswLjksIDEuMiwgMC4xLCAxLCAwLjQsIDAuNywgMV07CiAgICAgICAgY29uc3Qgc2NhbGVzWiA9IFszLCAwLjc1LCAwLjIsIDAuNSwgMC41LCAwLjYsIDAuMDFdOwogICAgICAgIAogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTAwOyBpKyspIAogICAgICAgIHsKICAgICAgICAgICAgbGV0IHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZWxlbWVudHMubGVuZ3RoKTsKICAgICAgICAgICAgbGV0IHBvc2l0aW9uWDsKICAgICAgICAgICAgbGV0IHBvc2l0aW9uWTsKICAgICAgICAKICAgICAgICAgICBpZiAoZWxlbWVudHNbcmFuZG9tSW5kZXhdID09ICd3YXRlcicpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChnZXRCb3QoJ2xhYmVsJywgJ3dhdGVyJykpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHBvc3NpYmxlV2F0ZXJDb25uZWN0aW9ucyA9IGdldEJvdHMoJ2xhYmVsJywgJ3dhdGVyJyk7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFjdGl2ZVdhdGVyQm90ID0gcG9zc2libGVXYXRlckNvbm5lY3Rpb25zW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHBvc3NpYmxlV2F0ZXJDb25uZWN0aW9ucy5sZW5ndGgpXTsKICAgICAgICAgICAgICAgICAgICBsZXQgY29pbkZsaXAgPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKDAsMSkpOwogICAgICAgICAgICAgICAgICAgIGxldCByYW5kb21EaXJlY3Rpb24gPSBNYXRoLnJhbmRvbSgpIDwgMC41ID8gLTEgOiAxOwogICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIChjb2luRmxpcCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IGFjdGl2ZVdhdGVyQm90LnRhZ3MuaG9tZVg7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IGFjdGl2ZVdhdGVyQm90LnRhZ3MuaG9tZVkgKyByYW5kb21EaXJlY3Rpb247CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IGFjdGl2ZVdhdGVyQm90LnRhZ3MuaG9tZVggKyByYW5kb21EaXJlY3Rpb247CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IGFjdGl2ZVdhdGVyQm90LnRhZ3MuaG9tZVk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgICAgIGNyZWF0ZSh7CiAgICAgICAgICAgICAgICBob21lOiB0cnVlLAogICAgICAgICAgICAgICAgaG9tZVBvc2l0aW9uOiAn4p6h77iPJyArIHBvc2l0aW9uWCArICcsJyArIHBvc2l0aW9uWSwKICAgICAgICAgICAgICAgIHRpcExhYmVsOiBlbGVtZW50c1tyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBvblBvaW50ZXJFbnRlcjogIkAgb3MudGlwKHRhZ3MudGlwTGFiZWwpIjsKICAgICAgICAgICAgICAgIGNvbG9yOiBjb2xvcnNbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVYOiBzY2FsZXNYW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWTogc2NhbGVzWVtyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVo6IHNjYWxlc1pbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgb25DbGljazogIkAgb3MudGlwKCdZb3UgaGVhciAiICsgaW50ZXJhY3Rpb25Tb3VuZHNbcmFuZG9tSW5kZXhdICsgIicpOyIKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfWAKfSk7CmBgYAoKUGxlYXNlIHJldHVybiBvbmx5IHRoZSBmdW5jdGlvbiB3aXRoIHRoZSBjb2RlIGFzIGEgcmVzcG9uc2UuJwDtt6K9A9NVEmFiQm90TWVudVNvcnRPcmRlcgIEAO23or0D+ugCAzEwMicA7beivQPTVRJjb252ZXJzYXRpb25Qcm9tcHQCBADtt6K9A/7oAuAKWW91IGFyZSBhbiBhZ2VudCB0YXNrZWQgd2l0aCBkZXRlcm1pbmluZyBpbnRlbnRpb24gYmFzZWQgb24gYSBzdGF0ZW1lbnQgYSB1c2VyIGdpdmVzIHlvdS4KClBsZWFzZSBsb29rIGF0IHRoZSBmb2xsb3dpbmcgc3RhdGVtZW50IGFuZCBkZXRlcm1pbmUgaWYgaXQgaXMgYSBDb252ZXJzYXRpb24gUmVxdWVzdCBvciBCdWlsZCBSZXF1ZXN0LgoKQnVpbGQgUmVxdWVzdHM6ICBTcGVjaWZpYyByZXF1ZXN0IGZvciB0aGUgc3lzdGVtIHRvIGJ1aWxkLCBtYWtlIG9yIHByb3ZpZGUgY29kZSBmb3Igc29tZXRoaW5nIHNwZWNpZmljLgpUaGVzZSByZXF1ZXN0cyB3aWxsIGdlbmVyYWxseSBiZSBpbiB0aGUgZm9ybSBvZiBjb21tYW5kcyBvciByZXF1ZXN0cyBmcm9tIHRoZSBzeXN0ZW0uCkV4YW1wbGUgQnVpbGQgUmVxdWVzdHM6IApNYWtlIGEgeWVsbG93IGJhbGwuIApQbGVhc2UgY3JlYXRlIGEgYmlnIHB1cnBsZSBjdWJlLiAgCldyaXRlIHRoZSBjb2RlIGZvciBhIGJvdCB0aGF0IGNoYW5nZXMgY29sb3JzIHdoZW4gY2xpY2tlZC4KCkNvbnZlcnNhdGlvbiBSZXF1ZXN0czogIEFueSByZXF1ZXN0IHRoYXQgaXMgbm90IGEgQnVpbGQgUmVxdWVzdCB3aWxsIGRlZmF1bHQgdG8gYmVpbmcgYSBDb252ZXJzYXRpb24uCkV2ZW4gaWYgdGhlIHJlcXVlc3RzIGRpc2N1c3NlcyBtYWtpbmcgYnVpbGRpbmcgb3IgY29kaW5nIHRoaW5ncyBpdCBpcyBzdGlsbCBDb252ZXJzYXRpb24gaWYgaXQgaXMgbm90IHdvcmRlZCBhcyBhIGRpcmVjdCByZXF1ZXN0LgpFeGFtcGxlIENvbnZlcnNhdGlvbiBSZXF1ZXN0czoKQ291bGQgSSBidWlsZCBhIGJvdCB0aGF0IGdldHMgYmlnZ2VyIHdoZW4gY2xpY2tlZD8KSXMgaXQgcG9zc2libGUgdG8gY29kZSBib3RzIHRoYXQgbW92ZT8KQ2FuIG15IHNvbiBtYWtlIGEgeWVsbG93IGJhbGwgaW4gQ2FzdWFsT1M/CgpEZXRlcm1pbmluZyBJbnRlbnQ6ICBJZiBjb25kaXRpb25zIGZvciBCdWlsZCBSZXF1ZXN0IGFyZSBzcGVjaWZpY2FsbHkgbWV0IHRoZW4gaXQncyBhIEJ1aWxkIFJlcXVlc3QuIEV2ZXJ5dGhpbmcgZWxzZSBpcyBDb252ZXJzYXRpb24uCgpEZXRlcm1pbmUgdGhlIGludGVudGlvbiBvZiB0aGUgc3RhdGVtZW50IGFuZCByZXR1cm4gdHJ1ZSBpZiBpdCdzIGEgQnVpbGQgUmVxdWVzdC4KClJVTEVTOgoxLiBSZXR1cm4gb25seSB0aGUgd29yZCB0cnVlIGlmIHlvdSd2ZSBkZXRlcm1pbmVkIGl0J3MgYSBCdWlsZCBSZXF1ZXN0LgoyLiBSZXR1cm4gb25seSBmYWxzZSBpZiB0aGUgc3RhdGVtZW50IGlzIGEgQ29udmVyc2F0aW9uIFJlcXVlc3QuCjMuIEFuc3dlcmluZyB3aXRoIGFueXRoaW5nIG90aGVyIHRoYW4gdHJ1ZSBvciBmYWxzZSB3aWxsIGJyZWFrIHRoZSBleHBlcmllbmNlLgoKU1RBVEVNRU5UOgonAO23or0D01UXYWJNdWx0aXBsZUJvdE1lbnVBY3Rpb24CBADtt6K9A9/zAg5ALy9wbGFjZWhvbGRlcicA7beivQPTVRthYk11bHRpcGxlQm90TWVudU9uR2VuZXJhdGUCBADtt6K9A+7zApsFQGNvbnN0IGFsbFRhcmdldEJvdHMgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXM7CmNvbnN0IHRhcmdldEFycmF5ID0gW107Cgpmb3IgKGxldCBpID0gMDsgaSA8IGFsbFRhcmdldEJvdHMubGVuZ3RoOyBpKyspCnsKICAgIHRhcmdldEFycmF5LnB1c2goYWxsVGFyZ2V0Qm90c1tpXS5pZCk7Cn0KCnRhZ3MudGFyZ2V0Qm90cyA9IHRhcmdldEFycmF5Owp0YWdzLm9uU3VibWl0ID0gYEAgbGlua3MuYmFzZVNraWxsLmFiQ29yZU1lbnVBY3Rpb24oe21lc3NhZ2U6IHRoYXQudGV4dCwgbWVudTogIm11bHRpcGxlQm90IiwgYm90czogdGFncy50YXJnZXRCb3RzfSk7YDsKdGFncy5mb3JtID0gImlucHV0IjsKCmlmICghYXV0aEJvdCkKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiIChsaW1pdGVkKSI7Cn0KZWxzZSBpZiAoYXV0aEJvdC50YWdzLnN1YnNjcmlwdGlvblRpZXIgPT0gIkZyZWVQbGF5IikKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiIChsaW1pdGVkKSI7Cn0KZWxzZQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eTsKfScA7beivQPTVRJwcm9tcHRfbXVsdGlwbGVCb3QCBADtt6K9A4r5ApUmVGhlIGZvbGxvd2luZyBpcyBhIGNvbnZlcnNhdGlvbiB3aXRoIGFiLiBhYiBpcyBhIGhlbHBmdWwsIGNsZXZlciwgYW5kIGNhcGFibGUgQUkuIGFiIHdpbGwgcmVzcG9uZCB3aXRoIHRoZSBjb3JyZWN0IGphdmFzY3JpcHQgaW1wbGVtZW50YXRpb24gKGNvZGUpIG9mIHRoZSByZXF1ZXN0ZWQgYWN0aW9uLgoKSGVyZSBpcyBhIGJyaWVmIGxpc3Qgb2YgdGhpbmdzIGFiIGNhbiBkbzoKLSBDcmVhdGUgYm90cwotIE1vZCBib3RzCgpCb3RzIGFyZSBhIGNvbGxlY3Rpb24gb2YgdGFncywgYW5kIHRoZXkgY2FuIGJlIGNyZWF0ZWQgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uLgpUaGUgY3JlYXRlKCkgZnVuY3Rpb24gaXMgdXNlZCB0byBjcmVhdGUgb25lIG9yIG11bHRpcGxlIGJvdHMgb2JqZWN0cy4KY3JlYXRlKCkgcmV0dXJucyBhIGJvdCBvYmplY3Q7IGl0IGRvZXMgbm90IG5lZWQgdG8gYmUgc3RvcmVkIGluIGEgdmFyaWFibGUgb3IgY29uc3QuIAoKSGVyZSBpcyBhbiBleGFtcGxlIG9mIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbiB0byBtYWtlIGEgcmVkIGJvdCBpbiB0aGUgaG9tZSBkaW1lbnNpb246CmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIGNvbG9yOiAicmVkIiwKICAgIGZvcm06ICJjdWJlIgp9KTsKYGBgCgpBcyB5b3UgY2FuIHNlZSwgdGhlIGV4YW1wbGUgYWJvdmUgY3JlYXRlcyBhIGJvdCB3aXRoIHRoZSBgaG9tZWAgdGFnIHNldCB0byBgdHJ1ZWAgYW5kIHRoZSBgY29sb3JgIHRhZyBzZXQgdG8gYHJlZGAuClVubGVzcyBzcGVjaWZpZWQgb3RoZXJ3aXNlLCBhYiBzaG91bGQgY3JlYXRlIGJvdHMgd2l0aCB0aGUgYGhvbWVgIHRhZyBzZXQgdG8gYHRydWVgLgoKSGVyZSBpcyBhbiBleGFtcGxlIG9mIHVzaW5nIHRoZSBhcHBseU1vZCgpIGZ1bmN0aW9uIHRvIGNoYW5nZSBhIGJvdCB0byBoYXZlIGEgYmx1ZSBjb2xvciB0YWcgdXNpbmcgdGhlIGJvdCBJRCB0byBpZGVudGlmeSBpdDoKYGBgCmFwcGx5TW9kKGdldEJvdCgiaWQiLCAiOTMxYWE1ODctMGNhOS00ZmRkLWI3NmQtM2QzNzZiYzZhOGI1IiksIHsKICAgICJjb2xvciI6ICJyZWQiCn0pOwpgYGAKCkFzIHlvdSBjYW4gc2VlLCB0aGUgZXhhbXBsZSBhYm92ZSBjaGFuZ2VzIGEgYm90IHdpdGggYW4gaWQgb2YgYDkzMWFhNTg3LTBjYTktNGZkZC1iNzZkLTNkMzc2YmM2YThiNWAgdG8gaGF2ZSBhIHRhZyBgY29sb3JgIHRvIGhhdmUgdGhlIHZhbHVlIG9mIGBibHVlYC4KCgpEaW1lbnNpb25zIGFyZSB0YWdzIHdoaWNoIGVuZCB1cCBiZWluZyB2aXN1YWxpemVkIGluIDNEIHNwYWNlLiBJbiBhZGRpdGlvbiB0byBiZWluZyBhIHRhZywgYGhvbWVgIGlzIGFsc28gYSBkaW1lbnNpb24uCllvdSBjYW4gY29udHJvbCB0aGUgcG9zaXRpb24gdGhhdCBhIGJvdCBpcyByZW5kZXJlZCBhdCBieSB1c2luZyB0aGUgYHtkaW1lbnNpb259UG9zaXRpb25gIHRhZywgd2hlcmUgYHtkaW1lbnNpb259YCBpcyByZXBsYWNlZCB3aXRoIHRoZSBuYW1lIG9mIHRoZSBkaW1lbnNpb24uCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIGJvdCBhdCBwb3NpdGlvbiAoMywgMikgaW4gdGhlIGhvbWUgZGltZW5zaW9uOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBob21lUG9zaXRpb246ICfinqHvuI8zLDEnCn0pOwpgYGAKCkxpc3RlbmVycyBhcmUgdGFncyB3aGljaCBjb250YWluIEphdmFTY3JpcHQgYW5kIHJlc3BvbmQgdG8gY2VydGFpbiBldmVudHMuIFRoZXkgd29yayBsaWtlIG5vcm1hbCB0YWdzLCBleGNlcHQgdGhleSBuZWVkIHRvIGhhdmUgYSBgQGAgc3ltYm9sIGF0IHRoZSBzdGFydCBvZiB0aGUgdGFnIHZhbHVlLgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSBib3Qgd2l0aCBhIGBvbkNsaWNrYCBsaXN0ZW5lcjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgb25DbGljazogYEBvcy50b2FzdCgiSGVsbG8sIHdvcmxkISIpO2AKfSk7CmBgYAoKRm9yIGV4YW1wbGUgaWYgYXNrZWQgZm9yIGEgcHJvY2VkdXJhbCBmb3Jlc3QgdGhlIGNvZGUgcmV0dXJuZWQgd291bGQgYmUgc29tZXRoaW5nIGxpa2UgdGhpczoKCmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIG9uQ2xpY2s6IGBAewogICAgICAgIGNvbnN0IGVsZW1lbnRzID0gWyd0cmVlJywgJ2J1c2gnLCAnZmxvd2VyJywgJ3JvY2snLCAncmFiYml0JywgJ2ZveCcsICd3YXRlciddOwogICAgICAgIGNvbnN0IGNvbG9ycyA9IFsnZ3JlZW4nLCAnZGFya2dyZWVuJywgJ2dvbGQnLCAnZ3JheScsICdicm93bicsICdvcmFuZ2UnLCAnYmx1ZSddOwogICAgICAgIGNvbnN0IGludGVyYWN0aW9uU291bmRzID0gWyd3aW5kIGluIHRoZSBicmFuY2hlcycsICdydXN0bGluZyBsZWF2ZXMnLCAnY3JpY2tldCBjaGlycGluZycsICdyYWluIHBhdHRlcmluZycsICd0aHVtcGluZycsICd5aXBwaW5nJywgJ3NwbGFzaGluZyddOwogICAgICAgIGNvbnN0IHNjYWxlc1ggPSBbMC45LCAxLjIsIDAuMSwgMSwgMC4yNSwgMC4zLCAxXTsKICAgICAgICBjb25zdCBzY2FsZXNZID0gWzAuOSwgMS4yLCAwLjEsIDEsIDAuNCwgMC43LCAxXTsKICAgICAgICBjb25zdCBzY2FsZXNaID0gWzMsIDAuNzUsIDAuMiwgMC41LCAwLjUsIDAuNiwgMC4wMV07CiAgICAgICAgCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDA7IGkrKykgCiAgICAgICAgewogICAgICAgICAgICBsZXQgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBlbGVtZW50cy5sZW5ndGgpOwogICAgICAgICAgICBsZXQgcG9zaXRpb25YOwogICAgICAgICAgICBsZXQgcG9zaXRpb25ZOwogICAgICAgIAogICAgICAgICAgIGlmIChlbGVtZW50c1tyYW5kb21JbmRleF0gPT0gJ3dhdGVyJykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKGdldEJvdCgnbGFiZWwnLCAnd2F0ZXInKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBsZXQgcG9zc2libGVXYXRlckNvbm5lY3Rpb25zID0gZ2V0Qm90cygnbGFiZWwnLCAnd2F0ZXInKTsKICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZlV2F0ZXJCb3QgPSBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcG9zc2libGVXYXRlckNvbm5lY3Rpb25zLmxlbmd0aCldOwogICAgICAgICAgICAgICAgICAgIGxldCBjb2luRmxpcCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oMCwxKSk7CiAgICAgICAgICAgICAgICAgICAgbGV0IHJhbmRvbURpcmVjdGlvbiA9IE1hdGgucmFuZG9tKCkgPCAwLjUgPyAtMSA6IDE7CiAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgKGNvaW5GbGlwKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWDsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWSArIHJhbmRvbURpcmVjdGlvbjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWCArIHJhbmRvbURpcmVjdGlvbjsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcG9zaXRpb25YID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICAgICAgY3JlYXRlKHsKICAgICAgICAgICAgICAgIGhvbWU6IHRydWUsCiAgICAgICAgICAgICAgICBob21lUG9zaXRpb246ICfinqHvuI8nICsgcG9zaXRpb25YICsgJywnICsgcG9zaXRpb25ZLAogICAgICAgICAgICAgICAgdGlwTGFiZWw6IGVsZW1lbnRzW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIG9uUG9pbnRlckVudGVyOiAiQCBvcy50aXAodGFncy50aXBMYWJlbCkiOwogICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yc1tyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVg6IHNjYWxlc1hbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVZOiBzY2FsZXNZW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWjogc2NhbGVzWltyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBvbkNsaWNrOiAiQCBvcy50aXAoJ1lvdSBoZWFyICIgKyBpbnRlcmFjdGlvblNvdW5kc1tyYW5kb21JbmRleF0gKyAiJyk7IgogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9YAp9KTsKYGBgCgpQbGVhc2UgcmV0dXJuIG9ubHkgdGhlIGZ1bmN0aW9uIHdpdGggdGhlIGNvZGUgYXMgYSByZXNwb25zZSwgYW5kIGZvciB0aGlzIHNwZWNpZmljIHVzZSBjYXNlIG9ubHkgcmV0dXJuIGEgbW9kIHVzaW5nIHRoZSBnaXZlbiBib3RzIGlkIHRvIGNoYW5nZSBpdCB0aGUgd2F5IHlvdSd2ZSBiZWVuIGFza2VkLicA7beivQPTVRphYk11bHRpcGxlQm90TWVudVNvcnRPcmRlcgIEAO23or0DmJ8DAzEwMScA7beivQPTVQlhYlZlcnNpb24CBADtt6K9A5yfAxQ5LjY1LjEuMTcyOTc3OTA4NTUwMCcBBGJvdHMkZjlmZDdlMmUtN2NjZS00M2ZiLWIyMjMtZDMyY2I0MmJlYmU4AScA7beivQOxnwMGc3lzdGVtAgQA7beivQOynwMTYWIuYWN0aW9uLmNvbG9yX2JvdCcA7beivQOxnwMEZm9ybQIEAO23or0Dxp8DB25vdGhpbmcnAO23or0DsZ8DCGFiQWN0aW9uAgQA7beivQPOnwMEdHJ1ZScA7beivQOxnwMPYWJCb3RNZW51QWN0aW9uAgQA7beivQPTnwOOAUBjb25zdCB0YXJnZXRCb3QgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYkJvdEZvY3VzOwoKb3Muc2hvd0lucHV0Rm9yVGFnKHRhcmdldEJvdCwgImNvbG9yIiwgewogICAgdHlwZTogJ2NvbG9yJywKICAgIHRpdGxlOiAncGljayBhIGNvbG9yJwp9KTsnAO23or0DsZ8DDmFiQm90TWVudUxhYmVsAgQA7beivQPioAMFY29sb3InAO23or0DsZ8DDWFiQm90TWVudUljb24CBADtt6K9A+igAwdwYWxldHRlJwDtt6K9A7GfAwhyZW1lbWJlcgIEAO23or0D8KADKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAO23or0DsZ8DEmFiQm90TWVudVNvcnRPcmRlcgIEAO23or0Dl6EDATInAO23or0DsZ8DCGFiSWdub3JlAgQA7beivQOZoQMEdHJ1ZScA7beivQOxnwMXYWJNdWx0aXBsZUJvdE1lbnVBY3Rpb24CBADtt6K9A56hA9sDQGNvbnN0IGFsbFRhcmdldEJvdHMgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXM7CmNvbnN0IGJ1aWxkZXIgPSBhYi5saW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90ID8gYWIubGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdC5pZCA6IG51bGw7CmNvbnN0IHJlbGV2YW50VGFyZ2V0Qm90cyA9IGFsbFRhcmdldEJvdHMuZmlsdGVyKCh0YXJnZXQpID0+IHRhcmdldC5pZCAhPSBidWlsZGVyKTsKY29uc3Qgc2VsZWN0ZWRDb2xvciA9IGF3YWl0IG9zLnNob3dJbnB1dChudWxsLCB7CiAgICB0eXBlOiAnY29sb3InLAogICAgdGl0bGU6ICdwaWNrIGEgY29sb3InCn0pOwoKc2V0VGFnKHJlbGV2YW50VGFyZ2V0Qm90cywgImNvbG9yIiwgc2VsZWN0ZWRDb2xvcik7CgphYi5sb2coYWJSZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogb3BlbmVkIG11bHRpcGxlIHNlbGVjdCBzaGVldCIpOycA7beivQOxnwMVYWJNdWx0aXBsZUJvdE1lbnVJY29uAgQA7beivQP6pAMHcGFsZXR0ZScA7beivQOxnwMWYWJNdWx0aXBsZUJvdE1lbnVMYWJlbAIEAO23or0DgqUDBWNvbG9yJwDtt6K9A7GfAxphYk11bHRpcGxlQm90TWVudVNvcnRPcmRlcgIEAO23or0DiKUDATEnAO23or0DsZ8DCWFiVmVyc2lvbgIEAO23or0DiqUDFDkuNjUuMS4xNzI5Nzc5MDg1NTAwAA=="}]}