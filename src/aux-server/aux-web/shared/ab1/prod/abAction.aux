{"version":2,"updates":[{"id":0,"timestamp":1724857166544,"update":"Aa8C9badsgcAJwEEYm90cyQzOTg4MDFmZS00YjM1LTRjZTQtODI2Zi0yMzgzNWMxYjlhYzUBJwD1tp2yBwAGc3lzdGVtAgQA9badsgcBFGFiLmFjdGlvbi5jcmVhdGVfYm90JwD1tp2yBwAIYWJBY3Rpb24CBAD1tp2yBxYEdHJ1ZScA9badsgcABGZvcm0CBAD1tp2yBxsHbm90aGluZycA9badsgcAC2Rlc2NyaXB0aW9uAgQA9badsgcjDUNyZWF0ZXMgYm90cy4nAPW2nbIHABBhYkdyaWRNZW51QWN0aW9uAgQA9badsgcxqwVAY29uc3QgZ3JpZEluZm9ybWF0aW9uID0gbGlua3MucmVtZW1iZXIudGFncy5hYkdyaWRGb2N1czsKY29uc3QgbmV3Qm90ID0ge307CgpuZXdCb3QuY3JlYXRvciA9IG51bGw7Cm5ld0JvdFtncmlkSW5mb3JtYXRpb24uZGltZW5zaW9uXSA9IHRydWU7Cm5ld0JvdFtncmlkSW5mb3JtYXRpb24uZGltZW5zaW9uICsgIlgiXSA9IGdyaWRJbmZvcm1hdGlvbi5wb3NpdGlvbi54OwpuZXdCb3RbZ3JpZEluZm9ybWF0aW9uLmRpbWVuc2lvbiArICJZIl0gPSBncmlkSW5mb3JtYXRpb24ucG9zaXRpb24ueTsKbmV3Qm90LmNvbG9yID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKCmxldCBjcmVhdGVkQm90ID0gY3JlYXRlKG5ld0JvdCk7CgpzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90Lm1hc2tzLmxpbmVDb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3I7CmxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QubWFza3MubGluZVRvID0gY3JlYXRlZEJvdC5pZDsKCmxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiQm90Rm9jdXMgPSAi8J+UlyIgKyBjcmVhdGVkQm90LmlkOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKHttZW51OiAiYm90In0pOycA9badsgcAD2FiR3JpZE1lbnVMYWJlbAIEAPW2nbIH2wUDYm90JwD1tp2yBwAOYWJHcmlkTWVudUljb24CBAD1tp2yB98FB2FkZF9ib3gnAPW2nbIHAAhyZW1lbWJlcgIEAPW2nbIH5wUo8J+Ul2U1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNycA9badsgcADW1hbmlmZXN0YXRpb24CBAD1tp2yB44GKPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAPW2nbIHAAhhYklnbm9yZQIEAPW2nbIHtQYEdHJ1ZScA9badsgcAE2FiR3JpZE1lbnVTb3J0T3JkZXICBAD1tp2yB7oGATEnAPW2nbIHAAlhYlZlcnNpb24CBAD1tp2yB7wGFDkuNjUuMS4xNzI0ODU3MTY2NTQwJwEEYm90cyQ1ODQ5YWY1NS01ZThhLTQ4ZDYtOTEwNi0xOTk0OThlOWVjMDgBJwD1tp2yB9EGBnN5c3RlbQIEAPW2nbIH0gYRYWIuYWN0aW9uLmRlc3Ryb3knAPW2nbIH0QYIYWJBY3Rpb24CBAD1tp2yB+QGBHRydWUnAPW2nbIH0QYEZm9ybQIEAPW2nbIH6QYHbm90aGluZycA9badsgfRBg9hYkJvdE1lbnVBY3Rpb24CBAD1tp2yB/EGgQFAY29uc3QgdGFyZ2V0Qm90ID0gbGlua3MucmVtZW1iZXIubGlua3MuYWJCb3RGb2N1czsKCmRlc3Ryb3kodGFyZ2V0Qm90KTsKCnNob3V0KCJhYk1lbnVSZWZyZXNoIik7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soKTsnAPW2nbIH0QYOYWJCb3RNZW51TGFiZWwCBAD1tp2yB/MHB2Rlc3Ryb3knAPW2nbIH0QYNYWJCb3RNZW51SWNvbgIEAPW2nbIH+wcOZGVsZXRlX2ZvcmV2ZXInAPW2nbIH0QYSYWJCb3RNZW51U29ydE9yZGVyAgQA9badsgeKCAMxMDAnAPW2nbIH0QYIcmVtZW1iZXICBAD1tp2yB44IKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAPW2nbIH0QYNbWFuaWZlc3RhdGlvbgIEAPW2nbIHtQgo8J+Ul2RjYTVkOTg3LWM0ZDgtNDZlNC1iNjBjLWRhYTdiMmY0ZGRhZCcA9badsgfRBghhYklnbm9yZQIEAPW2nbIH3AgEdHJ1ZScA9badsgfRBg5hYkJvdE1lbnVDb2xvcgIEAPW2nbIH4QgHI0Q5MzAzMCcA9badsgfRBhdhYk11bHRpcGxlQm90TWVudUFjdGlvbgIEAPW2nbIH6QjMAkBjb25zdCBhbGxUYXJnZXRCb3RzID0gbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzOwpjb25zdCBidWlsZGVyID0gYWIubGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdCA/IGFiLmxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QuaWQgOiBudWxsOwpjb25zdCByZWxldmFudFRhcmdldEJvdHMgPSBhbGxUYXJnZXRCb3RzLmZpbHRlcigodGFyZ2V0KSA9PiB0YXJnZXQuaWQgIT0gYnVpbGRlcik7CgpkZXN0cm95KHJlbGV2YW50VGFyZ2V0Qm90cyk7CgpzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7JwD1tp2yB9EGFWFiTXVsdGlwbGVCb3RNZW51SWNvbgIEAPW2nbIHtgsOZGVsZXRlX2ZvcmV2ZXInAPW2nbIH0QYWYWJNdWx0aXBsZUJvdE1lbnVMYWJlbAIEAPW2nbIHxQsHZGVzdHJveScA9badsgfRBhphYk11bHRpcGxlQm90TWVudVNvcnRPcmRlcgIEAPW2nbIHzQsDMTAwJwD1tp2yB9EGFmFiTXVsdGlwbGVCb3RNZW51Q29sb3ICBAD1tp2yB9ELByNEOTMwMzAnAPW2nbIH0QYJYWJWZXJzaW9uAgQA9badsgfZCxQ5LjY1LjEuMTcyNDg1NzE2NjU0MCcBBGJvdHMkNzE3NTY0NWMtNGI1My00NDU0LTg3MTYtZmMwZTY4ZGIyNjY1AScA9badsgfuCwZzeXN0ZW0CBAD1tp2yB+8LD2FiLmFjdGlvbi5sb2dpbicA9badsgfuCwhhYkFjdGlvbgIEAPW2nbIH/wsEdHJ1ZScA9badsgfuCwhhYklnbm9yZQIEAPW2nbIHhAwEdHJ1ZScA9badsgfuCwRmb3JtAgQA9badsgeJDAdub3RoaW5nJwD1tp2yB+4LD2FiQ29yZU1lbnVDb2xvcgIEAPW2nbIHkQwHI0YyQjcwNScA9badsgfuCxNhYkNvcmVNZW51U29ydE9yZGVyAgQA9badsgeZDAItNScA9badsgfuCxBhYkNvcmVNZW51QWN0aW9uAgQA9badsgecDCxAb3MuZ29Ub1VSTChsaW5rcy5yZW1lbWJlci50YWdzLmFiQXV0aFNpdGUpOycA9badsgfuCxRhYkNvcmVNZW51T25HZW5lcmF0ZQIEAPW2nbIHyQydAkBhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdEluQmFja2dyb3VuZCgpOwoKaWYgKCFsaW5rcy5yZW1lbWJlci50YWdzLmFiQXV0aFNpdGUpCnsKICAgIGRlc3Ryb3kodGhpc0JvdCk7Cn0KCnRhZ3MubGFiZWwgPSAiYnV5ICIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5OwoKaWYgKCFhdXRoQm90KQp7CiAgICByZXR1cm47Cn0KZWxzZSBpZiAoYXV0aEJvdC50YWdzLnN1YnNjcmlwdGlvblRpZXIgPT0gIkZyZWVQbGF5IikKewogICAgcmV0dXJuOwp9CgpkZXN0cm95KHRoaXNCb3QpOycA9badsgfuCw5hYkNvcmVNZW51SWNvbgIEAPW2nbIH5w4OYWNjb3VudF9jaXJjbGUnAPW2nbIH7gsIcmVtZW1iZXICBAD1tp2yB/YOKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAPW2nbIH7gsJYWJWZXJzaW9uAgQA9badsgedDxQ5LjY1LjEuMTcyNDg1NzE2NjU0MCcBBGJvdHMkYjMzOWMxMTgtNDg5YS00NjZiLWJhOWYtYjA3YTVmOWI2NjRmAScA9badsgeyDwZzeXN0ZW0CBAD1tp2yB7MPD2FiLmFjdGlvbi5wYXN0ZSgA9badsgeyDwhhYkFjdGlvbgF4JwD1tp2yB7IPBGZvcm0CBAD1tp2yB8QPB25vdGhpbmcnAPW2nbIHsg8LZGVzY3JpcHRpb24CBAD1tp2yB8wPK2FiIHNraWxsIHVzZWQgZm9yIGNvcHlpbmcgYW5kIHBhc3RpbmcgYm90cy4nAPW2nbIHsg8Hb25QYXN0ZQIEAPW2nbIH+A/iB0BpZiAoIWJ1aWxkZXJWZXJzaW9uKQp7CiAgICByZXR1cm47Cn0KCmNvbnN0IE1BQ1JPUyA9IFsKICAgIHsKICAgICAgICB0ZXN0OiAvKD86W+KAnOKAnV0pL2csCiAgICAgICAgcmVwbGFjZW1lbnQ6ICh2YWwpID0+ICciJywKICAgIH0sCiAgICB7CiAgICAgICAgdGVzdDogLyg/OlvigJjigJldKS9nLAogICAgICAgIHJlcGxhY2VtZW50OiAodmFsKSA9PiAiJyIsCiAgICB9LApdOwoKbGV0IGZvcm1hdHRlZENvcHkgPSByZXBsYWNlTWFjcm9zKHRoYXQudGV4dCk7CmxldCBjb3B5Qm90ID0gSlNPTi5wYXJzZShmb3JtYXR0ZWRDb3B5KTsKbGV0IHBhc3RlZERhdGEgPSAhY29weUJvdC5zdGF0ZSA/IHtbY29weUJvdC5pZF06IGNvcHlCb3R9IDogY29weUJvdC5zdGF0ZTsKbGV0IGRpbU1vZCA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJGb2N1c0RhdGE7CgppZiAoT2JqZWN0LmtleXMocGFzdGVkRGF0YSkubGVuZ3RoID09IDEgJiYgZGltTW9kKQp7CiAgICBwYXN0ZWREYXRhW2RpbU1vZC5kaW1lbnNpb25dID0gdHJ1ZTsKICAgIHBhc3RlZERhdGFbZGltTW9kLmRpbWVuc2lvbisiWCJdID0gZGltTW9kLng7CiAgICBwYXN0ZWREYXRhW2RpbU1vZC5kaW1lbnNpb24rIlkiXSA9IGRpbU1vZC55OwoKICAgIG9zLnRvYXN0KCJib3QgYWRkZWQgdG8gaW5zdCIpOwp9CmVsc2UKewogICAgb3MudG9hc3QoImJvdHMgYWRkZWQgdG8gaW5zdCIpOwp9CgphYi5sb2coYWJSZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogcGFzdGVkIGRhdGEiKTsKCmxpbmtzLmNyZWF0ZS5hYkNyZWF0ZUJvdHMoe2JvdHM6IHBhc3RlZERhdGF9KTsKCmZ1bmN0aW9uIHJlcGxhY2VNYWNyb3ModGV4dCkgewogICAgaWYgKCF0ZXh0KSB7CiAgICAgICAgcmV0dXJuIHRleHQ7CiAgICB9CgogICAgZm9yIChsZXQgbSBvZiBNQUNST1MpIHsKICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKG0udGVzdCwgbS5yZXBsYWNlbWVudCk7CiAgICB9CgogICAgcmV0dXJuIHRleHQ7Cn0nAPW2nbIHsg8IcmVtZW1iZXICBAD1tp2yB9MXKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAPW2nbIHsg8GY3JlYXRlAgQA9badsgf6Fyjwn5SXMzRjM2MyMTAtNWJmMS00OWNmLWIxNTEtZWUyZDA3ZjBlNjczJwD1tp2yB7IPCGFiSWdub3JlAgQA9badsgehGAR0cnVlJwD1tp2yB7IPCW9uS2V5RG93bgIEAPW2nbIHphisCUBpZiAoIWJ1aWxkZXJWZXJzaW9uIHx8ICghbGlua3MucmVtZW1iZXIubGlua3MuYWJCb3RGb2N1cyAmJiAhbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzKSkKewogICAgcmV0dXJuOwp9CgppZiAodGhhdC5rZXlzID09ICJjIikKewogICAgbGV0IG1ldGFJbnB1dCA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIk1ldGEiKTsKCiAgICBpZiAoIW1ldGFJbnB1dCkKICAgIHsKICAgICAgICBtZXRhSW5wdXQgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJDb250cm9sIik7CiAgICB9CiAgICAKICAgIGlmICghbWV0YUlucHV0KQogICAgewogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBsZXQgZm9ybWF0dGVkRmlsZTsKICAgIGxldCBzdGF0ZSA9IHt9OwoKICAgIGlmIChsaW5rcy5yZW1lbWJlci5saW5rcy5hYkJvdEZvY3VzKQogICAgewogICAgICAgIGxldCBzZWxlY3RlZEJvdCA9IGxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiQm90Rm9jdXM7CgogICAgICAgIHN0YXRlW3NlbGVjdGVkQm90LmlkXSA9IHNlbGVjdGVkQm90OwoKICAgICAgICBhYi5sb2coYWJSZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogY29waWVkIGEgYm90IHRvIGNsaXBib2FyZCIpOwogICAgfQogICAgZWxzZSBpZiAobGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzKQogICAgewogICAgICAgIGxldCBzZWxlY3RlZEJvdHMgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXM7CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0ZWRCb3RzLmxlbmd0aDsgaSsrKQogICAgICAgIHsKICAgICAgICAgICAgc3RhdGVbc2VsZWN0ZWRCb3RzW2ldLmlkXSA9IHNlbGVjdGVkQm90c1tpXTsKICAgICAgICB9CgogICAgICAgIGFiLmxvZyhhYlJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiBjb3BpZWQgbXVsdGlwbGUgYm90cyB0byBjbGlwYm9hcmQiKTsKICAgIH0KCiAgICBsZXQgbmV3RmlsZSA9IHt9OwogICAgbmV3RmlsZS52ZXJzaW9uID0gMTsKICAgIG5ld0ZpbGUuc3RhdGUgPSBzdGF0ZTsKCiAgICBmb3JtYXR0ZWRGaWxlID0gSlNPTi5zdHJpbmdpZnkobmV3RmlsZSk7CgogICAgb3Muc2V0Q2xpcGJvYXJkKGZvcm1hdHRlZEZpbGUpOwoKICAgIG9zLnRvYXN0KCJib3QgY29waWVkIHRvIGNsaXBib2FyZCIpOwp9JwD1tp2yB7IPCWFiVmVyc2lvbgIEAPW2nbIH0yEUOS42NS4xLjE3MjQ4NTcxNjY1NDAnAQRib3RzJGJkYWJkNmMwLTg5ZjktNGY3NS1iMzVjLTI2ZjRlYzUyMDdkNgEnAPW2nbIH6CEGc3lzdGVtAgQA9badsgfpIRBhYi5hY3Rpb24ucmVwb3J0JwD1tp2yB+ghBGZvcm0CBAD1tp2yB/ohB25vdGhpbmcnAPW2nbIH6CEQYWJDb3JlTWVudUFjdGlvbgIEAPW2nbIHgiIRQG9zLnJlcG9ydEluc3QoKTsnAPW2nbIH6CETYWJDb3JlTWVudVNvcnRPcmRlcgIEAPW2nbIHlCIDMTAxJwD1tp2yB+ghDmFiQ29yZU1lbnVJY29uAgQA9badsgeYIgRmbGFnJwD1tp2yB+ghD2FiQ29yZU1lbnVMYWJlbAIEAPW2nbIHnSIGcmVwb3J0JwD1tp2yB+ghCGFiQWN0aW9uAgQA9badsgekIgR0cnVlJwD1tp2yB+ghCGFiSWdub3JlAgQA9badsgepIgR0cnVlJwD1tp2yB+ghFGFiQ29yZU1lbnVPbkdlbmVyYXRlAgQA9badsgeuIkZAaWYgKGNvbmZpZ0JvdC50YWdzLnN0YXRpY0luc3QgIT0gdW5kZWZpbmVkKQp7CiAgICBkZXN0cm95KHRoaXNCb3QpOwp9JwD1tp2yB+ghCWFiVmVyc2lvbgIEAPW2nbIH9SIUOS42NS4xLjE3MjQ4NTcxNjY1NDAnAQRib3RzJGM2OGM1YjgyLWMwYTctNGE1YS05MTA0LTVkZDhlMzJhZTRlMgEnAPW2nbIHiiMGc3lzdGVtAgQA9badsgeLIxBhYi5hY3Rpb24ucG9ydGFsJwD1tp2yB4ojC2Rlc2NyaXB0aW9uAgQA9badsgecIxRTa2lsbCB0byBvcGVuIHNoZWV0LicA9badsgeKIwhhYkFjdGlvbgIEAPW2nbIHsSMEdHJ1ZScA9badsgeKIwRmb3JtAgQA9badsge2Iwdub3RoaW5nJwD1tp2yB4ojEGFiQ29yZU1lbnVBY3Rpb24CBAD1tp2yB74jhxxAc2hvdXQoImFiUG9ydGFsTWVudVJlZnJlc2giKTsKCmNvbnN0IGFjdGl2ZU1lbnUgPSBjb25maWdCb3QudGFncy5tZW51UG9ydGFsOwpjb25zdCBhY3RpdmVEaW1lbnNpb24gPSB0aGF0LmJvdC50YWdzLmN1cnJlbnREaW1lbnNpb247CmNvbnN0IGFjdGl2ZVBvcnRhbCA9IHRoYXQuYm90LnRhZ3MuY3VycmVudFBvcnRhbDsKCi8vIHRoYXQuYm90Lm1hc2tzW2FjdGl2ZU1lbnVdID0gZmFsc2U7CnRoYXQuYm90Lm1hc2tzLmFiUG9ydGFsTWVudVJlZnJlc2ggPSAiQCBjbGVhclRhZ01hc2tzKHRoaXNCb3QpOyI7CnRoYXQuYm90Lm1hc2tzLmZvcm1BZGRyZXNzID0gImFycm93X2Ryb3BfZG93biI7CnRoYXQuYm90Lm1hc2tzLm9uQ2xpY2sgPSBgQCBzaG91dCgiYWJQb3J0YWxNZW51UmVmcmVzaCIpO2A7CnRoYXQuYm90Lm1hc2tzLm1lbnVJdGVtU3R5bGUgPSB7ImJvcmRlci1yYWRpdXMiOiI4cHggOHB4IDAgMCIsICJtYXJnaW4tdG9wIjoiM3B4In07Cgpjb25zdCBtZW51Qm90ID0ge307CgptZW51Qm90LnNwYWNlID0gInRlbXBMb2NhbCI7Cm1lbnVCb3QuZGltZW5zaW9uID0gYWN0aXZlTWVudTsKbWVudUJvdFthY3RpdmVNZW51XSA9IHRydWU7Cm1lbnVCb3QuYWJQb3J0YWxNZW51UmVmcmVzaCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKbWVudUJvdC5hYk1lbnVSZWZyZXNoID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwptZW51Qm90Lm9uS2V5RG93biA9IGBAIGlmKHRoYXQua2V5cyA9PSAiU2hpZnQiKXttYXNrcy5sYWJlbCA9IHRhZ3MubGFiZWwgKyAiIGluIG5ldyB0YWIiO31gOwptZW51Qm90Lm9uS2V5VXAgPSBgQCBpZih0aGF0LmtleXMgPT0gIlNoaWZ0Iil7bWFza3MubGFiZWwgPSBudWxsO31gOwptZW51Qm90Lm1hbmFnZXIgPSBnZXRMaW5rKHRoYXQuYm90KTsKbWVudUJvdC5za2lsbEJvdCA9IGdldExpbmsodGhpc0JvdCk7CgptZW51Qm90LmxhYmVsID0gIm1hcCI7Cm1lbnVCb3QuZm9ybUFkZHJlc3MgPSAicHVibGljIjsKbWVudUJvdC5vbkNsaWNrID0gYEAgc2hvdXQoImFiUG9ydGFsTWVudVJlZnJlc2giKTsKCmNvbnN0IHN0YXRlID0gb3MuZ2V0SW5wdXRTdGF0ZSgia2V5Ym9hcmQiLCAiU2hpZnQiKTsKCmlmKHN0YXRlKQp7CiAgICBvcy5vcGVuVVJMKGNvbmZpZ0JvdC50YWdzLnBlcm1hbGluayArICImbWFwUG9ydGFsPSR7YWN0aXZlRGltZW5zaW9uID09ICJibHVlcHJpbnQiID8gImhvbWUiIDogYWN0aXZlRGltZW5zaW9ufSIpOwp9IAplbHNlCnsKICAgIGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA9ICIke2FjdGl2ZURpbWVuc2lvbiA9PSAiYmx1ZXByaW50IiA/ICJob21lIiA6IGFjdGl2ZURpbWVuc2lvbn0iOzsKfWA7Cm1lbnVCb3RbYWN0aXZlTWVudSArICJTb3J0T3JkZXIiXSA9IDAuMjsKbWVudUJvdC5tZW51SXRlbVN0eWxlID0geyJib3JkZXItcmFkaXVzIjoiMCIsICJtYXJnaW4tdG9wIjoiMHB4In07CgppZiAoYWN0aXZlUG9ydGFsICE9ICJtYXAiKQp7CiAgICAvL21hcCBwb3J0YWwgYnV0dG9uCiAgICBsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihtZW51Qm90KTsKfQoKbWVudUJvdC5sYWJlbCA9ICJncmlkIjsKbWVudUJvdC5mb3JtQWRkcmVzcyA9ICJjdWJlIjsKbWVudUJvdC5vbkNsaWNrID0gYEAgc2hvdXQoImFiUG9ydGFsTWVudVJlZnJlc2giKTsgCgpjb25zdCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7CgppZihzdGF0ZSkKewogICAgb3Mub3BlblVSTChjb25maWdCb3QudGFncy5wZXJtYWxpbmsgKyAiJmdyaWRQb3J0YWw9JHthY3RpdmVEaW1lbnNpb24gPT0gImJsdWVwcmludCIgPyAiaG9tZSIgOiBhY3RpdmVEaW1lbnNpb259Iik7Cn0gCmVsc2UKewogICAgY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbCA9ICIke2FjdGl2ZURpbWVuc2lvbiA9PSAiYmx1ZXByaW50IiA/ICJob21lIiA6IGFjdGl2ZURpbWVuc2lvbn0iOyBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgPSBudWxsOwp9YDsKbWVudUJvdFthY3RpdmVNZW51ICsgIlNvcnRPcmRlciJdID0gMC4yOwoKaWYgKGFjdGl2ZVBvcnRhbCAhPSAiZ3JpZCIgfHwgYWN0aXZlRGltZW5zaW9uID09ICJibHVlcHJpbnQiKQp7CiAgICAvL2dyaWQgcG9ydGFsIGJ1dHRvbgogICAgbGlua3MubWVudS5hYkNyZWF0ZU1lbnVCdXR0b24obWVudUJvdCk7Cn0KCm1lbnVCb3QubGFiZWwgPSAiYmx1ZXByaW50IjsKbWVudUJvdC5mb3JtQWRkcmVzcyA9ICJhcmNoaXRlY3R1cmUiOwptZW51Qm90Lm9uQ2xpY2sgPSBgQCBzaG91dCgiYWJQb3J0YWxNZW51UmVmcmVzaCIpOyAKCmNvbnN0IHN0YXRlID0gb3MuZ2V0SW5wdXRTdGF0ZSgia2V5Ym9hcmQiLCAiU2hpZnQiKTsKCmlmKHN0YXRlKQp7CiAgICBvcy5vcGVuVVJMKGNvbmZpZ0JvdC50YWdzLnBlcm1hbGluayArICImZ3JpZFBvcnRhbD1ibHVlcHJpbnQiKTsKfSAKZWxzZQp7CiAgICBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsID0gImJsdWVwcmludCI7IGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA9IG51bGw7Cn0KCmxpbmtzLnNraWxsQm90LmFiQmx1ZXByaW50KCk7YDsKbWVudUJvdFthY3RpdmVNZW51ICsgIlNvcnRPcmRlciJdID0gMC4zOwoKaWYgKGFjdGl2ZURpbWVuc2lvbiAhPSAiYmx1ZXByaW50IikKewogICAgLy9ibHVlcHJpbnQgcG9ydGFsIGJ1dHRvbgogICAgbGlua3MubWVudS5hYkNyZWF0ZU1lbnVCdXR0b24obWVudUJvdCk7Cn0KCm1lbnVCb3QubGFiZWwgPSAic2hlZXQiOwptZW51Qm90LmZvcm1BZGRyZXNzID0gInRhYmxlX3ZpZXciOwptZW51Qm90Lm9uQ2xpY2sgPSBgQCBzaG91dCgiYWJQb3J0YWxNZW51UmVmcmVzaCIpOwoKY29uc3Qgc3RhdGUgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJTaGlmdCIpOwoKaWYoc3RhdGUpCnsKICAgIG9zLm9wZW5VUkwoY29uZmlnQm90LnRhZ3MucGVybWFsaW5rICsgIiZzaGVldFBvcnRhbD0ke2FjdGl2ZURpbWVuc2lvbn0iKTsKfSAKZWxzZQp7IAogICAgY29uZmlnQm90LnRhZ3Muc2hlZXRQb3J0YWwgPSAiJHthY3RpdmVEaW1lbnNpb259IjsKfWA7Cm1lbnVCb3RbYWN0aXZlTWVudSArICJTb3J0T3JkZXIiXSA9IDAuMTsKCi8vc2hlZXQgcG9ydGFsIGJ1dHRvbgpsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihtZW51Qm90KTsKCm1lbnVCb3QubGFiZWwgPSAic3lzdGVtIjsKbWVudUJvdC5mb3JtQWRkcmVzcyA9ICJzZXR0aW5nc19hcHBsaWNhdGlvbnMiOwptZW51Qm90Lm9uQ2xpY2sgPSBgQCBzaG91dCgiYWJQb3J0YWxNZW51UmVmcmVzaCIpOwoKY29uc3Qgc3RhdGUgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJTaGlmdCIpOwoKaWYoc3RhdGUpCnsKICAgIG9zLm9wZW5VUkwoY29uZmlnQm90LnRhZ3MucGVybWFsaW5rICsgIiZzeXN0ZW1Qb3J0YWw9dHJ1ZSIpOwp9IAplbHNlCnsgCiAgICBjb25maWdCb3QudGFncy5zeXN0ZW1Qb3J0YWwgPSB0cnVlOwp9YDsKbWVudUJvdFthY3RpdmVNZW51ICsgIlNvcnRPcmRlciJdID0gMC40OwptZW51Qm90Lm1lbnVJdGVtU3R5bGUgPSB7ImJvcmRlci1yYWRpdXMiOiIwIDAgOHB4IDhweCJ9OwoKLy9zeXN0ZW0gcG9ydGFsIGJ1dHRvbgpsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihtZW51Qm90KTsnAPW2nbIHiiMIcmVtZW1iZXICBAD1tp2yB8Y/KPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAPW2nbIHiiMPYWJDb3JlTWVudUxhYmVsAgQA9badsgftPxBjdXJyZW50IHBvcnRhbDogJwD1tp2yB4ojD2FiQm90TWVudUFjdGlvbgIEAPW2nbIH/j/xAkBjb25zdCBjdXJyZW50SW5zdCA9IG9zLmdldEN1cnJlbnRJbnN0KCk7CmNvbnN0IGN1cnJlbnREaW0gPSBsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90LnRhZ3MubGluZVRvOwpjb25zdCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7CgppZiAoc3RhdGUpIAp7CiAgICBvcy5vcGVuVVJMKGNvbmZpZ0JvdC50YWdzLnBlcm1hbGluayArIGAmc2hlZXRQb3J0YWw9JHtjdXJyZW50RGltfWApOwp9CmVsc2UKewogICAgY29uZmlnQm90LnRhZ3Muc2hlZXRQb3J0YWwgPSBjdXJyZW50RGltOwp9CgphYi5sb2coYWJSZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogb3BlbmVkIGJvdCBzaGVldCIpOycA9badsgeKIw5hYkJvdE1lbnVMYWJlbAIEAPW2nbIH8EIOb3BlbiBib3Qgc2hlZXQnAPW2nbIHiiMNbWFuaWZlc3RhdGlvbgIEAPW2nbIH/0Io8J+Ul2RjYTVkOTg3LWM0ZDgtNDZlNC1iNjBjLWRhYTdiMmY0ZGRhZCcA9badsgeKIw1hYkJvdE1lbnVJY29uAgQA9badsgemQwp0YWJsZV92aWV3JwD1tp2yB4ojDmFiQ29yZU1lbnVJY29uAgQA9badsgexQwthcnJvd19yaWdodCcA9badsgeKIxJhYkJvdE1lbnVTb3J0T3JkZXICBAD1tp2yB71DATEnAPW2nbIHiiMIYWJJZ25vcmUCBAD1tp2yB79DBHRydWUnAPW2nbIHiiMXYWJNdWx0aXBsZUJvdE1lbnVBY3Rpb24CBAD1tp2yB8RDlARAY29uc3QgY3VycmVudEluc3QgPSBvcy5nZXRDdXJyZW50SW5zdCgpOwpjb25zdCBjdXJyZW50RGltID0gImFiTXVsdGlwbGVTZWxlY3QiOwoKY29uZmlnQm90LnRhZ3Muc2hlZXRQb3J0YWwgPSBjdXJyZW50RGltOwoKc2V0VGFnTWFzayhsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXMsIGN1cnJlbnREaW0sIHRydWUsICJ0ZW1wTG9jYWwiKTsKCm1hc2tzLmN1cnJlbnRTaGVldEJvdHMgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiTXVsdGlwbGVCb3RGb2N1czsKbWFza3Mub25Qb3J0YWxDaGFuZ2VkID0gYEAgaWYgKHRoYXQuZGltZW5zaW9uICE9ICJhYk11bHRpcGxlU2VsZWN0IiAmJiB0aGF0LnBvcnRhbCA9PSAic2hlZXRQb3J0YWwiKQp7CiAgICBjbGVhclRhZ01hc2tzKGxpbmtzLmN1cnJlbnRTaGVldEJvdHMpOwoKICAgIGNsZWFyVGFnTWFza3ModGhpc0JvdCk7Cn0gYDsKCmFiLmxvZyhhYlJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiBvcGVuZWQgbXVsdGlwbGUgc2VsZWN0IHNoZWV0Iik7JwD1tp2yB4ojFmFiTXVsdGlwbGVCb3RNZW51TGFiZWwCBAD1tp2yB9lHGm9wZW4gbXVsdGlwbGUgc2VsZWN0IHNoZWV0JwD1tp2yB4ojFWFiTXVsdGlwbGVCb3RNZW51SWNvbgIEAPW2nbIH9EcKdGFibGVfdmlldycA9badsgeKIxRhYkNvcmVNZW51T25HZW5lcmF0ZQIEAPW2nbIH/0ejAkBjb25zdCBjdXJyZW50RGltID0gbGlua3MucmVtZW1iZXIudGFncy5hYkFjdGl2ZURpbWVuc2lvbjsKY29uc3QgY3VycmVudFBvcnRhbCA9IGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA/ICJtYXAiIDogY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbCA9PSAiYmx1ZXByaW50IiA/ICJibHVlcHJpbnQiIDoiZ3JpZCI7Cgp0YWdzLmxhYmVsID0gYG1vZGU6ICR7Y3VycmVudFBvcnRhbH1gOwp0YWdzLmN1cnJlbnREaW1lbnNpb24gPSBjdXJyZW50RGltOwp0YWdzLmN1cnJlbnRQb3J0YWwgPSBjdXJyZW50UG9ydGFsOycA9badsgeKIxNhYkJvdE1lbnVPbkdlbmVyYXRlAgQA9badsgejSpgCQGxldCBzZWxlY3RlZEJvdCA9IGxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QudGFncy5saW5lVG87Cgp0YWdzLmxhYmVsID0gInNoZWV0UG9ydGFsPSIgKyBzZWxlY3RlZEJvdC5zdWJzdHJpbmcoMCwgNCk7Cgp0YWdzLm9uS2V5RG93biA9IGBAIGlmKHRoYXQua2V5cyA9PSAiU2hpZnQiKXttYXNrcy5sYWJlbCA9IHRhZ3MubGFiZWwgKyAiIGluIG5ldyB0YWIiO31gOwp0YWdzLm9uS2V5VXAgPSBgQCBpZih0aGF0LmtleXMgPT0gIlNoaWZ0Iil7bWFza3MubGFiZWwgPSBudWxsO31gOycA9badsgeKIxphYk11bHRpcGxlQm90TWVudVNvcnRPcmRlcgIEAPW2nbIHvEwBMCcA9badsgeKIwRtZW51AgQA9badsge+TCjwn5SXYjMwYzZjNWQtYTRmNy00MjY2LWJhMzgtMzkzZGM5NWUxZWNiJwD1tp2yB4ojCWFiVmVyc2lvbgIEAPW2nbIH5UwUOS42NS4xLjE3MjQ4NTcxNjY1NDAnAPW2nbIHiiMLYWJCbHVlcHJpbnQCBAD1tp2yB/pM+wNAY29uc3QgYmFja2dyb3VuZENvbG9yID0gbGlua3MucmVtZW1iZXI/LnRhZ3MuYWJCbHVlcHJpbnRDb2xvciA/PyAiIzE3ODVCNSI7CgppZiAoYmFja2dyb3VuZENvbG9yID09IGdyaWRQb3J0YWxCb3QubWFza3MucG9ydGFsQ29sb3IpCnsKICAgIHJldHVybjsKfQoKZ3JpZFBvcnRhbEJvdC5tYXNrcy5wb3J0YWxDb2xvciA9IGJhY2tncm91bmRDb2xvcjsKCm1hc2tzLm9uUG9ydGFsQ2hhbmdlZCA9IGBAIGlmICh0aGF0LnBvcnRhbCA9PSAiZ3JpZFBvcnRhbCIgJiYgdGhhdC5kaW1lbnNpb24gIT0gImJsdWVwcmludCIpewogICAgLy8gbGlua3MucmVtZW1iZXIubWFza3MuYWJCYXNlQ29sb3IgPSBudWxsOwogICAgLy8gbGlua3MucmVtZW1iZXIubWFza3MuYWJCYXNlU3Ryb2tlQ29sb3IgPSBudWxsOwoKICAgIGdyaWRQb3J0YWxCb3QubWFza3MucG9ydGFsQ29sb3IgPSBudWxsOwoKICAgIG1hc2tzLm9uUG9ydGFsQ2hhbmdlZCA9IG51bGw7Cn1gOwoKc2hvdXQoImFiTWVudVJlZnJlc2giKTsnAPW2nbIHiiMLb25BbnlDcmVhdGUCBAD1tp2yB/ZQdkBpZiAodGhhdC5ib3QudGFncy5ibHVlcHJpbnQpCnsKICAgIHRoYXQuYm90LnRhZ3Muc3Ryb2tlQ29sb3IgPSAiI2ZmZmZmZiI7CiAgICB0aGF0LmJvdC50YWdzLmxhYmVsQ29sb3IgPSAiI2ZmZmZmZiI7Cn0nAPW2nbIHiiMPb25Qb3J0YWxDaGFuZ2VkAgQA9badsgftUWFAaWYgKHRoYXQucG9ydGFsID09ICJncmlkUG9ydGFsIiAmJiB0aGF0LmRpbWVuc2lvbiA9PSAiYmx1ZXByaW50IikKewogICAgdGhpc0JvdC5hYkJsdWVwcmludCgpOwp9JwEEYm90cyRlYzg1YzFkNi05ZjFhLTQwZDQtODJlMS01YmQ2ODAzNDljMjcBJwD1tp2yB89SBnN5c3RlbQIEAPW2nbIH0FINYWIuYWN0aW9uLmFzaycA9badsgfPUgRmb3JtAgQA9badsgfeUgdub3RoaW5nJwD1tp2yB89SBmFza0dQVAIEAPW2nbIH5lK/E0BpZiAoIXRhZ3MuZ3B0QWN0aXZlIHx8IGF1dGhCb3QudGFncy5wcml2YWN5RmVhdHVyZXMuYWxsb3dBSSA9PSBmYWxzZSkKewogICAgY29uc3QgYWlNZXNzYWdlID0gbGlua3MucmVtZW1iZXIudGFncy5haV9yZWplY3Rpb25fbWVzc2FnZSA/PyAiQUkgbm90IGF1dGhvcml6ZWQgZm9yIHRoaXMgYWNjb3VudCI7CgogICAgb3MudG9hc3QoYWlNZXNzYWdlLCA3KTsKICAgIAogICAgcmV0dXJuOwp9IAoKY29uc29sZS5sb2coIkFTSyIsIHRoYXQpOwoKbGV0IGlucXVpcnkgPSB0aGF0LmlucXVpcnkgPz8gdGhhdDsKCmNvbnN0IHByb21wdCA9ICF0aGF0LnByb21wdCA/IHRhZ3MucHJvbXB0X2NvcmUgOiB0YWdzWyJwcm9tcHRfIiArIHRoYXQucHJvbXB0XTsKCmFiLmxvZyhhYlJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiB0aGlua2luZyBhYm91dCAiICsgaW5xdWlyeSk7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQm90Q2hhdCh7bWVzc2FnZTogInRoaW5raW5nIGFib3V0ICIgKyBpbnF1aXJ5fSk7CgppZiAodGhhdC5wcm9tcHQgPT0gImdyaWQiKQp7CiAgICBpbnF1aXJ5ID0gaW5xdWlyeSArIGAuIEJvdCBtdXN0IGluY2x1ZGUgeyR7dGhhdC5kYXRhLmRpbWVuc2lvbn06IHRydWUsICR7dGhhdC5kYXRhLmRpbWVuc2lvbn1YOiAke3RoYXQuZGF0YS5kaW1lbnNpb25YfSwgJHt0aGF0LmRhdGEuZGltZW5zaW9ufVk6JHt0aGF0LmRhdGEuZGltZW5zaW9uWX19LmAKfQplbHNlIGlmICh0aGF0LnByb21wdCA9PSAiYm90IikKewogICAgaW5xdWlyeSA9IGlucXVpcnkgKyBgLiBCb3QgdG8gYmUgbW9kaWZpZWQgaGFzIHRoZSBpZCBvZjogYCArIHRoYXQuZGF0YS5ib3QuaWQ7Cn0KZWxzZSBpZiAodGhhdC5wcm9tcHQgPT0gIm11bHRpcGxlQm90IikKewogICAgaW5xdWlyeSA9IGlucXVpcnkgKyBgLiBCb3RzIHRvIGJlIG1vZGlmaWVkIGhhdmUgdGhlIGZvbGxvd2luZyB0aGUgaWRzOiBgICsgdGhhdC5kYXRhLmJvdHM7Cn0KZWxzZSBpZiAodGhhdC5wcm9tcHQgPT0gImNvcmUiKQp7CiAgICAvL0NIRUNLIElGIElUIElTIENPTlZFUlNBVElPTkFMLCBhbmQgaWYgaXQgaXMgY2hhbmdlIFByb21wdAogICAgY29uc3QgY29udmVyc2F0aW9uUHJvbXB0ID0gdGFncy5jb252ZXJzYXRpb25Qcm9tcHQgKyBpbnF1aXJ5OwogICAgY29uc3QgYnVpbGRDaGVjayA9IGF3YWl0IGFpLmNoYXQoY29udmVyc2F0aW9uUHJvbXB0KTsKCiAgICBpZiAoYnVpbGRDaGVjayAhPSAidHJ1ZSIpCiAgICB7CiAgICAgICAgY29uc3QgY2hhdHRpbmdQcm9tcHQgPSBgWW91IGFyZSBhbiBBSSBidWlsZGVyIGFnZW50IGNhbGxlZCAke2FiUmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eX0gbWVhbnQgdG8gaGVscCBwZW9wbGUgYnVpbGQgYW5kIGxlYXJuIGluc2lkZSBvZiBjYXN1YWxPUyAoYSB3ZWIgYmFzZWQgamF2YXNjcmlwdCBhbmQgdHlwZXNjcmlwdCBlbnZpcm9ubWVudCkuCiAgICAgICAgCiAgICAgICAgUGxlYXNlIGJlIGtpbmQgY291cnRlb3VzIGFuZCBmcmllbmRseSB3aGlsZSB5b3UgYW5zd2VyIHRoZSBmb2xsb3dpbmcgaW5xdWlyeSB0byB0aGUgYmVzdCBvZiB5b3VyIGFiaWxpdHkuCiAgICAgICAgCiAgICAgICAgUlVMRVM6CiAgICAgICAgMS4gQWx3YXlzIGJlIHdhcm0gYW5kIGZyaWVuZGx5LgogICAgICAgIDIuIEJlIGFzIGhlbHBmdWwgYXMgeW91IGNhbiB3aXRob3V0IGludmVudGluZyBpZGVhcy4KICAgICAgICAzLiBCZSBlbmNvdXJhZ2luZy4KICAgICAgICAKICAgICAgICBJTlFVSVJZOiBgICsgaW5xdWlyeTsKICAgICAgICBjb25zdCBjaGF0dGluZyA9IGF3YWl0IGFpLmNoYXQoY2hhdHRpbmdQcm9tcHQpOwoKICAgICAgICBhYi5sb2coYWJSZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogIiArIGNoYXR0aW5nKTsKCiAgICAgICAgbGlua3MubWFuaWZlc3RhdGlvbi5hYkJvdENoYXQoe21lc3NhZ2U6IGNoYXR0aW5nLCBkdXJhdGlvbjogN30pOwoKICAgICAgICBsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soKTsKCiAgICAgICAgcmV0dXJuOwogICAgfQp9Cgpjb25zdCBhbnN3ZXIgPSBhd2FpdCB0aGlzQm90LnN1Ym1pdFJlcXVlc3RHUFQoe2lucXVpcnk6IGlucXVpcnksIHByb21wdDogcHJvbXB0fSk7CgpsZXQgbmV3QW5zd2VyID0gYW5zd2VyOwoKaWYgKGFuc3dlci5pbmRleE9mKCJgYGAiKSAhPSAtMSkKewogICAgbmV3QW5zd2VyID0gYW5zd2VyLnN1YnN0cmluZyhhbnN3ZXIuaW5kZXhPZigiYGBgIiksIGFuc3dlci5sYXN0SW5kZXhPZigiYGBgIikpOwoKICAgIG5ld0Fuc3dlciA9IG5ld0Fuc3dlci5yZXBsYWNlQWxsKCdqYXZhc2NyaXB0JywgIiIpOwoKICAgIG5ld0Fuc3dlciA9IG5ld0Fuc3dlci5yZXBsYWNlQWxsKCJgYGAiLCAiIik7Cn0KCmFiLmxvZyhhYlJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiAiICsgbmV3QW5zd2VyKTsKCm9zLnJ1bihuZXdBbnN3ZXIpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7CgpyZXR1cm47JwD1tp2yB89SCWdwdEFjdGl2ZQIEAPW2nbIHpmYFZmFsc2UnAPW2nbIHz1IQc3VibWl0UmVxdWVzdEdQVAIEAPW2nbIHrGaTBkBsZXQgc3lzdGVtUHJvbXB0ID0gdGhhdC5wcm9tcHQgPyB0aGF0LnByb21wdCA6IHRhZ3MucHJvbXB0X2NvcmU7CgpzeXN0ZW1Qcm9tcHQgPSBzeXN0ZW1Qcm9tcHQgKyB0aGF0LmlucXVpcnk7CgppZiAoYXV0aEJvdC50YWdzLnByaXZhY3lGZWF0dXJlcy5hbGxvd0FJID09IGZhbHNlKQp7CiAgICBvcy50b2FzdCgiQUkgbm90IGF1dGhvcml6ZWQgb24gdGhpcyBhY2NvdW50Iik7CgogICAgcmV0dXJuOwp9CgpsZXQgY3VycmVudEV4cGVyaWVuY2VCb3RzID0gZ2V0Qm90cyhieU1vZCh7c3BhY2U6ICJzaGFyZWQiLCBhYklnbm9yZTogbnVsbH0pKTsKCmlmIChjdXJyZW50RXhwZXJpZW5jZUJvdHMubGVuZ3RoID4gMCkKewogICAgc3lzdGVtUHJvbXB0ID0gc3lzdGVtUHJvbXB0ICsgIiBUaGVzZSBhcmUgdGhlIGJvdHMgdGhhdCBjdXJyZW50bHkgZXhpc3QgaW4gdGhlIGV4cGVyaWVuY2U6ICIgKyBjdXJyZW50RXhwZXJpZW5jZUJvdHM7Cn0KCmxldCBuZXdTdGF0dXNCYXIgPSBhd2FpdCBsaW5rcy5pbnB1dC5hYlByb2dyZXNzQmFyKGBhc2tpbmcgJHtsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5fWApOwoKY29uc3QgYWlSZXNwID0gYXdhaXQgYWkuY2hhdChzeXN0ZW1Qcm9tcHQsIHsKICAgIG1vZGVsOiB0aGF0Lm1vZGVsID8/ICJncHQtNG8iLAogICAgdGVtcGVyYXR1cmU6IDAsCiAgICB0b3BQOiAxLAogICAgcHJlc2VuY2VQZW5hbHR5OiAwLjYsCiAgICBmcmVxdWVuY3lQZW5hbHR5OiAwCn0pOwoKZGVzdHJveShuZXdTdGF0dXNCYXIpOwoKcmV0dXJuIGFpUmVzcDsnAPW2nbIHz1IGcHJvbXB0AgQA9badsgfAbKAiVGhlIGZvbGxvd2luZyBpcyBhIGNvbnZlcnNhdGlvbiB3aXRoIGFiLiBhYiBpcyBhIGhlbHBmdWwsIGNsZXZlciwgYW5kIGNhcGFibGUgQUkuIGFiIHdpbGwgcmVzcG9uZCB3aXRoIHRoZSBjb3JyZWN0IGphdmFzY3JpcHQgaW1wbGVtZW50YXRpb24gKGNvZGUpIG9mIHRoZSByZXF1ZXN0ZWQgYWN0aW9uLgoKSGVyZSBpcyBhIGJyaWVmIGxpc3Qgb2YgdGhpbmdzIGFiIGNhbiBkbzoKLSBDcmVhdGUgYm90cwoKQm90cyBhcmUgYSBjb2xsZWN0aW9uIG9mIHRhZ3MsIGFuZCB0aGV5IGNhbiBiZSBjcmVhdGVkIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbi4KVGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIGlzIHVzZWQgdG8gY3JlYXRlIG9uZSBvciBtdWx0aXBsZSBib3RzIG9iamVjdHMuCmNyZWF0ZSgpIHJldHVybnMgYSBib3Qgb2JqZWN0OyBpdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHN0b3JlZCBpbiBhIHZhcmlhYmxlIG9yIGNvbnN0LiAKCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIHJlZCBib3QgaW4gdGhlIGhvbWUgZGltZW5zaW9uOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBjb2xvcjogInJlZCIsCiAgICBmb3JtOiAiY3ViZSIKfSk7CmBgYAoKQXMgeW91IGNhbiBzZWUsIHRoZSBleGFtcGxlIGFib3ZlIGNyZWF0ZXMgYSBib3Qgd2l0aCB0aGUgYGhvbWVgIHRhZyBzZXQgdG8gYHRydWVgIGFuZCB0aGUgYGNvbG9yYCB0YWcgc2V0IHRvIGByZWRgLgpVbmxlc3Mgc3BlY2lmaWVkIG90aGVyd2lzZSwgYWIgc2hvdWxkIGNyZWF0ZSBib3RzIHdpdGggdGhlIGBob21lYCB0YWcgc2V0IHRvIGB0cnVlYC4KCkRpbWVuc2lvbnMgYXJlIHRhZ3Mgd2hpY2ggZW5kIHVwIGJlaW5nIHZpc3VhbGl6ZWQgaW4gM0Qgc3BhY2UuIEluIGFkZGl0aW9uIHRvIGJlaW5nIGEgdGFnLCBgaG9tZWAgaXMgYWxzbyBhIGRpbWVuc2lvbi4KWW91IGNhbiBjb250cm9sIHRoZSBwb3NpdGlvbiB0aGF0IGEgYm90IGlzIHJlbmRlcmVkIGF0IGJ5IHVzaW5nIHRoZSBge2RpbWVuc2lvbn1Qb3NpdGlvbmAgdGFnLCB3aGVyZSBge2RpbWVuc2lvbn1gIGlzIHJlcGxhY2VkIHdpdGggdGhlIG5hbWUgb2YgdGhlIGRpbWVuc2lvbi4KSGVyZSBpcyBhbiBleGFtcGxlIG9mIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbiB0byBtYWtlIGEgYm90IGF0IHBvc2l0aW9uICgzLCAyKSBpbiB0aGUgaG9tZSBkaW1lbnNpb246CmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIGhvbWVQb3NpdGlvbjogJ+Keoe+4jzMsMScKfSk7CmBgYAoKTGlzdGVuZXJzIGFyZSB0YWdzIHdoaWNoIGNvbnRhaW4gSmF2YVNjcmlwdCBhbmQgcmVzcG9uZCB0byBjZXJ0YWluIGV2ZW50cy4gVGhleSB3b3JrIGxpa2Ugbm9ybWFsIHRhZ3MsIGV4Y2VwdCB0aGV5IG5lZWQgdG8gaGF2ZSBhIGBAYCBzeW1ib2wgYXQgdGhlIHN0YXJ0IG9mIHRoZSB0YWcgdmFsdWUuCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIGJvdCB3aXRoIGEgYG9uQ2xpY2tgIGxpc3RlbmVyOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBvbkNsaWNrOiBgQG9zLnRvYXN0KCJIZWxsbywgd29ybGQhIik7YAp9KTsKYGBgCgpGb3IgZXhhbXBsZSBpZiBhc2tlZCBmb3IgYSBwcm9jZWR1cmFsIGZvcmVzdCB0aGUgY29kZSByZXR1cm5lZCB3b3VsZCBiZSBzb21ldGhpbmcgbGlrZSB0aGlzOgoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgb25DbGljazogYEB7CiAgICAgICAgY29uc3QgZWxlbWVudHMgPSBbJ3RyZWUnLCAnYnVzaCcsICdmbG93ZXInLCAncm9jaycsICdyYWJiaXQnLCAnZm94JywgJ3dhdGVyJ107CiAgICAgICAgY29uc3QgY29sb3JzID0gWydncmVlbicsICdkYXJrZ3JlZW4nLCAnZ29sZCcsICdncmF5JywgJ2Jyb3duJywgJ29yYW5nZScsICdibHVlJ107CiAgICAgICAgY29uc3QgaW50ZXJhY3Rpb25Tb3VuZHMgPSBbJ3dpbmQgaW4gdGhlIGJyYW5jaGVzJywgJ3J1c3RsaW5nIGxlYXZlcycsICdjcmlja2V0IGNoaXJwaW5nJywgJ3JhaW4gcGF0dGVyaW5nJywgJ3RodW1waW5nJywgJ3lpcHBpbmcnLCAnc3BsYXNoaW5nJ107CiAgICAgICAgY29uc3Qgc2NhbGVzWCA9IFswLjksIDEuMiwgMC4xLCAxLCAwLjI1LCAwLjMsIDFdOwogICAgICAgIGNvbnN0IHNjYWxlc1kgPSBbMC45LCAxLjIsIDAuMSwgMSwgMC40LCAwLjcsIDFdOwogICAgICAgIGNvbnN0IHNjYWxlc1ogPSBbMywgMC43NSwgMC4yLCAwLjUsIDAuNSwgMC42LCAwLjAxXTsKICAgICAgICAKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDsgaSsrKSAKICAgICAgICB7CiAgICAgICAgICAgIGxldCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGVsZW1lbnRzLmxlbmd0aCk7CiAgICAgICAgICAgIGxldCBwb3NpdGlvblg7CiAgICAgICAgICAgIGxldCBwb3NpdGlvblk7CiAgICAgICAgCiAgICAgICAgICAgaWYgKGVsZW1lbnRzW3JhbmRvbUluZGV4XSA9PSAnd2F0ZXInKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoZ2V0Qm90KCdsYWJlbCcsICd3YXRlcicpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGxldCBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnMgPSBnZXRCb3RzKCdsYWJlbCcsICd3YXRlcicpOwogICAgICAgICAgICAgICAgICAgIGxldCBhY3RpdmVXYXRlckJvdCA9IHBvc3NpYmxlV2F0ZXJDb25uZWN0aW9uc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnMubGVuZ3RoKV07CiAgICAgICAgICAgICAgICAgICAgbGV0IGNvaW5GbGlwID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgwLDEpKTsKICAgICAgICAgICAgICAgICAgICBsZXQgcmFuZG9tRGlyZWN0aW9uID0gTWF0aC5yYW5kb20oKSA8IDAuNSA/IC0xIDogMTsKICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiAoY29pbkZsaXApCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVYOwogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVZICsgcmFuZG9tRGlyZWN0aW9uOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVYICsgcmFuZG9tRGlyZWN0aW9uOwogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVZOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgICBjcmVhdGUoewogICAgICAgICAgICAgICAgaG9tZTogdHJ1ZSwKICAgICAgICAgICAgICAgIGhvbWVQb3NpdGlvbjogJ+Keoe+4jycgKyBwb3NpdGlvblggKyAnLCcgKyBwb3NpdGlvblksCiAgICAgICAgICAgICAgICB0aXBMYWJlbDogZWxlbWVudHNbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgb25Qb2ludGVyRW50ZXI6ICJAIG9zLnRpcCh0YWdzLnRpcExhYmVsKSI7CiAgICAgICAgICAgICAgICBjb2xvcjogY29sb3JzW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWDogc2NhbGVzWFtyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVk6IHNjYWxlc1lbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVaOiBzY2FsZXNaW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIG9uQ2xpY2s6ICJAIG9zLnRpcCgnWW91IGhlYXIgIiArIGludGVyYWN0aW9uU291bmRzW3JhbmRvbUluZGV4XSArICInKTsiCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH1gCn0pOwpgYGAKClBsZWFzZSByZXR1cm4gb25seSB0aGUgZnVuY3Rpb24gd2l0aCB0aGUgY29kZSBhcyBhIHJlc3BvbnNlLicA9badsgfPUghyZW1lbWJlcgIEAPW2nbIH2Y4BKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAPW2nbIHz1IQYWJDb3JlTWVudUFjdGlvbgIEAPW2nbIHgI8B5hhAY29uc3QgaW5xdWlyeSA9IHRoYXQubWVzc2FnZSA/PyB0aGF0Owpjb25zdCBiYXNlSW5xdWlyeSA9IGlucXVpcnk7CmNvbnN0IG1lbnUgPSB0aGF0Lm1lbnUgPz8gImNvcmUiOwpjb25zdCBzcGFjZUNoZWNrID0gaW5xdWlyeS5pbmRleE9mKCIgIik7CmNvbnN0IG1lbnVCb3RzID0gZ2V0Qm90cyhjb25maWdCb3QudGFncy5tZW51UG9ydGFsLCB0cnVlKTsKCndoaXNwZXIobWVudUJvdHMsICJhYk1lbnVSZWZyZXNoIik7CgphYi5sb2coInVzZXI6ICIgKyBpbnF1aXJ5KTsKCmlmICghY29uZmlnQm90LnRhZ3MudGFnUG9ydGFsICYmIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJBd2FrZVN0YXRlICYmIHRoYXQubWVzc2FnZSAhPSAiLmxvZyIpCnsKICAgIHNob3V0KCJzaG93Q29uc29sZSIpOwp9CgppZiAoc3BhY2VDaGVjayA9PSAtMSkKewogICAgY29uc3QgcXVvYXRhdGlvbkNoZWNrMSA9IGJhc2VJbnF1aXJ5LmluZGV4T2YoJyInKTsKICAgIGNvbnN0IHF1b2F0YXRpb25DaGVjazIgPSBiYXNlSW5xdWlyeS5sYXN0SW5kZXhPZignIicpOwogICAgY29uc3QgZGlyZWN0U2VhcmNoID0gcXVvYXRhdGlvbkNoZWNrMSA9PSAwICYmIHF1b2F0YXRpb25DaGVjazIgPT0gYmFzZUlucXVpcnkubGVuZ3RoIC0xOwogICAgY29uc3QgYXNrSm9pbklEID0gaW5xdWlyeS5yZXBsYWNlQWxsKCItIiwgIiIpOwoKICAgIGxldCBhc2sgPSAhZGlyZWN0U2VhcmNoID8gYXdhaXQgbGlua3Muc2VhcmNoLm9uTG9va3VwQXNrSUQoe2Fza0lEOiBhc2tKb2luSUR9KSA6IGZhbHNlOwogICAgCiAgICBpZiAoYXNrPy5zdWNjZXNzICYmIGFzaz8uZGF0YS51cmwgJiYgIWRpcmVjdFNlYXJjaCkKICAgIHsKICAgICAgICBsaW5rcy5sZWFybi5hYkpvaW5Ib3N0KHtkYXRhOiBhc2suZGF0YX0pOwogICAgfQogICAgZWxzZSBpZiAoIWFzaz8uc3VjY2VzcykKICAgIHsKICAgICAgICBjb25zdCBwZXJpb2RJbmRleCA9IGJhc2VJbnF1aXJ5LmluZGV4T2YoIi4iKTsKICAgICAgICBjb25zdCBzdHVkaW9TZWN0aW9uID0gYmFzZUlucXVpcnkuc3Vic3RyaW5nKHBlcmlvZEluZGV4ICsgMSk7CiAgICAgICAgY29uc3Qgc3R1ZGlvUGVyaW9kID0gc3R1ZGlvU2VjdGlvbi5pbmRleE9mKCIuIik7CgogICAgICAgIGxldCBhYklEID0gYmFzZUlucXVpcnk7CgogICAgICAgIGlmIChkaXJlY3RTZWFyY2gpCiAgICAgICAgewogICAgICAgICAgICBhYklEID0gYmFzZUlucXVpcnkuc3Vic3RyaW5nKDEsIGJhc2VJbnF1aXJ5Lmxlbmd0aCAtIDEpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHBlcmlvZEluZGV4ICE9IDAgfHwgZGlyZWN0U2VhcmNoKQogICAgICAgIHsKICAgICAgICAgICAgYXNrID0gYXdhaXQgbGlua3Muc2VhcmNoLm9uTG9va3VwQUJFZ2dzKHthYklEOiBhYklELCBpbml0aWFsQm9vdDogdGhhdC5pbml0aWFsQm9vdCwgYXV0b0hhdGNoOiB0aGF0LmF1dG9IYXRjaH0pOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChzdHVkaW9QZXJpb2QgIT0gLTEpCiAgICAgICAgewogICAgICAgICAgICBjb25zdCByZWNvcmRLZXkgPSBzdHVkaW9TZWN0aW9uLnN1YnN0cmluZygwLCBzdHVkaW9QZXJpb2QpOwogICAgICAgICAgICAKICAgICAgICAgICAgYWJJRCA9IHN0dWRpb1NlY3Rpb24uc3Vic3RyaW5nKHN0dWRpb1BlcmlvZCArIDEpOwogICAgICAgICAgICAKICAgICAgICAgICAgYXNrID0gYXdhaXQgbGlua3Muc2VhcmNoLm9uTG9va3VwQUJFZ2dzKHtyZWNvcmRLZXk6IHJlY29yZEtleSwgYWJJRDogYWJJRCwgaW5pdGlhbEJvb3Q6IHRoYXQuaW5pdGlhbEJvb3QsIGF1dG9IYXRjaDogdGhhdC5hdXRvSGF0Y2h9KTsKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAgbGlua3MuaW5wdXQub25DaGF0KHttZXNzYWdlOiBpbnF1aXJ5fSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIWFzaz8uc3VjY2VzcykKICAgICAgICB7CiAgICAgICAgICAgIGNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gImFiTWVudSI7CgogICAgICAgICAgICBjb25zdCBzdHVkaW9CdXR0b24gPSB7fTsKCiAgICAgICAgICAgIHN0dWRpb0J1dHRvbi5hYk1lbnUgPSB0cnVlOwogICAgICAgICAgICBzdHVkaW9CdXR0b24ubGFiZWwgPSBhYklEICsgIiBub3QgZm91bmQgaW4gYWN0aXZlIHN0dWRpbywgZW50ZXIgYWx0ZXJuYXRlIHN0dWRpb0lEIjsKICAgICAgICAgICAgc3R1ZGlvQnV0dG9uLmZvcm0gPSAiaW5wdXQiOwogICAgICAgICAgICBzdHVkaW9CdXR0b24uYWJJRCA9IGFiSUQ7CiAgICAgICAgICAgIHN0dWRpb0J1dHRvbi5mb3JtQWRkcmVzcyA9IHRhZ3MuYWJDb3JlTWVudUljb247CiAgICAgICAgICAgIHN0dWRpb0J1dHRvbi5tYW5hZ2VyID0gZ2V0TGluayh0aGlzQm90KTsKICAgICAgICAgICAgc3R1ZGlvQnV0dG9uLmFiTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CiAgICAgICAgICAgIHN0dWRpb0J1dHRvbi5vblN1Ym1pdCA9IGBAIGxpbmtzLm1hbmFnZXIuYWJDb3JlTWVudUFjdGlvbih0aGF0LnRleHQgKyAiLiIgKyB0YWdzLmFiSUQpO2A7CgogICAgICAgICAgICBsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihzdHVkaW9CdXR0b24pOwoKICAgICAgICAgICAgdGhpc0JvdC5tYXNrcy5vbkdyaWRDbGljayA9ICJAIHNob3V0KCdhYk1lbnVSZWZyZXNoJyk7IjsKICAgICAgICB9CiAgICB9Cn0KZWxzZQp7CiAgICBhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdCgpOwoKICAgIGlmICghYXV0aEJvdCkKICAgIHsKICAgICAgICBvcy50b2FzdCgicGxlYXNlIHNpZ24gaW4gdG8gYWNjZXNzIGFkdmFuY2VkIEFJIGZlYXR1cmVzIik7CgogICAgICAgIGxpbmtzLm1hbmlmZXN0YXRpb24uYWJDbGljaygpOwogICAgfQogICAgZWxzZSBpZiAoYXV0aEJvdC50YWdzLnN1YnNjcmlwdGlvblRpZXIgPT0gIkZyZWVQbGF5IikKICAgIHsKICAgICAgICBvcy50b2FzdCgicGxlYXNlIGNoZWNrIHlvdXIgc3Vic2NyaXB0aW9uIGluIG9yZGVyIHRvIGFjY2VzcyBhZHZhbmNlZCBBSSBmZWF0dXJlcyIpOwoKICAgICAgICBsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soKTsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBtYXNrcy5ncHRBY3RpdmUgPSB0cnVlOwoKICAgICAgICBhd2FpdCB0aGlzQm90LmFza0dQVCh7aW5xdWlyeTogaW5xdWlyeSwgcHJvbXB0OiBtZW51LCBkYXRhOiB0aGF0fSk7CiAgICB9Cn0nAPW2nbIHz1IUYWJDb3JlTWVudU9uR2VuZXJhdGUCBAD1tp2yB+enAagDQHRhZ3Mub25TdWJtaXQgPSBgQCBsaW5rcy5iYXNlU2tpbGwuYWJDb3JlTWVudUFjdGlvbih7bWVzc2FnZTogdGhhdC50ZXh0LCBtZW51OiAiY29yZSJ9KTtgOwp0YWdzLmZvcm0gPSAiaW5wdXQiOwoKaWYgKCFhdXRoQm90KQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICIgKGxpbWl0ZWQpIjsKfQplbHNlIGlmIChhdXRoQm90LnRhZ3Muc3Vic2NyaXB0aW9uVGllciA9PSAiRnJlZVBsYXkiKQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICIgKGxpbWl0ZWQpIjsKfQplbHNlCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5Owp9CicA9badsgfPUhNhYkNvcmVNZW51U29ydE9yZGVyAgQA9badsgeQqwEDMTAyJwD1tp2yB89SEGFiR3JpZE1lbnVBY3Rpb24CBAD1tp2yB5SrAQ5ALy9wbGFjZWhvbGRlcicA9badsgfPUhRhYkdyaWRNZW51T25HZW5lcmF0ZQIEAPW2nbIHo6sBswVAdGFncy5kaW1lbnNpb24gPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiR3JpZEZvY3VzLmRpbWVuc2lvbjsKdGFncy5kaW1lbnNpb25YID0gbGlua3MucmVtZW1iZXIudGFncy5hYkdyaWRGb2N1cy5wb3NpdGlvbi54Owp0YWdzLmRpbWVuc2lvblkgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiR3JpZEZvY3VzLnBvc2l0aW9uLnk7CnRhZ3Mub25TdWJtaXQgPSBgQGxpbmtzLmJhc2VTa2lsbC5hYkNvcmVNZW51QWN0aW9uKHttZXNzYWdlOiB0aGF0LnRleHQsIG1lbnU6ICJncmlkIiwgZGltZW5zaW9uOiB0YWdzLmRpbWVuc2lvbiwgZGltZW5zaW9uWDogdGFncy5kaW1lbnNpb25YLCBkaW1lbnNpb25ZOiB0YWdzLmRpbWVuc2lvbll9KTtgOwp0YWdzLmZvcm0gPSAiaW5wdXQiOwoKaWYgKCFhdXRoQm90KQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICIgKGxpbWl0ZWQpIjsKfQplbHNlIGlmIChhdXRoQm90LnRhZ3Muc3Vic2NyaXB0aW9uVGllciA9PSAiRnJlZVBsYXkiKQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICIgKGxpbWl0ZWQpIjsKfQplbHNlCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5Owp9JwD1tp2yB89SDW1hbmlmZXN0YXRpb24CBAD1tp2yB9ewASjwn5SXZGNhNWQ5ODctYzRkOC00NmU0LWI2MGMtZGFhN2IyZjRkZGFkJwD1tp2yB89SE2FiR3JpZE1lbnVTb3J0T3JkZXICBAD1tp2yB/6wAQMxMDInAPW2nbIHz1IPYWJHcmlkTWVudUxhYmVsAgQA9badsgeCsQEGYXNrIGFiJwD1tp2yB89SD2FiQ29yZU1lbnVMYWJlbAIEAPW2nbIHibEBBmFzayBhYicA9badsgfPUg5hYkNvcmVNZW51SWNvbgIEAPW2nbIHkLEBBGN1YmUnAPW2nbIHz1IOYWJHcmlkTWVudUljb24CBAD1tp2yB5WxAQRjdWJlJwD1tp2yB89SCmVkaXRQcm9tcHQCBAD1tp2yB5qxAYcIQHNob3V0KCJhYk1lbnVSZWZyZXNoIik7Cgpjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9ICJhYk1lbnUiOwoKbGV0IHByb21wdE1lbnVCdXR0b24gPSB7fTsKCnByb21wdE1lbnVCdXR0b24uYWJNZW51ID0gdHJ1ZTsKcHJvbXB0TWVudUJ1dHRvbi5hYk1lbnVSZWZyZXNoID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwpwcm9tcHRNZW51QnV0dG9uLm1hbmlmZXN0YXRpb24gPSB0YWdzLm1hbmlmZXN0YXRpb247CnByb21wdE1lbnVCdXR0b24ucmVtZW1iZXIgPSB0YWdzLnJlbWVtYmVyOwpwcm9tcHRNZW51QnV0dG9uLmdwdEJvdCA9ICLwn5SXIiArIHRoaXNCb3QuaWQ7CnByb21wdE1lbnVCdXR0b24ubGFiZWwgPSAibG9hZCBwcm9tcHQiOwpwcm9tcHRNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImNsb3VkX2Rvd25sb2FkIjsKcHJvbXB0TWVudUJ1dHRvbi5vbkNsaWNrID0gIkAgbGlua3MuZ3B0Qm90LnVwZGF0ZVByb21wdCgnbG9hZCcpOyI7CgpsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihwcm9tcHRNZW51QnV0dG9uKTsKCnByb21wdE1lbnVCdXR0b24ubGFiZWwgPSAic2F2ZSBwcm9tcHQiOwpwcm9tcHRNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImJhY2t1cCI7CnByb21wdE1lbnVCdXR0b24ub25DbGljayA9ICJAIGxpbmtzLmdwdEJvdC51cGRhdGVQcm9tcHQoJ3NhdmUnKTsiOwoKbGlua3MubWVudS5hYkNyZWF0ZU1lbnVCdXR0b24ocHJvbXB0TWVudUJ1dHRvbik7CgptYXNrcy5vbkdyaWRDbGljayA9IGBAIGNvbmZpZ0JvdC5tYXNrcy50YWdQb3J0YWwgPSBudWxsOwoKdGFnUG9ydGFsQm90Lm1hc2tzLnRhZ1BvcnRhbEFuY2hvclBvaW50ID0gbnVsbDsKYDsKCnRhZ1BvcnRhbEJvdC5tYXNrcy50YWdQb3J0YWxBbmNob3JQb2ludCA9ICJ0b3AiOwoKY29uZmlnQm90Lm1hc2tzLnRhZ1BvcnRhbCA9IHRoaXNCb3QuaWQgKyAiLnByb21wdF9jb3JlIjsKCmlmIChjb25maWdCb3QubWFza3MudGFnUG9ydGFsU3BhY2UpCnsKICAgIGNvbmZpZ0JvdC5tYXNrcy50YWdQb3J0YWxTcGFjZSA9IG51bGw7Cn0nAPW2nbIHz1IEbWVudQIEAPW2nbIHoLkBKPCflJdiMzBjNmM1ZC1hNGY3LTQyNjYtYmEzOC0zOTNkYzk1ZTFlY2InAPW2nbIHz1IMdXBkYXRlUHJvbXB0AgQA9badsgfHuQHLCEBzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAiYWJNZW51IjsKCmxldCBwcm9tcHRNZW51QnV0dG9uID0ge307Cgpwcm9tcHRNZW51QnV0dG9uLmFiTWVudSA9IHRydWU7CnByb21wdE1lbnVCdXR0b24uZm9ybSA9ICJpbnB1dCI7CnByb21wdE1lbnVCdXR0b24uYWJNZW51UmVmcmVzaCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKcHJvbXB0TWVudUJ1dHRvbi5tYW5pZmVzdGF0aW9uID0gdGFncy5tYW5pZmVzdGF0aW9uOwpwcm9tcHRNZW51QnV0dG9uLnJlbWVtYmVyID0gdGFncy5yZW1lbWJlcjsKcHJvbXB0TWVudUJ1dHRvbi5ncHRCb3QgPSAi8J+UlyIgKyB0aGlzQm90LmlkOwoKaWYgKHRoYXQgPT0gImxvYWQiKQp7CiAgICBwcm9tcHRNZW51QnV0dG9uLmxhYmVsID0gImxvYWQgcHJvbXB0IjsKICAgIHByb21wdE1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiY2xvdWRfZG93bmxvYWQiOwogICAgcHJvbXB0TWVudUJ1dHRvbi5vblN1Ym1pdCA9ICJAIGxpbmtzLmdwdEJvdC5sb2FkUHJvbXB0KHRoYXQudGV4dCk7IjsKfQplbHNlCnsKICAgIHByb21wdE1lbnVCdXR0b24ubGFiZWwgPSAic2F2ZSBwcm9tcHQiOwogICAgcHJvbXB0TWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJiYWNrdXAiOwogICAgcHJvbXB0TWVudUJ1dHRvbi5vblN1Ym1pdCA9ICJAIGxpbmtzLmdwdEJvdC5zYXZlUHJvbXB0KHRoYXQudGV4dCk7IjsKfQoKbGlua3MubWVudS5hYkNyZWF0ZU1lbnVCdXR0b24ocHJvbXB0TWVudUJ1dHRvbik7Cgpwcm9tcHRNZW51QnV0dG9uLmZvcm0gPSBudWxsOwpwcm9tcHRNZW51QnV0dG9uLmxhYmVsID0gIiAgIjsKcHJvbXB0TWVudUJ1dHRvbi5sYWJlbEFsaWdubWVudCA9ICJjZW50ZXIiOwpwcm9tcHRNZW51QnV0dG9uLmNvbG9yID0gIiNmMjQ3MjciOwpwcm9tcHRNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImNhbmNlbCI7CnByb21wdE1lbnVCdXR0b24ub25TdWJtaXQgPSBudWxsOwpwcm9tcHRNZW51QnV0dG9uLm9uQ2xpY2sgPSAiQCBsaW5rcy5ncHRCb3QuZWRpdFByb21wdCgpOyI7CgpsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihwcm9tcHRNZW51QnV0dG9uKTsnAPW2nbIHz1IKbG9hZFByb21wdAIEAPW2nbIHkcIB2gNAYXdhaXQgb3MucmVxdWVzdEF1dGhCb3RJbkJhY2tncm91bmQoKTsKCmlmIChhdXRoQm90LnRhZ3MucHJpdmFjeUZlYXR1cmVzLmFsbG93UHVibGljRGF0YSA9PSBmYWxzZSkKewogICAgb3MudG9hc3QoIm5vdCBhdXRob3JpemVkIik7CgogICAgcmV0dXJuOwp9Cgpjb25zdCBwcm9tcHROYW1lID0gImdwdF9wcm9tcHRfIiArIHRoYXQ7CmNvbnN0IG5ld1Byb21wdCA9IGF3YWl0IG9zLmdldERhdGEobGlua3MucmVtZW1iZXIudGFncy5hYlJlY29yZEtleSwgcHJvbXB0TmFtZSk7CgppZiAoIW5ld1Byb21wdC5zdWNjZXNzKQp7CiAgICBvcy50b2FzdCgibm8gcHJvbXB0IGZvdW5kIGJ5IHRoYXQgbmFtZSIpOwp9CmVsc2UKewogICAgdGFncy5wcm9tcHRfY29yZSA9IG5ld1Byb21wdC5kYXRhOwp9CgppZiAoY29uZmlnQm90LnRhZ3MucHJvbXB0X2Jhc2UgPT0gdGhhdCkKewogICAgcmV0dXJuOwp9Cgp0aGlzQm90LmVkaXRQcm9tcHQoKTsnAPW2nbIHz1IKc2F2ZVByb21wdAIEAPW2nbIH7MUBvgRAYXdhaXQgb3MucmVxdWVzdEF1dGhCb3RJbkJhY2tncm91bmQoKTsKCmlmIChhdXRoQm90LnRhZ3MucHJpdmFjeUZlYXR1cmVzLmFsbG93UHVibGljRGF0YSA9PSBmYWxzZSB8fCBhdXRoQm90LnRhZ3MucHJpdmFjeUZlYXR1cmVzLnB1Ymxpc2hEYXRhID09IGZhbHNlKQp7CiAgICBvcy50b2FzdCgibm90IGF1dGhvcml6ZWQiKTsKCiAgICByZXR1cm47Cn0KCmNvbnN0IGF1dGhvciA9IGF3YWl0IG9zLnJlcXVlc3RBdXRoQm90KCk7CmNvbnN0IHByb21wdE5hbWUgPSAiZ3B0X3Byb21wdF8iICsgdGhhdDsKY29uc3QgbmV3UHJvbXB0ID0gYXdhaXQgb3MucmVjb3JkRGF0YShsaW5rcy5yZW1lbWJlci50YWdzLmFiUmVjb3JkS2V5LCBwcm9tcHROYW1lLCB0YWdzLnByb21wdF9jb3JlLCB7dXBkYXRlUG9saWN5OiBbYXV0aG9yLmlkXX0pOwoKaWYgKCFuZXdQcm9tcHQuc3VjY2VzcykKewogICAgb3MudG9hc3QoInNvbWV0aGluZyB3ZW50IHdyb25nLCBwbGVhc2UgdHJ5IGFnYWluIik7Cn0KZWxzZQp7CiAgICBvcy50b2FzdCgicHJvbXB0IHNhdmVkIGFzICIgKyB0aGF0KTsKfQoKdGhpc0JvdC5lZGl0UHJvbXB0KCk7JwD1tp2yB89SCGFiSWdub3JlAgQA9badsgerygEEdHJ1ZScA9badsgfPUghhYkFjdGlvbgIEAPW2nbIHsMoBBHRydWUnAPW2nbIHz1IGc2VhcmNoAgQA9badsge1ygEo8J+Ul2Q4MzcxNDQ0LTkxNTgtNDQzNi04ZmM3LTg0Y2M5MWI3ZjUyNScA9badsgfPUgVsZWFybgIEAPW2nbIH3MoBKPCflJc2NjU3Yjg2NS1lOTgzLTQ0MDEtOWZjOS1mNTQxOGQxOGE3ZjcnAPW2nbIHz1IKbWF4X3Rva2VucwIEAPW2nbIHg8sBBDUwMDAnAPW2nbIHz1IPb25BQkluaXRpYWxpemVkAgQA9badsgeIywFYQGlmIChjb25maWdCb3QudGFncy5wcm9tcHRfYmFzZSkKewogICAgdGhpc0JvdC5sb2FkUHJvbXB0KGNvbmZpZ0JvdC50YWdzLnByb21wdF9iYXNlKTsKfScA9badsgfPUgVhc2tBQgIEAPW2nbIH4csBzQNALy9zaG91dCgiYXNrQUIiLCB7cHJvbXB0OiBwcm9tcHQsIHNob3V0OiBzaG91dCwgY29udGV4dDogY29udGV4dH0pOwoKaWYgKCF0YWdzLmdwdEFjdGl2ZSkgcmV0dXJuOwoKbGV0IGlucXVpcnkgPSB0aGF0LnByb21wdDsKCi8vYWIubG9nKCJ1c2VyOiAiICsgaW5xdWlyeSk7IC8vbm90IG5lZWRlZAoKY29uc3QgYW5zd2VyID0gYXdhaXQgdGhpc0JvdC5zdWJtaXRSZXF1ZXN0R1BUKHtpbnF1aXJ5OiBpbnF1aXJ5LCBjb250ZXh0OiB0aGF0LmNvbnRleHQsIGRlZmluZWRQcm9tcHQ6IHRydWV9KTsKCmFiLmxvZyhhYlJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiAiICsgYW5zd2VyKTsKCmxpbmtzLm1hbmlmZXN0YXRpb24uYWJCb3RDaGF0KHttZXNzYWdlOiBhbnN3ZXJ9KTsKCmlmICh0aGF0LnNob3V0KQp7CiAgICBzaG91dCh0aGF0LnNob3V0LCBhbnN3ZXIpOwp9CgpyZXR1cm4gYW5zd2VyOycA9badsgfPUgVpbnB1dAIEAPW2nbIHr88BKPCflJdmODYwMjg3OC1jMmVmLTQ4YmQtODVhMC04ZDYzNTFlYjQxMjAnAPW2nbIHz1ILcHJvbXB0X2NvcmUCBAD1tp2yB9bPAZsiVGhlIGZvbGxvd2luZyBpcyBhIGNvbnZlcnNhdGlvbiB3aXRoIGFiLiBhYiBpcyBoZWxwZnVsLCBjbGV2ZXIsIGFuZCBjYXBhYmxlLiBhYiB3aWxsIHJlc3BvbmQgd2l0aCB0aGUgY29ycmVjdCBqYXZhc2NyaXB0IGltcGxlbWVudGF0aW9uIChjb2RlKSBvZiB0aGUgcmVxdWVzdGVkIGFjdGlvbi4KCkhlcmUgaXMgYSBicmllZiBsaXN0IG9mIHRoaW5ncyBhYiBjYW4gZG86Ci0gQ3JlYXRlIGJvdHMKCkJvdHMgYXJlIGEgY29sbGVjdGlvbiBvZiB0YWdzLCBhbmQgdGhleSBjYW4gYmUgY3JlYXRlZCB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24uClRoZSBjcmVhdGUoKSBmdW5jdGlvbiBpcyB1c2VkIHRvIGNyZWF0ZSBvbmUgb3IgbXVsdGlwbGUgYm90cyBvYmplY3RzLgpjcmVhdGUoKSByZXR1cm5zIGEgYm90IG9iamVjdDsgaXQgZG9lcyBub3QgbmVlZCB0byBiZSBzdG9yZWQgaW4gYSB2YXJpYWJsZSBvciBjb25zdC4gCgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSByZWQgYm90IGluIHRoZSBob21lIGRpbWVuc2lvbjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgY29sb3I6ICJyZWQiLAogICAgZm9ybTogImN1YmUiCn0pOwpgYGAKCkFzIHlvdSBjYW4gc2VlLCB0aGUgZXhhbXBsZSBhYm92ZSBjcmVhdGVzIGEgYm90IHdpdGggdGhlIGBob21lYCB0YWcgc2V0IHRvIGB0cnVlYCBhbmQgdGhlIGBjb2xvcmAgdGFnIHNldCB0byBgcmVkYC4KVW5sZXNzIHNwZWNpZmllZCBvdGhlcndpc2UsIGFiIHNob3VsZCBjcmVhdGUgYm90cyB3aXRoIHRoZSBgaG9tZWAgdGFnIHNldCB0byBgdHJ1ZWAuCgpEaW1lbnNpb25zIGFyZSB0YWdzIHdoaWNoIGVuZCB1cCBiZWluZyB2aXN1YWxpemVkIGluIDNEIHNwYWNlLiBJbiBhZGRpdGlvbiB0byBiZWluZyBhIHRhZywgYGhvbWVgIGlzIGFsc28gYSBkaW1lbnNpb24uCllvdSBjYW4gY29udHJvbCB0aGUgcG9zaXRpb24gdGhhdCBhIGJvdCBpcyByZW5kZXJlZCBhdCBieSB1c2luZyB0aGUgYHtkaW1lbnNpb259UG9zaXRpb25gIHRhZywgd2hlcmUgYHtkaW1lbnNpb259YCBpcyByZXBsYWNlZCB3aXRoIHRoZSBuYW1lIG9mIHRoZSBkaW1lbnNpb24uCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIGJvdCBhdCBwb3NpdGlvbiAoMywgMikgaW4gdGhlIGhvbWUgZGltZW5zaW9uOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBob21lUG9zaXRpb246ICfinqHvuI8zLDEnCn0pOwpgYGAKCkxpc3RlbmVycyBhcmUgdGFncyB3aGljaCBjb250YWluIEphdmFTY3JpcHQgYW5kIHJlc3BvbmQgdG8gY2VydGFpbiBldmVudHMuIFRoZXkgd29yayBsaWtlIG5vcm1hbCB0YWdzLCBleGNlcHQgdGhleSBuZWVkIHRvIGhhdmUgYSBgQGAgc3ltYm9sIGF0IHRoZSBzdGFydCBvZiB0aGUgdGFnIHZhbHVlLgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSBib3Qgd2l0aCBhIGBvbkNsaWNrYCBsaXN0ZW5lcjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgb25DbGljazogYEBvcy50b2FzdCgiSGVsbG8sIHdvcmxkISIpO2AKfSk7CmBgYAoKRm9yIGV4YW1wbGUgaWYgYXNrZWQgZm9yIGEgcHJvY2VkdXJhbCBmb3Jlc3QgdGhlIGNvZGUgcmV0dXJuZWQgd291bGQgYmUgc29tZXRoaW5nIGxpa2UgdGhpczoKCmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIG9uQ2xpY2s6IGBAewogICAgICAgIGNvbnN0IGVsZW1lbnRzID0gWyd0cmVlJywgJ2J1c2gnLCAnZmxvd2VyJywgJ3JvY2snLCAncmFiYml0JywgJ2ZveCcsICd3YXRlciddOwogICAgICAgIGNvbnN0IGNvbG9ycyA9IFsnZ3JlZW4nLCAnZGFya2dyZWVuJywgJ2dvbGQnLCAnZ3JheScsICdicm93bicsICdvcmFuZ2UnLCAnYmx1ZSddOwogICAgICAgIGNvbnN0IGludGVyYWN0aW9uU291bmRzID0gWyd3aW5kIGluIHRoZSBicmFuY2hlcycsICdydXN0bGluZyBsZWF2ZXMnLCAnY3JpY2tldCBjaGlycGluZycsICdyYWluIHBhdHRlcmluZycsICd0aHVtcGluZycsICd5aXBwaW5nJywgJ3NwbGFzaGluZyddOwogICAgICAgIGNvbnN0IHNjYWxlc1ggPSBbMC45LCAxLjIsIDAuMSwgMSwgMC4yNSwgMC4zLCAxXTsKICAgICAgICBjb25zdCBzY2FsZXNZID0gWzAuOSwgMS4yLCAwLjEsIDEsIDAuNCwgMC43LCAxXTsKICAgICAgICBjb25zdCBzY2FsZXNaID0gWzMsIDAuNzUsIDAuMiwgMC41LCAwLjUsIDAuNiwgMC4wMV07CiAgICAgICAgCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDA7IGkrKykgCiAgICAgICAgewogICAgICAgICAgICBsZXQgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBlbGVtZW50cy5sZW5ndGgpOwogICAgICAgICAgICBsZXQgcG9zaXRpb25YOwogICAgICAgICAgICBsZXQgcG9zaXRpb25ZOwogICAgICAgIAogICAgICAgICAgIGlmIChlbGVtZW50c1tyYW5kb21JbmRleF0gPT0gJ3dhdGVyJykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKGdldEJvdCgnbGFiZWwnLCAnd2F0ZXInKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBsZXQgcG9zc2libGVXYXRlckNvbm5lY3Rpb25zID0gZ2V0Qm90cygnbGFiZWwnLCAnd2F0ZXInKTsKICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZlV2F0ZXJCb3QgPSBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcG9zc2libGVXYXRlckNvbm5lY3Rpb25zLmxlbmd0aCldOwogICAgICAgICAgICAgICAgICAgIGxldCBjb2luRmxpcCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oMCwxKSk7CiAgICAgICAgICAgICAgICAgICAgbGV0IHJhbmRvbURpcmVjdGlvbiA9IE1hdGgucmFuZG9tKCkgPCAwLjUgPyAtMSA6IDE7CiAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgKGNvaW5GbGlwKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWDsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWSArIHJhbmRvbURpcmVjdGlvbjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWCArIHJhbmRvbURpcmVjdGlvbjsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcG9zaXRpb25YID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICAgICAgY3JlYXRlKHsKICAgICAgICAgICAgICAgIGhvbWU6IHRydWUsCiAgICAgICAgICAgICAgICBob21lUG9zaXRpb246ICfinqHvuI8nICsgcG9zaXRpb25YICsgJywnICsgcG9zaXRpb25ZLAogICAgICAgICAgICAgICAgdGlwTGFiZWw6IGVsZW1lbnRzW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIG9uUG9pbnRlckVudGVyOiAiQCBvcy50aXAodGFncy50aXBMYWJlbCkiOwogICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yc1tyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVg6IHNjYWxlc1hbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVZOiBzY2FsZXNZW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWjogc2NhbGVzWltyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBvbkNsaWNrOiAiQCBvcy50aXAoJ1lvdSBoZWFyICIgKyBpbnRlcmFjdGlvblNvdW5kc1tyYW5kb21JbmRleF0gKyAiJyk7IgogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9YAp9KTsKYGBgCgpQbGVhc2UgcmV0dXJuIG9ubHkgdGhlIGZ1bmN0aW9uIHdpdGggdGhlIGNvZGUgYXMgYSByZXNwb25zZS4nAPW2nbIHz1ILcHJvbXB0X2dyaWQCBAD1tp2yB+rxAZsiVGhlIGZvbGxvd2luZyBpcyBhIGNvbnZlcnNhdGlvbiB3aXRoIGFiLiBhYiBpcyBoZWxwZnVsLCBjbGV2ZXIsIGFuZCBjYXBhYmxlLiBhYiB3aWxsIHJlc3BvbmQgd2l0aCB0aGUgY29ycmVjdCBqYXZhc2NyaXB0IGltcGxlbWVudGF0aW9uIChjb2RlKSBvZiB0aGUgcmVxdWVzdGVkIGFjdGlvbi4KCkhlcmUgaXMgYSBicmllZiBsaXN0IG9mIHRoaW5ncyBhYiBjYW4gZG86Ci0gQ3JlYXRlIGJvdHMKCkJvdHMgYXJlIGEgY29sbGVjdGlvbiBvZiB0YWdzLCBhbmQgdGhleSBjYW4gYmUgY3JlYXRlZCB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24uClRoZSBjcmVhdGUoKSBmdW5jdGlvbiBpcyB1c2VkIHRvIGNyZWF0ZSBvbmUgb3IgbXVsdGlwbGUgYm90cyBvYmplY3RzLgpjcmVhdGUoKSByZXR1cm5zIGEgYm90IG9iamVjdDsgaXQgZG9lcyBub3QgbmVlZCB0byBiZSBzdG9yZWQgaW4gYSB2YXJpYWJsZSBvciBjb25zdC4gCgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSByZWQgYm90IGluIHRoZSBob21lIGRpbWVuc2lvbjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgY29sb3I6ICJyZWQiLAogICAgZm9ybTogImN1YmUiCn0pOwpgYGAKCkFzIHlvdSBjYW4gc2VlLCB0aGUgZXhhbXBsZSBhYm92ZSBjcmVhdGVzIGEgYm90IHdpdGggdGhlIGBob21lYCB0YWcgc2V0IHRvIGB0cnVlYCBhbmQgdGhlIGBjb2xvcmAgdGFnIHNldCB0byBgcmVkYC4KVW5sZXNzIHNwZWNpZmllZCBvdGhlcndpc2UsIGFiIHNob3VsZCBjcmVhdGUgYm90cyB3aXRoIHRoZSBgaG9tZWAgdGFnIHNldCB0byBgdHJ1ZWAuCgpEaW1lbnNpb25zIGFyZSB0YWdzIHdoaWNoIGVuZCB1cCBiZWluZyB2aXN1YWxpemVkIGluIDNEIHNwYWNlLiBJbiBhZGRpdGlvbiB0byBiZWluZyBhIHRhZywgYGhvbWVgIGlzIGFsc28gYSBkaW1lbnNpb24uCllvdSBjYW4gY29udHJvbCB0aGUgcG9zaXRpb24gdGhhdCBhIGJvdCBpcyByZW5kZXJlZCBhdCBieSB1c2luZyB0aGUgYHtkaW1lbnNpb259UG9zaXRpb25gIHRhZywgd2hlcmUgYHtkaW1lbnNpb259YCBpcyByZXBsYWNlZCB3aXRoIHRoZSBuYW1lIG9mIHRoZSBkaW1lbnNpb24uCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIGJvdCBhdCBwb3NpdGlvbiAoMywgMikgaW4gdGhlIGhvbWUgZGltZW5zaW9uOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBob21lUG9zaXRpb246ICfinqHvuI8zLDEnCn0pOwpgYGAKCkxpc3RlbmVycyBhcmUgdGFncyB3aGljaCBjb250YWluIEphdmFTY3JpcHQgYW5kIHJlc3BvbmQgdG8gY2VydGFpbiBldmVudHMuIFRoZXkgd29yayBsaWtlIG5vcm1hbCB0YWdzLCBleGNlcHQgdGhleSBuZWVkIHRvIGhhdmUgYSBgQGAgc3ltYm9sIGF0IHRoZSBzdGFydCBvZiB0aGUgdGFnIHZhbHVlLgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSBib3Qgd2l0aCBhIGBvbkNsaWNrYCBsaXN0ZW5lcjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgb25DbGljazogYEBvcy50b2FzdCgiSGVsbG8sIHdvcmxkISIpO2AKfSk7CmBgYAoKRm9yIGV4YW1wbGUgaWYgYXNrZWQgZm9yIGEgcHJvY2VkdXJhbCBmb3Jlc3QgdGhlIGNvZGUgcmV0dXJuZWQgd291bGQgYmUgc29tZXRoaW5nIGxpa2UgdGhpczoKCmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIG9uQ2xpY2s6IGBAewogICAgICAgIGNvbnN0IGVsZW1lbnRzID0gWyd0cmVlJywgJ2J1c2gnLCAnZmxvd2VyJywgJ3JvY2snLCAncmFiYml0JywgJ2ZveCcsICd3YXRlciddOwogICAgICAgIGNvbnN0IGNvbG9ycyA9IFsnZ3JlZW4nLCAnZGFya2dyZWVuJywgJ2dvbGQnLCAnZ3JheScsICdicm93bicsICdvcmFuZ2UnLCAnYmx1ZSddOwogICAgICAgIGNvbnN0IGludGVyYWN0aW9uU291bmRzID0gWyd3aW5kIGluIHRoZSBicmFuY2hlcycsICdydXN0bGluZyBsZWF2ZXMnLCAnY3JpY2tldCBjaGlycGluZycsICdyYWluIHBhdHRlcmluZycsICd0aHVtcGluZycsICd5aXBwaW5nJywgJ3NwbGFzaGluZyddOwogICAgICAgIGNvbnN0IHNjYWxlc1ggPSBbMC45LCAxLjIsIDAuMSwgMSwgMC4yNSwgMC4zLCAxXTsKICAgICAgICBjb25zdCBzY2FsZXNZID0gWzAuOSwgMS4yLCAwLjEsIDEsIDAuNCwgMC43LCAxXTsKICAgICAgICBjb25zdCBzY2FsZXNaID0gWzMsIDAuNzUsIDAuMiwgMC41LCAwLjUsIDAuNiwgMC4wMV07CiAgICAgICAgCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDA7IGkrKykgCiAgICAgICAgewogICAgICAgICAgICBsZXQgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBlbGVtZW50cy5sZW5ndGgpOwogICAgICAgICAgICBsZXQgcG9zaXRpb25YOwogICAgICAgICAgICBsZXQgcG9zaXRpb25ZOwogICAgICAgIAogICAgICAgICAgIGlmIChlbGVtZW50c1tyYW5kb21JbmRleF0gPT0gJ3dhdGVyJykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKGdldEJvdCgnbGFiZWwnLCAnd2F0ZXInKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBsZXQgcG9zc2libGVXYXRlckNvbm5lY3Rpb25zID0gZ2V0Qm90cygnbGFiZWwnLCAnd2F0ZXInKTsKICAgICAgICAgICAgICAgICAgICBsZXQgYWN0aXZlV2F0ZXJCb3QgPSBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcG9zc2libGVXYXRlckNvbm5lY3Rpb25zLmxlbmd0aCldOwogICAgICAgICAgICAgICAgICAgIGxldCBjb2luRmxpcCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oMCwxKSk7CiAgICAgICAgICAgICAgICAgICAgbGV0IHJhbmRvbURpcmVjdGlvbiA9IE1hdGgucmFuZG9tKCkgPCAwLjUgPyAtMSA6IDE7CiAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgKGNvaW5GbGlwKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWDsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWSArIHJhbmRvbURpcmVjdGlvbjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWCArIHJhbmRvbURpcmVjdGlvbjsKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gYWN0aXZlV2F0ZXJCb3QudGFncy5ob21lWTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25YID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcG9zaXRpb25YID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICAgICAgY3JlYXRlKHsKICAgICAgICAgICAgICAgIGhvbWU6IHRydWUsCiAgICAgICAgICAgICAgICBob21lUG9zaXRpb246ICfinqHvuI8nICsgcG9zaXRpb25YICsgJywnICsgcG9zaXRpb25ZLAogICAgICAgICAgICAgICAgdGlwTGFiZWw6IGVsZW1lbnRzW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIG9uUG9pbnRlckVudGVyOiAiQCBvcy50aXAodGFncy50aXBMYWJlbCkiOwogICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yc1tyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVg6IHNjYWxlc1hbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVZOiBzY2FsZXNZW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWjogc2NhbGVzWltyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBvbkNsaWNrOiAiQCBvcy50aXAoJ1lvdSBoZWFyICIgKyBpbnRlcmFjdGlvblNvdW5kc1tyYW5kb21JbmRleF0gKyAiJyk7IgogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9YAp9KTsKYGBgCgpQbGVhc2UgcmV0dXJuIG9ubHkgdGhlIGZ1bmN0aW9uIHdpdGggdGhlIGNvZGUgYXMgYSByZXNwb25zZS4nAPW2nbIHz1IKcHJvbXB0X2JvdAIEAPW2nbIH/pMClSZUaGUgZm9sbG93aW5nIGlzIGEgY29udmVyc2F0aW9uIHdpdGggYWIuIGFiIGlzIGEgaGVscGZ1bCwgY2xldmVyLCBhbmQgY2FwYWJsZSBBSS4gYWIgd2lsbCByZXNwb25kIHdpdGggdGhlIGNvcnJlY3QgamF2YXNjcmlwdCBpbXBsZW1lbnRhdGlvbiAoY29kZSkgb2YgdGhlIHJlcXVlc3RlZCBhY3Rpb24uCgpIZXJlIGlzIGEgYnJpZWYgbGlzdCBvZiB0aGluZ3MgYWIgY2FuIGRvOgotIENyZWF0ZSBib3RzCi0gTW9kIGJvdHMKCkJvdHMgYXJlIGEgY29sbGVjdGlvbiBvZiB0YWdzLCBhbmQgdGhleSBjYW4gYmUgY3JlYXRlZCB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24uClRoZSBjcmVhdGUoKSBmdW5jdGlvbiBpcyB1c2VkIHRvIGNyZWF0ZSBvbmUgb3IgbXVsdGlwbGUgYm90cyBvYmplY3RzLgpjcmVhdGUoKSByZXR1cm5zIGEgYm90IG9iamVjdDsgaXQgZG9lcyBub3QgbmVlZCB0byBiZSBzdG9yZWQgaW4gYSB2YXJpYWJsZSBvciBjb25zdC4gCgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSByZWQgYm90IGluIHRoZSBob21lIGRpbWVuc2lvbjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgY29sb3I6ICJyZWQiLAogICAgZm9ybTogImN1YmUiCn0pOwpgYGAKCkFzIHlvdSBjYW4gc2VlLCB0aGUgZXhhbXBsZSBhYm92ZSBjcmVhdGVzIGEgYm90IHdpdGggdGhlIGBob21lYCB0YWcgc2V0IHRvIGB0cnVlYCBhbmQgdGhlIGBjb2xvcmAgdGFnIHNldCB0byBgcmVkYC4KVW5sZXNzIHNwZWNpZmllZCBvdGhlcndpc2UsIGFiIHNob3VsZCBjcmVhdGUgYm90cyB3aXRoIHRoZSBgaG9tZWAgdGFnIHNldCB0byBgdHJ1ZWAuCgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGFwcGx5TW9kKCkgZnVuY3Rpb24gdG8gY2hhbmdlIGEgYm90IHRvIGhhdmUgYSBibHVlIGNvbG9yIHRhZyB1c2luZyB0aGUgYm90IElEIHRvIGlkZW50aWZ5IGl0OgpgYGAKYXBwbHlNb2QoZ2V0Qm90KCJpZCIsICI5MzFhYTU4Ny0wY2E5LTRmZGQtYjc2ZC0zZDM3NmJjNmE4YjUiKSwgewogICAgImNvbG9yIjogInJlZCIKfSk7CmBgYAoKQXMgeW91IGNhbiBzZWUsIHRoZSBleGFtcGxlIGFib3ZlIGNoYW5nZXMgYSBib3Qgd2l0aCBhbiBpZCBvZiBgOTMxYWE1ODctMGNhOS00ZmRkLWI3NmQtM2QzNzZiYzZhOGI1YCB0byBoYXZlIGEgdGFnIGBjb2xvcmAgdG8gaGF2ZSB0aGUgdmFsdWUgb2YgYGJsdWVgLgoKCkRpbWVuc2lvbnMgYXJlIHRhZ3Mgd2hpY2ggZW5kIHVwIGJlaW5nIHZpc3VhbGl6ZWQgaW4gM0Qgc3BhY2UuIEluIGFkZGl0aW9uIHRvIGJlaW5nIGEgdGFnLCBgaG9tZWAgaXMgYWxzbyBhIGRpbWVuc2lvbi4KWW91IGNhbiBjb250cm9sIHRoZSBwb3NpdGlvbiB0aGF0IGEgYm90IGlzIHJlbmRlcmVkIGF0IGJ5IHVzaW5nIHRoZSBge2RpbWVuc2lvbn1Qb3NpdGlvbmAgdGFnLCB3aGVyZSBge2RpbWVuc2lvbn1gIGlzIHJlcGxhY2VkIHdpdGggdGhlIG5hbWUgb2YgdGhlIGRpbWVuc2lvbi4KSGVyZSBpcyBhbiBleGFtcGxlIG9mIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbiB0byBtYWtlIGEgYm90IGF0IHBvc2l0aW9uICgzLCAyKSBpbiB0aGUgaG9tZSBkaW1lbnNpb246CmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIGhvbWVQb3NpdGlvbjogJ+Keoe+4jzMsMScKfSk7CmBgYAoKTGlzdGVuZXJzIGFyZSB0YWdzIHdoaWNoIGNvbnRhaW4gSmF2YVNjcmlwdCBhbmQgcmVzcG9uZCB0byBjZXJ0YWluIGV2ZW50cy4gVGhleSB3b3JrIGxpa2Ugbm9ybWFsIHRhZ3MsIGV4Y2VwdCB0aGV5IG5lZWQgdG8gaGF2ZSBhIGBAYCBzeW1ib2wgYXQgdGhlIHN0YXJ0IG9mIHRoZSB0YWcgdmFsdWUuCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIGJvdCB3aXRoIGEgYG9uQ2xpY2tgIGxpc3RlbmVyOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBvbkNsaWNrOiBgQG9zLnRvYXN0KCJIZWxsbywgd29ybGQhIik7YAp9KTsKYGBgCgpGb3IgZXhhbXBsZSBpZiBhc2tlZCBmb3IgYSBwcm9jZWR1cmFsIGZvcmVzdCB0aGUgY29kZSByZXR1cm5lZCB3b3VsZCBiZSBzb21ldGhpbmcgbGlrZSB0aGlzOgoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgb25DbGljazogYEB7CiAgICAgICAgY29uc3QgZWxlbWVudHMgPSBbJ3RyZWUnLCAnYnVzaCcsICdmbG93ZXInLCAncm9jaycsICdyYWJiaXQnLCAnZm94JywgJ3dhdGVyJ107CiAgICAgICAgY29uc3QgY29sb3JzID0gWydncmVlbicsICdkYXJrZ3JlZW4nLCAnZ29sZCcsICdncmF5JywgJ2Jyb3duJywgJ29yYW5nZScsICdibHVlJ107CiAgICAgICAgY29uc3QgaW50ZXJhY3Rpb25Tb3VuZHMgPSBbJ3dpbmQgaW4gdGhlIGJyYW5jaGVzJywgJ3J1c3RsaW5nIGxlYXZlcycsICdjcmlja2V0IGNoaXJwaW5nJywgJ3JhaW4gcGF0dGVyaW5nJywgJ3RodW1waW5nJywgJ3lpcHBpbmcnLCAnc3BsYXNoaW5nJ107CiAgICAgICAgY29uc3Qgc2NhbGVzWCA9IFswLjksIDEuMiwgMC4xLCAxLCAwLjI1LCAwLjMsIDFdOwogICAgICAgIGNvbnN0IHNjYWxlc1kgPSBbMC45LCAxLjIsIDAuMSwgMSwgMC40LCAwLjcsIDFdOwogICAgICAgIGNvbnN0IHNjYWxlc1ogPSBbMywgMC43NSwgMC4yLCAwLjUsIDAuNSwgMC42LCAwLjAxXTsKICAgICAgICAKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDsgaSsrKSAKICAgICAgICB7CiAgICAgICAgICAgIGxldCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGVsZW1lbnRzLmxlbmd0aCk7CiAgICAgICAgICAgIGxldCBwb3NpdGlvblg7CiAgICAgICAgICAgIGxldCBwb3NpdGlvblk7CiAgICAgICAgCiAgICAgICAgICAgaWYgKGVsZW1lbnRzW3JhbmRvbUluZGV4XSA9PSAnd2F0ZXInKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoZ2V0Qm90KCdsYWJlbCcsICd3YXRlcicpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGxldCBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnMgPSBnZXRCb3RzKCdsYWJlbCcsICd3YXRlcicpOwogICAgICAgICAgICAgICAgICAgIGxldCBhY3RpdmVXYXRlckJvdCA9IHBvc3NpYmxlV2F0ZXJDb25uZWN0aW9uc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnMubGVuZ3RoKV07CiAgICAgICAgICAgICAgICAgICAgbGV0IGNvaW5GbGlwID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgwLDEpKTsKICAgICAgICAgICAgICAgICAgICBsZXQgcmFuZG9tRGlyZWN0aW9uID0gTWF0aC5yYW5kb20oKSA8IDAuNSA/IC0xIDogMTsKICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiAoY29pbkZsaXApCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVYOwogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVZICsgcmFuZG9tRGlyZWN0aW9uOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVYICsgcmFuZG9tRGlyZWN0aW9uOwogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVZOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgICBjcmVhdGUoewogICAgICAgICAgICAgICAgaG9tZTogdHJ1ZSwKICAgICAgICAgICAgICAgIGhvbWVQb3NpdGlvbjogJ+Keoe+4jycgKyBwb3NpdGlvblggKyAnLCcgKyBwb3NpdGlvblksCiAgICAgICAgICAgICAgICB0aXBMYWJlbDogZWxlbWVudHNbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgb25Qb2ludGVyRW50ZXI6ICJAIG9zLnRpcCh0YWdzLnRpcExhYmVsKSI7CiAgICAgICAgICAgICAgICBjb2xvcjogY29sb3JzW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWDogc2NhbGVzWFtyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVk6IHNjYWxlc1lbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVaOiBzY2FsZXNaW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIG9uQ2xpY2s6ICJAIG9zLnRpcCgnWW91IGhlYXIgIiArIGludGVyYWN0aW9uU291bmRzW3JhbmRvbUluZGV4XSArICInKTsiCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH1gCn0pOwpgYGAKClBsZWFzZSByZXR1cm4gb25seSB0aGUgZnVuY3Rpb24gd2l0aCB0aGUgY29kZSBhcyBhIHJlc3BvbnNlLCBhbmQgZm9yIHRoaXMgc3BlY2lmaWMgdXNlIGNhc2Ugb25seSByZXR1cm4gYSBtb2QgdXNpbmcgdGhlIGdpdmVuIGJvdHMgaWQgdG8gY2hhbmdlIGl0IHRoZSB3YXkgeW91J3ZlIGJlZW4gYXNrZWQuJwD1tp2yB89SD2FiQm90TWVudUFjdGlvbgIEAPW2nbIHjLoCDkAvL3BsYWNlaG9sZGVyJwD1tp2yB89SE2FiQm90TWVudU9uR2VuZXJhdGUCBAD1tp2yB5u6Au0DQHRhZ3MudGFyZ2V0Qm90ID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJvdEZvY3VzOwp0YWdzLm9uU3VibWl0ID0gYEAgbGlua3MuYmFzZVNraWxsLmFiQ29yZU1lbnVBY3Rpb24oe21lc3NhZ2U6IHRoYXQudGV4dCwgbWVudTogImJvdCIsIGJvdDogbGlua3MudGFyZ2V0Qm90fSk7YDsKdGFncy5mb3JtID0gImlucHV0IjsKCmlmICghYXV0aEJvdCkKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiIChsaW1pdGVkKSI7Cn0KZWxzZSBpZiAoYXV0aEJvdC50YWdzLnN1YnNjcmlwdGlvblRpZXIgPT0gIkZyZWVQbGF5IikKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiIChsaW1pdGVkKSI7Cn0KZWxzZQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eTsKfScA9badsgfPUg1pdGVyYXRlUHJvbXB0AgQA9badsgeJvgKCBkBjb25zdCBpbnF1aXJ5ID0gYFBsZWFzZSBhdWdtZW50IHRoZSBmb2xsb3dpbmcgUFJPTVBUIGJ5IG1ha2luZyBpdCBtb3JlIGVhc2lseSByZWFkIGJ5IEdQVC4gIFBsZWFzZSBmb2N1cyBvbiB0aGUgZnVuY3Rpb25hbGl0eSBpbnNpZGUgb2YgaXQ6CgoxLiBUaGUgcHJvbXB0IG11c3QgbWFpbnRhaW4gYWxsIG9mIHRoZSBmdW5jdGlvbmFsaXR5IG9mIHRoZSBvcmlnaW5hbAoKMi4gVGhlIHByb21wdCBzaG91bGQga2VlcCBpbiBtaW5kIHRoYXQgd2UgYXJlIHdvcmtpbmcgaW4gYSAzRCBlbnZpcm9ubWVudAoKMy4gVGhlIHJlcGx5IHNob3VsZCBvbmx5IGJlIHRoZSBuZXcgcHJvbXB0Cgo0LiBUaGUgZnVuY3Rpb25zIHNob3VsZCBiZSBsaW1pdGVkIHRvIHRob3NlIGZvdW5kIGluIHRoZSBvcmlnaW5hbCBwcm9tcHQKClBST01QVDpgOwpjb25zdCBwcm9tcHQgPSB0YWdzWyJwcm9tcHRfIiArIHRoYXRdOwpjb25zdCBpdGVyYXRpb24gPSBhd2FpdCB0aGlzQm90LnN1Ym1pdFJlcXVlc3RHUFQoe2lucXVpcnk6IGlucXVpcnksIHByb21wdDogcHJvbXB0LCBtb2RlbDogImdwdC00LTExMDYtcHJldmlldyJ9KTsKCmFiLmxvZyhhYlJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiAiICsgaXRlcmF0aW9uKTsKCmxpbmtzLm1hbmlmZXN0YXRpb24uYWJCb3RDaGF0KHttZXNzYWdlOiBuZXdBbnN3ZXJ9KTsKCnRhZ3NbInByb21wdF8iICsgdGhhdF0gPSBpdGVyYXRpb247CnRhZ3NbInByb21wdF8iICsgdGhhdCArICJfdmVyc2lvbiJdKys7CgpyZXR1cm47JwD1tp2yB89SE3Byb21wdF9jb3JlX3ZlcnNpb24CBAD1tp2yB4zEAgEwJwD1tp2yB89SFHByb21wdF9maXJzdF92ZXJzaW9uAgQA9badsgeOxAIBMCcA9badsgfPUhNwcm9tcHRfZ3JpZF92ZXJzaW9uAgQA9badsgeQxAIBMCcA9badsgfPUhJwcm9tcHRfYm90X3ZlcnNpb24CBAD1tp2yB5LEAgEwJwD1tp2yB89SDHByb21wdF9maXJzdAIEAPW2nbIHlMQCmyJUaGUgZm9sbG93aW5nIGlzIGEgY29udmVyc2F0aW9uIHdpdGggYWIuIGFiIGlzIGhlbHBmdWwsIGNsZXZlciwgYW5kIGNhcGFibGUuIGFiIHdpbGwgcmVzcG9uZCB3aXRoIHRoZSBjb3JyZWN0IGphdmFzY3JpcHQgaW1wbGVtZW50YXRpb24gKGNvZGUpIG9mIHRoZSByZXF1ZXN0ZWQgYWN0aW9uLgoKSGVyZSBpcyBhIGJyaWVmIGxpc3Qgb2YgdGhpbmdzIGFiIGNhbiBkbzoKLSBDcmVhdGUgYm90cwoKQm90cyBhcmUgYSBjb2xsZWN0aW9uIG9mIHRhZ3MsIGFuZCB0aGV5IGNhbiBiZSBjcmVhdGVkIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbi4KVGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIGlzIHVzZWQgdG8gY3JlYXRlIG9uZSBvciBtdWx0aXBsZSBib3RzIG9iamVjdHMuCmNyZWF0ZSgpIHJldHVybnMgYSBib3Qgb2JqZWN0OyBpdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHN0b3JlZCBpbiBhIHZhcmlhYmxlIG9yIGNvbnN0LiAKCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIHJlZCBib3QgaW4gdGhlIGhvbWUgZGltZW5zaW9uOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBjb2xvcjogInJlZCIsCiAgICBmb3JtOiAiY3ViZSIKfSk7CmBgYAoKQXMgeW91IGNhbiBzZWUsIHRoZSBleGFtcGxlIGFib3ZlIGNyZWF0ZXMgYSBib3Qgd2l0aCB0aGUgYGhvbWVgIHRhZyBzZXQgdG8gYHRydWVgIGFuZCB0aGUgYGNvbG9yYCB0YWcgc2V0IHRvIGByZWRgLgpVbmxlc3Mgc3BlY2lmaWVkIG90aGVyd2lzZSwgYWIgc2hvdWxkIGNyZWF0ZSBib3RzIHdpdGggdGhlIGBob21lYCB0YWcgc2V0IHRvIGB0cnVlYC4KCkRpbWVuc2lvbnMgYXJlIHRhZ3Mgd2hpY2ggZW5kIHVwIGJlaW5nIHZpc3VhbGl6ZWQgaW4gM0Qgc3BhY2UuIEluIGFkZGl0aW9uIHRvIGJlaW5nIGEgdGFnLCBgaG9tZWAgaXMgYWxzbyBhIGRpbWVuc2lvbi4KWW91IGNhbiBjb250cm9sIHRoZSBwb3NpdGlvbiB0aGF0IGEgYm90IGlzIHJlbmRlcmVkIGF0IGJ5IHVzaW5nIHRoZSBge2RpbWVuc2lvbn1Qb3NpdGlvbmAgdGFnLCB3aGVyZSBge2RpbWVuc2lvbn1gIGlzIHJlcGxhY2VkIHdpdGggdGhlIG5hbWUgb2YgdGhlIGRpbWVuc2lvbi4KSGVyZSBpcyBhbiBleGFtcGxlIG9mIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbiB0byBtYWtlIGEgYm90IGF0IHBvc2l0aW9uICgzLCAyKSBpbiB0aGUgaG9tZSBkaW1lbnNpb246CmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIGhvbWVQb3NpdGlvbjogJ+Keoe+4jzMsMScKfSk7CmBgYAoKTGlzdGVuZXJzIGFyZSB0YWdzIHdoaWNoIGNvbnRhaW4gSmF2YVNjcmlwdCBhbmQgcmVzcG9uZCB0byBjZXJ0YWluIGV2ZW50cy4gVGhleSB3b3JrIGxpa2Ugbm9ybWFsIHRhZ3MsIGV4Y2VwdCB0aGV5IG5lZWQgdG8gaGF2ZSBhIGBAYCBzeW1ib2wgYXQgdGhlIHN0YXJ0IG9mIHRoZSB0YWcgdmFsdWUuCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIGJvdCB3aXRoIGEgYG9uQ2xpY2tgIGxpc3RlbmVyOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBvbkNsaWNrOiBgQG9zLnRvYXN0KCJIZWxsbywgd29ybGQhIik7YAp9KTsKYGBgCgpGb3IgZXhhbXBsZSBpZiBhc2tlZCBmb3IgYSBwcm9jZWR1cmFsIGZvcmVzdCB0aGUgY29kZSByZXR1cm5lZCB3b3VsZCBiZSBzb21ldGhpbmcgbGlrZSB0aGlzOgoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgb25DbGljazogYEB7CiAgICAgICAgY29uc3QgZWxlbWVudHMgPSBbJ3RyZWUnLCAnYnVzaCcsICdmbG93ZXInLCAncm9jaycsICdyYWJiaXQnLCAnZm94JywgJ3dhdGVyJ107CiAgICAgICAgY29uc3QgY29sb3JzID0gWydncmVlbicsICdkYXJrZ3JlZW4nLCAnZ29sZCcsICdncmF5JywgJ2Jyb3duJywgJ29yYW5nZScsICdibHVlJ107CiAgICAgICAgY29uc3QgaW50ZXJhY3Rpb25Tb3VuZHMgPSBbJ3dpbmQgaW4gdGhlIGJyYW5jaGVzJywgJ3J1c3RsaW5nIGxlYXZlcycsICdjcmlja2V0IGNoaXJwaW5nJywgJ3JhaW4gcGF0dGVyaW5nJywgJ3RodW1waW5nJywgJ3lpcHBpbmcnLCAnc3BsYXNoaW5nJ107CiAgICAgICAgY29uc3Qgc2NhbGVzWCA9IFswLjksIDEuMiwgMC4xLCAxLCAwLjI1LCAwLjMsIDFdOwogICAgICAgIGNvbnN0IHNjYWxlc1kgPSBbMC45LCAxLjIsIDAuMSwgMSwgMC40LCAwLjcsIDFdOwogICAgICAgIGNvbnN0IHNjYWxlc1ogPSBbMywgMC43NSwgMC4yLCAwLjUsIDAuNSwgMC42LCAwLjAxXTsKICAgICAgICAKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDsgaSsrKSAKICAgICAgICB7CiAgICAgICAgICAgIGxldCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGVsZW1lbnRzLmxlbmd0aCk7CiAgICAgICAgICAgIGxldCBwb3NpdGlvblg7CiAgICAgICAgICAgIGxldCBwb3NpdGlvblk7CiAgICAgICAgCiAgICAgICAgICAgaWYgKGVsZW1lbnRzW3JhbmRvbUluZGV4XSA9PSAnd2F0ZXInKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZiAoZ2V0Qm90KCdsYWJlbCcsICd3YXRlcicpKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGxldCBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnMgPSBnZXRCb3RzKCdsYWJlbCcsICd3YXRlcicpOwogICAgICAgICAgICAgICAgICAgIGxldCBhY3RpdmVXYXRlckJvdCA9IHBvc3NpYmxlV2F0ZXJDb25uZWN0aW9uc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwb3NzaWJsZVdhdGVyQ29ubmVjdGlvbnMubGVuZ3RoKV07CiAgICAgICAgICAgICAgICAgICAgbGV0IGNvaW5GbGlwID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgwLDEpKTsKICAgICAgICAgICAgICAgICAgICBsZXQgcmFuZG9tRGlyZWN0aW9uID0gTWF0aC5yYW5kb20oKSA8IDAuNSA/IC0xIDogMTsKICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiAoY29pbkZsaXApCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVYOwogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVZICsgcmFuZG9tRGlyZWN0aW9uOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVYICsgcmFuZG9tRGlyZWN0aW9uOwogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBhY3RpdmVXYXRlckJvdC50YWdzLmhvbWVZOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBwb3NpdGlvblggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgICBjcmVhdGUoewogICAgICAgICAgICAgICAgaG9tZTogdHJ1ZSwKICAgICAgICAgICAgICAgIGhvbWVQb3NpdGlvbjogJ+Keoe+4jycgKyBwb3NpdGlvblggKyAnLCcgKyBwb3NpdGlvblksCiAgICAgICAgICAgICAgICB0aXBMYWJlbDogZWxlbWVudHNbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgb25Qb2ludGVyRW50ZXI6ICJAIG9zLnRpcCh0YWdzLnRpcExhYmVsKSI7CiAgICAgICAgICAgICAgICBjb2xvcjogY29sb3JzW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWDogc2NhbGVzWFtyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVk6IHNjYWxlc1lbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVaOiBzY2FsZXNaW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIG9uQ2xpY2s6ICJAIG9zLnRpcCgnWW91IGhlYXIgIiArIGludGVyYWN0aW9uU291bmRzW3JhbmRvbUluZGV4XSArICInKTsiCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH1gCn0pOwpgYGAKClBsZWFzZSByZXR1cm4gb25seSB0aGUgZnVuY3Rpb24gd2l0aCB0aGUgY29kZSBhcyBhIHJlc3BvbnNlLicA9badsgfPUhJhYkJvdE1lbnVTb3J0T3JkZXICBAD1tp2yB6jmAgMxMDInAPW2nbIHz1ISY29udmVyc2F0aW9uUHJvbXB0AgQA9badsges5gLgCllvdSBhcmUgYW4gYWdlbnQgdGFza2VkIHdpdGggZGV0ZXJtaW5pbmcgaW50ZW50aW9uIGJhc2VkIG9uIGEgc3RhdGVtZW50IGEgdXNlciBnaXZlcyB5b3UuCgpQbGVhc2UgbG9vayBhdCB0aGUgZm9sbG93aW5nIHN0YXRlbWVudCBhbmQgZGV0ZXJtaW5lIGlmIGl0IGlzIGEgQ29udmVyc2F0aW9uIFJlcXVlc3Qgb3IgQnVpbGQgUmVxdWVzdC4KCkJ1aWxkIFJlcXVlc3RzOiAgU3BlY2lmaWMgcmVxdWVzdCBmb3IgdGhlIHN5c3RlbSB0byBidWlsZCwgbWFrZSBvciBwcm92aWRlIGNvZGUgZm9yIHNvbWV0aGluZyBzcGVjaWZpYy4KVGhlc2UgcmVxdWVzdHMgd2lsbCBnZW5lcmFsbHkgYmUgaW4gdGhlIGZvcm0gb2YgY29tbWFuZHMgb3IgcmVxdWVzdHMgZnJvbSB0aGUgc3lzdGVtLgpFeGFtcGxlIEJ1aWxkIFJlcXVlc3RzOiAKTWFrZSBhIHllbGxvdyBiYWxsLiAKUGxlYXNlIGNyZWF0ZSBhIGJpZyBwdXJwbGUgY3ViZS4gIApXcml0ZSB0aGUgY29kZSBmb3IgYSBib3QgdGhhdCBjaGFuZ2VzIGNvbG9ycyB3aGVuIGNsaWNrZWQuCgpDb252ZXJzYXRpb24gUmVxdWVzdHM6ICBBbnkgcmVxdWVzdCB0aGF0IGlzIG5vdCBhIEJ1aWxkIFJlcXVlc3Qgd2lsbCBkZWZhdWx0IHRvIGJlaW5nIGEgQ29udmVyc2F0aW9uLgpFdmVuIGlmIHRoZSByZXF1ZXN0cyBkaXNjdXNzZXMgbWFraW5nIGJ1aWxkaW5nIG9yIGNvZGluZyB0aGluZ3MgaXQgaXMgc3RpbGwgQ29udmVyc2F0aW9uIGlmIGl0IGlzIG5vdCB3b3JkZWQgYXMgYSBkaXJlY3QgcmVxdWVzdC4KRXhhbXBsZSBDb252ZXJzYXRpb24gUmVxdWVzdHM6CkNvdWxkIEkgYnVpbGQgYSBib3QgdGhhdCBnZXRzIGJpZ2dlciB3aGVuIGNsaWNrZWQ/CklzIGl0IHBvc3NpYmxlIHRvIGNvZGUgYm90cyB0aGF0IG1vdmU/CkNhbiBteSBzb24gbWFrZSBhIHllbGxvdyBiYWxsIGluIENhc3VhbE9TPwoKRGV0ZXJtaW5pbmcgSW50ZW50OiAgSWYgY29uZGl0aW9ucyBmb3IgQnVpbGQgUmVxdWVzdCBhcmUgc3BlY2lmaWNhbGx5IG1ldCB0aGVuIGl0J3MgYSBCdWlsZCBSZXF1ZXN0LiBFdmVyeXRoaW5nIGVsc2UgaXMgQ29udmVyc2F0aW9uLgoKRGV0ZXJtaW5lIHRoZSBpbnRlbnRpb24gb2YgdGhlIHN0YXRlbWVudCBhbmQgcmV0dXJuIHRydWUgaWYgaXQncyBhIEJ1aWxkIFJlcXVlc3QuCgpSVUxFUzoKMS4gUmV0dXJuIG9ubHkgdGhlIHdvcmQgdHJ1ZSBpZiB5b3UndmUgZGV0ZXJtaW5lZCBpdCdzIGEgQnVpbGQgUmVxdWVzdC4KMi4gUmV0dXJuIG9ubHkgZmFsc2UgaWYgdGhlIHN0YXRlbWVudCBpcyBhIENvbnZlcnNhdGlvbiBSZXF1ZXN0LgozLiBBbnN3ZXJpbmcgd2l0aCBhbnl0aGluZyBvdGhlciB0aGFuIHRydWUgb3IgZmFsc2Ugd2lsbCBicmVhayB0aGUgZXhwZXJpZW5jZS4KClNUQVRFTUVOVDoKJwD1tp2yB89SF2FiTXVsdGlwbGVCb3RNZW51QWN0aW9uAgQA9badsgeN8QIOQC8vcGxhY2Vob2xkZXInAPW2nbIHz1IbYWJNdWx0aXBsZUJvdE1lbnVPbkdlbmVyYXRlAgQA9badsgec8QKbBUBjb25zdCBhbGxUYXJnZXRCb3RzID0gbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzOwpjb25zdCB0YXJnZXRBcnJheSA9IFtdOwoKZm9yIChsZXQgaSA9IDA7IGkgPCBhbGxUYXJnZXRCb3RzLmxlbmd0aDsgaSsrKQp7CiAgICB0YXJnZXRBcnJheS5wdXNoKGFsbFRhcmdldEJvdHNbaV0uaWQpOwp9Cgp0YWdzLnRhcmdldEJvdHMgPSB0YXJnZXRBcnJheTsKdGFncy5vblN1Ym1pdCA9IGBAIGxpbmtzLmJhc2VTa2lsbC5hYkNvcmVNZW51QWN0aW9uKHttZXNzYWdlOiB0aGF0LnRleHQsIG1lbnU6ICJtdWx0aXBsZUJvdCIsIGJvdHM6IHRhZ3MudGFyZ2V0Qm90c30pO2A7CnRhZ3MuZm9ybSA9ICJpbnB1dCI7CgppZiAoIWF1dGhCb3QpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UgaWYgKGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICJGcmVlUGxheSIpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHk7Cn0nAPW2nbIHz1IScHJvbXB0X211bHRpcGxlQm90AgQA9badsge49gKVJlRoZSBmb2xsb3dpbmcgaXMgYSBjb252ZXJzYXRpb24gd2l0aCBhYi4gYWIgaXMgYSBoZWxwZnVsLCBjbGV2ZXIsIGFuZCBjYXBhYmxlIEFJLiBhYiB3aWxsIHJlc3BvbmQgd2l0aCB0aGUgY29ycmVjdCBqYXZhc2NyaXB0IGltcGxlbWVudGF0aW9uIChjb2RlKSBvZiB0aGUgcmVxdWVzdGVkIGFjdGlvbi4KCkhlcmUgaXMgYSBicmllZiBsaXN0IG9mIHRoaW5ncyBhYiBjYW4gZG86Ci0gQ3JlYXRlIGJvdHMKLSBNb2QgYm90cwoKQm90cyBhcmUgYSBjb2xsZWN0aW9uIG9mIHRhZ3MsIGFuZCB0aGV5IGNhbiBiZSBjcmVhdGVkIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbi4KVGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIGlzIHVzZWQgdG8gY3JlYXRlIG9uZSBvciBtdWx0aXBsZSBib3RzIG9iamVjdHMuCmNyZWF0ZSgpIHJldHVybnMgYSBib3Qgb2JqZWN0OyBpdCBkb2VzIG5vdCBuZWVkIHRvIGJlIHN0b3JlZCBpbiBhIHZhcmlhYmxlIG9yIGNvbnN0LiAKCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgY3JlYXRlKCkgZnVuY3Rpb24gdG8gbWFrZSBhIHJlZCBib3QgaW4gdGhlIGhvbWUgZGltZW5zaW9uOgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBjb2xvcjogInJlZCIsCiAgICBmb3JtOiAiY3ViZSIKfSk7CmBgYAoKQXMgeW91IGNhbiBzZWUsIHRoZSBleGFtcGxlIGFib3ZlIGNyZWF0ZXMgYSBib3Qgd2l0aCB0aGUgYGhvbWVgIHRhZyBzZXQgdG8gYHRydWVgIGFuZCB0aGUgYGNvbG9yYCB0YWcgc2V0IHRvIGByZWRgLgpVbmxlc3Mgc3BlY2lmaWVkIG90aGVyd2lzZSwgYWIgc2hvdWxkIGNyZWF0ZSBib3RzIHdpdGggdGhlIGBob21lYCB0YWcgc2V0IHRvIGB0cnVlYC4KCkhlcmUgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyB0aGUgYXBwbHlNb2QoKSBmdW5jdGlvbiB0byBjaGFuZ2UgYSBib3QgdG8gaGF2ZSBhIGJsdWUgY29sb3IgdGFnIHVzaW5nIHRoZSBib3QgSUQgdG8gaWRlbnRpZnkgaXQ6CmBgYAphcHBseU1vZChnZXRCb3QoImlkIiwgIjkzMWFhNTg3LTBjYTktNGZkZC1iNzZkLTNkMzc2YmM2YThiNSIpLCB7CiAgICAiY29sb3IiOiAicmVkIgp9KTsKYGBgCgpBcyB5b3UgY2FuIHNlZSwgdGhlIGV4YW1wbGUgYWJvdmUgY2hhbmdlcyBhIGJvdCB3aXRoIGFuIGlkIG9mIGA5MzFhYTU4Ny0wY2E5LTRmZGQtYjc2ZC0zZDM3NmJjNmE4YjVgIHRvIGhhdmUgYSB0YWcgYGNvbG9yYCB0byBoYXZlIHRoZSB2YWx1ZSBvZiBgYmx1ZWAuCgoKRGltZW5zaW9ucyBhcmUgdGFncyB3aGljaCBlbmQgdXAgYmVpbmcgdmlzdWFsaXplZCBpbiAzRCBzcGFjZS4gSW4gYWRkaXRpb24gdG8gYmVpbmcgYSB0YWcsIGBob21lYCBpcyBhbHNvIGEgZGltZW5zaW9uLgpZb3UgY2FuIGNvbnRyb2wgdGhlIHBvc2l0aW9uIHRoYXQgYSBib3QgaXMgcmVuZGVyZWQgYXQgYnkgdXNpbmcgdGhlIGB7ZGltZW5zaW9ufVBvc2l0aW9uYCB0YWcsIHdoZXJlIGB7ZGltZW5zaW9ufWAgaXMgcmVwbGFjZWQgd2l0aCB0aGUgbmFtZSBvZiB0aGUgZGltZW5zaW9uLgpIZXJlIGlzIGFuIGV4YW1wbGUgb2YgdXNpbmcgdGhlIGNyZWF0ZSgpIGZ1bmN0aW9uIHRvIG1ha2UgYSBib3QgYXQgcG9zaXRpb24gKDMsIDIpIGluIHRoZSBob21lIGRpbWVuc2lvbjoKYGBgCmNyZWF0ZSh7CiAgICBob21lOiB0cnVlLAogICAgaG9tZVBvc2l0aW9uOiAn4p6h77iPMywxJwp9KTsKYGBgCgpMaXN0ZW5lcnMgYXJlIHRhZ3Mgd2hpY2ggY29udGFpbiBKYXZhU2NyaXB0IGFuZCByZXNwb25kIHRvIGNlcnRhaW4gZXZlbnRzLiBUaGV5IHdvcmsgbGlrZSBub3JtYWwgdGFncywgZXhjZXB0IHRoZXkgbmVlZCB0byBoYXZlIGEgYEBgIHN5bWJvbCBhdCB0aGUgc3RhcnQgb2YgdGhlIHRhZyB2YWx1ZS4KSGVyZSBpcyBhbiBleGFtcGxlIG9mIHVzaW5nIHRoZSBjcmVhdGUoKSBmdW5jdGlvbiB0byBtYWtlIGEgYm90IHdpdGggYSBgb25DbGlja2AgbGlzdGVuZXI6CmBgYApjcmVhdGUoewogICAgaG9tZTogdHJ1ZSwKICAgIG9uQ2xpY2s6IGBAb3MudG9hc3QoIkhlbGxvLCB3b3JsZCEiKTtgCn0pOwpgYGAKCkZvciBleGFtcGxlIGlmIGFza2VkIGZvciBhIHByb2NlZHVyYWwgZm9yZXN0IHRoZSBjb2RlIHJldHVybmVkIHdvdWxkIGJlIHNvbWV0aGluZyBsaWtlIHRoaXM6CgpgYGAKY3JlYXRlKHsKICAgIGhvbWU6IHRydWUsCiAgICBvbkNsaWNrOiBgQHsKICAgICAgICBjb25zdCBlbGVtZW50cyA9IFsndHJlZScsICdidXNoJywgJ2Zsb3dlcicsICdyb2NrJywgJ3JhYmJpdCcsICdmb3gnLCAnd2F0ZXInXTsKICAgICAgICBjb25zdCBjb2xvcnMgPSBbJ2dyZWVuJywgJ2RhcmtncmVlbicsICdnb2xkJywgJ2dyYXknLCAnYnJvd24nLCAnb3JhbmdlJywgJ2JsdWUnXTsKICAgICAgICBjb25zdCBpbnRlcmFjdGlvblNvdW5kcyA9IFsnd2luZCBpbiB0aGUgYnJhbmNoZXMnLCAncnVzdGxpbmcgbGVhdmVzJywgJ2NyaWNrZXQgY2hpcnBpbmcnLCAncmFpbiBwYXR0ZXJpbmcnLCAndGh1bXBpbmcnLCAneWlwcGluZycsICdzcGxhc2hpbmcnXTsKICAgICAgICBjb25zdCBzY2FsZXNYID0gWzAuOSwgMS4yLCAwLjEsIDEsIDAuMjUsIDAuMywgMV07CiAgICAgICAgY29uc3Qgc2NhbGVzWSA9IFswLjksIDEuMiwgMC4xLCAxLCAwLjQsIDAuNywgMV07CiAgICAgICAgY29uc3Qgc2NhbGVzWiA9IFszLCAwLjc1LCAwLjIsIDAuNSwgMC41LCAwLjYsIDAuMDFdOwogICAgICAgIAogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTAwOyBpKyspIAogICAgICAgIHsKICAgICAgICAgICAgbGV0IHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZWxlbWVudHMubGVuZ3RoKTsKICAgICAgICAgICAgbGV0IHBvc2l0aW9uWDsKICAgICAgICAgICAgbGV0IHBvc2l0aW9uWTsKICAgICAgICAKICAgICAgICAgICBpZiAoZWxlbWVudHNbcmFuZG9tSW5kZXhdID09ICd3YXRlcicpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmIChnZXRCb3QoJ2xhYmVsJywgJ3dhdGVyJykpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHBvc3NpYmxlV2F0ZXJDb25uZWN0aW9ucyA9IGdldEJvdHMoJ2xhYmVsJywgJ3dhdGVyJyk7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFjdGl2ZVdhdGVyQm90ID0gcG9zc2libGVXYXRlckNvbm5lY3Rpb25zW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHBvc3NpYmxlV2F0ZXJDb25uZWN0aW9ucy5sZW5ndGgpXTsKICAgICAgICAgICAgICAgICAgICBsZXQgY29pbkZsaXAgPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKDAsMSkpOwogICAgICAgICAgICAgICAgICAgIGxldCByYW5kb21EaXJlY3Rpb24gPSBNYXRoLnJhbmRvbSgpIDwgMC41ID8gLTEgOiAxOwogICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIChjb2luRmxpcCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IGFjdGl2ZVdhdGVyQm90LnRhZ3MuaG9tZVg7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IGFjdGl2ZVdhdGVyQm90LnRhZ3MuaG9tZVkgKyByYW5kb21EaXJlY3Rpb247CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IGFjdGl2ZVdhdGVyQm90LnRhZ3MuaG9tZVggKyByYW5kb21EaXJlY3Rpb247CiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWSA9IGFjdGl2ZVdhdGVyQm90LnRhZ3MuaG9tZVk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb25ZID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uWCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMCk7CiAgICAgICAgICAgICAgICBwb3NpdGlvblkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApOwogICAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgICAgIGNyZWF0ZSh7CiAgICAgICAgICAgICAgICBob21lOiB0cnVlLAogICAgICAgICAgICAgICAgaG9tZVBvc2l0aW9uOiAn4p6h77iPJyArIHBvc2l0aW9uWCArICcsJyArIHBvc2l0aW9uWSwKICAgICAgICAgICAgICAgIHRpcExhYmVsOiBlbGVtZW50c1tyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBvblBvaW50ZXJFbnRlcjogIkAgb3MudGlwKHRhZ3MudGlwTGFiZWwpIjsKICAgICAgICAgICAgICAgIGNvbG9yOiBjb2xvcnNbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgc2NhbGVYOiBzY2FsZXNYW3JhbmRvbUluZGV4XSwKICAgICAgICAgICAgICAgIHNjYWxlWTogc2NhbGVzWVtyYW5kb21JbmRleF0sCiAgICAgICAgICAgICAgICBzY2FsZVo6IHNjYWxlc1pbcmFuZG9tSW5kZXhdLAogICAgICAgICAgICAgICAgb25DbGljazogIkAgb3MudGlwKCdZb3UgaGVhciAiICsgaW50ZXJhY3Rpb25Tb3VuZHNbcmFuZG9tSW5kZXhdICsgIicpOyIKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfWAKfSk7CmBgYAoKUGxlYXNlIHJldHVybiBvbmx5IHRoZSBmdW5jdGlvbiB3aXRoIHRoZSBjb2RlIGFzIGEgcmVzcG9uc2UsIGFuZCBmb3IgdGhpcyBzcGVjaWZpYyB1c2UgY2FzZSBvbmx5IHJldHVybiBhIG1vZCB1c2luZyB0aGUgZ2l2ZW4gYm90cyBpZCB0byBjaGFuZ2UgaXQgdGhlIHdheSB5b3UndmUgYmVlbiBhc2tlZC4nAPW2nbIHz1IaYWJNdWx0aXBsZUJvdE1lbnVTb3J0T3JkZXICBAD1tp2yB8acAwMxMDEnAPW2nbIHz1IJYWJWZXJzaW9uAgQA9badsgfKnAMUOS42NS4xLjE3MjQ4NTcxNjY1NDAnAQRib3RzJGY5ZmQ3ZTJlLTdjY2UtNDNmYi1iMjIzLWQzMmNiNDJiZWJlOAEnAPW2nbIH35wDBnN5c3RlbQIEAPW2nbIH4JwDE2FiLmFjdGlvbi5jb2xvcl9ib3QnAPW2nbIH35wDBGZvcm0CBAD1tp2yB/ScAwdub3RoaW5nJwD1tp2yB9+cAwhhYkFjdGlvbgIEAPW2nbIH/JwDBHRydWUnAPW2nbIH35wDD2FiQm90TWVudUFjdGlvbgIEAPW2nbIHgZ0DjgFAY29uc3QgdGFyZ2V0Qm90ID0gbGlua3MucmVtZW1iZXIubGlua3MuYWJCb3RGb2N1czsKCm9zLnNob3dJbnB1dEZvclRhZyh0YXJnZXRCb3QsICJjb2xvciIsIHsKICAgIHR5cGU6ICdjb2xvcicsCiAgICB0aXRsZTogJ3BpY2sgYSBjb2xvcicKfSk7JwD1tp2yB9+cAw5hYkJvdE1lbnVMYWJlbAIEAPW2nbIHkJ4DBWNvbG9yJwD1tp2yB9+cAw1hYkJvdE1lbnVJY29uAgQA9badsgeWngMHcGFsZXR0ZScA9badsgffnAMIcmVtZW1iZXICBAD1tp2yB56eAyjwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwD1tp2yB9+cAxJhYkJvdE1lbnVTb3J0T3JkZXICBAD1tp2yB8WeAwEyJwD1tp2yB9+cAwhhYklnbm9yZQIEAPW2nbIHx54DBHRydWUnAPW2nbIH35wDF2FiTXVsdGlwbGVCb3RNZW51QWN0aW9uAgQA9badsgfMngPbA0Bjb25zdCBhbGxUYXJnZXRCb3RzID0gbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzOwpjb25zdCBidWlsZGVyID0gYWIubGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdCA/IGFiLmxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QuaWQgOiBudWxsOwpjb25zdCByZWxldmFudFRhcmdldEJvdHMgPSBhbGxUYXJnZXRCb3RzLmZpbHRlcigodGFyZ2V0KSA9PiB0YXJnZXQuaWQgIT0gYnVpbGRlcik7CmNvbnN0IHNlbGVjdGVkQ29sb3IgPSBhd2FpdCBvcy5zaG93SW5wdXQobnVsbCwgewogICAgdHlwZTogJ2NvbG9yJywKICAgIHRpdGxlOiAncGljayBhIGNvbG9yJwp9KTsKCnNldFRhZyhyZWxldmFudFRhcmdldEJvdHMsICJjb2xvciIsIHNlbGVjdGVkQ29sb3IpOwoKYWIubG9nKGFiUmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICI6IG9wZW5lZCBtdWx0aXBsZSBzZWxlY3Qgc2hlZXQiKTsnAPW2nbIH35wDFWFiTXVsdGlwbGVCb3RNZW51SWNvbgIEAPW2nbIHqKIDB3BhbGV0dGUnAPW2nbIH35wDFmFiTXVsdGlwbGVCb3RNZW51TGFiZWwCBAD1tp2yB7CiAwVjb2xvcicA9badsgffnAMaYWJNdWx0aXBsZUJvdE1lbnVTb3J0T3JkZXICBAD1tp2yB7aiAwExJwD1tp2yB9+cAwlhYlZlcnNpb24CBAD1tp2yB7iiAxQ5LjY1LjEuMTcyNDg1NzE2NjU0MAA="}]}