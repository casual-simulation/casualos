{"version":2,"updates":[{"id":0,"timestamp":1721159128873,"update":"AZEC8I3JzAIAJwEEYm90cyQxMDE0MjU0Ni04YzM0LTRiZDYtYWQzNi0wYTE0NjE3OTNkMDkBJwDwjcnMAgAEYWJJRAIEAPCNycwCARRhYnJ3X3Rlc3RfZXhwZXJpZW5jZScA8I3JzAIAEGVnZ0Zvcm1hdFZlcnNpb24CBADwjcnMAhYkMDE3MGQ4YmEtMTdjMC00MmM2LTgwZTktMmIxNWQzY2Q3NWM3KADwjcnMAgANdGFyZ2V0VmVyc2lvbgF9AScA8I3JzAIAB21hbmFnZXICBADwjcnMAjwo8J+Ul2Q4MzcxNDQ0LTkxNTgtNDQzNi04ZmM3LTg0Y2M5MWI3ZjUyNScA8I3JzAIAB29uQ2xpY2sCBADwjcnMAmMlQCBsaW5rcy5tYW5hZ2VyLmludGVyYWN0T3ZvKHRoaXNCb3QpOycA8I3JzAIACG9uQ3JlYXRlAgQA8I3JzAKJAZYEQGNvbnN0IHRhcmdldEFCID0gYXdhaXQgb3Muc2hvd0lucHV0KCdhYicsIHsKICAgIHRpdGxlOiAnYWIgbmFtZScKfSk7CgppZiAoIXRhcmdldEFCIHx8IHRhcmdldEFCID09ICJhYiIpCnsKICAgIG9zLnRvYXN0KCJubyB2YWxpZCBhYiBnaXZlbiIpOwoKICAgIGRlc3Ryb3kodGhpc0JvdCk7CgogICAgcmV0dXJuOwp9CgppZiAoIWF1dGhCb3QudGFncy5wcml2YWN5RmVhdHVyZXMucHVibGlzaERhdGEpCnsKICAgIG9zLnRvYXN0KCJub3QgYXV0aG9yaXplZCIpOwoKICAgIHJldHVybjsKfQoKY29uc3QgZ2V0UmVjb3JkID0gYXdhaXQgb3MuZ2V0RGF0YShsaW5rcy5yZW1lbWJlci50YWdzLmFiUmVjb3JkS2V5LCB0YXJnZXRBQiwgbGlua3MucmVtZW1iZXIudGFncy5hYkVuZHBvaW50KTsKCmlmICghZ2V0UmVjb3JkLnN1Y2Nlc3MpCnsKICAgIG9zLnRvYXN0KCJubyBhYiBmb3VuZCB3aXRoIHRoYXQgbmFtZSIpOwoKICAgIGRlc3Ryb3kodGhpc0JvdCk7CgogICAgcmV0dXJuOwp9CgphcHBseU1vZCh0aGlzQm90LCBnZXRSZWNvcmQuZGF0YSk7JwDwjcnMAgAEZm9ybQIEAPCNycwCoAUDZWdnJwDwjcnMAgAQcHJvZ3Jlc3NCYXJDb2xvcgIEAPCNycwCpAUHI0JGNUU2NicA8I3JzAIAGnByb2dyZXNzQmFyQmFja2dyb3VuZENvbG9yAgQA8I3JzAKsBQcjNTkyOTg5KADwjcnMAgAJbGFiZWxTaXplAXw/AAAAJwDwjcnMAgAKbGFiZWxDb2xvcgIEAPCNycwCtQUHIzQwNDA0MCcA8I3JzAIADm9uUG9pbnRlckVudGVyAgQA8I3JzAK9BS9Ab3MudG9hc3QodGFncy5hYklEICsgJyB2Jyt0YWdzLnRhcmdldFZlcnNpb24pOycA8I3JzAIADWxhYmVsUG9zaXRpb24CBADwjcnMAu0FBWZyb250JwDwjcnMAgAPb3JpZW50YXRpb25Nb2RlAgQA8I3JzALzBQ5iaWxsYm9hcmRGcm9udCcA8I3JzAIACW9uRGVzdHJveQIEAPCNycwCggYjQGxpbmtzLm1hbmFnZXIubWFza3Mub3ZvQm90ID0gbnVsbDsnAPCNycwCAAlkaW1lbnNpb24CBADwjcnMAqYGBGhvbWUnAPCNycwCAAZzeXN0ZW0CBADwjcnMAqsGC2FiLnRvb2wuZWdnJwDwjcnMAgAJbGlzdGVuaW5nAgQA8I3JzAK3BgVmYWxzZScA8I3JzAIACGFiSWdub3JlAgQA8I3JzAK9BgR0cnVlJwDwjcnMAgAIcmVtZW1iZXICBADwjcnMAsIGKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAPCNycwCAAVjb2xvcgIEAPCNycwC6QYHI0ZGRkZGRigA8I3JzAIADGFiQm90VmVyc2lvbgF9FicA8I3JzAIAD2FiTWVudVNvcnRPcmRlcgIEAPCNycwC8gYBMycA8I3JzAIAC3Rvb2xib3hJY29uAgQA8I3JzAL0BgNlZ2cnAPCNycwCAAZhYlRvb2wCBADwjcnMAvgGBHRydWUnAQRib3RzJDFkZDU5NmUxLTg4MjYtNDI1Ny1iNWQ2LWRjMmE5YTU3MWRmNQEnAPCNycwC/QYFY29sb3ICBADwjcnMAv4GByM3QjY0RkYnAPCNycwC/QYEZm9ybQIEAPCNycwChgcDaGV4KADwjcnMAv0GBXNjYWxlAXw/wAAAKADwjcnMAv0GBnNjYWxlWgF7P4R64UeuFHsnAPCNycwC/QYHb25DbGljawIEAPCNycwCjAeJCUBzaG91dCgicGFkTWVudVJlc2V0Iik7Cgpjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9ICJwYWRNZW51IjsKCm1hc2tzLm9uR3JpZENsaWNrID0gYEAgc2hvdXQoInBhZE1lbnVSZXNldCIpO2A7Cm1hc2tzLnBhZE1lbnVSZXNldCA9IGBAIGNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gbnVsbDsKCmNsZWFyVGFnTWFza3ModGhpc0JvdCk7YDsKCmNvbnN0IHBhZExvY2F0aW9ucyA9IHRhZ3MucGFkTG9jYXRpb25zOwpjb25zdCBtZW51QnV0dG9uID0ge307CgptZW51QnV0dG9uLnNwYWNlID0gInRlbXBMb2NhbCI7Cm1lbnVCdXR0b24ucGFkTWVudSA9IHRydWU7Cm1lbnVCdXR0b24ucGFkTWVudVJlc2V0ID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwptZW51QnV0dG9uLm1lbnVJdGVtU3R5bGUgPSB7ImJvcmRlci1yYWRpdXMiOiI4cHgiLCAibWFyZ2luLXRvcCI6IjNweCJ9OwptZW51QnV0dG9uLmxhYmVsQWxpZ25tZW50ID0gImxlZnQiOwptZW51QnV0dG9uLmNvbG9yID0gdGFncy5jb2xvcjsKbWVudUJ1dHRvbi5tYW5hZ2VyID0gZ2V0TGluayh0aGlzQm90KTsKCmlmIChwYWRMb2NhdGlvbnMubGVuZ3RoID4gMCkKewogICAgbWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJtZWV0aW5nX3Jvb20iOwogICAgbWVudUJ1dHRvbi5vbkNsaWNrID0gYEAgbGlua3MubWFuYWdlci5wYWRHb1RvTG9jYXRpb24odGFncy5sYWJlbCk7YDsKCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhZExvY2F0aW9ucy5sZW5ndGg7IGkrKykKICAgIHsKICAgICAgICBtZW51QnV0dG9uLmxhYmVsID0gcGFkTG9jYXRpb25zW2ldOwoKICAgICAgICBjcmVhdGUobWVudUJ1dHRvbik7CiAgICB9Cn0KCm1lbnVCdXR0b24ubGFiZWxBbGlnbm1lbnQgPSAiY2VudGVyIjsKbWVudUJ1dHRvbi5sYWJlbCA9ICIgICAgIjsKbWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJpb3Nfc2hhcmUiOwptZW51QnV0dG9uLm9uQ2xpY2sgPSBgQCBsaW5rcy5tYW5hZ2VyLnBhZFNoYXJlKCk7YDsKCmNyZWF0ZShtZW51QnV0dG9uKTsKCmlmIChidWlsZGVyVmVyc2lvbikKewogICAgbWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJlZGl0IjsKICAgIG1lbnVCdXR0b24ub25DbGljayA9IGBAIGxpbmtzLm1hbmFnZXIucGFkRWRpdE1lbnUoKTtgOwoKICAgIGNyZWF0ZShtZW51QnV0dG9uKTsKfScA8I3JzAL9Bg5vblBvaW50ZXJFbnRlcgIEAPCNycwClhAhQCBtYXNrcy5zY2FsZSA9IHRhZ3Muc2NhbGUgKyAwLjE7JwDwjcnMAv0GDW9uUG9pbnRlckV4aXQCBADwjcnMArgQGUAgY2xlYXJUYWdNYXNrcyh0aGlzQm90KTsnAPCNycwC/QYGc3lzdGVtAgQA8I3JzALSEAthYi50b29sLnBhZCcA8I3JzAL9Bg9wYWRHb1RvTG9jYXRpb24CBADwjcnMAt4QogVAbGV0IHRhcmdldExvY2F0aW9uID0gdGhhdDsKbGV0IHVybENoZWNrID0gZmFsc2U7Cgp0cnkgCnsKICAgIHRhcmdldExvY2F0aW9uID0gbmV3IFVSTCh0aGF0KTsKCiAgICB1cmxDaGVjayA9ICF1cmxDaGVjazsKfQpjYXRjaCAoZSkgCnsKCiAgICBvcy50b2FzdCgidHJhdmVsbGluZyBub3ciKTsKCiAgICBvcy5nb1RvVVJMKCIvP2FiPSIgKyB0YXJnZXRMb2NhdGlvbik7Cn0KCmxldCBpbnN0Q2hlY2sgPSB0YXJnZXRMb2NhdGlvbi5zZWFyY2hQYXJhbXMuaGFzKCJpbnN0Iik7CmxldCBhYkNoZWNrID0gdGFyZ2V0TG9jYXRpb24uc2VhcmNoUGFyYW1zLmhhcygiYWIiKTsKCmlmIChpbnN0Q2hlY2spCnsKICAgIGlmIChhYkNoZWNrKQogICAgewogICAgICAgIG9zLmdvVG9VUkwoIi8/Z3JpZFBvcnRhbD1ob21lJmluc3Q9IiArIHRhcmdldExvY2F0aW9uLnNlYXJjaFBhcmFtcy5nZXQoImluc3QiKSArICImYWI9IiArIHRhcmdldExvY2F0aW9uLnNlYXJjaFBhcmFtcy5nZXQoImFiIikpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIG9zLmdvVG9VUkwoIi8/Z3JpZFBvcnRhbD1ob21lJmluc3Q9IiArIHRhcmdldExvY2F0aW9uLnNlYXJjaFBhcmFtcy5nZXQoImluc3QiKSk7CiAgICB9CiAgICAKfQplbHNlIAp7CiAgICBvcy50b2FzdCgibm90IGEgcmVjb2duaXplZCB1cmwiKTsKfScA8I3JzAL9BgtwYWRFZGl0TWVudQIEAPCNycwCgRaBD0BzaG91dCgicGFkTWVudVJlc2V0Iik7Cgpjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9ICJwYWRNZW51IjsKCm1hc2tzLm9uR3JpZENsaWNrID0gYEAgc2hvdXQoInBhZE1lbnVSZXNldCIpO2A7Cm1hc2tzLnBhZE1lbnVSZXNldCA9IGBAIGNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gbnVsbDsKCmNsZWFyVGFnTWFza3ModGhpc0JvdCk7YDsKCmNvbnN0IHBhZExvY2F0aW9ucyA9IHRhZ3MucGFkTG9jYXRpb25zOwpjb25zdCBtZW51QnV0dG9uID0ge307CgptZW51QnV0dG9uLnNwYWNlID0gInRlbXBMb2NhbCI7Cm1lbnVCdXR0b24ucGFkTWVudVNvcnRPcmRlciA9IDEwMDsKbWVudUJ1dHRvbi5wYWRNZW51UmVzZXQgPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7Cm1lbnVCdXR0b24ubWVudUl0ZW1TdHlsZSA9IHsgImJvcmRlci1yYWRpdXMiOiAiOHB4IiwgIm1hcmdpbi10b3AiOiAiM3B4IiB9OwptZW51QnV0dG9uLmxhYmVsQWxpZ25tZW50ID0gImNlbnRlciI7Cm1lbnVCdXR0b24uY29sb3IgPSAiI0Q2NkQ1RSI7Cm1lbnVCdXR0b24ubWFuYWdlciA9IGdldExpbmsodGhpc0JvdCk7Cm1lbnVCdXR0b24ubGFiZWwgPSAiICAgICI7Cm1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiZGVsZXRlX2ZvcmV2ZXIiOwptZW51QnV0dG9uLm9uQ2xpY2sgPSBgQCBsaW5rcy5tYW5hZ2VyLnBhZFJlbW92ZUxvY2F0aW9ucygpO2A7Cm1lbnVCdXR0b24ub3B0aW9uQ2xpY2sgPSBgQCBpZiAoZ2V0Qm90KGJ5TW9kKHtwYWRMb2NhdGlvbk9wdGlvbjogdHJ1ZSwgZm9ybUFkZHJlc3M6ICJjaGVja19ib3gifSkpKQp7CiAgICB0YWdzLnBhZE1lbnUgPSB0cnVlOwp9CmVsc2UKewogICAgdGFncy5wYWRNZW51ID0gZmFsc2U7Cn1gOwoKbGV0IGRlbGV0ZUJ1dHRvbiA9IGNyZWF0ZShtZW51QnV0dG9uKTsKCm1lbnVCdXR0b24ucGFkTWVudSA9IHRydWU7Cm1lbnVCdXR0b24ubGFiZWxBbGlnbm1lbnQgPSAibGVmdCI7Cm1lbnVCdXR0b24uY29sb3IgPSB0YWdzLmNvbG9yOwptZW51QnV0dG9uLmRlbGV0ZUJ1dHRvbiA9IGdldExpbmsoZGVsZXRlQnV0dG9uKTsKCmlmIChwYWRMb2NhdGlvbnMubGVuZ3RoID4gMCkgCnsKICAgIG1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiY2hlY2tfYm94X291dGxpbmVfYmxhbmsiOwogICAgbWVudUJ1dHRvbi5wYWRMb2NhdGlvbk9wdGlvbiA9IHRydWU7CiAgICBtZW51QnV0dG9uLm9uQ2xpY2sgPSBgQCBpZiAodGFncy5mb3JtQWRkcmVzcyA9PSAiY2hlY2tfYm94X291dGxpbmVfYmxhbmsiKQogICAgewogICAgICAgIHRhZ3MuZm9ybUFkZHJlc3MgPSAiY2hlY2tfYm94IjsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICB0YWdzLmZvcm1BZGRyZXNzID0gImNoZWNrX2JveF9vdXRsaW5lX2JsYW5rIjsKICAgIH0KICAgIAogICAgbGlua3MuZGVsZXRlQnV0dG9uLm9wdGlvbkNsaWNrKHRoaXNCb3QpO2A7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYWRMb2NhdGlvbnMubGVuZ3RoOyBpKyspIAogICAgewogICAgICAgIG1lbnVCdXR0b24ucGFkTWVudVNvcnRPcmRlciA9IGk7CiAgICAgICAgbWVudUJ1dHRvbi5sYWJlbCA9IHBhZExvY2F0aW9uc1tpXTsKCiAgICAgICAgY3JlYXRlKG1lbnVCdXR0b24pOwogICAgfQp9CgptZW51QnV0dG9uLm9uQ2xpY2sgPSBudWxsOwptZW51QnV0dG9uLnBhZExvY2F0aW9uT3B0aW9uID0gbnVsbDsKbWVudUJ1dHRvbi5wYWRNZW51U29ydE9yZGVyID0gLTE7Cm1lbnVCdXR0b24ubGFiZWwgPSAiKyI7Cm1lbnVCdXR0b24uZm9ybSA9ICJpbnB1dCI7Cm1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAibWVldGluZ19yb29tIjsKbWVudUJ1dHRvbi5vblN1Ym1pdCA9IGBAIGlmICghdGhhdCkKewogICAgcmV0dXJuOwp9CgpsaW5rcy5tYW5hZ2VyLnBhZEFkZExvY2F0aW9uKHRoYXQudGV4dCk7YDsKCmNyZWF0ZShtZW51QnV0dG9uKTsnAPCNycwC/QYIcGFkU2hhcmUCBADwjcnMAoMlY0BzaG91dCgicGFkTWVudVJlc2V0Iik7Cgpvcy5zZXRDbGlwYm9hcmQoY29uZmlnQm90LnRhZ3MudXJsKTsKCm9zLnRvYXN0KCJ1cmwgY29waWVkIHRvIGNsaXBib2FyZCIpOycA8I3JzAL9Bg5wYWRBZGRMb2NhdGlvbgIEAPCNycwC5yWHAUBzaG91dCgicGFkTWVudVJlc2V0Iik7CgpsZXQgbmV3QXJyYXkgPSB0YWdzLnBhZExvY2F0aW9uczsKCm5ld0FycmF5LnB1c2godGhhdCk7Cgp0YWdzLnBhZExvY2F0aW9ucyA9IG5ld0FycmF5OwoKdGhpc0JvdC5wYWRFZGl0TWVudSgpOycA8I3JzAL9BhJwYWRSZW1vdmVMb2NhdGlvbnMCBADwjcnMAu8m5QNAY29uc3QgcGFkTWVudU9wdGlvbnMgPSBnZXRCb3RzKGJ5TW9kKHtwYWRMb2NhdGlvbk9wdGlvbjogdHJ1ZSwgZm9ybUFkZHJlc3M6ICJjaGVja19ib3giLCBwYWRNZW51OiB0cnVlfSkpOwpjb25zdCByZW1vdmVUYXJnZXRzID0gW107Cgpmb3IgKGxldCBpID0gMDsgaSA8IHBhZE1lbnVPcHRpb25zLmxlbmd0aDsgaSsrKQp7CiAgICByZW1vdmVUYXJnZXRzLnB1c2gocGFkTWVudU9wdGlvbnNbaV0udGFncy5sYWJlbCk7Cn0KCnNob3V0KCJwYWRNZW51UmVzZXQiKTsKCmNvbnN0IHBhZExvY2F0aW9ucyA9IHRhZ3MucGFkTG9jYXRpb25zOwoKZm9yIChsZXQgaiA9IDA7IGogPCByZW1vdmVUYXJnZXRzLmxlbmd0aDsgaisrKQp7CiAgICBsZXQgdGFyZ2V0SW5kZXggPSBwYWRMb2NhdGlvbnMuaW5kZXhPZihyZW1vdmVUYXJnZXRzW2pdKTsKCiAgICBwYWRMb2NhdGlvbnMuc3BsaWNlKHRhcmdldEluZGV4LCAxKTsKfQoKdGhpc0JvdC5wYWRFZGl0TWVudSgpOygA8I3JzAL9BgxhYkJvdFZlcnNpb24BfQwnAPCNycwC/QYIYWJJZ25vcmUCBADwjcnMAtYqBHRydWUnAPCNycwC/QYJbGlzdGVuaW5nAgQA8I3JzALbKgVmYWxzZScA8I3JzAL9Bgt0b29sTWFuYWdlcgIEAPCNycwC4Soo8J+UlzE0ZTFmZGFjLWNmZDctNGU3ZS1iZGQxLTk2N2E0MDg1YTc1NScA8I3JzAL9BghvbkNyZWF0ZQIEAPCNycwCiCtSQGlmICghdGFncy5zeXN0ZW0pCnsKICAgIGxldCBiYXNlQXJyYXkgPSBbXTsKCiAgICB0YWdzLnBhZExvY2F0aW9ucyA9IGJhc2VBcnJheTsKfScA8I3JzAL9Bg9hYk1lbnVTb3J0T3JkZXICBADwjcnMAtsrATEnAPCNycwC/QYLdG9vbGJveEljb24CBADwjcnMAt0rDG1lZXRpbmdfcm9vbScA8I3JzAL9BgZhYlRvb2wCBADwjcnMAuorBHRydWUnAQRib3RzJGE1ZTJlZWRmLWNkMTctNGJmOC1hOTg2LWRkODJhYTFmZDg1OAEnAPCNycwC7ysFY29sb3ICBADwjcnMAvArByM2MjI3NzMnAPCNycwC7ysEZm9ybQIEAPCNycwC+CsFaGVsaXgnAPCNycwC7ysEbW9kcwIEAPCNycwC/isY8J+nrHsiY29sb3IiOiAiIzYyMjc3MyJ9JwDwjcnMAu8rBnN5c3RlbQIEAPCNycwClSwLYWIudG9vbC5tb2QnAPCNycwC7ysIYWJJZ25vcmUCBADwjcnMAqEsBHRydWUnAPCNycwC7ysJbGlzdGVuaW5nAgQA8I3JzAKmLAVmYWxzZScA8I3JzALvKwt0b29sTWFuYWdlcgIEAPCNycwCrCwo8J+UlzE0ZTFmZGFjLWNmZDctNGU3ZS1iZGQxLTk2N2E0MDg1YTc1NScA8I3JzALvKwdvbkNsaWNrAgQA8I3JzALTLJMGQHNob3V0KCJtb2RNZW51UmVzZXQiKTsKCmNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gIm1vZE1lbnUiOwoKbWFza3Mub25HcmlkQ2xpY2sgPSBgQCBzaG91dCgibW9kTWVudVJlc2V0Iik7YDsKbWFza3MubW9kTWVudVJlc2V0ID0gYEAgY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSBudWxsOwpjb25maWdCb3QubWFza3MudGFnUG9ydGFsID0gbnVsbDsKCnRhZ1BvcnRhbEJvdC5tYXNrcy50YWdQb3J0YWxBbmNob3IgPSBudWxsOwoKY2xlYXJUYWdNYXNrcyh0aGlzQm90KTtgOwoKbGV0IG1vZE1lbnVCb3QgPSB7fTsKCm1vZE1lbnVCb3Quc3BhY2UgPSAidGVtcExvY2FsIjsKbW9kTWVudUJvdC5tb2RNZW51ID0gdHJ1ZTsKbW9kTWVudUJvdC5sYWJlbCA9ICJlZGl0IG1vZCI7Cm1vZE1lbnVCb3QuZm9ybUFkZHJlc3MgPSAiZWRpdCI7Cm1vZE1lbnVCb3QuY29sb3IgPSB0YWdzLmNvbG9yOwptb2RNZW51Qm90Lm1vZERpbWVuc2lvbiA9IHRoaXNCb3QuaWQgKyAiLm1vZHMiOwptb2RNZW51Qm90Lm1vZE1lbnVSZXNldCA9IGBAIGRlc3Ryb3kodGhpc0JvdCk7YDsKbW9kTWVudUJvdC5tZW51SXRlbVN0eWxlID0geyJib3JkZXItcmFkaXVzIjoiOHB4IiwgIm1hcmdpbi10b3AiOiIzcHgifTsKbW9kTWVudUJvdC5vbkNsaWNrID0gYEAgZGVzdHJveSh0aGlzQm90KTsKCmNvbmZpZ0JvdC5tYXNrcy50YWdQb3J0YWwgPSB0YWdzLm1vZERpbWVuc2lvbjsKCnRhZ1BvcnRhbEJvdC5tYXNrcy50YWdQb3J0YWxBbmNob3JQb2ludCA9ICJ0b3AiOwpgOwoKY3JlYXRlKG1vZE1lbnVCb3QpOycA8I3JzALvKwZvbkRyb3ACBADwjcnMAucy6QJAaWYgKHRoYXQuZHJhZ0JvdCAhPSB0aGlzQm90IHx8IHRoYXQudG8uYm90LnRhZ3MuYWJUb29sYm94KQp7CiAgICByZXR1cm47Cn0KCmFwcGx5TW9kKHRoYXQudG8uYm90LCB0YWdzLm1vZHMpOwoKbGV0IHByZXZpb2l1c0RpbWVuc2lvbiA9IHRoYXQuZnJvbS5kaW1lbnNpb247Cgp0YWdzW3RoYXQudG8uZGltZW5zaW9uXSA9IG51bGw7CnRhZ3NbcHJldmlvaXVzRGltZW5zaW9uXSA9IHRydWU7CnRhZ3NbcHJldmlvaXVzRGltZW5zaW9uICsgIlgiXSA9IHRoYXQuZnJvbS54Owp0YWdzW3ByZXZpb2l1c0RpbWVuc2lvbiArICJZIl0gPSB0aGF0LmZyb20ueTsKdGFnc1twcmV2aW9pdXNEaW1lbnNpb24gKyAiWiJdID0gdGhhdC5mcm9tLno7KADwjcnMAu8rDGFiQm90VmVyc2lvbgF9FicA8I3JzALvKw9hYk1lbnVTb3J0T3JkZXICBADwjcnMAtI1ATQnAPCNycwC7ysLdG9vbGJveEljb24CBADwjcnMAtQ1BWhlbGl4JwDwjcnMAu8rBmFiVG9vbAIEAPCNycwC2jUEdHJ1ZScBBGJvdHMkYzQ0ZWJjN2YtM2RmNy00ZThlLTk3ODEtMTRlMmNlOGUzNGM4AScA8I3JzALfNQVjb2xvcgIEAPCNycwC4DUHIzkwOEJGQygA8I3JzALfNQxhYkJvdFZlcnNpb24BfRsnAPCNycwC3zUEZm9ybQIEAPCNycwC6TUGY2lyY2xlKADwjcnMAt81BXNjYWxlAX0CJwDwjcnMAt81C3Rvb2xNYW5hZ2VyAgQA8I3JzALxNSjwn5SXMTRlMWZkYWMtY2ZkNy00ZTdlLWJkZDEtOTY3YTQwODVhNzU1JwDwjcnMAt81BnNjYWxlWgIEAPCNycwCmDYDMC4xJwDwjcnMAt81BnN5c3RlbQIEAPCNycwCnDYQYWIudG9vbC5ib3RTdG9yZScA8I3JzALfNQZvbkRyb3ACBADwjcnMAq02f0BpZiAodGhhdC5kcmFnQm90ID09IHRoaXNCb3QgfHwgdGhhdC5kcmFnQm90LnRhZ3Muc3BhY2UgIT0gInNoYXJlZCIpCnsKICAgIHJldHVybjsKfQoKdGhpc0JvdFt0YWdzLnN0b3JlTW9kZSArICJPbkRyb3AiXSh0aGF0KTsnAPCNycwC3zURYm90U3RvcmVSZWplY3RCb3QCBADwjcnMAq03igJAdGhhdC5kcmFnQm90LnRhZ3NbdGhhdC50by5kaW1lbnNpb25dID0gbnVsbDsKdGhhdC5kcmFnQm90LnRhZ3NbdGhhdC5mcm9tLmRpbWVuc2lvbl0gPSB0cnVlOwp0aGF0LmRyYWdCb3QudGFnc1t0aGF0LmZyb20uZGltZW5zaW9uKyJYIl0gPSB0aGF0LmZyb20ueDsKdGhhdC5kcmFnQm90LnRhZ3NbdGhhdC5mcm9tLmRpbWVuc2lvbisiWSJdID0gdGhhdC5mcm9tLnk7CnRoYXQuZHJhZ0JvdC50YWdzW3RoYXQuZnJvbS5kaW1lbnNpb24rIloiXSA9IHRoYXQuZnJvbS56OycA8I3JzALfNQlzdG9yZU1vZGUCBADwjcnMArg5CXVubGltaXRlZCcA8I3JzALfNQ91bmxpbWl0ZWRPbkRyb3ACBADwjcnMAsI5ZUBpZiAodGFncy50ZW1wbGF0ZSkKewogICAgdGhpc0JvdC5ib3RTdG9yZVJlamVjdEJvdCh0aGF0KTsKCiAgICByZXR1cm47Cn0KCnRoaXNCb3QuYWRkVGVtcGxhdGUodGhhdCk7JwDwjcnMAt81DWxpbWl0ZWRPbkRyb3ACBADwjcnMAqg6iQJAaWYgKCh0YWdzLmJvdFN0b3JlSUQgJiYgdGhhdC5kcmFnQm90LnRhZ3MuYm90U3RvcmVJRCAhPSB0YWdzLmJvdFN0b3JlSUQpIHx8IHRhZ3MubWF4Q291bnQgPT0gdGFncy5sYWJlbCkKewogICAgdGhpc0JvdC5ib3RTdG9yZVJlamVjdEJvdCh0aGF0KTsKCiAgICByZXR1cm47Cn0KCnRhZ3MubGFiZWwrKzsKCmlmICh0YWdzLnRlbXBsYXRlKQp7CiAgICBkZXN0cm95KHRoYXQuZHJhZ0JvdCk7Cn0KZWxzZQp7CiAgICB0aGlzQm90LmFkZFRlbXBsYXRlKHRoYXQpOwp9JwDwjcnMAt81C2FkZFRlbXBsYXRlAgQA8I3JzAKyPOMLQHRhZ3MudGVtcGxhdGUgPSBnZXRMaW5rKHRoYXQuZHJhZ0JvdCk7Cgp0aGF0LmRyYWdCb3QudGFncy5saXN0ZW5pbmcgPSBmYWxzZTsKdGhhdC5kcmFnQm90LnRhZ3MucG9pbnRhYmxlID0gZmFsc2U7CnRoYXQuZHJhZ0JvdC50YWdzLnRyYW5zZm9ybWVyID0gdGhpc0JvdC5pZDsKdGhhdC5kcmFnQm90LnRhZ3MuY3JlYXRvciA9IHRoaXNCb3QuaWQ7CnRoYXQuZHJhZ0JvdC50YWdzLnRyYW5zZm9ybWVyID0gdGhpc0JvdC5pZDsKdGhhdC5kcmFnQm90LnRhZ3NbdGhhdC50by5kaW1lbnNpb24gKyAiWCJdID0gMDsKdGhhdC5kcmFnQm90LnRhZ3NbdGhhdC50by5kaW1lbnNpb24gKyAiWSJdID0gMDsKdGhhdC5kcmFnQm90LnRhZ3NbdGhhdC50by5kaW1lbnNpb24gKyAiWiJdID0gNTsKdGhhdC5kcmFnQm90LnRhZ3Muc2NhbGUgPSB0aGF0LmRyYWdCb3QudGFncy5zY2FsZSA/IHRoYXQuZHJhZ0JvdC50YWdzLnNjYWxlIC8gMiA6IDAuNTsKdGhhdC5kcmFnQm90LnRhZ3Muc2NhbGVYID0gdGhhdC5kcmFnQm90LnRhZ3Muc2NhbGVYID8gdGhhdC5kcmFnQm90LnRhZ3Muc2NhbGVYIC8gMiA6IDE7CnRoYXQuZHJhZ0JvdC50YWdzLnNjYWxlWSA9IHRoYXQuZHJhZ0JvdC50YWdzLnNjYWxlWSA/IHRoYXQuZHJhZ0JvdC50YWdzLnNjYWxlWSAvIDIgOiAxOwp0aGF0LmRyYWdCb3QudGFncy5zY2FsZVogPSB0aGF0LmRyYWdCb3QudGFncy5zY2FsZVogPyB0aGF0LmRyYWdCb3QudGFncy5zY2FsZVogKiAxMCA6IDEwOwoKaWYgKHRhZ3Muc3RvcmVNb2RlID09ICJsaW1pdGVkIikKewogICAgbGV0IG5ld1N0b3JlSUQgPSB1dWlkKCk7CgogICAgdGFncy5ib3RTdG9yZUlEID0gbmV3U3RvcmVJRDsKCiAgICB0aGF0LmRyYWdCb3QudGFncy5ib3RTdG9yZUlEID0gbmV3U3RvcmVJRDsKfQoKbGV0IGhpdEJveCA9IHt9OwoKaGl0Qm94LnRyYW5zZm9ybWVyID0gdGhpc0JvdC5pZDsKaGl0Qm94LmNvbG9yID0gImNsZWFyIjsKaGl0Qm94LmRyYWdnYWJsZSA9IGZhbHNlOwpoaXRCb3gubWFuYWdlciA9IGdldExpbmsodGhpc0JvdCk7CmhpdEJveC5vbkRyYWcgPSBgQCBsaW5rcy5tYW5hZ2VyLnRlbXBsYXRlRHJhZyh0aGF0KTtgOwpoaXRCb3guc2NhbGUgPSBsaW5rcy50ZW1wbGF0ZS50YWdzLnNjYWxlOwpoaXRCb3guc2NhbGVYID0gbGlua3MudGVtcGxhdGUudGFncy5zY2FsZVg7CmhpdEJveC5zY2FsZVkgPSBsaW5rcy50ZW1wbGF0ZS50YWdzLnNjYWxlWTsKaGl0Qm94LnNjYWxlWiA9IGxpbmtzLnRlbXBsYXRlLnRhZ3Muc2NhbGVaOwpoaXRCb3hbdGhhdC50by5kaW1lbnNpb25dID0gdHJ1ZTsKaGl0Qm94W3RoYXQudG8uZGltZW5zaW9uICsgIlgiXSA9IDA7CmhpdEJveFt0aGF0LnRvLmRpbWVuc2lvbiArICJZIl0gPSAwOwpoaXRCb3hbdGhhdC50by5kaW1lbnNpb24gKyAiWiJdID0gNTsKCmxldCBuZXdIaXRib3ggPSBjcmVhdGUoaGl0Qm94KTsKCmxpbmtzLmhpdEJveCA9IGdldExpbmsobmV3SGl0Ym94KTsKCnRoaXNCb3QuaW5pdGlhdGVCb3RTdG9yZUFuaW1hdGlvbigpOycA8I3JzALfNQdvbkNsaWNrAgQA8I3JzAKWSPwKQHNob3V0KCJib3RTdG9yZU1lbnVSZXNldCIpOwoKY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAiYm90U3RvcmVNZW51IjsKCm1hc2tzLm9uR3JpZENsaWNrID0gYEAgc2hvdXQoImJvdFN0b3JlTWVudVJlc2V0Iik7YDsKbWFza3MuYm90U3RvcmVNZW51UmVzZXQgPSBgQCBjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9IG51bGw7CgpjbGVhclRhZ01hc2tzKHRoaXNCb3QpO2A7CgpsZXQgbWVudUJ1dHRvbiA9IHt9OwoKbWVudUJ1dHRvbi5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwptZW51QnV0dG9uLmJvdFN0b3JlTWVudSA9IHRydWU7Cm1lbnVCdXR0b24uYm90U3RvcmVNZW51UmVzZXQgPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7Cm1lbnVCdXR0b24ubWVudUl0ZW1TdHlsZSA9IHsiYm9yZGVyLXJhZGl1cyI6IjhweCIsICJtYXJnaW4tdG9wIjoiM3B4In07Cm1lbnVCdXR0b24ubGFiZWxBbGlnbm1lbnQgPSAibGVmdCI7Cm1lbnVCdXR0b24uY29sb3IgPSB0YWdzLmNvbG9yOwptZW51QnV0dG9uLm1hbmFnZXIgPSBnZXRMaW5rKHRoaXNCb3QpOwptZW51QnV0dG9uLm9uQ2xpY2sgPSBgQCBzaG91dCgiYm90U3RvcmVNZW51UmVzZXQiKTsKICAgIApsaW5rcy5tYW5hZ2VyLmNoYW5nZVN0b3JlU3RhdGUoKTtgOwoKaWYgKHRhZ3Muc3RvcmVNb2RlID09ICJ1bmxpbWl0ZWQiKQp7CiAgICBtZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImludmVudG9yeSI7CiAgICBtZW51QnV0dG9uLmxhYmVsID0gImNoYW5nZSB0byBsaW1pdGVkIjsKCiAgICBjcmVhdGUobWVudUJ1dHRvbik7Cn0KZWxzZQp7CiAgICBtZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImZpbGVfY29weSI7CiAgICBtZW51QnV0dG9uLmxhYmVsID0gImNoYW5nZSB0byB1bmxpbWl0ZWQiOwoKICAgIGNyZWF0ZShtZW51QnV0dG9uKTsKCiAgICBtZW51QnV0dG9uLmxhYmVsID0gIiAgICAiOwogICAgbWVudUJ1dHRvbi5sYWJlbEFsaWdubWVudCA9ICJjZW50ZXIiOwogICAgbWVudUJ1dHRvbi5vbkNsaWNrID0gYEAgbGlua3MubWFuYWdlci50YWdzLnRlbXBsYXRlTG9jayA9ICFsaW5rcy5tYW5hZ2VyLnRhZ3MudGVtcGxhdGVMb2NrCiAgICAKICAgIGlmIChsaW5rcy5tYW5hZ2VyLnRhZ3MudGVtcGxhdGVMb2NrKQogICAgewogICAgICAgIHRhZ3MuZm9ybUFkZHJlc3MgPSAibG9jayI7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgdGFncy5mb3JtQWRkcmVzcyA9ICJsb2NrX29wZW4iOwogICAgfWA7CgogICAgaWYgKHRhZ3MudGVtcGxhdGVMb2NrKQogICAgewogICAgICAgIG1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAibG9jayI7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJsb2NrX29wZW4iOwogICAgfQoKICAgIGNyZWF0ZShtZW51QnV0dG9uKTsKfQoKJwDwjcnMAt81DHRlbXBsYXRlRHJhZwIEAPCNycwCk1OBB0BpZiAodGFncy5zdG9yZU1vZGUgPT0gImxpbWl0ZWQiKQp7CiAgICBpZiAodGFncy5sYWJlbCA9PSAwKQogICAgewogICAgICAgIHJldHVybjsKICAgIH0KfQoKbGV0IG5ld0JvdCA9IGdldE1vZChsaW5rcy50ZW1wbGF0ZSk7CgpuZXdCb3RbdGhhdC5mcm9tLmRpbWVuc2lvbl0gPSB0cnVlOwpuZXdCb3RbdGhhdC5mcm9tLmRpbWVuc2lvbiArICJYIl0gPSB0YWdzW3RoYXQuZnJvbS5kaW1lbnNpb24gKyAiWCJdOwpuZXdCb3RbdGhhdC5mcm9tLmRpbWVuc2lvbiArICJZIl0gPSB0YWdzW3RoYXQuZnJvbS5kaW1lbnNpb24gKyAiWSJdOwpuZXdCb3RbdGhhdC5mcm9tLmRpbWVuc2lvbiArICJaIl0gPSAwOwpuZXdCb3QubGlzdGVuaW5nID0gbnVsbDsKbmV3Qm90LnBvaW50YWJsZSA9IG51bGw7Cm5ld0JvdC50cmFuc2Zvcm1lciA9IG51bGw7Cm5ld0JvdC5jcmVhdG9yID0gbnVsbDsKbmV3Qm90LnRyYW5zZm9ybWVyID0gbnVsbDsKbmV3Qm90LnNjYWxlID0gbmV3Qm90LnNjYWxlID09IDAuNSA/IG51bGwgOiBuZXdCb3Quc2NhbGUgKiAyOwpuZXdCb3Quc2NhbGVYID0gbmV3Qm90LnNjYWxlWCA9PSAxID8gbnVsbCA6IG5ld0JvdC5zY2FsZVggKiAyOwpuZXdCb3Quc2NhbGVZID0gbmV3Qm90LnNjYWxlWSA9PSAxID8gbnVsbCA6IG5ld0JvdC5zY2FsZVkgKiAyOwpuZXdCb3Quc2NhbGVaID0gbmV3Qm90LnNjYWxlWiA9PSAxMCA/IG51bGwgOiBuZXdCb3Quc2NhbGVaIC8gMTA7Cm5ld0JvdC5ib3RTdG9yZUlEID0gdGFncy5ib3RTdG9yZUlEOwoKbGV0IGNyZWF0ZWRCb3QgPSBjcmVhdGUobmV3Qm90KTsKCm9zLnJlcGxhY2VEcmFnQm90KGNyZWF0ZWRCb3QpOwoKaWYgKHRhZ3Muc3RvcmVNb2RlID09ICJsaW1pdGVkIikKewogICAgdGhpc0JvdC5yZWR1Y2VMaW1pdGVkQ291bnQoKTsKfScA8I3JzALfNRJyZWR1Y2VMaW1pdGVkQ291bnQCBADwjcnMApVajQJAdGFncy5sYWJlbC0tOwoKaWYgKHRhZ3MubGFiZWwgPT0gMCAmJiAhdGFncy50ZW1wbGF0ZUxvY2spCnsKICAgIGNsZWFySW50ZXJ2YWwodGFncy5zdG9yZUludGVydmFsKTsKCiAgICBkZXN0cm95KGxpbmtzLnRlbXBsYXRlKTsKICAgIGRlc3Ryb3kobGlua3MuaGl0Qm94KTsKCiAgICB0YWdzLnRlbXBsYXRlID0gbnVsbDsKICAgIHRhZ3MuaGl0Qm94ID0gbnVsbDsKICAgIHRhZ3MuYm90U3RvcmVJRCA9IG51bGw7CiAgICBtYXNrcy5zdG9yZUludGVydmFsID0gbnVsbDsKfScA8I3JzALfNQhhYklnbm9yZQIEAPCNycwCo1wEdHJ1ZScA8I3JzALfNQlsaXN0ZW5pbmcCBADwjcnMAqhcBWZhbHNlJwDwjcnMAt81EGNoYW5nZVN0b3JlU3RhdGUCBADwjcnMAq5c7QRAaWYgKHRhZ3Muc3RvcmVNb2RlID09ICJ1bmxpbWl0ZWQiKQp7CiAgICB0YWdzLnN0b3JlTW9kZSA9ICJsaW1pdGVkIjsKCiAgICBjb25zdCBtYXhDb3VudCA9IGF3YWl0IG9zLnNob3dJbnB1dCgxLCB7CiAgICAgICAgdGl0bGU6ICdjaG9vc2UgbWF4JwogICAgfSk7CgogICAgaWYgKCFtYXhDb3VudCkKICAgIHsKICAgICAgICBtYXhDb3VudCA9IDE7CiAgICB9CgogICAgdGFncy5tYXhDb3VudCA9IG1heENvdW50OwoKICAgIGlmICh0YWdzLnRlbXBsYXRlKQogICAgewogICAgICAgIGxldCBuZXdTdG9yZUlEID0gdXVpZCgpOwoKICAgICAgICB0YWdzLmJvdFN0b3JlSUQgPSBuZXdTdG9yZUlEOwoKICAgICAgICBsaW5rcy50ZW1wbGF0ZS50YWdzLmJvdFN0b3JlSUQgPSBuZXdTdG9yZUlEOwoKICAgICAgICB0YWdzLmxhYmVsID0gMTsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICB0YWdzLmxhYmVsID0gMDsKICAgIH0KfQplbHNlCnsKICAgIHRhZ3Muc3RvcmVNb2RlID0gInVubGltaXRlZCI7CgogICAgdGFncy5sYWJlbCA9IG51bGw7CiAgICB0YWdzLm1heENvdW50ID0gbnVsbDsKICAgIHRhZ3MudGVtcGxhdGVMb2NrID0gbnVsbDsKICAgIHRhZ3MuYm90U3RvcmVJRCA9IG51bGw7Cn0nAPCNycwC3zUZaW5pdGlhdGVCb3RTdG9yZUFuaW1hdGlvbgIEAPCNycwCnGGLAUBpZiAoIXRhZ3Muc3RvcmVJbnRlcnZhbCkKewogICAgdGhpc0JvdC5hbmltYXRlQm90U3RvcmUoKTsKCiAgICBtYXNrcy5zdG9yZUludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gdGhpc0JvdC5hbmltYXRlQm90U3RvcmUoKSwgMjAwMCk7Cn0nAPCNycwC3zUPYW5pbWF0ZUJvdFN0b3JlAgQA8I3JzAKoYpoCQGxldCByb3RaID0gY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbCArICJSb3RhdGlvbloiOwpsZXQgdGFyZ2V0Um90YXRpb24gPSAzNjAgKiBNYXRoLlBJLzE4MDsKCmF3YWl0IGFuaW1hdGVUYWcobGlua3MudGVtcGxhdGUsIHJvdFosIHsKICAgIGZyb21WYWx1ZTogMCwKICAgIHRvVmFsdWU6IHRhcmdldFJvdGF0aW9uLAogICAgZWFzaW5nOnsKICAgICAgICBtb2RlOiAiaW5vdXQiLAogICAgICAgIHR5cGU6ICJsaW5lYXIiCiAgICB9LAogICAgZHVyYXRpb246IDIKfSkuY2F0Y2goZSA9PiB7fSk7JwDwjcnMAt81D29uSW5zdFN0cmVhbWluZwIEAPCNycwCw2RAQGlmICh0YWdzLnRlbXBsYXRlKQp7CiAgICB0aGlzQm90LmluaXRpYXRlQm90U3RvcmVBbmltYXRpb24oKTsKfScA8I3JzALfNQlvbkRlc3Ryb3kCBADwjcnMAoRlI0BjbGVhckludGVydmFsKHRhZ3Muc3RvcmVJbnRlcnZhbCk7JwDwjcnMAt81D2FiTWVudVNvcnRPcmRlcgIEAPCNycwCqGUBNScA8I3JzALfNQt0b29sYm94SWNvbgIEAPCNycwCqmULaW52ZW50b3J5XzInAPCNycwC3zUGYWJUb29sAgQA8I3JzAK2ZQR0cnVlJwEEYm90cyRkMTQwMjA0Yy01NWM3LTRlYzMtOTM1NC05M2FlNzYyNmE4MzYBKADwjcnMArtlBnNjYWxlWgF7P4R64UeuFHsoAPCNycwCu2UFc2NhbGUBez/jhR64UeuFJwDwjcnMArtlBWNvbG9yAgQA8I3JzAK+ZQRncmF5JwDwjcnMArtlC3N0cm9rZUNvbG9yAgQA8I3JzALDZQcjNUU1ODgwJwDwjcnMArtlCWxpbmVDb2xvcgIEAPCNycwCy2UHIzVFNTg4MCgA8I3JzAK7ZQhkdXJhdGlvbgF9AScA8I3JzAK7ZQplYXNpbmdUeXBlAgQA8I3JzALUZQZsaW5lYXInAPCNycwCu2UKZWFzaW5nTW9kZQIEAPCNycwC22UFaW5vdXQnAPCNycwCu2UJbGluZVN0eWxlAgQA8I3JzALhZQRsaW5lJwDwjcnMArtlBnN5c3RlbQIEAPCNycwC5mUNYWIudG9vbC50cmFjaycA8I3JzAK7ZQhhYklnbm9yZQIEAPCNycwC9GUEdHJ1ZScA8I3JzAK7ZQt0b29sTWFuYWdlcgIEAPCNycwC+WUo8J+UlzE0ZTFmZGFjLWNmZDctNGU3ZS1iZGQxLTk2N2E0MDg1YTc1NSgA8I3JzAK7ZQxhYkJvdFZlcnNpb24BfRYnAPCNycwCu2UIb25DcmVhdGUCBADwjcnMAqFmb0B0YWdzLmNvbG9yID0gImNsZWFyIjsKCmlmICghdGFncy5saW5lVG8pCnsKICAgIHRoaXNCb3QuYWRkVHJhY2tOb2RlKHtkaW1lbnNpb246IGNvbmZpZ0JvdC50YWdzLmdyaWRQb3J0YWx9KTsKfScA8I3JzAK7ZQxhZGRUcmFja05vZGUCBADwjcnMApFnrwZAY29uc3QgbW9kaWZ5VmFsdWUgPSBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgPyAwLjAwMSA6IDMKCmxldCBib3RNb2QgPSBnZXRNb2QodGhpc0JvdCk7Cgpib3RNb2RbdGhhdC5kaW1lbnNpb24gKyAiWSJdID0gYm90TW9kW3RoYXQuZGltZW5zaW9uICsgIlkiXSAtIG1vZGlmeVZhbHVlOwoKYm90TW9kLmxpbmVUbyA9IHRoaXNCb3QuaWQ7CmJvdE1vZC5jcmVhdG9yID0gdGhpc0JvdC5pZDsKCmxldCBub2RlMiA9IGNyZWF0ZShib3RNb2QpOwoKdGFncy5saW5lVG8gPSBub2RlMi5pZDsKdGFncy5jcmVhdG9yID0gbm9kZTIuaWQ7CgpsZXQgbm9kZTMgPSBjcmVhdGUoYm90TW9kKTsKCmJvdE1vZFt0aGF0LmRpbWVuc2lvbiArICJYIl0gPSBib3RNb2RbdGhhdC5kaW1lbnNpb24gKyAiWCJdICsgbW9kaWZ5VmFsdWU7CgpsZXQgbm9kZTQgPSBjcmVhdGUoYm90TW9kKTsKCm5vZGUzLnRhZ3MubGluZVRvID0gbm9kZTQuaWQ7Cm5vZGUzLnRhZ3MuY3JlYXRvciA9IG5vZGU0LmlkOwpub2RlNC50YWdzLmxpbmVUbyA9IG5vZGUzLmlkOwpub2RlNC50YWdzLmNyZWF0b3IgPSBub2RlMy5pZDsKCmxldCBub2RlNSA9IGNyZWF0ZShib3RNb2QpOwoKYm90TW9kW3RoYXQuZGltZW5zaW9uICsgIlkiXSA9IGJvdE1vZFt0aGF0LmRpbWVuc2lvbiArICJZIl0gLSBtb2RpZnlWYWx1ZTsKCmxldCBub2RlNiA9IGNyZWF0ZShib3RNb2QpOwoKbm9kZTUudGFncy5saW5lVG8gPSBub2RlNi5pZDsKbm9kZTUudGFncy5jcmVhdG9yID0gbm9kZTYuaWQ7Cm5vZGU2LnRhZ3MubGluZVRvID0gbm9kZTUuaWQ7Cm5vZGU2LnRhZ3MuY3JlYXRvciA9IG5vZGU1LmlkOycA8I3JzAK7ZQthYlRyYWNrTm9kZQIEAPCNycwCwW0EdHJ1ZScA8I3JzAK7ZQlsaXN0ZW5pbmcCBADwjcnMAsZtBWZhbHNlJwDwjcnMArtlBm9uRHJvcAIEAPCNycwCzG2WBUBpZiAodGhhdC5kcmFnQm90LnRhZ3MuYWJUcmFja05vZGUpCnsKICAgIHRhZ3NbY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbCArICJYIl0gPSBNYXRoLnJvdW5kKHRhZ3NbY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbCArICJYIl0pOwogICAgdGFnc1tjb25maWdCb3QudGFncy5ncmlkUG9ydGFsICsgIlkiXSA9IE1hdGgucm91bmQodGFnc1tjb25maWdCb3QudGFncy5ncmlkUG9ydGFsICsgIlkiXSk7CgogICAgcmV0dXJuOwp9CmVsc2UgaWYgKHRoYXQuZHJhZ0JvdC50YWdzLnRvb2xib3hJY29uID09ICJoZWxpeCIpCnsKICAgIHRoaXNCb3QuYXBwbHlNb2RUb1RyYWNrTm9kZSh0aGF0KTsKCiAgICB0aGF0LmRyYWdCb3QudGFnc1t0aGF0LmZyb20uZGltZW5zaW9uICsgIlgiXSA9IHRoYXQuZnJvbS54OwogICAgdGhhdC5kcmFnQm90LnRhZ3NbdGhhdC5mcm9tLmRpbWVuc2lvbiArICJZIl0gPSB0aGF0LmZyb20ueTsKCiAgICByZXR1cm47Cn0KCnRoYXQuZHJhZ0JvdC5tYXNrcy5vbkRyYWcgPSAiQCBjbGVhclRpbWVvdXQodGFncy50cmFja1RpbWVvdXQpOyBjbGVhckFuaW1hdGlvbnModGhpc0JvdCk7IjsKCnRoaXNCb3QuYW5pbWF0ZVRyYWNrKHthbmltYXRlZEJvdDogdGhhdC5kcmFnQm90LCB0YXJnZXROb2RlOiBnZXRCb3QoImlkIiwgdGFncy5saW5lVG8pfSk7JwDwjcnMArtlDGFuaW1hdGVUcmFjawIEAPCNycwC43KPDUBsZXQgY3VycmVudERpbSA9IGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA/IGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA6IGNvbmZpZ0JvdC50YWdzLmdyaWRQb3J0YWw7CmxldCBhbmltYXRlZEJvdCA9IHRoYXQuYW5pbWF0ZWRCb3Q7CmxldCBuZXh0Tm9kZSA9IHRoYXQudGFyZ2V0Tm9kZTsKbGV0IG9yaWdpbk5vZGUgPSB0aGlzQm90OwoKaWYgKG5leHROb2RlLmlkID09IHRoaXNCb3QuaWQpCnsKICAgIGxldCBub2RlU3RhY2sgPSBnZXRCb3RzKGJ5TW9kKHthYlRyYWNrTm9kZTogdHJ1ZSwgW2N1cnJlbnREaW1dOiB0cnVlLCBbY3VycmVudERpbSArICJYIl06IHRhZ3NbY3VycmVudERpbSArICJYIl0sIFtjdXJyZW50RGltICsgIlkiXTogdGFnc1tjdXJyZW50RGltICsgIlkiXX0pKTsKCiAgICBpZiAobm9kZVN0YWNrLmxlbmd0aCA+PSAzKQogICAgewogICAgICAgIG9yaWdpbk5vZGUgPSBub2RlU3RhY2tbbWF0aC5yYW5kb21JbnQoMCwgbm9kZVN0YWNrLmxlbmd0aCldOwoKICAgICAgICBuZXh0Tm9kZSA9IGdldEJvdCgiaWQiLCBvcmlnaW5Ob2RlLnRhZ3MubGluZVRvKTsKICAgIH0KICAgIGVsc2UgaWYgKG5vZGVTdGFjay5sZW5ndGggPiAxKQogICAgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbm9kZVN0YWNrLmxlbmd0aDsgaSsrKQogICAgICAgIHsKICAgICAgICAgICAgaWYgKG5vZGVTdGFja1tpXS5pZCAhPSB0aGlzQm90LmlkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBvcmlnaW5Ob2RlID0gbm9kZVN0YWNrW2ldOwoKICAgICAgICAgICAgICAgIG5leHROb2RlID0gZ2V0Qm90KCJpZCIsIG9yaWdpbk5vZGUudGFncy5saW5lVG8pOwoKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgZWxzZQogICAgewogICAgICAgIG5leHROb2RlID0gZ2V0Qm90KCJpZCIsIHRhZ3MubGluZVRvKTsKICAgIH0KfQoKYW5pbWF0ZWRCb3QubWFza3MudHJhY2tUaW1lb3V0ID0gc2V0VGltZW91dCgoKT0+IHdoaXNwZXIobmV4dE5vZGUsICJhbmltYXRlVHJhY2siLCB7YW5pbWF0ZWRCb3Q6IGFuaW1hdGVkQm90LCB0YXJnZXROb2RlOiBuZXh0Tm9kZX0pLCB0YWdzLmR1cmF0aW9uICogMTAwMCk7CgppZiAob3JpZ2luTm9kZS50YWdzLm1vZHMpCnsKICAgIGFwcGx5TW9kKGFuaW1hdGVkQm90LCBvcmlnaW5Ob2RlLnRhZ3MubW9kcyk7Cn0KCmF3YWl0IGFuaW1hdGVUYWcoYW5pbWF0ZWRCb3QsIHsKICAgIGZyb21WYWx1ZTogewogICAgICAgIFtjdXJyZW50RGltICsgIlgiXTogb3JpZ2luTm9kZS50YWdzW2N1cnJlbnREaW0gKyAiWCJdLAogICAgICAgIFtjdXJyZW50RGltICsgIlkiXTogb3JpZ2luTm9kZS50YWdzW2N1cnJlbnREaW0gKyAiWSJdCiAgICB9LAogICAgdG9WYWx1ZTogewogICAgICAgIFtjdXJyZW50RGltICsgIlgiXTogbmV4dE5vZGUudGFnc1tjdXJyZW50RGltICsgIlgiXSwKICAgICAgICBbY3VycmVudERpbSArICJZIl06IG5leHROb2RlLnRhZ3NbY3VycmVudERpbSArICJZIl0KICAgIH0sCiAgICBkdXJhdGlvbjogdGFncy5kdXJhdGlvbiwKICAgIGVhc2luZzp7CiAgICAgICAgdHlwZTogdGFncy5lYXNpbmdUeXBlLAogICAgICAgIG1vZGU6IHRhZ3MuZWFzaW5nTW9kZQogICAgfSwKICAgIHRhZ01hc2tTcGFjZTogInRlbXBMb2NhbCIKfSkuY2F0Y2goZSA9PiB7fSk7JwDwjcnMArtlB29uQ2xpY2sCBADwjcnMAvN/zQhAc2hvdXQoImFiVHJhY2tNZW51UmVzZXQiKTsKCmNvbnN0IG1lbnVUeXBlID0gdGhhdC5tZW51VHlwZSA/IHRoYXQubWVudVR5cGUgOiAiYmFzZSI7CmNvbnN0IG1lbnVUYWcgPSB0YWdzW21lbnVUeXBlICsgIkFCVHJhY2tNZW51Il07Cgpjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9ICJhYlRyYWNrTWVudSI7CgptYXNrcy5vbkdyaWRDbGljayA9IGBAIHNob3V0KCJhYlRyYWNrTWVudVJlc2V0Iik7YDsKbWFza3MuYWJUcmFja01lbnVSZXNldCA9IGBAIGNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gbnVsbDsKCmNsZWFyVGFnTWFza3ModGhpc0JvdCk7YDsKCmxldCBtZW51QnV0dG9uID0ge307CgptZW51QnV0dG9uLnNwYWNlID0gInRlbXBMb2NhbCI7Cm1lbnVCdXR0b24uYWJUcmFja01lbnUgPSB0cnVlOwptZW51QnV0dG9uLmFiVHJhY2tNZW51UmVzZXQgPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7Cm1lbnVCdXR0b24ubWVudUl0ZW1TdHlsZSA9IHsiYm9yZGVyLXJhZGl1cyI6IjhweCIsICJtYXJnaW4tdG9wIjoiM3B4In07Cm1lbnVCdXR0b24ubGFiZWxBbGlnbm1lbnQgPSAibGVmdCI7Cm1lbnVCdXR0b24ubGFiZWxDb2xvciA9ICIjZmZmZmZmIjsKbWVudUJ1dHRvbi5jb2xvciA9IHRhZ3Muc3Ryb2tlQ29sb3I7Cm1lbnVCdXR0b24ubWFuYWdlciA9IGdldExpbmsodGhpc0JvdCk7Cgpmb3IgKGxldCBpID0gMDsgaSA8IHRhZ3NbbWVudVR5cGUgKyAiQUJUcmFja01lbnUiXS5sZW5ndGg7IGkrKykKewogICAgY3JlYXRlKG1lbnVCdXR0b24sIHRhZ3NbbWVudVR5cGUgKyAiQUJUcmFja01lbnUiXVtpXSk7Cn0KCmlmICh0YWdzLm1vZHMpCnsKICAgIG1lbnVCdXR0b24ubGFiZWwgPSAicmVtb3ZlIG1vZCI7CiAgICBtZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImhlbGl4IjsKICAgIG1lbnVCdXR0b24ub25DbGljayA9IGBAIGxpbmtzLm1hbmFnZXIudGFncy5tb2RzID0gbnVsbDsKICAgIGxpbmtzLm1hbmFnZXIudGFncy5jb2xvciA9ICJjbGVhciI7CiAgICBsaW5rcy5tYW5hZ2VyLnRhZ3MuZm9ybSA9IG51bGw7CiAgICAKICAgIHNob3V0KCdhYlRyYWNrTWVudVJlc2V0Jyk7YDsKCiAgICBjcmVhdGUobWVudUJ1dHRvbik7Cn0nAPCNycwCu2UPYmFzZUFCVHJhY2tNZW51AgQA8I3JzALBiAHVAvCfp6xbeyJvbkNsaWNrIjogIkAgbGlua3MubWFuYWdlci51cGRhdGVUcmFja0R1cmF0aW9uKCk7IiwgImZvcm1BZGRyZXNzIjogImF2X3RpbWVyIiwgImxhYmVsIjogImR1cmF0aW9uIn0sCnsib25DbGljayI6ICJAIGxpbmtzLm1hbmFnZXIub25DbGljayh7bWVudVR5cGU6ICdlYXNpbmcnfSk7IiwgImZvcm1BZGRyZXNzIjogInRyZW5kaW5nX2ZsYXQiLCAibGFiZWwiOiAiZWFzaW5nIHR5cGUifSwKeyJvbkNsaWNrIjogIkAgbGlua3MubWFuYWdlci5vbkNsaWNrKHttZW51VHlwZTogJ21vZGUnfSk7IiwgImZvcm1BZGRyZXNzIjogInRyZW5kaW5nX3VwIiwgImxhYmVsIjogImVhc2luZyBtb2RlIn1dJwDwjcnMArtlE3VwZGF0ZVRyYWNrRHVyYXRpb24CBADwjcnMApWLAaIBQHNob3V0KCJhYlRyYWNrTWVudVJlc2V0Iik7CgpsZXQgaW5wdXQgPSBhd2FpdCBvcy5zaG93SW5wdXQodGFncy5kdXJhdGlvbiwgewogICAgdGl0bGU6ICJkdXJhdGlvbiIKfSk7CgppZiAoaW5wdXQgJiYgIWlzTmFOKGlucHV0KSkKewogICAgdGFncy5kdXJhdGlvbiA9IGlucHV0Owp9JwDwjcnMArtlEWVhc2luZ0FCVHJhY2tNZW51AgQA8I3JzAK4jAHuCfCfp6xbeyJvbkNsaWNrIjogIkAgbGlua3MubWFuYWdlci50YWdzLmVhc2luZ1R5cGUgPSB0YWdzLmxhYmVsOyBzaG91dCgnYWJUcmFja01lbnVSZXNldCcpOyIsICJmb3JtQWRkcmVzcyI6ICJhcnJvd19yaWdodCIsICJsYWJlbCI6ICJsaW5lYXIifSwKeyJvbkNsaWNrIjogIkAgbGlua3MubWFuYWdlci50YWdzLmVhc2luZ1R5cGUgPSB0YWdzLmxhYmVsOyBzaG91dCgnYWJUcmFja01lbnVSZXNldCcpOyIsICJmb3JtQWRkcmVzcyI6ICJhcnJvd19yaWdodCIsICJsYWJlbCI6ICJxdWFkcmF0aWMifSwKeyJvbkNsaWNrIjogIkAgbGlua3MubWFuYWdlci50YWdzLmVhc2luZ1R5cGUgPSB0YWdzLmxhYmVsOyBzaG91dCgnYWJUcmFja01lbnVSZXNldCcpOyIsICJmb3JtQWRkcmVzcyI6ICJhcnJvd19yaWdodCIsICJsYWJlbCI6ICJjdWJpYyJ9LAp7Im9uQ2xpY2siOiAiQCBsaW5rcy5tYW5hZ2VyLnRhZ3MuZWFzaW5nVHlwZSA9IHRhZ3MubGFiZWw7IHNob3V0KCdhYlRyYWNrTWVudVJlc2V0Jyk7IiwgImZvcm1BZGRyZXNzIjogImFycm93X3JpZ2h0IiwgImxhYmVsIjogInF1YXJ0aWMifSwKeyJvbkNsaWNrIjogIkAgbGlua3MubWFuYWdlci50YWdzLmVhc2luZ1R5cGUgPSB0YWdzLmxhYmVsOyBzaG91dCgnYWJUcmFja01lbnVSZXNldCcpOyIsICJmb3JtQWRkcmVzcyI6ICJhcnJvd19yaWdodCIsICJsYWJlbCI6ICJxdWludGljIn0sCnsib25DbGljayI6ICJAIGxpbmtzLm1hbmFnZXIudGFncy5lYXNpbmdUeXBlID0gdGFncy5sYWJlbDsgc2hvdXQoJ2FiVHJhY2tNZW51UmVzZXQnKTsiLCAiZm9ybUFkZHJlc3MiOiAiYXJyb3dfcmlnaHQiLCAibGFiZWwiOiAic2ludXNvaWRhbCJ9LAp7Im9uQ2xpY2siOiAiQCBsaW5rcy5tYW5hZ2VyLnRhZ3MuZWFzaW5nVHlwZSA9IHRhZ3MubGFiZWw7IHNob3V0KCdhYlRyYWNrTWVudVJlc2V0Jyk7IiwgImZvcm1BZGRyZXNzIjogImFycm93X3JpZ2h0IiwgImxhYmVsIjogImV4cG9uZW50aWFsIn0sCnsib25DbGljayI6ICJAIGxpbmtzLm1hbmFnZXIudGFncy5lYXNpbmdUeXBlID0gdGFncy5sYWJlbDsgc2hvdXQoJ2FiVHJhY2tNZW51UmVzZXQnKTsiLCAiZm9ybUFkZHJlc3MiOiAiYXJyb3dfcmlnaHQiLCAibGFiZWwiOiAiY2lyY3VsYXIifSwKeyJvbkNsaWNrIjogIkAgbGlua3MubWFuYWdlci50YWdzLmVhc2luZ1R5cGUgPSB0YWdzLmxhYmVsOyBzaG91dCgnYWJUcmFja01lbnVSZXNldCcpOyIsICJmb3JtQWRkcmVzcyI6ICJhcnJvd19yaWdodCIsICJsYWJlbCI6ICJlbGFzdGljIn1dJwDwjcnMArtlD21vZGVBQlRyYWNrTWVudQIEAPCNycwCpZYBmgPwn6esW3sib25DbGljayI6ICJAIGxpbmtzLm1hbmFnZXIudGFncy5lYXNpbmdNb2RlID0gdGFncy5sYWJlbDsgc2hvdXQoJ2FiVHJhY2tNZW51UmVzZXQnKTsiLCAiZm9ybUFkZHJlc3MiOiAiYXJyb3dfcmlnaHQiLCAibGFiZWwiOiAiaW4ifSwKeyJvbkNsaWNrIjogIkAgbGlua3MubWFuYWdlci50YWdzLmVhc2luZ01vZGUgPSB0YWdzLmxhYmVsOyBzaG91dCgnYWJUcmFja01lbnVSZXNldCcpOyIsICJmb3JtQWRkcmVzcyI6ICJhcnJvd19yaWdodCIsICJsYWJlbCI6ICJvdXQifSwKeyJvbkNsaWNrIjogIkAgbGlua3MubWFuYWdlci50YWdzLmVhc2luZ01vZGUgPSB0YWdzLmxhYmVsOyBzaG91dCgnYWJUcmFja01lbnVSZXNldCcpOyIsICJmb3JtQWRkcmVzcyI6ICJhcnJvd19yaWdodCIsICJsYWJlbCI6ICJpbm91dCJ9XScA8I3JzAK7ZRNhcHBseU1vZFRvVHJhY2tOb2RlAgQA8I3JzAK+mQH1AUBsZXQgYm90TW9kID0gdGhhdC5kcmFnQm90LnRhZ3MubW9kczsKCnRhZ3MubW9kcyA9IGJvdE1vZDsKdGFncy5jb2xvciA9IHRhZ3Muc3Ryb2tlQ29sb3I7CnRhZ3MuZm9ybSA9ICJzcHJpdGUiOwp0YWdzLmZvcm1BZGRyZXNzID0gImh0dHBzOi8vYnVpbGRlci1sdG0tZmlsZXMuczMuYW1hem9uYXdzLmNvbS9iNjM1MmVkYjg4NTk4YTE5NjlhNjQ4ZjdkZDZkNDE4MjMzZWYxMTU5YmQ3OGI3MzdjZjIwYTNkYTU0MDVkMWM0LnBuZyI7JwDwjcnMArtlD2FiTWVudVNvcnRPcmRlcgIEAPCNycwCtJsBATInAPCNycwCu2ULdG9vbGJveEljb24CBADwjcnMArabAQh0aW1lbGluZScA8I3JzAK7ZQZhYlRvb2wCBADwjcnMAr+bAQR0cnVlJwEEYm90cyRlYjc1ZjU1YS0yYmI5LTQzNzItYmY4Yy1jY2JhYzg2MzkwZmYBJwDwjcnMAsSbAQVjb2xvcgIEAPCNycwCxZsBByM3QjY0RkYnAPCNycwCxJsBCWRpbWVuc2lvbgIEAPCNycwCzZsBBGhvbWUnAPCNycwCxJsBBGZvcm0CBADwjcnMAtKbAQNoZXgoAPCNycwCxJsBBXNjYWxlAX0CJwDwjcnMAsSbAQZzY2FsZVoCBADwjcnMAtebAQQwLjc1JwDwjcnMAsSbAQdvbkNsaWNrAgQA8I3JzALcmwEaQHRoaXNCb3Qub3BlblBvcnRhbCh0aGF0KTsnAPCNycwCxJsBDm9uUG9pbnRlckVudGVyAgQA8I3JzAL3mwETQG1hc2tzLnNjYWxlID0gMi4xOycA8I3JzALEmwELb25Ecm9wRW50ZXICBADwjcnMAoucAWhAaWYgKHRoYXQuZHJhZ0JvdC5pZCAhPSB0aGlzQm90LmlkKSAvL01BWUJFIE1BS0UgQSBXQVkgRk9SIEFCIFRPIE5PVCBJTlRFUkFDVAp7CiAgICB0aGlzQm90Lm9uQ2xpY2soKTsKfScA8I3JzALEmwEGc3lzdGVtAgQA8I3JzAL0nAEOYWIudG9vbC5wb3J0YWwnAPCNycwCxJsBDW9uUG9pbnRlckV4aXQCBADwjcnMAoOdARRAbWFza3Muc2NhbGUgPSBudWxsOygA8I3JzALEmwEMYWJCb3RWZXJzaW9uAX0RJwDwjcnMAsSbAQhhYklnbm9yZQIEAPCNycwCmZ0BBHRydWUnAPCNycwCxJsBC3Rvb2xNYW5hZ2VyAgQA8I3JzAKenQEo8J+UlzE0ZTFmZGFjLWNmZDctNGU3ZS1iZGQxLTk2N2E0MDg1YTc1NScA8I3JzALEmwEJbGlzdGVuaW5nAgQA8I3JzALFnQEFZmFsc2UnAPCNycwCxJsBCm9wZW5Qb3J0YWwCBADwjcnMAsudAaUwQGNvbnN0IGN1cnJlbnREaW0gPSBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgPyBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgOiBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsOwpjb25zdCBhID0gTWF0aC5QSSAvIDY7CmNvbnN0IGhleFNjYWxlID0gNTsKY29uc3QgcG9ydGFsRGltZW5zaW9uID0gdGFncy5wb3J0YWxBZGRyZXNzOwoKbGV0IGhleCA9IHt9OwpsZXQgaGV4TnVtID0gMTsKCmhleC5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwpoZXgucG9ydGFsUmVzZXQgPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CmhleC5mb3JtID0gImhleCI7CmhleC5jb2xvciA9IHRhZ3MuY29sb3I7CmhleC5vcmlnaW4gPSB0aGlzQm90LmlkOwpoZXgucG9ydGFsSGV4ID0gdHJ1ZTsKaGV4W2N1cnJlbnREaW0rIloiXSA9IC0xOwpoZXguYW5jaG9yUG9pbnQgPSAidG9wIjsKaGV4LnNjYWxlID0gNC41OwpoZXhbY3VycmVudERpbV0gPSB0cnVlOwpoZXgucG9pbnRhYmxlID0gZmFsc2U7CmhleC5zY2FsZVogPSAwLjAxOwpoZXguYW5pbWF0ZSA9IGBAIGFuaW1hdGVUYWcodGhpc0JvdCwgInNjYWxlIiwgewogICAgZnJvbVZhbHVlOiB0YWdzLnNjYWxlLAogICAgdG9WYWx1ZTogW3RoYXRdLAogICAgZWFzaW5nOiB7CiAgICAgICAgdHlwZTogInF1YWRyYXRpYyIsCiAgICAgICAgbW9kZTogIm91dCIKICAgIH0sCiAgICBkdXJhdGlvbjogMC4zCn0pLmNhdGNoKGUgPT4geyB9KTtgOwoKbGV0IGRpbWVuc2lvbkJvdHMgPSBnZXRCb3RzKHBvcnRhbERpbWVuc2lvbiwgdHJ1ZSk7CmxldCByaW5nTnVtOwoKaWYgKGRpbWVuc2lvbkJvdHMubGVuZ3RoID4gMCkKewogICAgbGV0IHhQYXJhbWV0ZXIgPSBkaW1lbnNpb25Cb3RzLnNvcnQoKGEsIGIpPT4gTWF0aC5hYnMoYi50YWdzW3BvcnRhbERpbWVuc2lvbisiWCJdKSAtIE1hdGguYWJzKGEudGFnc1twb3J0YWxEaW1lbnNpb24rIlgiXSkpWzBdLnRhZ3NbcG9ydGFsRGltZW5zaW9uKyJYIl07CiAgICBsZXQgeVBhcmFtZXRlciA9IGRpbWVuc2lvbkJvdHMuc29ydCgoYSwgYik9PiBNYXRoLmFicyhiLnRhZ3NbcG9ydGFsRGltZW5zaW9uKyJZIl0pIC0gTWF0aC5hYnMoYS50YWdzW3BvcnRhbERpbWVuc2lvbisiWSJdKSlbMF0udGFnc1twb3J0YWxEaW1lbnNpb24rIlkiXTsKCgogICAgbGV0IGRpc3RhbmNlID0gTWF0aC5mbG9vcihNYXRoLnNxcnQoTWF0aC5wb3coTWF0aC5mbG9vcihNYXRoLmFicyh4UGFyYW1ldGVyIC0gMCkpLCAyKSArIE1hdGgucG93KE1hdGguZmxvb3IoTWF0aC5hYnMoeVBhcmFtZXRlciAtIDApKSwgMikpIC8gaGV4U2NhbGUpICsgMTsKICAgIHJpbmdOdW0gPSA2ICogKGRpc3RhbmNlKSooZGlzdGFuY2UrMSkvMiArIDE7CgogICAgaWYgKHJpbmdOdW0gPiAzOTcpCiAgICB7CiAgICAgICAgcmluZ051bSA9IDM5NzsKICAgIH0KfQplbHNlCnsKICAgIHJpbmdOdW0gPSA3Owp9CgptYXNrcy5zY2FsZSA9IDAuMTsKbWFza3MucG9pbnRhYmxlID0gZmFsc2U7CgpsZXQgcHJldmlvdXNIZXg7Cgpmb3IgKGxldCBpID0gMDsgaSA8IHJpbmdOdW07IGkrKykKewogICAgaWYgKGkgIT0gMCkKICAgIHsKICAgICAgICBsZXQgZW1wdHlQb3MgPSBhd2FpdCBjaGVja0hleFBvcyhwcmV2aW91c0hleCwgY3VycmVudERpbSk7CgogICAgICAgIGlmIChlbXB0eVBvcyA9PSAwIHx8IGVtcHR5UG9zID09IDMpCiAgICAgICAgewogICAgICAgICAgICB2YXIgeCA9IHByZXZpb3VzSGV4LnRhZ3NbY3VycmVudERpbSsiWCJdOwogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIGZsaXBYID0gMTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIChlbXB0eVBvcyA9PSAwKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgZmxpcFkgPSAwOwogICAgICAgICAgICAgICAgdmFyIHkgPSBwcmV2aW91c0hleC50YWdzW2N1cnJlbnREaW0rIlkiXSArIGhleFNjYWxlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGZsaXBZID0gLTE7CiAgICAgICAgICAgICAgICB2YXIgeSA9IHByZXZpb3VzSGV4LnRhZ3NbY3VycmVudERpbSsiWSJdIC0gaGV4U2NhbGUvMjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewogICAgICAgICAgICB2YXIgeCA9IHByZXZpb3VzSGV4LnRhZ3NbY3VycmVudERpbSsiWCJdICsgKGhleFNjYWxlICogMC44NSk7CiAgICAgICAgICAgIHZhciB5ID0gcHJldmlvdXNIZXgudGFnc1tjdXJyZW50RGltKyJZIl07CgogICAgICAgICAgICBpZiAoZW1wdHlQb3MgPT0gMSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGZsaXBYID0gMTsKICAgICAgICAgICAgICAgIHZhciBmbGlwWSA9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAoZW1wdHlQb3MgPT0gMikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIGZsaXBYID0gMTsKICAgICAgICAgICAgICAgIHZhciBmbGlwWSA9IC0xOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKGVtcHR5UG9zID09IDQpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHggPSBwcmV2aW91c0hleC50YWdzW2N1cnJlbnREaW0rIlgiXSAtIChoZXhTY2FsZSAqIDAuODUpOwoKICAgICAgICAgICAgICAgIHZhciBmbGlwWCA9IDE7CiAgICAgICAgICAgICAgICB2YXIgZmxpcFkgPSAtMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmIChlbXB0eVBvcyA9PSA1KQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB4ID0gcHJldmlvdXNIZXgudGFnc1tjdXJyZW50RGltKyJYIl0gLSAoaGV4U2NhbGUgKiAwLjg1KTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGZsaXBYID0gMTsKICAgICAgICAgICAgICAgIHZhciBmbGlwWSA9IDE7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGhleFtjdXJyZW50RGltKyJYIl0gPSB4ICogZmxpcFg7CiAgICAgICAgaGV4W2N1cnJlbnREaW0rIlkiXSA9IHkgKyBmbGlwWSAqIGhleFNjYWxlLzI7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgaGV4W2N1cnJlbnREaW0rIlgiXSA9IHRhZ3NbY3VycmVudERpbSsiWCJdOwogICAgICAgIGhleFtjdXJyZW50RGltKyJZIl0gPSB0YWdzW2N1cnJlbnREaW0rIlkiXTsKICAgIH0KCiAgICBoZXguaGV4TnVtID0gaGV4TnVtOwoKICAgIGxldCBuZWFyYnlQb3J0YWxCb3QgPSBnZXRCb3QoYnlNb2Qoey8vYmVpbmcgbWlycm9yZWQgcmlnaHQgbm93CiAgICAgICAgW3BvcnRhbERpbWVuc2lvbl06IHRydWUsCiAgICAgICAgW3BvcnRhbERpbWVuc2lvbisiWCJdOiB4ID0+IHggPiAoaGV4W2N1cnJlbnREaW0rIlgiXSAtIHRhZ3NbY3VycmVudERpbSsiWCJdKSAtIGhleFNjYWxlICYmIHggPCAoaGV4W2N1cnJlbnREaW0rIlgiXSAtIHRhZ3NbY3VycmVudERpbSsiWCJdKSArIGhleFNjYWxlLAogICAgICAgIFtwb3J0YWxEaW1lbnNpb24rIlkiXTogeSA9PiB5ID4gKGhleFtjdXJyZW50RGltKyJZIl0gLSB0YWdzW2N1cnJlbnREaW0rIlkiXSkgLSBoZXhTY2FsZSAmJiB5IDwgKGhleFtjdXJyZW50RGltKyJZIl0gLSB0YWdzW2N1cnJlbnREaW0rIlkiXSkgKyBoZXhTY2FsZQogICAgfSkpOwoKICAgIGlmIChuZWFyYnlQb3J0YWxCb3QgfHwgaSA8IDcpCiAgICB7CiAgICAgICAgaGV4Lm9uUG9ydGFsQ29tcGxldGUgPSBmYWxzZTsKICAgICAgICBoZXguY29sb3IgPSB0YWdzLmNvbG9yOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIGhleC5vblBvcnRhbENvbXBsZXRlID0gdHJ1ZTsKICAgICAgICBoZXguY29sb3IgPSAiY2xlYXIiOwogICAgfQoKICAgIGhleE51bSsrOwoKICAgIHByZXZpb3VzSGV4ID0gYXdhaXQgY3JlYXRlKGhleCk7Cn0KCmxldCBub25Qb3J0YWxIZXhlcyA9IGdldEJvdHMoIm9uUG9ydGFsQ29tcGxldGUiLCB0cnVlKTsKbGV0IHBvcnRhbEhleGVzID0gZ2V0Qm90cygib25Qb3J0YWxDb21wbGV0ZSIsIGZhbHNlKTsKCmZvciAobGV0IG4gPSAwOyBuIDwgbm9uUG9ydGFsSGV4ZXMubGVuZ3RoOyBuKyspCnsKICAgIGRlc3Ryb3kobm9uUG9ydGFsSGV4ZXNbbl0pOwp9Cgp3aGlzcGVyKHBvcnRhbEhleGVzLCAiYW5pbWF0ZSIsIGhleFNjYWxlKTsKCm1hc2tzLmZvcm0gPSAicG9ydGFsIjsKbWFza3MuZm9ybUFkZHJlc3MgPSB0YWdzLnBvcnRhbEFkZHJlc3M7Cm1hc2tzLnBvcnRhbEhleEJvdHMgPSBnZXRMaW5rKHBvcnRhbEhleGVzKTsKCnRoaXNCb3QucG9ydGFsTWVudSgpOwoKZnVuY3Rpb24gY2hlY2tIZXhQb3MoaGV4LCBkaW1lbnNpb24pCnsKICAgIGxldCBzY2FsZVZhciA9IGhleFNjYWxlLzI7CiAgICBsZXQgeFBvcyA9IGhleC50YWdzW2RpbWVuc2lvbisiWCJdOwogICAgbGV0IHlQb3MgPSBoZXgudGFnc1tkaW1lbnNpb24rIlkiXTsKICAgIGxldCBoZXhNYXRoVmFyID0gTWF0aC5QSSAvIDY7CiAgICBsZXQgeFNwYWNpbmdQbHVzID0geFBvcyArIHNjYWxlVmFyICsgKDEgKyBNYXRoLmNvcyhoZXhNYXRoVmFyKSk7CiAgICBsZXQgeFNwYWNpbmdNaW51cyA9IHhQb3MgLSAoc2NhbGVWYXIgKyAoMSArIE1hdGguY29zKGhleE1hdGhWYXIpKSk7CiAgICBsZXQgeVNwYWNpbmdUb3AgPSBNYXRoLmZsb29yKGhleC50YWdzLnNjYWxlKSArIHlQb3M7CiAgICBsZXQgeVNwYWNpbmdVcCA9IHlQb3MgKyBzY2FsZVZhciAqIE1hdGguc2luKGhleE1hdGhWYXIpOwogICAgbGV0IHlTcGFjaW5nRG93biA9IHlQb3MgLSBzY2FsZVZhciAqIE1hdGguc2luKGhleE1hdGhWYXIpOwogICAgbGV0IHlTcGFjaW5nQm90dG9tID0geVBvcyAtIE1hdGguZmxvb3IoaGV4LnRhZ3Muc2NhbGUpOwogICAgbGV0IHhDaGVjayA9IFt4UG9zLCB4U3BhY2luZ1BsdXMsIHhTcGFjaW5nUGx1cywgeFBvcywgeFNwYWNpbmdNaW51cywgeFNwYWNpbmdNaW51c107CiAgICBsZXQgeUNoZWNrID0gW3lTcGFjaW5nVG9wLCB5U3BhY2luZ1VwLCB5U3BhY2luZ0Rvd24sIHlTcGFjaW5nQm90dG9tLCB5U3BhY2luZ0Rvd24sIHlTcGFjaW5nVXBdOwogICAgbGV0IHRvdGFsTmVpZ2hib3JzID0gMDsKICAgIGxldCBuZWlnaGJvckFycmF5ID0gW10KCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY7IGkrKykKICAgIHsKICAgICAgICBsZXQgaGV4TmVpZ2hib3IgPSBnZXRCb3QoYnlNb2QoewogICAgICAgICAgICBbZGltZW5zaW9uXTogdHJ1ZSwgCiAgICAgICAgICAgIFtkaW1lbnNpb24rIlgiXTogeCA9PiB4ID4geENoZWNrW2ldIC0gc2NhbGVWYXIgJiYgeCA8IHhDaGVja1tpXSArIHNjYWxlVmFyLCAKICAgICAgICAgICAgW2RpbWVuc2lvbisiWSJdOiB5ID0+IHkgPiB5Q2hlY2tbaV0gLSBzY2FsZVZhciAmJiB5IDwgeUNoZWNrW2ldICsgc2NhbGVWYXIsCiAgICAgICAgICAgIG9yaWdpbjogaGV4LnRhZ3Mub3JpZ2luLAogICAgICAgICAgICBwb3J0YWxIZXg6IHRydWUKICAgICAgICB9KSk7CgogICAgICAgIGlmICghaGV4TmVpZ2hib3IpCiAgICAgICAgewogICAgICAgICAgICBuZWlnaGJvckFycmF5LnB1c2goImVtcHR5Iik7CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIG5laWdoYm9yQXJyYXkucHVzaChoZXhOZWlnaGJvcik7CiAgICAgICAgICAgIHRvdGFsTmVpZ2hib3JzKys7CiAgICAgICAgfQogICAgfQoKICAgIGlmICh0b3RhbE5laWdoYm9ycyA9PSAwKQogICAgewogICAgICAgIHZhciB0YXJnZXQgPSAwOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIHZhciBlbXB0eSA9IGZhbHNlOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDY7IGorKykKICAgICAgICB7CiAgICAgICAgICAgIGxldCBuZXh0RW1wdHkgPSBuZWlnaGJvckFycmF5W2pdOwoKICAgICAgICAgICAgaWYgKG5leHRFbXB0eSA9PSAiZW1wdHkiKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBlbXB0eSA9IHRydWU7CgogICAgICAgICAgICAgICAgaWYgKGogPT0gNSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gNTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZihuZXh0RW1wdHkgIT0gImVtcHR5IiAmJiBlbXB0eSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGotMTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIHRhcmdldDsKfScA8I3JzALEmwEJcG9pbnRhYmxlAgQA8I3JzALxzQEEdHJ1ZScA8I3JzALEmwELb25HcmlkQ2xpY2sCBADwjcnMAvbNAZMBQGlmICh0YWdzLmZvcm0gIT0gInBvcnRhbCIpCnsKICAgIHJldHVybjsKfQoKbGV0IHBvcnRhbENsaWNrID0gdGhpc0JvdC5wb3J0YWxQb3NpdGlvbkNoZWNrKHRoYXQpOwoKaWYgKCFwb3J0YWxDbGljaykKewogICAgdGhpc0JvdC5jbG9zZVBvcnRhbCgpOwp9JwDwjcnMAsSbAQtjbG9zZVBvcnRhbAIEAPCNycwCis8BakB3aGlzcGVyKGxpbmtzLnBvcnRhbEhleEJvdHMsICJwb3J0YWxSZXNldCIpOwoKY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSBudWxsOwoKY2xlYXJUYWdNYXNrcyh0aGlzQm90KTsnAPCNycwCxJsBCnBvcnRhbE1lbnUCBADwjcnMAvXPAeIHQHNob3V0KCJhYlBvcnRhbE1lbnVSZXNldCIpOwoKY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAiYWJQb3J0YWxNZW51IjsKCmxldCBtZW51QnV0dG9uID0ge307CgptZW51QnV0dG9uLnNwYWNlID0gInRlbXBMb2NhbCI7Cm1lbnVCdXR0b24uYWJQb3J0YWxNZW51ID0gdHJ1ZTsKbWVudUJ1dHRvbi5hYlBvcnRhbE1lbnVSZXNldCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKbWVudUJ1dHRvbi5jb2xvciA9IHRhZ3MuY29sb3I7Cm1lbnVCdXR0b24ubWFuYWdlciA9IGdldExpbmsodGhpc0JvdCk7Cm1lbnVCdXR0b24ubWVudUl0ZW1TdHlsZSA9IGDwn6esIHsiYm9yZGVyLXJhZGl1cyI6ICI5cHggOXB4IDlweCA5cHgiLCAibWFyZ2luLXRvcCI6ICI2cHgifWA7Cm1lbnVCdXR0b24ubGFiZWxBbGlnbm1lbnQgPSAiY2VudGVyIjsKbWVudUJ1dHRvbi5sYWJlbCA9IHRhZ3MucG9ydGFsQWRkcmVzczsKCmNyZWF0ZShtZW51QnV0dG9uKTsKCm1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiZWRpdCI7Cm1lbnVCdXR0b24ubGFiZWxBbGlnbm1lbnQgPSAibGVmdCI7Cm1lbnVCdXR0b24ubGFiZWwgPSAiZWRpdCBkaW1lbnNpb24iOwptZW51QnV0dG9uLnRhcmdldCA9IHRoaXNCb3QuaWQ7Cm1lbnVCdXR0b24ub25DbGljayA9IGBAIGxpbmtzLm1hbmFnZXIucG9ydGFsQ2hhbmdlRGltZW5zaW9uKCk7YDsKCmNyZWF0ZShtZW51QnV0dG9uKTsKCm1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiYXJyb3dfZm9yd2FyZCI7Cm1lbnVCdXR0b24ubGFiZWxBbGlnbm1lbnQgPSAibGVmdCI7Cm1lbnVCdXR0b24ubGFiZWwgPSAiZ28gdG8gZGltZW5zaW9uIjsKbWVudUJ1dHRvbi50YXJnZXQgPSB0YWdzLmZvcm1BZGRyZXNzOwptZW51QnV0dG9uLm9uQ2xpY2sgPSBgQCBzaG91dCgiYWJQb3J0YWxNZW51UmVzZXQiKTsKCmNvbmZpZ0JvdC50YWdzLmdyaWRQb3J0YWwgPSBsaW5rcy5tYW5hZ2VyLnRhZ3MucG9ydGFsQWRkcmVzcztgOwoKY3JlYXRlKG1lbnVCdXR0b24pOycA8I3JzALEmwEIb25DcmVhdGUCBADwjcnMAtbXAT5AaWYgKCF0YWdzLnBvcnRhbEFkZHJlc3MpCnsKICAgIHRhZ3MucG9ydGFsQWRkcmVzcyA9IHV1aWQoKTsKfScA8I3JzALEmwETcG9ydGFsUG9zaXRpb25DaGVjawIEAPCNycwCldgBpBZAbGV0IGN1cnJlbnREaW0gPSB0aGF0LmRpbWVuc2lvbiA/IHRoYXQuZGltZW5zaW9uIDogdGhhdC50by5kaW1lbnNpb247CmxldCBwb3NZID0gdGhhdC5wb3NpdGlvbiA/IHRoYXQucG9zaXRpb24ueSA6IHRoYXQudG8ueTsKbGV0IHBvc1ggPSB0aGF0LnBvc2l0aW9uID8gdGhhdC5wb3NpdGlvbi54IDogdGhhdC50by54OwpsZXQgcG9ydGFsSGV4Qm90cyA9IGxpbmtzLnBvcnRhbEhleEJvdHM7CmxldCBwb3J0YWxFbnRyeSA9IGZhbHNlOwoKZm9yIChsZXQgaSA9IDA7IGkgPCBwb3J0YWxIZXhCb3RzLmxlbmd0aDsgaSsrKSAKewogICAgbGV0IGN1cnJlbnRIZXggPSBwb3J0YWxIZXhCb3RzW2ldOwogICAgbGV0IG1heFkgPSBjdXJyZW50SGV4LnRhZ3NbY3VycmVudERpbSArICJZIl0gKyBjdXJyZW50SGV4LnRhZ3Muc2NhbGUgLyAyOwogICAgbGV0IG1pblkgPSBjdXJyZW50SGV4LnRhZ3NbY3VycmVudERpbSArICJZIl0gLSBjdXJyZW50SGV4LnRhZ3Muc2NhbGUgLyAyOwoKICAgIGlmIChwb3NZIDw9IG1heFkgJiYgcG9zWSA+PSBtaW5ZKSB7CgogICAgICAgIC8vU0VUVVAgQSBDSEVDSyBGT1IgV0hFTiBYID0gREVDSyBYCiAgICAgICAgbGV0IG1heFggPSBjdXJyZW50SGV4LnRhZ3NbY3VycmVudERpbSArICJYIl0gKyBjdXJyZW50SGV4LnRhZ3Muc2NhbGUgLyAyICsgMC41OwogICAgICAgIGxldCBtaW5YID0gY3VycmVudEhleC50YWdzW2N1cnJlbnREaW0gKyAiWCJdIC0gY3VycmVudEhleC50YWdzLnNjYWxlIC8gMiAtIDAuNTsKCiAgICAgICAgaWYgKHBvc1ggPD0gbWF4WCAmJiBwb3NYID49IG1pblgpIHsKICAgICAgICAgICAgaWYgKHBvc1ggPD0gY3VycmVudEhleC50YWdzW2N1cnJlbnREaW0gKyAiWCJdICsgMC4zICYmIHBvc1ggPj0gY3VycmVudEhleC50YWdzW2N1cnJlbnREaW0gKyAiWCJdIC0gMC4zKS8vbm90IHBlcmZlY3QgcGFydCBvZiBhbGcKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKHBvc1kgPj0gY3VycmVudEhleC50YWdzW2N1cnJlbnREaW0gKyAiWSJdIC0gY3VycmVudEhleC50YWdzLnNjYWxlIC8gMiAmJiBwb3NZIDw9IGN1cnJlbnRIZXgudGFnc1tjdXJyZW50RGltICsgIlkiXSArIGN1cnJlbnRIZXgudGFncy5zY2FsZSAvIDIpIAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHBvcnRhbEVudHJ5ID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCBtaWRYID0gY3VycmVudEhleC50YWdzW2N1cnJlbnREaW0gKyAiWCJdOwogICAgICAgICAgICBsZXQgbWlkWSA9IGN1cnJlbnRIZXgudGFnc1tjdXJyZW50RGltICsgIlkiXTsKICAgICAgICAgICAgY29uc3QgYSA9IE1hdGgucG93KGN1cnJlbnRIZXgudGFncy5zY2FsZSAvIDIsIDIpOwogICAgICAgICAgICBjb25zdCBiID0gTWF0aC5wb3coYSAvIDIsIDIpOwogICAgICAgICAgICBjb25zdCBtYXhEaXN0YW5jZSA9IE1hdGguc3FydChNYXRoLmFicyhhIC0gYikpOwogICAgICAgICAgICBsZXQgc2xvcGU7CgogICAgICAgICAgICBpZiAoKHBvc1ggPiBtaWRYICYmIHBvc1kgPiBtaWRZKSB8fCAocG9zWCA8IG1pZFggJiYgcG9zWSA8IG1pZFkpKSAKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgc2xvcGUgPSAobWF4WSAtIG1pblkpIC8gKG1heFggLSBtaW5YKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChwb3NYID4gbWlkWCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzbG9wZSA9IChtYXhYIC0gbWluWCkgLyAobWF4WSAtIG1pblkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSAKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBzbG9wZSA9IDEgLyAobWF4WCAtIG1pblgpIC8gKG1heFkgLSBtaW5ZKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGV0IGMxID0gbWF4WSAtIChtYXhYICogc2xvcGUpOwogICAgICAgICAgICBsZXQgYzIgPSBwb3NZIC0gKHBvc1ggKiBzbG9wZSk7CiAgICAgICAgICAgIGxldCBhY3R1YWxEaXN0YW5jZSA9IE1hdGguYWJzKGMyIC0gYzEpIC8gTWF0aC5zcXJ0KE1hdGgucG93KHNsb3BlLCAyKSArIDEpOwoKICAgICAgICAgICAgaWYgKGFjdHVhbERpc3RhbmNlIDw9IG1heERpc3RhbmNlKSAKICAgICAgICAgICAgeyAgIAogICAgICAgICAgICAgICAgcG9ydGFsRW50cnkgPSB0cnVlOwoKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8vTk9UIFNVUkUgT0YgVEhJUyBDT0RFUyBORUVEPwogICAgLy8gaWYgKHRoYXQucG9ydGFsSUQpIAogICAgLy8gewogICAgLy8gICAgIGlmICh0aGF0LnBvcnRhbElEID09IGN1cnJlbnRIZXgudGFncy5vcmlnaW4pIAogICAgLy8gICAgIHsKICAgIC8vICAgICAgICAgcG9ydGFsRW50cnkgPSB0cnVlOwoKICAgIC8vICAgICAgICAgYnJlYWs7CiAgICAvLyAgICAgfQogICAgLy8gfQp9CgovLyBsZXQgcG9ydGFsQm90cyA9IGdldEJvdHMoInBvcnRhbEhleEJvdHMiKTsvL0NIRUNLIFRPIFNFRSBJRiBUSEVSRSBBUkUgT1RIRVIgT1BFTiBQT1JUQUwgKG5vdCBzdXJlIEkgbmVlZCB0aGlzKQoKLy8gZm9yIChsZXQgaSA9IDA7IGkgPCBwb3J0YWxCb3RzLmxlbmd0aDsgaSsrKSAKLy8gewovLyAgICAgaWYgKHBvcnRhbEJvdHNbaV0uaWQgIT0gdGhpc0JvdC5pZCkgCi8vICAgICB7Ci8vICAgICAgICAgd2hpc3Blcihwb3J0YWxCb3RzW2ldLCAiY2xvc2VQb3J0YWwiKTsKLy8gICAgIH0KLy8gfQoKcmV0dXJuIHBvcnRhbEVudHJ5OycA8I3JzALEmwEMb25BbnlCb3REcm9wAgQA8I3JzAK67gHVBEBpZiAodGhhdC5kcmFnQm90LmlkID09IHRoaXNCb3QuaWQpCnsKICAgIGNsZWFySW50ZXJ2YWwodGFncy5pbnRlcnZhbCk7CgogICAgbWFza3MuaW50ZXJ2YWwgPSBudWxsOwoKICAgIHJldHVybjsKfQoKaWYgKHRhZ3MuZm9ybSAhPSAicG9ydGFsIikKewogICAgcmV0dXJuOwp9Cgpjb25zdCBjdXJyZW50RGltID0gdGhhdC50by5kaW1lbnNpb247CmNvbnN0IHBvcnRhbERyb3AgPSBhd2FpdCB0aGlzQm90LnBvcnRhbFBvc2l0aW9uQ2hlY2sodGhhdCk7CgppZiAocG9ydGFsRHJvcCkgCnsKICAgIGxldCBuZXdEaW0gPSB0YWdzLnBvcnRhbEFkZHJlc3M7CgogICAgdGhhdC5kcmFnQm90LnRhZ3NbbmV3RGltXSA9IHRydWU7CiAgICB0aGF0LmRyYWdCb3QudGFnc1tuZXdEaW0gKyAiWCJdID0gdGhhdC5kcmFnQm90LnRhZ3NbY3VycmVudERpbSArICJYIl0gLSB0YWdzW2N1cnJlbnREaW0gKyAiWCJdOwogICAgdGhhdC5kcmFnQm90LnRhZ3NbbmV3RGltICsgIlkiXSA9IHRoYXQuZHJhZ0JvdC50YWdzW2N1cnJlbnREaW0gKyAiWSJdIC0gdGFnc1tjdXJyZW50RGltICsgIlkiXTsKICAgIHRoYXQuZHJhZ0JvdC50YWdzW2N1cnJlbnREaW1dID0gbnVsbDsKfScA8I3JzALEmwEGb25EcmFnAgQA8I3JzAKQ8wFeQGlmICghdGFncy5pbnRlcnZhbCkKewogICAgbWFza3MuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB0aGlzQm90LnBvc2l0aW9uQ2hlY2soKSwgMTAwKTsKfScA8I3JzALEmwEVcG9ydGFsQ2hhbmdlRGltZW5zaW9uAgQA8I3JzALv8wG+AUBjb25zdCBuZXdEaW1lbnNpb24gPSBhd2FpdCBvcy5zaG93SW5wdXQodGFncy5wb3J0YWxBZGRyZXNzLCB7CiAgICB0aXRsZTogImVkaXQgZGltZW5zaW9uIgp9KTsKCmlmICghbmV3RGltZW5zaW9uKQp7CiAgICByZXR1cm47Cn07Cgp0YWdzLnBvcnRhbEFkZHJlc3MgPSBuZXdEaW1lbnNpb247Cgp0aGlzQm90LnBvcnRhbE1lbnUoKTsnAPCNycwCxJsBDXBvc2l0aW9uQ2hlY2sCBADwjcnMAq71AagMQGxldCBoZWlnaHQgPSBncmlkUG9ydGFsQm90LnRhZ3MucGl4ZWxIZWlnaHQ7CmxldCBib3RUaGlyZCA9IGhlaWdodCAtIChoZWlnaHQgLyA4KTsKbGV0IHBvaW50ZXJZID0gZ3JpZFBvcnRhbEJvdC50YWdzLnBvaW50ZXJQaXhlbFk7CgppZiAocG9pbnRlclkgPiBib3RUaGlyZCkKewogICAgaWYgKGNvbmZpZ0JvdC50YWdzLm1pbmlHcmlkUG9ydGFsICE9IHRhZ3MucG9ydGFsQWRkcmVzcykKICAgIHsKICAgICAgICBjb25maWdCb3QudGFncy5taW5pR3JpZFBvcnRhbCA9IHRhZ3MucG9ydGFsQWRkcmVzczsKCiAgICAgICAgbWluaUdyaWRQb3J0YWxCb3QudGFncy5taW5pUG9ydGFsV2lkdGggPSAxOwoKICAgICAgICBtaW5pR3JpZFBvcnRhbEJvdC50YWdzLnBvcnRhbENvbG9yID0gdGFncy5jb2xvcjsKICAgIH0KfQplbHNlCnsKICAgIGlmIChjb25maWdCb3QudGFncy5taW5pR3JpZFBvcnRhbCA9PSB0YWdzLnBvcnRhbEFkZHJlc3MpCiAgICB7CiAgICAgICAgY29uZmlnQm90LnRhZ3MubWluaUdyaWRQb3J0YWwgPSBudWxsOwogICAgICAgIG1pbmlHcmlkUG9ydGFsQm90LnRhZ3MucG9ydGFsQ29sb3IgPSBudWxsOwogICAgICAgIG1pbmlHcmlkUG9ydGFsQm90LnRhZ3MubWluaVBvcnRhbFdpZHRoID0gbnVsbDsKICAgIH0KfQoKCgoKLy8gaWYgKHRoYXQuYm90LnRhZ3MucHJpbWl0aXZlSUQpCi8vIHsKLy8gICAgIGlmICh0aGF0LmJvdC50YWdzLnByaW1pdGl2ZUlEID09ICJwb3J0YWwiKQovLyAgICAgewovLyAgICAgICAgIGxldCBwb3J0YWxCb3QgPSB0aGF0LmJvdDsKCi8vICAgICAgICAgY2xlYXJJbnRlcnZhbChwb3J0YWxCb3QubWFza3MuaW50ZXJ2YWwpOwovLyAgICAgICAgIGNsZWFyVGFnTWFza3MocG9ydGFsQm90KTsKCi8vICAgICAgICAgaWYgKHRoYXQudG8uZGltZW5zaW9uICE9IHRoYXQuZnJvbS5kaW1lbnNpb24pCi8vICAgICAgICAgewovLyAgICAgICAgICAgICBpZiAodGhhdC50by5kaW1lbnNpb24gPT0gcG9ydGFsQm90LnRhZ3MucG9ydGFsQWRkcmVzcykKLy8gICAgICAgICAgICAgewovLyAgICAgICAgICAgICAgICAgY29uZmlnQm90LnRhZ3MubWluaUdyaWRQb3J0YWwgPSBwb3J0YWxCb3QudGFncy5wb3J0YWxBZGRyZXNzOwoKLy8gICAgICAgICAgICAgICAgIG1pbmlHcmlkUG9ydGFsQm90LnRhZ3MubWluaVBvcnRhbFdpZHRoID0gMTsKCi8vICAgICAgICAgICAgICAgICBwb3J0YWxCb3QudGFnc1t0aGF0LnRvLmRpbWVuc2lvbiArICJYIl0gPSAwOwovLyAgICAgICAgICAgICAgICAgcG9ydGFsQm90LnRhZ3NbdGhhdC50by5kaW1lbnNpb24gKyAiWSJdID0gMDsKLy8gICAgICAgICAgICAgfQovLyAgICAgICAgICAgICBlbHNlIGlmIChjb25maWdCb3QudGFncy5taW5pR3JpZFBvcnRhbCA9PSBwb3J0YWxCb3QudGFncy5wb3J0YWxBZGRyZXNzICYmIHRoYXQudG8uZGltZW5zaW9uICE9IHBvcnRhbEJvdC50YWdzLnBvcnRhbEFkZHJlc3MpCi8vICAgICAgICAgICAgIHsKLy8gICAgICAgICAgICAgICAgIGNvbmZpZ0JvdC50YWdzLm1pbmlHcmlkUG9ydGFsID0gbnVsbDsKLy8gICAgICAgICAgICAgfQovLyAgICAgICAgIH0KLy8gICAgIH0KLy8gfScA8I3JzALEmwEPYWJNZW51U29ydE9yZGVyAgQA8I3JzALXgQIBMCcA8I3JzALEmwELdG9vbGJveEljb24CBADwjcnMAtmBAgV0b3BpYycA8I3JzALEmwEGYWJUb29sAgQA8I3JzALfgQIEdHJ1ZQA="}]}