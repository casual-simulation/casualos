{"version":2,"updates":[{"id":0,"timestamp":1730315167423,"update":"AdgB+ffVpgsAJwEEYm90cyQxM2YzM2E1MS1jMmZhLTQ2ZGEtYTg4ZS1lNWMwNjc1NTZkMDIBJwD599WmCwAKYWJJRE9yaWdpbgIEAPn31aYLAQ10b29sYm94X3NraWxsJwD599WmCwALYWJJbnRlcmZhY2UCBAD599WmCw8FdHJ1ZQonAPn31aYLAAtkZXNjcmlwdGlvbgIEAPn31aYLFSlUaGlzIHNraWxsIGlzIGFuIGludGVyZmFjZSBmb3IgdG9vbGJveGVzLicA+ffVpgsABGZvcm0CBAD599WmCz8Hbm90aGluZycA+ffVpgsABG1lbnUCBAD599WmC0co8J+Ul2IzMGM2YzVkLWE0ZjctNDI2Ni1iYTM4LTM5M2RjOTVlMWVjYicA+ffVpgsABnN5c3RlbQIEAPn31aYLbhRhYi5pbnRlcmZhY2UudG9vbGJveCcA+ffVpgsACmFiSURTdHVkaW8CBAD599WmC4MBJGU5MWVhYjBkLTZhNzUtNGFiOS04YTBlLTUwYTRjYzBjMWQzNCcA+ffVpgsACHJlbWVtYmVyAgQA+ffVpguoASjwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwD599WmCwALdG9vbGJveF9hZGQCBAD599WmC88BngRAY29uc3QgdG9vbGJveERhdGEgPSB0aGF0Owpjb25zdCB0b29sYm94TmFtZSA9IHRoYXQubmFtZTsKY29uc3QgdG9vbGJveFN0dWRpbyA9IHRoYXQuc3R1ZGlvOwoKLy9MT0FESU5HIEJBUj8KCmlmICh0b29sYm94U3R1ZGlvID09IGZhbHNlKQp7CiAgICBhd2FpdCBsaW5rcy5sZWFybi5hYkFkYXB0KHRvb2xib3hOYW1lKTsKCiAgICBvcy50b2FzdCgidG9vbGJveCBsb2FkZWQiKTsKfQplbHNlCnsKICAgIGNvbnN0IHRvb2xib3hMb29rdXAgPSBhd2FpdCBsaW5rcy5zZWFyY2guaGF0Y2goe2FiSUQ6IHRvb2xib3hOYW1lLCByZWNvcmRLZXk6IHRvb2xib3hTdHVkaW8sIGF1dG9IYXRjaDogdHJ1ZX0pOwoKICAgIGlmICh0b29sYm94TG9va3VwLnN1Y2Nlc3MpCiAgICB7CiAgICAgICAgb3MudG9hc3QoInRvb2xib3ggbG9hZGVkIik7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgY29uc29sZS5sb2codG9vbGJveExvb2t1cCk7CgogICAgICAgIG9zLnRvYXN0KCJpc3N1ZSBsb2FkaW5nIHRvb2xib3gsIHBsZWFzZSB0cnkgYWdhaW4iKTsKICAgIH0KfScA+ffVpgsABWxlYXJuAgQA+ffVpgvuBSjwn5SXNjY1N2I4NjUtZTk4My00NDAxLTlmYzktZjU0MThkMThhN2Y3JwD599WmCwAFc3RvcmUCBAD599WmC5UGKPCflJc3NmFmMDQ5MS0zOTE5LTQ5ODQtYWE4Mi0yMmM3NDJmNDI2M2YnAPn31aYLAAZzZWFyY2gCBAD599WmC7wGKPCflJdkODM3MTQ0NC05MTU4LTQ0MzYtOGZjNy04NGNjOTFiN2Y1MjUnAPn31aYLAAhhYklnbm9yZQIEAPn31aYL4wYEdHJ1ZScA+ffVpgsACWFiVmVyc2lvbgIEAPn31aYL6AYUOS42NS4xLjE3MzAzMTUxNjc0MjInAPn31aYLAA1tYW5pZmVzdGF0aW9uAgQA+ffVpgv9Bijwn5SXZGNhNWQ5ODctYzRkOC00NmU0LWI2MGMtZGFhN2IyZjRkZGFkJwD599WmCwAQYWJHcmlkTWVudUFjdGlvbgIEAPn31aYLpAenB0BzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAiYWJNZW51IjsKCmxpbmtzLm1lbnUubWFza3Mub25HcmlkQ2xpY2sgPSAiQCBzaG91dCgnYWJNZW51UmVmcmVzaCcpOyBsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soKTsiOwoKY29uc3QgcG9zc2libGVUb29sYm94ZXMgPSBsaW5rcy5yZW1lbWJlci50YWdzLnRvb2xib3hfYXJyYXk7CmNvbnN0IG1lbnVCb3QgPSB7fTsKCm1lbnVCb3QuYWJNZW51ID0gdHJ1ZTsKbWVudUJvdC5hYk1lbnVSZWZyZXNoID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwptZW51Qm90Lm1hbmFnZXIgPSBnZXRMaW5rKHRoaXNCb3QpOwptZW51Qm90LmZvcm1BZGRyZXNzID0gImFkZF9ib3giOwptZW51Qm90Lm1hbmlmZXN0YXRpb24gPSB0YWdzLm1hbmlmZXN0YXRpb247Cm1lbnVCb3Qub25DbGljayA9IGBAIGxpbmtzLm1hbmFnZXIudG9vbGJveF9hZGQodGFncy50b29sYm94X2RhdGEpOyBzaG91dCgiYWJNZW51UmVmcmVzaCIpOyBsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soKTtgOwoKZm9yIChsZXQgaSA9IDA7IGkgPCBwb3NzaWJsZVRvb2xib3hlcy5sZW5ndGg7IGkrKykKewogICAgY29uc3QgYWN0aXZlVG9vbGJveCA9IHBvc3NpYmxlVG9vbGJveGVzW2ldOwogICAgY29uc3QgZXh0YW50Qm90ID0gYWN0aXZlVG9vbGJveC5zdHVkaW8gPyBnZXRCb3QoImFiSURPcmlnaW4iLCBhY3RpdmVUb29sYm94Lm5hbWUpOiBnZXRCb3QoYWN0aXZlVG9vbGJveC5uYW1lLCB0cnVlKTsKCiAgICBtZW51Qm90LnRvb2xib3hfZGF0YSA9IGFjdGl2ZVRvb2xib3g7CiAgICBtZW51Qm90LmxhYmVsID0gYWN0aXZlVG9vbGJveC5uYW1lOwoKICAgIGlmICghZXh0YW50Qm90KQogICAgewogICAgICAgIGxpbmtzLm1lbnUuYWJDcmVhdGVNZW51QnV0dG9uKG1lbnVCb3QpOwogICAgfQp9JwD599WmCwAUYWJHcmlkTWVudU9uR2VuZXJhdGUCBAD599WmC8wO5wJAY29uc3QgdG9vbGJveEFycmF5ID0gYWJSZW1lbWJlci50YWdzLnRvb2xib3hfYXJyYXk7CgpsZXQgYWxsVG9vbHMgPSB0cnVlOwoKZm9yIChsZXQgaSA9IDA7IGkgPCB0b29sYm94QXJyYXkubGVuZ3RoOyBpKyspCnsKICAgIGNvbnN0IGN1cnJlbnRUb29sID0gdG9vbGJveEFycmF5W2ldLm5hbWU7CgogICAgaWYgKCFnZXRCb3QoImFiSURPcmlnaW4iLCBjdXJyZW50VG9vbCkgJiYgIWdldEJvdChjdXJyZW50VG9vbCwgdHJ1ZSkpCiAgICB7CiAgICAgICAgYWxsVG9vbHMgPSBmYWxzZTsKICAgIH0KfSAgIAoKaWYgKGFsbFRvb2xzKQp7CiAgICBkZXN0cm95KGxpbmtzLmJhc2VTa2lsbCk7CgogICAgZGVzdHJveSh0aGlzQm90KTsKfScA+ffVpgsADmFiR3JpZE1lbnVJY29uAgQA+ffVpgu0ERNob21lX3JlcGFpcl9zZXJ2aWNlJwD599WmCwAPYWJHcmlkTWVudUxhYmVsAgQA+ffVpgvIEQ90b29sYm94IHRvb2xib3gnAPn31aYLABNhYkdyaWRNZW51U29ydE9yZGVyAgQA+ffVpgvYEQMzLjUnAPn31aYLAA9vbkFCSW5pdGlhbGl6ZWQCBAD599WmC9wRIUBsaW5rcy5sZWFybi5hYkFkYXB0KCJ0b29sYm94MSIpOycBBGJvdHMkMTc0MTBkODMtN2VlZS00YTFlLWI2MzgtNjU0NjM3NGQxN2MzAScA+ffVpgv+EQZzeXN0ZW0CBAD599WmC/8REWFiLmludGVyZmFjZS5zY2FuJwD599WmC/4RBGZvcm0CBAD599WmC5ESB25vdGhpbmcnAPn31aYL/hELYWJJbnRlcmZhY2UCBAD599WmC5kSBHRydWUnAPn31aYL/hEIYWJJZ25vcmUCBAD599WmC54SBHRydWUnAPn31aYL/hEPb25RUkNvZGVTY2FubmVkAgQA+ffVpgujEsYMQGlmICghYnVpbGRlclZlcnNpb24pCnsKICAgIHJldHVybjsKfQoKYWIubG9nKGFiUmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICI6IHNjYW5uZWQgIiArIHRoYXQpOwoKaWYgKGNvbmZpZ0JvdC50YWdzLnB1Ymxpc2hTY2FuKQp7CiAgICBvcy5jbG9zZVFSQ29kZVNjYW5uZXIoKTsKCiAgICBsaW5rcy5zdG9yZS5hYlFSUHVibGlzaCh0aGF0KTsKfQplbHNlIGlmIChjb25maWdCb3QudGFncy5wcmFjdGljZVBlcm1pdFNjYW4pCnsKICAgIGxldCBzY2FubmVkVVJMOwoKICAgIGNvbmZpZ0JvdC50YWdzLnByYWN0aWNlUGVybWl0U2NhbiA9IG51bGw7CgogICAgb3MuY2xvc2VRUkNvZGVTY2FubmVyKCk7CgogICAgdHJ5CiAgICB7CiAgICAgICAgc2Nhbm5lZFVSTCA9IG5ldyBVUkwodGhhdCk7CiAgICB9CiAgICBjYXRjaCAoZSkKICAgIHsKICAgICAgICBvcy50b2FzdCgibm90IGEgcmVjb2duaXplZCBwcmFjdGljZSBwZXJtaXQiKTsKCiAgICAgICAgY29uc29sZS5sb2coZSk7CgogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBsZXQgcGhDaGVjayA9IHNjYW5uZWRVUkwuc2VhcmNoUGFyYW1zLmhhcygicGgiKTsKICAgIGxldCBpbnN0Q2hlY2sgPSBzY2FubmVkVVJMLnNlYXJjaFBhcmFtcy5oYXMoImluc3QiKTsKICAgIGxldCBhYkNoZWNrID0gc2Nhbm5lZFVSTC5zZWFyY2hQYXJhbXMuaGFzKCJhYiIpOwogICAgbGV0IGN3Q2hlY2sgPSBzY2FubmVkVVJMLnNlYXJjaFBhcmFtcy5oYXMoImN3Iik7CgogICAgaWYgKHBoQ2hlY2sgJiYgaW5zdENoZWNrICYmIGFiQ2hlY2sgJiYgY3dDaGVjaykKICAgIHsKICAgICAgICBvcy5nb1RvVVJMKHRoYXQpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIG9zLnRvYXN0KCJub3QgYSByZWNvZ25pemVkIHByYWN0aWNlIHBlcm1pdCIpOwogICAgfQoKICAgIHNob3V0KCJhYk1lbnVSZWZyZXNoIik7Cn0KZWxzZSBpZiAoY29uZmlnQm90LnRhZ3MuYWJTY2FuKQp7CiAgICBzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKICAgIGNvbmZpZ0JvdC50YWdzLmFiU2NhbiA9IG51bGw7CiAgICAKICAgIG9zLmNsb3NlUVJDb2RlU2Nhbm5lcigpOwoKICAgIGxldCBzY2FubmVkVVJMOwoKICAgIHRyeSAKICAgIHsKICAgICAgICBzY2FubmVkVVJMID0gbmV3IFVSTCh0aGF0KTsKICAgIH0KICAgIGNhdGNoIChlKSAKICAgIHsKICAgICAgICBsaW5rcy5zZWFyY2guYWJMVE1TZWFyY2goe2FiSUQ6IHRoYXR9KTsKCiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmKHNjYW5uZWRVUkwuc2VhcmNoUGFyYW1zLmdldCgiYWIiKSA9PSAiZWdnQ2FydG9uIikKICAgIHsKICAgICAgICBvcy5nb1RvVVJMKHRoYXQpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIHNjYW5uZWRVUkwuc2VhcmNoUGFyYW1zLmZvckVhY2goKHZhbHVlLCBrZXkpID0+IHsKICAgICAgICAgICAgbGV0IG5ld1RhZyA9IGtleTsKICAgICAgICAgICAgbGV0IG5ld1ZhbHVlID0gdmFsdWU7CgogICAgICAgICAgICBjb25maWdCb3QudGFnc1tuZXdUYWddID0gbmV3VmFsdWU7CiAgICAgICAgfSk7CgogICAgICAgIGxpbmtzLnNlYXJjaC5hYkxUTVNlYXJjaCh7YWJJRDogY29uZmlnQm90LnRhZ3MuYWJ9KTsKICAgIH0KfScA+ffVpgv+EQVzdG9yZQIEAPn31aYL6h4o8J+Ulzc2YWYwNDkxLTM5MTktNDk4NC1hYTgyLTIyYzc0MmY0MjYzZicA+ffVpgv+EQZzZWFyY2gCBAD599WmC5EfKPCflJdkODM3MTQ0NC05MTU4LTQ0MzYtOGZjNy04NGNjOTFiN2Y1MjUnAPn31aYL/hEQYWJDb3JlTWVudUFjdGlvbgIEAPn31aYLuB83QG9zLm9wZW5RUkNvZGVTY2FubmVyKCk7Cgpjb25maWdCb3QudGFncy5hYlNjYW4gPSB0cnVlOycA+ffVpgv+EQ9hYkNvcmVNZW51TGFiZWwCBAD599WmC/AfBHNjYW4nAPn31aYL/hEOYWJDb3JlTWVudUljb24CBAD599WmC/UfD3FyX2NvZGVfc2Nhbm5lcicA+ffVpgv+ERNhYkNvcmVNZW51U29ydE9yZGVyAgQA+ffVpguFIAEzJwD599WmC/4RCWFiVmVyc2lvbgIEAPn31aYLhyAUOS42NS4xLjE3MzAzMTUxNjc0MjInAQRib3RzJDRhYWY2OTllLWFiYmYtNDRhOC04NWUxLTY4Y2JiNWRmMGUxZgEnAPn31aYLnCAGc3lzdGVtAgQA+ffVpgudIBNhYi5pbnRlcmZhY2UubnVnZ2V0JwD599WmC5wgBGZvcm0CBAD599WmC7EgB25vdGhpbmcnAPn31aYLnCALYWJJbnRlcmZhY2UCBAD599WmC7kgBHRydWUnAPn31aYLnCAIYWJJZ25vcmUCBAD599WmC74gBHRydWUnAPn31aYLnCAMYWJMb2FkTnVnZ2V0AgQA+ffVpgvDIJgCQGxldCBudWdnZXROYW1lID0gdGhhdC5udWdnZXROYW1lOwpsZXQgZm9ybWF0dGVkTnVnZ2V0QUIgPSAibnVnXyIrbnVnZ2V0TmFtZTsKbGV0IGxvYWRlZE51Z2dldCA9IGF3YWl0IGxpbmtzLnNlYXJjaC5vbkxvb2t1cEFCRWdncyh7YWJJRDogZm9ybWF0dGVkTnVnZ2V0QUIsIGFiVmVyc2lvbjogdGhhdC52ZXJzaW9uLCByZXR1cm5UeXBlOiAiZGF0YSJ9KTsKCmxvYWRlZE51Z2dldCA9IGxvYWRlZE51Z2dldC5zdGF0ZVtudWdnZXROYW1lXS5udWdnZXQ7CgpyZXR1cm4gbG9hZGVkTnVnZ2V0OycA+ffVpgucIA9hYlB1Ymxpc2hOdWdnZXQCBAD599WmC9wi7QJALy9zaG91dCgiYWJQdWJsaXNoTnVnZ2V0Iiwge251ZzogIm51Z05hbWUiLCBkYXRhOiBkYXRhfSk7ICBBREQgRUdHIElEIEVWRU5UVUFMTFkKbGV0IHRlc3ROdWdnZXQgPSB0aGF0LmRhdGE7CmxldCBmb3JtYXR0ZWROdWdnZXQgPSB7aWQ6IHRoYXQubnVnLCBudWdnZXQ6IHRlc3ROdWdnZXR9OwpsZXQgdGVzdE51Z2dldE5hbWUgPSB0aGF0Lm51ZzsKbGV0IGZvcm1hdHRlZE51Z2dldEFCID0gIm51Z18iK3Rlc3ROdWdnZXROYW1lOwoKbWFza3MubnVnZ2V0VG9QdWJsaXNoID0gZm9ybWF0dGVkTnVnZ2V0QUI7CgpsaW5rcy5zdG9yZS5hYlB1Ymxpc2hBQih7YWI6IGZvcm1hdHRlZE51Z2dldEFCLCB0YXJnZXQ6IGZvcm1hdHRlZE51Z2dldH0pOycA+ffVpgucIA9pbXBsZW1lbnROdWdnZXQCBAD599WmC8olsQdAbGV0IG51Z2dldE5hbWUgPSB0aGF0Lm51Z2dldDsKbGV0IG51Z2dldFZlcnNpb25DaGVjayA9IG51Z2dldE5hbWUuaW5kZXhPZigiLnYiKTsKbGV0IHZlcnNpb247CgppZiAobnVnZ2V0VmVyc2lvbkNoZWNrICE9IC0xKQp7CiAgICBudWdnZXROYW1lID0gbnVnZ2V0TmFtZS5zdWJzdHJpbmcoMCwgbnVnZ2V0VmVyc2lvbkNoZWNrKTsKCiAgICBsZXQgdmVyc2lvbkNoZWNrID0gdGhhdC5udWdnZXQuc3Vic3RyaW5nKG51Z2dldFZlcnNpb25DaGVjayArIDIpOwoKICAgIGlmIChpc05hTih2ZXJzaW9uQ2hlY2spKQogICAgewogICAgICAgIGNvbnNvbGUubG9nKHZlcnNpb25DaGVjaywgInZlcnNpb24gaXMgbm90IGEgbnVtYmVyIik7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgdmVyc2lvbiA9IE51bWJlcih2ZXJzaW9uQ2hlY2spOwogICAgfQp9CmNvbnNvbGUubG9nKG51Z2dldE5hbWUsIHZlcnNpb24pOwpsZXQgbnVnRGF0YSA9IGF3YWl0IHRoaXNCb3QuYWJMb2FkTnVnZ2V0KHtudWdnZXROYW1lOiBudWdnZXROYW1lLCB2ZXJzaW9uOiB2ZXJzaW9ufSk7CgppZiAobnVnRGF0YSA9PSAiYWJJRCBub3QgZm91bmQiKQp7CiAgICBvcy50b2FzdCgibnVnZ2V0IG5vdCBmb3VuZCIpOwp9CmVsc2UKewogICAgbGV0IHRhcmdldEJvdCA9IGdldEJvdCgiaWQiLCB0aGF0LmJvdCk7CiAgICBsZXQgdGFyZ2V0VGFnID0gdGFyZ2V0Qm90LnJhd1t0aGF0LnRhZ10udG9TdHJpbmcoKTsKICAgIGxldCB0YXJnZXROdWcgPSAieyIgKyB0aGF0Lm51Z2dldCArICJ9IjsgCiAgICBsZXQgbnVnUG9zID0gdGFyZ2V0VGFnLmluZGV4T2YodGFyZ2V0TnVnKTsKCiAgICBkZWxldGVUYWdUZXh0KHRhcmdldEJvdCwgdGhhdC50YWcsIG51Z1BvcywgdGFyZ2V0TnVnLmxlbmd0aCk7CiAgICBpbnNlcnRUYWdUZXh0KHRhcmdldEJvdCwgdGhhdC50YWcsIG51Z1BvcywgbnVnRGF0YSk7Cn0nAPn31aYLnCAMbnVnZ2V0QnV0dG9uAgQA+ffVpgv8LPUMQGxldCB0YWdWYWx1ZSA9IHRoYXQudGFnVmFsdWU7CmxldCByZWdleCA9IC9cbi9naTsKbGV0IGJyZWFrQ2hlY2s7CmxldCBicmVha0FycmF5ID0gWzBdOwovL2xldCBjcmVhdGVkQnV0dG9ucyA9IFtdOwoKd2hpbGUgKGJyZWFrQ2hlY2sgPSByZWdleC5leGVjKHRhZ1ZhbHVlKSkKewogICAgYnJlYWtBcnJheS5wdXNoKGJyZWFrQ2hlY2suaW5kZXgpOwp9CgpsZXQgbmV3TnVnZ2V0QnV0dG9uID0ge307CgpuZXdOdWdnZXRCdXR0b24uc3BhY2UgPSAidGVtcExvY2FsIjsKbmV3TnVnZ2V0QnV0dG9uLmZvcm0gPSAiY29kZUJ1dHRvbiI7Cm5ld051Z2dldEJ1dHRvbi50YXJnZXRCb3QgPSB0aGF0LmJvdC5pZDsKbmV3TnVnZ2V0QnV0dG9uLnRhcmdldFRhZyA9IHRoYXQudGFnOwpuZXdOdWdnZXRCdXR0b24ubGFiZWwgPSAibG9hZCBudWdnZXQiOwpuZXdOdWdnZXRCdXR0b24ubnVnZ2V0UmVzZXQgPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7Cm5ld051Z2dldEJ1dHRvblt0aGF0LmJvdC5pZCArICIuIiArIHRoYXQudGFnXSA9IHRydWU7Cm5ld051Z2dldEJ1dHRvbi5udWdnZXRNYW5hZ2VyID0gIvCflJciICsgdGhpc0JvdC5pZDsKbmV3TnVnZ2V0QnV0dG9uLm9uQ2xpY2sgPSBgQCBsaW5rcy5udWdnZXRNYW5hZ2VyLmltcGxlbWVudE51Z2dldCh7Ym90OiB0YWdzLnRhcmdldEJvdCwgbnVnZ2V0OiB0YWdzLnRhcmdldE51Z2dldCwgdGFnOiB0YWdzLnRhcmdldFRhZ30pOwoKZGVzdHJveSh0aGlzQm90KTtgOwoKZm9yIChsZXQgbnVncyA9IDA7IG51Z3MgPCB0aGF0Lm51Z2dldC5sZW5ndGg7IG51Z3MrKykKewogICAgbGV0IGN1cnJlbnROdWdnZXQgPSB0aGF0Lm51Z2dldFtudWdzXTsKICAgIC8vbGV0IGJ1dHRvbkNoZWNrID0gY3JlYXRlZEJ1dHRvbnMuaW5kZXhPZihjdXJyZW50TnVnZ2V0Lm51Z05hbWUpOwoKICAgIGlmICghY3VycmVudE51Z2dldCB8fCBjdXJyZW50TnVnZ2V0ID09IHVuZGVmaW5lZCkgLy98fCBidXR0b25DaGVjayAhPSAtMQogICAgewogICAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIGlmIChjdXJyZW50TnVnZ2V0Lm51Z1B1Ymxpc2gpCiAgICB7CiAgICAgICAgbmV3TnVnZ2V0QnV0dG9uLm9uQ2xpY2sgPSBgQCBsaW5rcy5udWdnZXRNYW5hZ2VyLnBhY2thZ2VOdWdnZXQoe2JvdDogdGFncy50YXJnZXRCb3QsIG51Z2dldDogdGFncy50YXJnZXROdWdnZXQsIHRhZzogdGFncy50YXJnZXRUYWd9KTsKCiAgICAgICAgZGVzdHJveSh0aGlzQm90KTtgOwoKICAgICAgICBuZXdOdWdnZXRCdXR0b24ubGFiZWwgPSAicHVibGlzaCAiICsgY3VycmVudE51Z2dldC5udWdOYW1lICsgIiBudWdnZXQiOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIG5ld051Z2dldEJ1dHRvbi5sYWJlbCA9ICJsb2FkICIgKyBjdXJyZW50TnVnZ2V0Lm51Z05hbWUgKyAiIG51Z2dldCI7CiAgICB9CgogICAgbmV3TnVnZ2V0QnV0dG9uLnRhcmdldE51Z2dldCA9IGN1cnJlbnROdWdnZXQubnVnTmFtZTsKICAgIG5ld051Z2dldEJ1dHRvblt0aGF0LmJvdC5pZCArICIuIiArIHRoYXQudGFnICsgIlN0YXJ0Il0gPSBjdXJyZW50TnVnZ2V0Lm51Z1N0YXJ0OwoKICAgIGNyZWF0ZShuZXdOdWdnZXRCdXR0b24pOwoKICAgIC8vY3JlYXRlZEJ1dHRvbnMucHVzaChjdXJyZW50TnVnZ2V0Lm51Z05hbWUpOwp9CgpyZXR1cm47JwD599WmC5wgC251Z2dldFBhcnNlAgQA+ffVpgvwOacPQGNvbnN0IG9yaWdpbmFsVGFnVmFsdWUgPSB0aGF0LmVkaXRlZEJvdC5yYXdbdGhhdC5lZGl0ZWRUYWddOwpsZXQgdGFnVmFsdWUgPSBvcmlnaW5hbFRhZ1ZhbHVlOwoKaWYgKCF0YWdWYWx1ZSkgCnsKICAgIHJldHVybjsKfQplbHNlIGlmICh0eXBlb2YgdGFnVmFsdWUgIT09ICJzdHJpbmciKSAKewogICAgdGFnVmFsdWUgPSB0YWdWYWx1ZS50b1N0cmluZygpOwp9CgpsZXQgaW5pdGlhbFBvc3NpYmxlTnVnUG9zID0gMDsKCmlmIChpbml0aWFsUG9zc2libGVOdWdQb3MgPT0gLTEpIAp7CiAgICByZXR1cm47Cn0KZWxzZQp7CiAgICB0YWdWYWx1ZSA9IHRhZ1ZhbHVlLnN1YnN0cmluZyhpbml0aWFsUG9zc2libGVOdWdQb3MpOwp9CgpsZXQgcG9zc2libGVOdWdzID0gb3JpZ2luYWxUYWdWYWx1ZS5yZXBsYWNlKC9bXntdL2csICIiKS5sZW5ndGg7CmxldCB0b3RhbE51Z0JyZWFrcyA9IG9yaWdpbmFsVGFnVmFsdWUucmVwbGFjZSgvW15cbl0vZywgIiIpLmxlbmd0aDsKbGV0IGJyZWFrTGV2ZWwgPSAwOwpsZXQgbnVnc1RvQ2hlY2sgPSBbXTsKCmZvciAobGV0IGkgPSAwOyBpIDwgcG9zc2libGVOdWdzOyBpKyspCnsKICAgIGxldCBpbml0aWFsTnVnUG9zID0gdGFnVmFsdWUuaW5kZXhPZigieyIpICsgMTsKICAgIGxldCBwb3NzaWJsZU51Z0VuZCA9IHRhZ1ZhbHVlLmluZGV4T2YoIn0iKTsKICAgIGxldCBwb3NzaWJsZU51ZyA9IHRhZ1ZhbHVlLnN1YnN0cmluZyhpbml0aWFsTnVnUG9zLCBwb3NzaWJsZU51Z0VuZCk7CgogICAgaWYgKHBvc3NpYmxlTnVnLmluZGV4T2YoIiAiKSA9PSAtMSAmJiAvXG4vZy50ZXN0KHBvc3NpYmxlTnVnKSAhPSB0cnVlICYmIHBvc3NpYmxlTnVnLmxlbmd0aCA+IDAgJiYgcG9zc2libGVOdWcuaW5kZXhPZigiOiIpID09IC0xKQogICAgewogICAgICAgIGxldCBudWdCcmVha3MgPSB0YWdWYWx1ZS5zdWJzdHJpbmcoMCwgdGFnVmFsdWUuaW5kZXhPZigieyIrcG9zc2libGVOdWcrIn0iKSkucmVwbGFjZSgvW15cbl0vZywgIiIpLmxlbmd0aDsKICAgICAgICBsZXQgcHVibGlzaENoZWNrID0gdGFnVmFsdWUuc3Vic3RyaW5nKGluaXRpYWxOdWdQb3MgLSA2LCBpbml0aWFsTnVnUG9zIC0gMik7CiAgICAgICAgbGV0IG51Z1B1Ymxpc2ggPSBudWxsOwoKICAgICAgICBpZiAocHVibGlzaENoZWNrID09ICIubnVnIikKICAgICAgICB7CiAgICAgICAgICAgIG51Z1B1Ymxpc2ggPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgYnJlYWtMZXZlbCArPSBudWdCcmVha3M7CgogICAgICAgIG51Z0JyZWFrcyA9IHRvdGFsTnVnQnJlYWtzIC0gKHRvdGFsTnVnQnJlYWtzIC0gYnJlYWtMZXZlbCk7CiAgICAgICAgCiAgICAgICAgLy9DSEVDSyBJRiAkIGJlZm9yZSBudWdnZXQKICAgICAgICBpZiAodGFnVmFsdWUuc3Vic3RyaW5nKGluaXRpYWxOdWdQb3MgLSAyLCBpbml0aWFsTnVnUG9zIC0gMSkgIT0gIiQiKQogICAgICAgIHsKICAgICAgICAgICAgbnVnc1RvQ2hlY2sucHVzaCh7bnVnTmFtZTogcG9zc2libGVOdWcsIG51Z1N0YXJ0OiBudWdCcmVha3MgKyAxLCBudWdQdWJsaXNoOiBudWdQdWJsaXNofSk7CiAgICAgICAgfQogICAgfQogICAgZWxzZQogICAgewogICAgICAgIGxldCBudWdCcmVha3MgPSB0YWdWYWx1ZS5zdWJzdHJpbmcoMCwgdGFnVmFsdWUuaW5kZXhPZigifSIpKS5yZXBsYWNlKC9bXlxuXS9nLCAiIikubGVuZ3RoOwoKICAgICAgICBicmVha0xldmVsICs9IG51Z0JyZWFrczsKCiAgICAgICAgbnVnQnJlYWtzID0gdG90YWxOdWdCcmVha3MgLSAodG90YWxOdWdCcmVha3MgLSBicmVha0xldmVsKTsKICAgIH0KCiAgICB0YWdWYWx1ZSA9IHRhZ1ZhbHVlLnN1YnN0cmluZyhwb3NzaWJsZU51Z0VuZCArIDEpOwp9Cgp0aGlzQm90Lm51Z2dldEJ1dHRvbih7IG51Z2dldDogbnVnc1RvQ2hlY2ssIGJvdDogdGhhdC5lZGl0ZWRCb3QsIHRhZzogdGhhdC5lZGl0ZWRUYWcsIHRhZ1ZhbHVlOiBvcmlnaW5hbFRhZ1ZhbHVlfSk7JwD599WmC5wgDW9uQUJQdWJsaXNoZWQCBAD599WmC5hJwQFAY29uc29sZS5sb2codGhhdC5hYiwgdGFncy5udWdnZXRUb1B1Ymxpc2gpCgppZiAodGhhdC5hYiA9PSB0YWdzLm51Z2dldFRvUHVibGlzaCkKewogICAgb3MudG9hc3QoIm51Z2dldCBwdWJsaXNoZWQiKTsKCiAgICBtYXNrcy5udWdnZXRUb1B1Ymxpc2ggPSBudWxsOwoKICAgIGNvbmZpZ0JvdC5tYXNrcy5hYlZlcnNpb24gPSBudWxsOwp9JwD599WmC5wgEG9uQW55Qm90c0NoYW5nZWQCBAD599WmC9pKtwRAaWYgKGNvbmZpZ0JvdCAmJiB0aGF0WzBdLmJvdC5pZCAhPSB0aGlzQm90LmlkKSAKewogICAgaWYgKCFjb25maWdCb3QudGFncy5lZGl0aW5nQm90KSByZXR1cm47IC8vIElnbm9yZSBpZiB0aGUgY29uZmlnQm90IGlzbid0IHJlYWR5IHlldC4KCiAgICBjb25zdCBlZGl0ZWRCb3RJRCA9IGNvbmZpZ0JvdC50YWdzLmVkaXRpbmdCb3QucmVwbGFjZSgi8J+UlyIsICIiKTsKCiAgICBpZiAoIXRoYXQuZmluZCh4ID0+IHguYm90LmlkID09IGVkaXRlZEJvdElEKSkgcmV0dXJuOyAvLyBJZiB0aGUgYm90IGNoYW5nZWQgd2Fzbid0IGJlaW5nIGVkaXRlZCBieSB0aGUgdXNlciBpZ25vcmUgaXQuCgogICAgY29uc3QgZWRpdGVkVGFnID0gY29uZmlnQm90LnRhZ3MuZWRpdGluZ1RhZzsKICAgIGNvbnN0IGVkaXRlZEJvdCA9IGdldEJvdCgiaWQiLCBlZGl0ZWRCb3RJRCk7CgogICAgaWYgKGVkaXRlZEJvdCAmJiBlZGl0ZWRUYWcpIAogICAgewogICAgICAgIHNob3V0KCJudWdnZXRSZXNldCIpOwoKICAgICAgICB0aGlzQm90Lm51Z2dldFBhcnNlKHsgZWRpdGVkQm90LCBlZGl0ZWRUYWcgfSk7CiAgICB9Cn0nAPn31aYLnCAIb25DcmVhdGUCBAD599WmC5BPTEB0YWdzLmxpc3RlbmluZyA9IGZhbHNlOwoKLy9zZXRUYWdNYXNrKHRoaXNCb3QsICJsaXN0ZW5pbmciLCB0cnVlLCAibG9jYWwiKTsnAPn31aYLnCANcGFja2FnZU51Z2dldAIEAPn31aYL3U/4BkBjb25zdCB0YXJnZXRCb3QgPSBnZXRCb3QoImlkIiwgdGhhdC5ib3QpOwpjb25zdCB0YWdUZXh0ID0gdGFyZ2V0Qm90LnJhd1t0aGF0LnRhZ107CgppZiAoY29uZmlnQm90LnRhZ3MuY3Vyc29yU3RhcnRJbmRleCB8fCBjb25maWdCb3QudGFncy5jdXJzb3JFbmRJbmRleCkKewogICAgbGV0IHN0YXJ0UG9zID0gY29uZmlnQm90LnRhZ3MuY3Vyc29yU3RhcnRJbmRleDsKICAgIGxldCBlbmRQb3MgPSBjb25maWdCb3QudGFncy5jdXJzb3JFbmRJbmRleDsKCiAgICBpZiAoc3RhcnRQb3MgPT0gZW5kUG9zKQogICAgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIGVsc2UgaWYgKHN0YXJ0UG9zID4gZW5kUG9zKQogICAgewogICAgICAgIGxldCBuZXdTdGFydFBvcyA9IGVuZFBvczsKICAgICAgICBsZXQgbmV3RW5kUG9zID0gc3RhcnRQb3M7CgogICAgICAgIHN0YXJ0UG9zID0gbmV3U3RhcnRQb3M7CiAgICAgICAgZW5kUG9zID0gbmV3RW5kUG9zOwogICAgfQoKICAgIGxldCBkYXRhID0gdGFnVGV4dC5zdWJzdHJpbmcoc3RhcnRQb3MsIGVuZFBvcyArIDEpOwoKICAgIHNob3V0KCJhYlB1Ymxpc2hOdWdnZXQiLCB7bnVnOiB0aGF0Lm51Z2dldCwgZGF0YTogZGF0YX0pOwoKICAgIG9zLnRvYXN0KCJudWcgaXMgcHVibGlzaGluZyIsIDEwKTsKCiAgICBsZXQgdGFyZ2V0TnVnID0gIi5udWcgeyIgKyB0aGF0Lm51Z2dldCArICJ9IjsgCiAgICBsZXQgbnVnUG9zID0gdGFyZ2V0Qm90LnJhd1t0aGF0LnRhZ10uaW5kZXhPZih0YXJnZXROdWcpOwoKICAgIGRlbGV0ZVRhZ1RleHQodGFyZ2V0Qm90LCB0aGF0LnRhZywgbnVnUG9zLCB0YXJnZXROdWcubGVuZ3RoKTsKfQplbHNlCnsKICAgIG9zLnRvYXN0KCJjYW5ub3QgcmVhZCBudWdnZXQgdG8gYmUgcHVibGlzaGVkIikKfScA+ffVpgucIAhyZW1lbWJlcgIEAPn31aYL1lYo8J+Ul2U1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNycA+ffVpgucIAZzZWFyY2gCBAD599WmC/1WKPCflJdkODM3MTQ0NC05MTU4LTQ0MzYtOGZjNy04NGNjOTFiN2Y1MjUnAPn31aYLnCAFc3RvcmUCBAD599WmC6RXKPCflJc3NmFmMDQ5MS0zOTE5LTQ5ODQtYWE4Mi0yMmM3NDJmNDI2M2YnAPn31aYLnCAJbGlzdGVuaW5nAgQA+ffVpgvLVwVmYWxzZScA+ffVpgucIAlhYlZlcnNpb24CBAD599WmC9FXFDkuNjUuMS4xNzMwMzE1MTY3NDIyJwEEYm90cyRiMjZlMTA4OS0xNzJkLTQ1YTktOGQyMi0wNWMzZjU4YzJiZjcBJwD599WmC+ZXBnN5c3RlbQIEAPn31aYL51cWYWIuaW50ZXJmYWNlLmFuaW1hdGlvbicA+ffVpgvmVwRmb3JtAgQA+ffVpgv+Vwdub3RoaW5nJwD599WmC+ZXC2FiSW50ZXJmYWNlAgQA+ffVpguGWAR0cnVlJwD599WmC+ZXCGFiSWdub3JlAgQA+ffVpguLWAR0cnVlJwD599WmC+ZXDW1hbmlmZXN0YXRpb24CBAD599WmC5BYKPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAPn31aYL5lcIcmVtZW1iZXICBAD599WmC7dYKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAPn31aYL5lcYYW5pbWF0aW9uX2FiR3JpZE1hbmlmZXN0AgQA+ffVpgveWOsOQHNob3V0KCJyZXNldCIpOwoKY29uc3QgcG9zaXRpb25YID0gdGhhdD8ucG9zaXRpb24ueCA/PyAwOwpjb25zdCBwb3NpdGlvblkgPSB0aGF0Py5wb3NpdGlvbi55ID8/IDA7CmNvbnN0IGRpbWVuc2lvbiA9IHRoYXQ/LmRpbWVuc2lvbiA/PyAiaG9tZSI7CmNvbnN0IGdyaWRTY2FsZSA9IHRoYXQ/LnNjYWxlID8/IDU7CmNvbnN0IG1vbWVudENvdW50ID0gMDsKY29uc3QgZ3JpZEJvdCA9IHt9OwoKZ3JpZEJvdC5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwpncmlkQm90LmNvbG9yID0gImNsZWFyIjsKZ3JpZEJvdC5zdHJva2VDb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3I7CmdyaWRCb3Quc2NhbGUgPSAwLjAwMTsKZ3JpZEJvdC5zY2FsZVogPSAwLjE7CmdyaWRCb3QucmVzZXQgPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CmdyaWRCb3RbZGltZW5zaW9uXSA9IHRydWU7CmdyaWRCb3QucG9pbnRhYmxlID0gZmFsc2U7CmdyaWRCb3Qua2lsbFRpbWVyID0gIkAgYXdhaXQgb3Muc2xlZXAoNDAwKTsgZGVzdHJveSh0aGlzQm90KTsiOwoKbGV0IHJvdW5kQm90czsKCmZvciAobGV0IGkgPSBncmlkU2NhbGU7IGkgPiAwOyBpLS0pCnsKICAgIGNvbnN0IGJvdENvdW50ID0gaSAqIDg7CgogICAgbGV0IHNpZGVDb3VudCA9IDA7CiAgICBsZXQgcGhhc2VGYWN0b3IgPSAwOwoKICAgIGZvciAobGV0IGogPSAwOyBqIDwgYm90Q291bnQ7IGorKykKICAgIHsKICAgICAgICBpZiAocGhhc2VGYWN0b3IgPT0gMCkKICAgICAgICB7CiAgICAgICAgICAgIGdyaWRCb3RbZGltZW5zaW9uICsgIlgiXSA9ICgoaSArIHBvc2l0aW9uWCkgKiAtMSkgKyBzaWRlQ291bnQ7CiAgICAgICAgICAgIGdyaWRCb3RbZGltZW5zaW9uICsgIlkiXSA9IGkgKyBwb3NpdGlvblk7CiAgICAgICAgfQogICAgICAgIGVsc2UgaWYgKHBoYXNlRmFjdG9yID09IDEpCiAgICAgICAgewogICAgICAgICAgICBncmlkQm90W2RpbWVuc2lvbiArICJYIl0gPSBpICsgcG9zaXRpb25YOwogICAgICAgICAgICBncmlkQm90W2RpbWVuc2lvbiArICJZIl0gPSAoaSArIHBvc2l0aW9uWSkgLSBzaWRlQ291bnQ7ICAKICAgICAgICB9CiAgICAgICAgZWxzZSBpZiAocGhhc2VGYWN0b3IgPT0gMikKICAgICAgICB7CiAgICAgICAgICAgIGdyaWRCb3RbZGltZW5zaW9uICsgIlgiXSA9IChpICsgcG9zaXRpb25YKSAtIHNpZGVDb3VudDsKICAgICAgICAgICAgZ3JpZEJvdFtkaW1lbnNpb24gKyAiWSJdID0gKChpICsgcG9zaXRpb25ZKSAqIC0xKSA7CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICAgIGdyaWRCb3RbZGltZW5zaW9uICsgIlgiXSA9ICgoaSArIHBvc2l0aW9uWCkgKiAtMSkgOwogICAgICAgICAgICBncmlkQm90W2RpbWVuc2lvbiArICJZIl0gPSAoKGkgKyBwb3NpdGlvblkpICogLTEpICsgc2lkZUNvdW50OyAgCiAgICAgICAgfQoKICAgICAgICBjb25zdCBuZXdHcmlkQm90ID0gYXdhaXQgY3JlYXRlKGdyaWRCb3QpOwoKICAgICAgICBhbmltYXRlVGFnKG5ld0dyaWRCb3QsICJzY2FsZSIsIHsKICAgICAgICAgICAgdG9WYWx1ZTogMSwKICAgICAgICAgICAgZWFzaW5nOiB7CiAgICAgICAgICAgICAgICB0eXBlOiAiZWxhc3RpYyIsCiAgICAgICAgICAgICAgICBtb2RlOiAib3V0IgogICAgICAgICAgICB9LAogICAgICAgICAgICBkdXJhdGlvbjogMC4wMQogICAgICAgIH0pOwoKICAgICAgICBuZXdHcmlkQm90LmtpbGxUaW1lcigpOwoKICAgICAgICBzaWRlQ291bnQrKzsKCiAgICAgICAgaWYgKHNpZGVDb3VudCA9PSBib3RDb3VudCAvIDQpCiAgICAgICAgewogICAgICAgICAgICBzaWRlQ291bnQgPSAwOwoKICAgICAgICAgICAgcGhhc2VGYWN0b3IrKzsKICAgICAgICB9CgogICAgICAgIGF3YWl0IG9zLnNsZWVwKDgpOwogICAgfQp9JwD599WmC+ZXCWFiVmVyc2lvbgIEAPn31aYLymcUOS42NS4xLjE3MzAzMTUxNjc0MjInAPn31aYL5lcGb25DaGF0AgQA+ffVpgvfZ1VALy8gaWYgKHRoYXQubWVzc2FnZSA9PSAiQHRlc3QiKQovLyB7Ci8vICAgICB0aGlzQm90LmFuaW1hdGlvbl9hYkdyaWRNYW5pZmVzdCgpOwovLyB9JwEEYm90cyRiMzBjNmM1ZC1hNGY3LTQyNjYtYmEzOC0zOTNkYzk1ZTFlY2IBJwD599WmC7VoBnN5c3RlbQIEAPn31aYLtmgRYWIuaW50ZXJmYWNlLm1lbnUnAPn31aYLtWgEZm9ybQIEAPn31aYLyGgHbm90aGluZycA+ffVpgu1aAtkZXNjcmlwdGlvbgIEAPn31aYL0GgmVGhpcyBza2lsbCBpcyBkZXNpZ25lZCBmb3IgbWVudSBzdHVmZi4oAPn31aYLtWgLYWJJbnRlcmZhY2UBeCcA+ffVpgu1aAphYk9wZW5NZW51AgQA+ffVpgv4aOkKQGF3YWl0IG9zLnJlcXVlc3RBdXRoQm90SW5CYWNrZ3JvdW5kKCk7Cgpjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9ICJhYk1lbnUiOwoKbGV0IG1lbnVUeXBlID0gdGhhdCA/ICJhYiIgKyB0aGF0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGhhdC5zbGljZSgxKSArICJNZW51IjogImFiQ29yZU1lbnUiOyAvL3NldCB1cCBhIGNoZWNrIHRvIHNlZSB3aGF0IHR5cGUgb2YgbWVudSBzaG91bGQgYmUgb2NjdXJpbmcgW2NvcmUsIGJvdCwgZ3JpZCwgaW5zdF0KbGV0IG1lbnVTa2lsbHMgPSBnZXRCb3RzKG1lbnVUeXBlICsgIkFjdGlvbiIpOwpsZXQgbWF4T3B0aW9ucyA9IG1lbnVUeXBlID09ICJpbnN0IiA/IDcgOiA1OwpsZXQgYWJNZW51QnV0dG9uID0ge307CgphYk1lbnVCdXR0b24uYWJNZW51ID0gdHJ1ZTsKYWJNZW51QnV0dG9uLnJlbWVtYmVyID0gdGFncy5yZW1lbWJlcjsKYWJNZW51QnV0dG9uLm1hbmlmZXN0YXRpb24gPSB0YWdzLm1hbmlmZXN0YXRpb247CmFiTWVudUJ1dHRvbi5hYk1lbnVSZWZyZXNoID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwphYk1lbnVCdXR0b24ub25DbGljayA9IGBAIGxpbmtzLmJhc2VTa2lsbC4ke21lbnVUeXBlICsgIkFjdGlvbiJ9KHtib3Q6IHRoaXNCb3R9KTtgOwoKZm9yIChsZXQgaSA9IDA7IGkgPCBtZW51U2tpbGxzLmxlbmd0aDsgaSsrKS8vQUREIExPR0lDIEZPUiBNT1JFIE9QVElPTlMgVEhBTiA1IDogbWF4T3B0aW9ucwp7CiAgICBsZXQgY3VycmVudFNraWxsID0gbWVudVNraWxsc1tpXTsKCiAgICBhYk1lbnVCdXR0b24uYmFzZVNraWxsID0gIvCflJciICsgY3VycmVudFNraWxsLmlkOwogICAgYWJNZW51QnV0dG9uLmxhYmVsID0gY3VycmVudFNraWxsLnRhZ3NbbWVudVR5cGUgKyAiTGFiZWwiXTsKICAgIGFiTWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9IGN1cnJlbnRTa2lsbC50YWdzW21lbnVUeXBlICsgIkljb24iXTsKICAgIGFiTWVudUJ1dHRvbi5vbkNyZWF0ZSA9IGN1cnJlbnRTa2lsbC50YWdzW21lbnVUeXBlICsgIk9uR2VuZXJhdGUiXTsKICAgIGFiTWVudUJ1dHRvbi5hYk1lbnVTb3J0T3JkZXIgPSBjdXJyZW50U2tpbGwudGFnc1ttZW51VHlwZSArICJTb3J0T3JkZXIiXTsKICAgIGFiTWVudUJ1dHRvbi5jb2xvciA9IGN1cnJlbnRTa2lsbC50YWdzW21lbnVUeXBlICsgIkNvbG9yIl0gPyBjdXJyZW50U2tpbGwudGFnc1ttZW51VHlwZSArICJDb2xvciJdIDogbGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKCiAgICB0aGlzQm90LmFiQ3JlYXRlTWVudUJ1dHRvbihhYk1lbnVCdXR0b24pOwp9Cgp0aGlzQm90Lm1hc2tzLm9uR3JpZENsaWNrID0gIkAgc2hvdXQoJ2FiTWVudVJlZnJlc2gnKTsgbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7IjsnAPn31aYLtWgSYWJDcmVhdGVNZW51QnV0dG9uAgQA+ffVpgvgc+cDQGxldCBhZGRpdGlvbmFsVGFncyA9IHRoYXQ7CmxldCBuZXdNZW51QnV0dG9uID0ge307CgpuZXdNZW51QnV0dG9uLnNwYWNlID0gInRlbXBMb2NhbCI7Cm5ld01lbnVCdXR0b24uY29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZVN0cm9rZUNvbG9yOwpuZXdNZW51QnV0dG9uLmxhYmVsQ29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZUxhYmVsQ29sb3IgPz8gImJsYWNrIjsKbmV3TWVudUJ1dHRvbi5sYWJlbEFsaWdubWVudCA9ICJsZWZ0IjsKbmV3TWVudUJ1dHRvbi5tZW51SXRlbVN0eWxlID0geyAiYm9yZGVyLXJhZGl1cyI6IjhweCIsICJtYXJnaW4tdG9wIjoiM3B4In07Cgpmb3IgKGNvbnN0IHRhZyBpbiBhZGRpdGlvbmFsVGFncykKewogICAgbmV3TWVudUJ1dHRvblt0YWddID0gYWRkaXRpb25hbFRhZ3NbdGFnXTsKfQoKbmV3TWVudUJ1dHRvbiA9IGNyZWF0ZShuZXdNZW51QnV0dG9uKTsKCnJldHVybiBuZXdNZW51QnV0dG9uOycA+ffVpgu1aA1hYk1lbnVSZWZyZXNoAgQA+ffVpgvId4EBQGlmIChjb25maWdCb3QudGFncy5tZW51UG9ydGFsPy5zdWJzdHJpbmcoMCwyKSA9PSAiYWIiKQp7CiAgICBjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9IG51bGw7CgogICAgbWFza3Mub25HcmlkQ2xpY2sgPSBudWxsOwp9JwD599WmC7VoCHJlbWVtYmVyAgQA+ffVpgvKeCjwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwD599WmC7VoDW1hbmlmZXN0YXRpb24CBAD599WmC/F4KPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAPn31aYLtWgRYWJFbnZpcm9ubWVudE1lbnUCBAD599WmC5h50AZAc2hvdXQoImFiTWVudVJlZnJlc2giKTsKCmNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gImFiTWVudSI7CgpsZXQgYWJNZW51QnV0dG9uID0ge307CgphYk1lbnVCdXR0b24uYWJNZW51ID0gdHJ1ZTsKYWJNZW51QnV0dG9uLmFiTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CmFiTWVudUJ1dHRvbi5tYW5pZmVzdGF0aW9uID0gdGFncy5tYW5pZmVzdGF0aW9uOwphYk1lbnVCdXR0b24ucmVtZW1iZXIgPSB0YWdzLnJlbWVtYmVyOwphYk1lbnVCdXR0b24ubGVhcm4gPSB0YWdzLmxlYXJuOwoKYnV0dG9uTG9vcDoKZm9yIChsZXQgaSA9IDA7IGkgPCB0YWdzLmFiRW52aXJvbm1lbnRBcnJheS5sZW5ndGg7IGkrKykKewogICAgbGV0IGFjdGl2ZUJ1dHRvbiA9IHRhZ3MuYWJFbnZpcm9ubWVudEFycmF5W2ldOwoKICAgIGFiTWVudUJ1dHRvbi5hYk1lbnVTb3J0T3JkZXIgPSBhY3RpdmVCdXR0b24uYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXI7CgogICAgaWYgKGFjdGl2ZUJ1dHRvbi5hYkVudmlyb25tZW50R2F0ZSkKICAgIHsKICAgICAgICBpZiAoIWxpbmtzW2FjdGl2ZUJ1dHRvbi5hYkVudmlyb25tZW50R2F0ZV0pCiAgICAgICAgewogICAgICAgICAgICBjb250aW51ZSBidXR0b25Mb29wOwogICAgICAgIH0KICAgIH0KCiAgICBsZXQgbmV3QnV0dG9uRGF0YSA9IHsuLi5hYk1lbnVCdXR0b24sIC4uLmFjdGl2ZUJ1dHRvbn07CgogICAgdGhpc0JvdC5hYkNyZWF0ZU1lbnVCdXR0b24obmV3QnV0dG9uRGF0YSk7Cn0KCnRoaXNCb3QubWFza3Mub25HcmlkQ2xpY2sgPSAiQCBzaG91dCgnYWJNZW51UmVmcmVzaCcpOyBsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soKTsiOycA+ffVpgu1aAVsZWFybgIEAPn31aYL6X8o8J+UlzY2NTdiODY1LWU5ODMtNDQwMS05ZmM5LWY1NDE4ZDE4YTdmNycA+ffVpgu1aANncHQCBAD599WmC5CAASjwn5SXZWM4NWMxZDYtOWYxYS00MGQ0LTgyZTEtNWJkNjgwMzQ5YzI3JwD599WmC7VoCGFiSWdub3JlAgQA+ffVpgu3gAEEdHJ1ZScA+ffVpgu1aAZzZWFyY2gCBAD599WmC7yAASjwn5SXZDgzNzE0NDQtOTE1OC00NDM2LThmYzctODRjYzkxYjdmNTI1JwD599WmC7VoBm51Z2dldAIEAPn31aYL44ABKPCflJc0YWFmNjk5ZS1hYmJmLTQ0YTgtODVlMS02OGNiYjVkZjBlMWYnAPn31aYLtWgFdGVzdHMCBAD599WmC4qBASjwn5SXYjgzZDk3MmItMDUzNS00MDUxLWI1ODktNDFjZWRhODUzNWYxJwD599WmC7VoD29uUG9ydGFsQ2hhbmdlZAIEAPn31aYLsYEBbkBpZiAodGhhdC5wb3J0YWwgPT0gInN5c3RlbVBvcnRhbCIgJiYgIXRoYXQuZGltZW5zaW9uICYmICFsaW5rcy50ZXN0cykKewogICAgbGlua3MubGVhcm4uYWJBZGFwdCgiYWJUZXN0cyIpOwp9JwD599WmC7VoA2FzawIEAPn31aYLoIIBKPCflJdlYzg1YzFkNi05ZjFhLTQwZDQtODJlMS01YmQ2ODAzNDljMjcnAPn31aYLtWgSYWJFbnZpcm9ubWVudEFycmF5AgQA+ffVpgvHggHdH/Cfp6xbeyJsYWJlbCI6ICJoaWRlIiwgImZvcm1BZGRyZXNzIjogInZpc2liaWxpdHlfb2ZmIiwgIm9uQ2xpY2siOiAiQCBkZXN0cm95KGxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QpOyIsICJhYkVudmlyb25tZW50TWVudVNvcnRPcmRlciI6IDB9LAp7ImxhYmVsIjogIm9wdGltaXplIG1vZGUiLCAib25DcmVhdGUiOiAiQCBjb25maWdCb3QudGFncy5hYk9wdGltaXplZCA/IHRhZ3MuZm9ybUFkZHJlc3MgPSAnY2hlY2tfYm94JyA6IHRhZ3MuZm9ybUFkZHJlc3MgPSAnY2hlY2tfYm94X291dGxpbmVfYmxhbmsnOyIsICJvbkNsaWNrIjogIkAgY29uZmlnQm90LnRhZ3MuYWJPcHRpbWl6ZWQgPyBjb25maWdCb3QudGFncy5hYk9wdGltaXplZCA9IGZhbHNlIDogY29uZmlnQm90LnRhZ3MuYWJPcHRpbWl6ZWQgPSB0cnVlOyB0aGlzQm90Lm9uQ3JlYXRlKCk7IiwgImFiRW52aXJvbm1lbnRNZW51U29ydE9yZGVyIjogMX0sCnsibGFiZWwiOiAiY29sb3IiLCAiZm9ybUFkZHJlc3MiOiAicGFsZXR0ZSIsICJvbkNsaWNrIjogIkAgY29uc3QgY29sb3IgPSBhd2FpdCBvcy5zaG93SW5wdXQobGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VTdHJva2VDb2xvciwge3R5cGU6ICdjb2xvcicsdGl0bGU6ICdwaWNrIGEgY29sb3InfSk7IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3IgPSBjb2xvcjsgaWYgKGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlQ29sb3IgIT0gJ2NsZWFyJyl7bGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VDb2xvciA9IGNvbG9yfTsgZGVzdHJveShsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90KTsiLCAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiAyfSwKeyJsYWJlbCI6ICJzbGVlcCIsICJmb3JtQWRkcmVzcyI6ICJuaWdodHNfc3RheSIsICJvbkNsaWNrIjogIkBkZXN0cm95KGxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QpOyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQXdha2VTdGF0ZSA9IGZhbHNlOyIsICJhYkVudmlyb25tZW50TWVudVNvcnRPcmRlciI6IDN9LAp7ImxhYmVsIjogImNoYXQiLCAiZm9ybUFkZHJlc3MiOiAiY2hhdCIsICJvbkNsaWNrIjogIkAgb3Muc2hvd0NoYXQoKTsiLCAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiA0fSwKeyJsYWJlbCI6ICJudWdnZXRzIiwgIm9uQ3JlYXRlIjogIkAgdGFncy5udWdNYW5hZ2VyID0gZ2V0TGluayhnZXRCb3QoJ3N5c3RlbScsICdhYi5pbnRlcmZhY2UubnVnZ2V0JykpOyBpZiAobGlua3MubnVnTWFuYWdlci50YWdzLmxpc3RlbmluZyl7dGFncy5vbkNsaWNrID0gYEAgc2hvdXQoJ2FiTWVudVJlZnJlc2gnKTsgbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7IHNldFRhZ01hc2sobGlua3MubnVnTWFuYWdlciwgJ2xpc3RlbmluZycsIG51bGwpO2A7dGFncy5mb3JtQWRkcmVzcyA9IGBjaGVja19ib3hgO31lbHNleyAgICB0YWdzLm9uQ2xpY2sgPSBgQCBzaG91dCgnYWJNZW51UmVmcmVzaCcpOyBsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soKTsgc2V0VGFnTWFzayhsaW5rcy5udWdNYW5hZ2VyLCAnbGlzdGVuaW5nJywgdHJ1ZSwgJ2xvY2FsJyk7YDsgICAgdGFncy5mb3JtQWRkcmVzcyA9IGBjaGVja19ib3hfb3V0bGluZV9ibGFua2A7fSIsICJhYkVudmlyb25tZW50TWVudVNvcnRPcmRlciI6IDV9LAp7ImFiRW52aXJvbm1lbnRHYXRlIjogImdwdCIsICJvbkNyZWF0ZSI6ICJAICBpZiAoIWF1dGhCb3Qpe2Rlc3Ryb3kodGhpc0JvdCk7fWVsc2UgaWYgKGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICdGcmVlUGxheScgfHwgYXV0aEJvdC50YWdzLnN1YnNjcmlwdGlvblRpZXIgPT0gdW5kZWZpbmVkKXtkZXN0cm95KHRoaXNCb3QpO307IHRhZ3MubGFiZWwgPSAnZWRpdCAnICsgbGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICcgcHJvbXB0JzsgdGFncy5ncHRCb3QgPSBnZXRMaW5rKGdldEJvdCgnc3lzdGVtJywgJ2FiLmFjdGlvbi5hc2snKSk7IiwgImZvcm1BZGRyZXNzIjogImVkaXRfbm90ZSIsICJvbkNsaWNrIjogIkAgbGlua3MuZ3B0Qm90LmVkaXRQcm9tcHQoKTsiLCAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiA3fSwKeyJsYWJlbCI6ICJncmlkIHNuYXAiLCAib25DcmVhdGUiOiAiQCB0YWdzLmZvcm1BZGRyZXNzID0gbGlua3MucmVtZW1iZXIudGFncy5hYkdyaWRTbmFwU3RhdGUgPyAnY2hlY2tfYm94JyA6ICdjaGVja19ib3hfb3V0bGluZV9ibGFuayciLCAib25DbGljayI6ICJAIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkU25hcFN0YXRlID0gIWxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkU25hcFN0YXRlO3RhZ3MuZm9ybUFkZHJlc3MgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiR3JpZFNuYXBTdGF0ZSA/ICdjaGVja19ib3gnIDogJ2NoZWNrX2JveF9vdXRsaW5lX2JsYW5rJzsiLCAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiA4fSwKeyJsYWJlbCI6ICJib3Qgc25hcCIsICJvbkNyZWF0ZSI6ICJAIHRhZ3MuZm9ybUFkZHJlc3MgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQm90U25hcFN0YXRlID8gJ2NoZWNrX2JveCcgOiAnY2hlY2tfYm94X291dGxpbmVfYmxhbmsnOyIsICJvbkNsaWNrIjogIkAgbGlua3MucmVtZW1iZXIudGFncy5hYkJvdFNuYXBTdGF0ZSA9ICFsaW5rcy5yZW1lbWJlci50YWdzLmFiQm90U25hcFN0YXRlOyB0YWdzLmZvcm1BZGRyZXNzID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJvdFNuYXBTdGF0ZSA/ICdjaGVja19ib3gnIDogJ2NoZWNrX2JveF9vdXRsaW5lX2JsYW5rJzsiLCAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiA5fSwKeyJsYWJlbCI6ICJhY2NvdW50IiwgImZvcm1BZGRyZXNzIjogImJhZGdlIiwgIm9uQ2xpY2siOiAiQCBvcy5zaG93QWNjb3VudEluZm8oKTsiLCAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiAxMH0sCnsiYWJFbnZpcm9ubWVudEdhdGUiOiAidGVzdHMiLCAibGFiZWwiOiAicmVjb3JkIHRlc3QiLCAiZm9ybUFkZHJlc3MiOiAic2NpZW5jZSIsICJvbktleURvd24iOiAiQCAiLCAib25LZXlVcCI6ICJAICIsICJvbkNsaWNrIjogIkAgbGV0IHNoaWZ0Q2hlY2sgPSBvcy5nZXRJbnB1dFN0YXRlKCdrZXlib2FyZCcsICdTaGlmdCcpO2xldCBjdXJyZW50SW5zdCA9IG9zLmdldEN1cnJlbnRJbnN0KCk7c2hvdXQoJ2FiUmVjb3JkVGVzdCcpO3Nob3V0KCdhYk1lbnVSZWZyZXNoJyk7IiwgImFiRW52aXJvbm1lbnRNZW51U29ydE9yZGVyIjogMTF9LAp7ImFiRW52aXJvbm1lbnRHYXRlIjogInRlc3RzIiwgImxhYmVsIjogInJlY29yZCB0cmFjZSIsICJmb3JtQWRkcmVzcyI6ICJ0aW1lbGluZSIsICJvbktleURvd24iOiAiQCAiLCAib25LZXlVcCI6ICJAICIsICJvbkNsaWNrIjogIkAgbGV0IHNoaWZ0Q2hlY2sgPSBvcy5nZXRJbnB1dFN0YXRlKCdrZXlib2FyZCcsICdTaGlmdCcpO2xldCBjdXJyZW50SW5zdCA9IG9zLmdldEN1cnJlbnRJbnN0KCk7c2hvdXQoJ2FiUmVjb3JkVHJhY2UnKTtzaG91dCgnYWJNZW51UmVmcmVzaCcpOyIsICJhYkVudmlyb25tZW50TWVudVNvcnRPcmRlciI6IDEyfSwKeyJvbkNyZWF0ZSI6ICJAIHRhZ3MubGFiZWwgPSAncGVybWFuZW50bHkgZGVsZXRlICcgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgJyB2JyArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJWZXJzaW9uOyB0YWdzLmNvbG9yID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VDb250cmFzdENvbG9yID8/ICcjRDkzMDMwJzsiLCAiZm9ybUFkZHJlc3MiOiAiZGVsZXRlX2ZvcmV2ZXIiLCAib25DbGljayI6ICJAIGxldCBhbGxCb3RzID0gZ2V0Qm90cygnc3BhY2UnLCAnc2hhcmVkJyk7ZGVzdHJveShsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90KTtmb3IgKGxldCBpID0gMDsgaSA8IGFsbEJvdHMubGVuZ3RoOyBpKyspe2lmIChhbGxCb3RzW2ldLnRhZ3Muc3lzdGVtKSB7aWYgKGFsbEJvdHNbaV0udGFncy5zeXN0ZW0uaW5jbHVkZXMoJ2FiJykpe2Rlc3Ryb3koYWxsQm90c1tpXSk7fX19IiwgImFiRW52aXJvbm1lbnRNZW51U29ydE9yZGVyIjogMTAwfQpdJwD599WmC7VoCWFiVmVyc2lvbgIEAPn31aYLo6IBFDkuNjUuMS4xNzMwMzE1MTY3NDIyJwEEYm90cyRkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQBJwD599WmC7iiAQZzeXN0ZW0CBAD599WmC7miARphYi5pbnRlcmZhY2UubWFuaWZlc3RhdGlvbicA+ffVpgu4ogEEZm9ybQIEAPn31aYL1KIBB25vdGhpbmcoAPn31aYLuKIBC2FiSW50ZXJmYWNlAXgnAPn31aYLuKIBC2Rlc2NyaXB0aW9uAgQA+ffVpgvdogE4VGhpcyBza2lsbCBjb250cm9scyB0aGUgYWN0dWFsIGJvdCBmb3IgdGhlIGFiIGludGVyZmFjZS4nAPn31aYLuKIBBWxlYXJuAgQA+ffVpguWowEo8J+UlzY2NTdiODY1LWU5ODMtNDQwMS05ZmM5LWY1NDE4ZDE4YTdmNycA+ffVpgu4ogEPb25Qb3J0YWxDaGFuZ2VkAgQA+ffVpgu9owG8DUBpZiAoY29uZmlnQm90LnRhZ3Muc2hlZXRQb3J0YWwgIT0gbnVsbCB8fCBjb25maWdCb3QudGFncy5zeXN0ZW1Qb3J0YWwgIT0gbnVsbCkKewogICAgaWYgKHRhZ3MuYWJCb3QpCiAgICB7CiAgICAgICAgZGVzdHJveShsaW5rcy5hYkJvdCk7CiAgICB9CgogICAgcmV0dXJuOwp9CgppZiAoIWxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJBd2FrZVN0YXRlIHx8IHRoYXQucG9ydGFsID09ICJ0YWdQb3J0YWwiIHx8IHRoYXQucG9ydGFsID09ICJtZW51UG9ydGFsIiB8fCAodGhhdC5wb3J0YWwgPT0gImdyaWRQb3J0YWwiICYmIGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCkpCnsKICAgIHJldHVybjsKfQoKaWYgKHRhZ3MuYWJCb3QpCnsKICAgIGRlc3Ryb3kobGlua3MuYWJCb3QpOwp9Cgpjb25zdCBwb3J0YWxBcnJheSA9IFsibWluaUdyaWRQb3J0YWwiLCAiZ3JpZFBvcnRhbCIsICJtYXBQb3J0YWwiLCAibWluaU1hcFBvcnRhbCIsICJsZWZ0V3Jpc3RQb3J0YWwiLCAicmlnaHRXcmlzdFBvcnRhbCJdOwoKbGV0IG1hcFBvcnRhbENoZWNrID0gZmFsc2U7CmxldCBuZXdBQiA9IGZhbHNlOwoKaWYgKHBvcnRhbEFycmF5LmluZGV4T2YodGhhdC5wb3J0YWwpICE9IC0xICYmIHRoYXQuZGltZW5zaW9uICYmICFjb25maWdCb3QudGFncy5zaGVldFBvcnRhbCkKewogICAgaWYgKHRoYXQucG9ydGFsID09ICJtYXBQb3J0YWwiKQogICAgewogICAgICAgIG5ld0FCID0gYXdhaXQgdGhpc0JvdC5hYk1hbmlmZXN0Qm90KHsgZGltZW5zaW9uOiB0aGF0LmRpbWVuc2lvbiwgcG9zaXRpb246IHt4OiAtODUuNjc2MTg5NDgyMjQzNCwgeTogNDIuOTY1Njc1Njc1Njc1Nn19KTsKCiAgICAgICAgbWFwUG9ydGFsQ2hlY2sgPSB0cnVlOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIG5ld0FCID0gYXdhaXQgdGhpc0JvdC5hYk1hbmlmZXN0Qm90KHtkaW1lbnNpb246IHRoYXQuZGltZW5zaW9uLCBwb3NpdGlvbjp7eDowLHk6MH19KTsKICAgIH0KfQplbHNlIGlmIChwb3J0YWxBcnJheS5pbmRleE9mKHRoYXQucG9ydGFsKSA9PSAtMSAmJiAhdGhhdC5kaW1lbnNpb24pCnsKICAgIGNvbnN0IHN1bW1vbkRpbWVuc2lvbiA9IGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA/IGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA6IGNvbmZpZ0JvdC50YWdzLmdyaWRQb3J0YWw7CiAgICAKICAgIG1hcFBvcnRhbENoZWNrID0gY29uZmlnQm90LnRhZ3MubWFwUG9ydGFsID8gdHJ1ZSA6IGZhbHNlOwoKICAgIGlmIChtYXBQb3J0YWxDaGVjaykKICAgIHsKICAgICAgICBuZXdBQiA9IGF3YWl0IHRoaXNCb3QuYWJNYW5pZmVzdEJvdCh7IGRpbWVuc2lvbjogc3VtbW9uRGltZW5zaW9uLCBwb3NpdGlvbjoge3g6IC04NS42NzYxODk0ODIyNDM0LCB5OiA0Mi45NjU2NzU2NzU2NzU2fX0pOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIG5ld0FCID0gYXdhaXQgdGhpc0JvdC5hYk1hbmlmZXN0Qm90KHtkaW1lbnNpb246IHN1bW1vbkRpbWVuc2lvbiwgcG9zaXRpb246e3g6MCx5OjB9fSk7CiAgICB9Cn0KZWxzZQp7CiAgICByZXR1cm47Cn0KCmlmIChuZXdBQikKewogICAgYXdhaXQgb3Muc2xlZXAoNTAwKQoKICAgIGNvbnN0IHpvb21WYXJpYW5jZSA9IG1hcFBvcnRhbENoZWNrID8gMjAwMCA6IDEwOwoKICAgIGF3YWl0IG9zLmZvY3VzT24obGlua3MuYWJCb3QsIHt6b29tOiB6b29tVmFyaWFuY2UsIHJvdGF0aW9uOiB7eDogNDUsIHk6IDQ1fX0pLmNhdGNoKGUgPT4ge30pOwp9JwD599WmC7iiAQhyZW1lbWJlcgIEAPn31aYL+rABKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAPn31aYLuKIBDWFiTWFuaWZlc3RCb3QCBAD599WmC6GxAcUQQGlmICh0YWdzLmFiQm90KQp7CiAgICBhd2FpdCBkZXN0cm95KGxpbmtzLmFiQm90KTsKfQoKbGV0IGFiID0ge307CgphYi5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwphYi5jb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlQ29sb3I7CmFiLmZvcm1PcGFjaXR5ID0gIjAuMzMiOwphYi5sYWJlbCA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlTGFiZWw7CmFiLmxhYmVsUG9zaXRpb24gPSAiZnJvbnQiOwphYi5sYWJlbENvbG9yID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKYWIubGFiZWxTaXplID0gMC42MTsKYWIub25DbGljayA9ICJAIGxpbmtzLm1hbmFnZXIuYWJDbGljaygpOyI7CmFiLmRpbWVuc2lvbiA9IHRoYXQuZGltZW5zaW9uOwphYlt0aGF0LmRpbWVuc2lvbl0gPSB0cnVlOwphYlt0aGF0LmRpbWVuc2lvbiArICJYIl0gPSB0aGF0LnBvc2l0aW9uLng7CmFiW3RoYXQuZGltZW5zaW9uICsgIlkiXSA9IHRoYXQucG9zaXRpb24ueTsKYWIuc3Ryb2tlQ29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZVN0cm9rZUNvbG9yOwovL2FiLmxpbmVDb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3I7CmFiLm1hbmFnZXIgPSAi8J+UlyIgKyB0aGlzQm90LmlkOwphYi5hbmltYXRlQm90ID0gYEAgaWYgKGNvbmZpZ0JvdC50YWdzLmFiT3B0aW1pemVkKQp7CiAgICByZXR1cm47Cn0KCmNvbnN0IHJvdFogPSB0YWdzLmRpbWVuc2lvbiArICJSb3RhdGlvbloiOwpsZXQgdGFyZ2V0U2NhbGUgPSAwLjY1OwoKLy8gaWYgKHRhZ3Muc2NhbGUgPD0gMC42NTEpCi8vIHsKLy8gICAgIHRhcmdldFNjYWxlID0gMC45NTsKLy8gfQoKYXdhaXQgYW5pbWF0ZVRhZyh0aGlzQm90LAp7CiAgICBmcm9tVmFsdWU6IHsKICAgICAgICBbcm90Wl06IDAsCiAgICAgICAgLy9zY2FsZTogdGFncy5zY2FsZQogICAgfSwKICAgIHRvVmFsdWU6IHsKICAgICAgICBbcm90Wl06IDYuMywKICAgICAgICAvL3NjYWxlOiB0YXJnZXRTY2FsZQogICAgfSwKICAgIGVhc2luZzogewogICAgICAgIHR5cGU6ICJzaW51c29pZGFsIiwKICAgICAgICBtb2RlOiAiaW5vdXQiCiAgICB9LAogICAgZHVyYXRpb246IDIKfSkuY2F0Y2goZSA9PiB7fSk7CmA7CmFiLm9uQ3JlYXRlID0gYEAKCnRoaXNCb3QuYW5pbWF0ZUJvdCgpOwoKbWFza3MuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB0aGlzQm90LmFuaW1hdGVCb3QoKSwgMjAwMCk7CmA7CmFiLm9uRGVzdHJveSA9IGBACmNsZWFySW50ZXJ2YWwodGFncy5pbnRlcnZhbCk7CgpzaG91dCgiYWJNZW51UmVmcmVzaCIpOwpgOwphYi5kcmFnZ2FibGUgPSBmYWxzZTsKYWIuc2NhbGUgPSAwLjk7CgpsZXQgYWJNYW5pZmVzdGVkID0gYXdhaXQgY3JlYXRlKGFiKTsKCmlmIChsaW5rcy5yZW1lbWJlci50YWdzLmFiU2Vjb25kYXJ5TGFiZWwpCnsKICAgIGxldCBhYkxhYmVsQm90ID0ge307CgogICAgYWJMYWJlbEJvdC5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwogICAgYWJMYWJlbEJvdFt0aGF0LmRpbWVuc2lvbl0gPSB0cnVlOwogICAgYWJMYWJlbEJvdFt0aGF0LmRpbWVuc2lvbiArICJaIl0gPSAtMTsKICAgIGFiTGFiZWxCb3QuY3JlYXRvciA9IGFiTWFuaWZlc3RlZC5pZDsKICAgIGFiTGFiZWxCb3QudHJhbnNmb3JtZXIgPSBhYk1hbmlmZXN0ZWQuaWQ7CiAgICBhYkxhYmVsQm90LnBvaW50YWJsZSA9IGZhbHNlOwogICAgYWJMYWJlbEJvdC5jb2xvciA9ICJjbGVhciI7CiAgICBhYkxhYmVsQm90LmxhYmVsID0gbGlua3MucmVtZW1iZXIudGFncy5hYlNlY29uZGFyeUxhYmVsOwogICAgYWJMYWJlbEJvdC5sYWJlbFBvc2l0aW9uID0gImxlZnQiOwogICAgYWJMYWJlbEJvdC5sYWJlbFNpemUgPSAwLjc7CiAgICBhYkxhYmVsQm90LmxhYmVsQ29sb3IgPSBhYk1hbmlmZXN0ZWQudGFncy5sYWJlbENvbG9yOwoKICAgIGNyZWF0ZShhYkxhYmVsQm90KTsKfQoKbWFza3MuYWJCb3QgPSAi8J+UlyIgKyBhYk1hbmlmZXN0ZWQuaWQ7CgpsaW5rcy5yZW1lbWJlci5tYXNrcy5hYkFjdGl2ZURpbWVuc2lvbiA9IHRoYXQuZGltZW5zaW9uOwoKcmV0dXJuIGFiTWFuaWZlc3RlZDsKCgoKaWYgKGNvbmZpZ0JvdC50YWdzLmFiT3B0aW1pemVkKQp7CiAgICByZXR1cm47Cn0nAPn31aYLuKIBHGFiTWFuaWZlc3RTdGF0ZUFzbGVlcE9uRW50ZXICBAD599WmC+PBAVpAZGVzdHJveShsaW5rcy5hYkJvdCk7CgpzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKbGlua3MucmVtZW1iZXIudGFncy5hYkF3YWtlU3RhdGUgPSBmYWxzZTsnAPn31aYLuKIBC29uR3JpZENsaWNrAgQA+ffVpgu+wgH2EEBpZiAoIWxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJBd2FrZVN0YXRlKQp7CiAgICByZXR1cm47Cn0KCnNob3V0KCJhYk1lbnVSZWZyZXNoIik7Cgpjb25zdCBzaGlmdENoZWNrID0gb3MuZ2V0SW5wdXRTdGF0ZSgia2V5Ym9hcmQiLCAiU2hpZnQiKTsKCmlmIChzaGlmdENoZWNrICYmIHRhZ3MuYWJCb3QpCnsKICAgIGlmIChsaW5rcy5hYkJvdC50YWdzLmFybSkKICAgIHsKICAgICAgICBkZXN0cm95KGxpbmtzLmFiQm90LmxpbmtzLmFybSk7CgogICAgICAgIGxpbmtzLmFiQm90Lm1hc2tzLmxpbmVUbyA9IG51bGw7CiAgICB9CiAgICAKICAgIGxldCBhcm0gPSB7fTsKCiAgICBhcm0uc3BhY2UgPSAidGVtcExvY2FsIjsKICAgIGFybVt0aGF0LmRpbWVuc2lvbl0gPSB0cnVlOwogICAgYXJtW3RoYXQuZGltZW5zaW9uICsgIlgiXSA9IHRoYXQucG9zaXRpb24ueDsKICAgIGFybVt0aGF0LmRpbWVuc2lvbiArICJZIl0gPSB0aGF0LnBvc2l0aW9uLnk7CiAgICBhcm0uZGltZW5zaW9uID0gdGhhdC5kaW1lbnNpb247CiAgICBhcm0uc2NhbGUgPSAwLjk7CiAgICBhcm0uc2NhbGVaID0gMC4wMTsKICAgIGFybS5jb2xvciA9ICJjbGVhciI7CiAgICBhcm0uc3Ryb2tlQ29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZVN0cm9rZUNvbG9yOwogICAgYXJtLmxpbmVDb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3I7CiAgICBhcm0ubGluZVRvID0gbGlua3MuYWJCb3QuaWQ7CiAgICBhcm0ubWFuYWdlciA9ICLwn5SXIiArIHRoaXNCb3QuaWQ7CiAgICBhcm0ub25DbGljayA9IGBAIGRlc3Ryb3kodGhpc0JvdCk7CgogICAgbGlua3MubWFuYWdlci5hYk1hbmlmZXN0Qm90KHtkaW1lbnNpb246IHRhZ3MuZGltZW5zaW9uLCBwb3NpdGlvbjp7eDp0YWdzW3RhZ3MuZGltZW5zaW9uICsgIlgiXSx5OnRhZ3NbdGFncy5kaW1lbnNpb24gKyAiWSJdfX0pO2A7CgogICAgbGV0IG5ld0FybSA9IGF3YWl0IGNyZWF0ZShhcm0pOwoKICAgIGxpbmtzLmFiQm90Lm1hc2tzLmFybSA9ICLwn5SXIiArIG5ld0FybS5pZDsKCiAgICBsaW5rcy5yZW1lbWJlci5tYXNrcy5hYkdyaWRGb2N1cyA9IHtkaW1lbnNpb246IHRoYXQuZGltZW5zaW9uLCBwb3NpdGlvbjoge3g6IHRoYXQucG9zaXRpb24ueCwgeTogdGhhdC5wb3NpdGlvbi55fX07CgogICAgdGhpc0JvdC5hYkNsaWNrKHttZW51OiAiZ3JpZCJ9KTsKCiAgICByZXR1cm47Cn0KCmxldCBmb290cHJpbnQgPSB7fTsKCmZvb3RwcmludC5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwpmb290cHJpbnRbdGhhdC5kaW1lbnNpb25dID0gdHJ1ZTsKZm9vdHByaW50LmRpbWVuc2lvbiA9IHRoYXQuZGltZW5zaW9uOwpmb290cHJpbnRbdGhhdC5kaW1lbnNpb24gKyAiWCJdID0gdGhhdC5wb3NpdGlvbi54Owpmb290cHJpbnRbdGhhdC5kaW1lbnNpb24gKyAiWSJdID0gdGhhdC5wb3NpdGlvbi55Owpmb290cHJpbnQuc2NhbGVaID0gMC4wMTsKZm9vdHByaW50Lm9uQ2xpY2sgPSBgQCB0YWdzW3RhZ3MuZGltZW5zaW9uXSA9IGZhbHNlOwoKbGlua3MubWFuYWdlci5hYk1hbmlmZXN0Qm90KHRhZ3MucG9zaXRpb25JbmZvKTsKYDsKZm9vdHByaW50LnBvc2l0aW9uSW5mbyA9IHRoYXQ7CmZvb3RwcmludC5jb2xvciA9ICJjbGVhciI7CmZvb3RwcmludC5zdHJva2VDb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3I7CmZvb3RwcmludC5kcmFnZ2FibGUgPSBmYWxzZTsKZm9vdHByaW50Lm1hbmFnZXIgPSAi8J+UlyIgKyB0aGlzQm90LmlkOwpmb290cHJpbnQub25DcmVhdGUgPSBgQCBzZXRUaW1lb3V0KCgpID0+IGRlc3Ryb3kodGhpc0JvdCksIDgwMCk7CgogICAgYXdhaXQgYW5pbWF0ZVRhZyh0aGlzQm90LCB7CiAgICAgICAgZnJvbVZhbHVlOiB7CiAgICAgICAgICAgIHNjYWxlWDogMC4xLAogICAgICAgICAgICBzY2FsZVk6IDAuMQogICAgICAgIH0sCiAgICAgICAgdG9WYWx1ZTogewogICAgICAgICAgICBzY2FsZVg6IDEuMSwKICAgICAgICAgICAgc2NhbGVZOiAxLjEKICAgICAgICB9LAogICAgICAgIGR1cmF0aW9uOiAwLjUsCiAgICAgICAgZWFzaW5nOiB7CiAgICAgICAgICAgIHR5cGU6ICJlbGFzdGljIiwKICAgICAgICAgICAgbW9kZTogIm91dCIKICAgICAgICB9CiAgICB9KS5jYXRjaChlID0+IHt9KTsKYDsKCmNyZWF0ZShmb290cHJpbnQpOycA+ffVpgu4ogEEbWVudQIEAPn31aYLr9MBKPCflJdiMzBjNmM1ZC1hNGY3LTQyNjYtYmEzOC0zOTNkYzk1ZTFlY2InAPn31aYLuKIBB2FiQ2xpY2sCBAD599WmC9bTAe8JQGlmICghbGlua3MuYWJCb3QpCnsKICAgIHJldHVybjsKfQoKb3MuaGlkZUNoYXQoKTsKCmNvbnN0IG1lbnVUeXBlID0gdGhhdCA/IHRoYXQubWVudSA6ICJjb3JlIjsKY29uc3Qgc3RhdGUgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJTaGlmdCIpOwoKaWYgKGxpbmtzLmFiQm90LnRhZ3MuaW50ZXJ2YWwgfHwgc3RhdGUpCnsKICAgIGNvbnN0IGFiTWVudUJvdHMgPSBnZXRCb3RzKCJhYk1lbnUiLCB0cnVlKTsKCiAgICB3aGlzcGVyKGFiTWVudUJvdHMsICJhYk1lbnVSZWZyZXNoIik7CiAgICAKICAgIGNsZWFySW50ZXJ2YWwobGlua3MuYWJCb3QudGFncy5pbnRlcnZhbCk7CgogICAgbGlua3MuYWJCb3QubWFza3MuaW50ZXJ2YWwgPSBudWxsOwoKICAgIGNsZWFyQW5pbWF0aW9ucyhsaW5rcy5hYkJvdCk7CgogICAgY29uc3Qgcm90WiA9IGxpbmtzLmFiQm90LnRhZ3MuZGltZW5zaW9uICsgIlJvdGF0aW9uWiI7CgogICAgaWYgKHN0YXRlICYmIG1lbnVUeXBlID09ICJjb3JlIikKICAgIHsKICAgICAgICBsaW5rcy5tZW51LmFiRW52aXJvbm1lbnRNZW51KCk7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbGlua3MubWVudS5hYk9wZW5NZW51KG1lbnVUeXBlKTsKICAgIH0KCiAgICBhd2FpdCBhbmltYXRlVGFnKGxpbmtzLmFiQm90LAogICAgewogICAgICAgIGZyb21WYWx1ZTogewogICAgICAgICAgICBbcm90Wl06IGxpbmtzLmFiQm90LnRhZ3Nbcm90Wl0sCiAgICAgICAgICAgIHNjYWxlOiBsaW5rcy5hYkJvdC50YWdzLnNjYWxlCiAgICAgICAgfSwKICAgICAgICB0b1ZhbHVlOiB7CiAgICAgICAgICAgIFtyb3RaXTogMCwKICAgICAgICAgICAgc2NhbGU6IDAuOQogICAgICAgIH0sCiAgICAgICAgZWFzaW5nOiB7CiAgICAgICAgICAgIHR5cGU6ICJzaW51c29pZGFsIiwKICAgICAgICAgICAgbW9kZTogImlub3V0IgogICAgICAgIH0sCiAgICAgICAgZHVyYXRpb246IDAuNQogICAgfSkuY2F0Y2goZSA9PiB7fSk7Cn0KZWxzZQp7CiAgICBsaW5rcy5hYkJvdC5hbmltYXRlQm90KCk7CgogICAgbGlua3MuYWJCb3QubWFza3MubGluZVRvID0gbnVsbDsKCiAgICBpZiAobGlua3MuYWJCb3QudGFncy5hcm0pCiAgICB7CiAgICAgICAgZGVzdHJveShsaW5rcy5hYkJvdC5saW5rcy5hcm0pOwogICAgfQoKICAgIHNob3V0KCJhYk1lbnVSZWZyZXNoIik7CgogICAgbGlua3MuYWJCb3QubWFza3MuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiBsaW5rcy5hYkJvdC5hbmltYXRlQm90KCksIDIwMDApOwp9JwD599WmC7iiARthYk1hbmlmZXN0U3RhdGVBd2FrZU9uRW50ZXICBAD599WmC8bdAfQBQGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJBd2FrZVN0YXRlID0gdHJ1ZTsKCmxldCBkaW1lbnNpb24gPSBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgPyBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgOiBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsOwoKaWYgKCFkaW1lbnNpb24pCnsKICAgIHJldHVybjsKfQoKdGhpc0JvdC5hYk1hbmlmZXN0Qm90KHtkaW1lbnNpb246IGRpbWVuc2lvbiwgcG9zaXRpb246IHt4OiAwLCB5OiAwfX0pOycA+ffVpgu4ogEMb25BbnlCb3REcmFnAgQA+ffVpgu73wHICkBpZiAodGhhdC5ib3QgIT0gbGlua3MuYWJCb3QpIHJldHVybjsKCm9zLmhpZGVDaGF0KCk7CgppZiAobGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzICYmIHRoYXQuYm90LmlkID09IGxpbmtzLmFiQm90LmlkKQp7CiAgICBvcy5lbmFibGVDdXN0b21EcmFnZ2luZygpOwoKICAgIHJldHVybjsKfQoKaWYgKGxpbmtzLmFiQm90LnRhZ3MuYXJtKQp7CiAgICBkZXN0cm95KGxpbmtzLmFiQm90LmxpbmtzLmFybSk7Cn0KCmlmICghdGhhdC5ib3QudGFncy5pbnRlcnZhbCkKewogICAgdGhpc0JvdC5hYkNsaWNrKCk7Cn0KCmxldCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7CmxldCBhcm0gPSB7fTsKCmFybS5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwphcm1bbGlua3MuYWJCb3QudGFncy5kaW1lbnNpb25dID0gdHJ1ZTsKYXJtW2xpbmtzLmFiQm90LnRhZ3MuZGltZW5zaW9uICsgIlgiXSA9IGxpbmtzLmFiQm90LnRhZ3NbbGlua3MuYWJCb3QudGFncy5kaW1lbnNpb24gKyAiWCJdOwphcm1bbGlua3MuYWJCb3QudGFncy5kaW1lbnNpb24gKyAiWSJdID0gbGlua3MuYWJCb3QudGFnc1tsaW5rcy5hYkJvdC50YWdzLmRpbWVuc2lvbiArICJZIl07CmFybS5jcmVhdG9yID0gbGlua3MuYWJCb3QuaWQ7CmFybS5kaW1lbnNpb24gPSBsaW5rcy5hYkJvdC50YWdzLmRpbWVuc2lvbjsKYXJtLnNjYWxlID0gMC45Owphcm0uc2NhbGVaID0gMC4wMTsKYXJtLmNvbG9yID0gImNsZWFyIjsKYXJtLnN0cm9rZUNvbG9yID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKYXJtLmxpbmVDb2xvciA9IGxpbmtzLmFiQm90LnRhZ3Muc3Ryb2tlQ29sb3I7CmFybS5saW5lVG8gPSB0aGF0LmJvdC5pZDsKYXJtLm1hbmFnZXIgPSAi8J+UlyIgKyB0aGlzQm90LmlkOwphcm0ub25DbGljayA9IGBAIGRlc3Ryb3kodGhpc0JvdCk7CgpsaW5rcy5tYW5hZ2VyLmFiTWFuaWZlc3RCb3Qoe2RpbWVuc2lvbjogdGFncy5kaW1lbnNpb24sIHBvc2l0aW9uOnt4OnRhZ3NbdGFncy5kaW1lbnNpb24gKyAiWCJdLHk6dGFnc1t0YWdzLmRpbWVuc2lvbiArICJZIl19fSk7YDsKCmlmIChzdGF0ZSkKewogICAgYXJtLm11bHRpU2VsZWN0ID0gdHJ1ZTsKICAgIGFybS5mb3JtID0gInNwaGVyZSI7CiAgICBhcm0uY29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZVN0cm9rZUNvbG9yOwoKICAgIGxpbmtzLmFiQm90Lm1hc2tzLmRyYWdnYWJsZSA9IHRydWU7Cn0KCmxldCBuZXdBcm0gPSBhd2FpdCBjcmVhdGUoYXJtKTsKCmxpbmtzLmFiQm90Lm1hc2tzLmFybSA9ICLwn5SXIiArIG5ld0FybS5pZDsKCm9zLnJlcGxhY2VEcmFnQm90KG5ld0FybSk7JwD599WmC7iiARFvbkFueUJvdERyb3BFbnRlcgIEAPn31aYLgOoBzQhAaWYgKCF0YWdzLmFiQm90KSByZXR1cm47CmlmIChsaW5rcy5hYkJvdD8ubGlua3MuYXJtICE9IHRoYXQuZHJhZ0JvdCkgcmV0dXJuOwoKaWYgKGxpbmtzLmFiQm90LmxpbmtzLmFybS50YWdzLm11bHRpU2VsZWN0KQp7CiAgICBsaW5rcy5hYkJvdC5tYXNrcy5saW5lQ29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZVN0cm9rZUNvbG9yOwoKICAgIGlmIChBcnJheS5pc0FycmF5KGxpbmtzLmFiQm90LnRhZ3MubGluZVRvKSkKICAgIHsKICAgICAgICBsaW5rcy5hYkJvdC5tYXNrcy5saW5lVG8ucHVzaCh0aGF0LnRvLmJvdC5pZCk7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbGlua3MuYWJCb3QubWFza3MubGluZVRvID0gW3RoYXQudG8uYm90LmlkXTsKICAgIH0KCiAgICBsZXQgbmV3TGluazsKCiAgICBpZiAoIWxpbmtzLmFiQm90LmxpbmtzLmFybS50YWdzLnNlbGVjdGVkQm90cykKICAgIHsKICAgICAgICBuZXdMaW5rID0gZ2V0TGluayh0aGF0LnRvLmJvdCk7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbGV0IHByZXZpb3VzTGlua0JvdHMgPSBsaW5rcy5hYkJvdC5saW5rcy5hcm0ubGlua3Muc2VsZWN0ZWRCb3RzOwoKICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkocHJldmlvdXNMaW5rQm90cykpCiAgICAgICAgewogICAgICAgICAgICBwcmV2aW91c0xpbmtCb3RzID0gW3ByZXZpb3VzTGlua0JvdHNdCiAgICAgICAgfQoKICAgICAgICBwcmV2aW91c0xpbmtCb3RzLnB1c2godGhhdC50by5ib3QpOwoKICAgICAgICBuZXdMaW5rID0gZ2V0TGluayhwcmV2aW91c0xpbmtCb3RzKTsKICAgIH0KCiAgICBsaW5rcy5hYkJvdC5saW5rcy5hcm0udGFncy5zZWxlY3RlZEJvdHMgPSBuZXdMaW5rOwp9CmVsc2UKewogICAgbGlua3MuYWJCb3QubGlua3MuYXJtLm1hc2tzLnN0cm9rZUNvbG9yID0gImNsZWFyIjsKICAgIGxpbmtzLmFiQm90LmxpbmtzLmFybS5tYXNrcy5saW5lVG8gPSBmYWxzZTsKCiAgICBsaW5rcy5hYkJvdC5tYXNrcy5saW5lQ29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZVN0cm9rZUNvbG9yOwogICAgbGlua3MuYWJCb3QubWFza3MubGluZVRvID0gdGhhdC50by5ib3QuaWQ7Cn0nAPn31aYLuKIBEG9uQW55Qm90RHJvcEV4aXQCBAD599WmC87yAZwCQGlmICghbGlua3MuYWJCb3QpIHJldHVybjsKaWYgKGxpbmtzLmFiQm90LmxpbmtzLmFybSAhPSB0aGF0LmRyYWdCb3QpIHJldHVybjsKCmlmICghbGlua3MuYWJCb3QubGlua3MuYXJtLnRhZ3MubXVsdGlTZWxlY3QpCnsKICAgIGxpbmtzLmFiQm90LmxpbmtzLmFybS5tYXNrcy5zdHJva2VDb2xvciA9IG51bGw7CiAgICBsaW5rcy5hYkJvdC5saW5rcy5hcm0ubWFza3MubGluZVRvID0gbnVsbDsKCiAgICBsaW5rcy5hYkJvdC5tYXNrcy5saW5lVG8gPSBsaW5rcy5hYkJvdC5saW5rcy5hcm0uaWQ7Cn0nAPn31aYLuKIBDG9uQW55Qm90RHJvcAIEAPn31aYL6/QBsgZAbWFza3MubXVsdGlEcmFnID0gbnVsbDsKCmlmICghdGFncy5hYkJvdCkgcmV0dXJuOwppZiAoIWxpbmtzLmFiQm90KSByZXR1cm47CmlmICghbGlua3MuYWJCb3QudGFncy5hcm0pIHJldHVybjsKaWYgKGxpbmtzLmFiQm90LmxpbmtzLmFybSAhPSB0aGF0LmRyYWdCb3QpIHJldHVybjsKCmlmIChsaW5rcy5hYkJvdC5saW5rcy5hcm0udGFncy5tdWx0aVNlbGVjdCkKewogICAgbGlua3MucmVtZW1iZXIubWFza3MuYWJNdWx0aXBsZUJvdEZvY3VzID0gbGlua3MuYWJCb3QubGlua3MuYXJtLnRhZ3Muc2VsZWN0ZWRCb3RzOwoKICAgIHRoaXNCb3QuYWJDbGljayh7bWVudTogIm11bHRpcGxlQm90In0pOwoKICAgIGRlc3Ryb3kobGlua3MuYWJCb3QubGlua3MuYXJtKTsKfQplbHNlIGlmICh0aGF0LnRvLmJvdCkKewogICAgaWYgKHRoYXQudG8uYm90ID09IGxpbmtzLmFiQm90KQogICAgewogICAgICAgIGxpbmtzLm1lbnUuYWJFbnZpcm9ubWVudE1lbnUoKTsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBsaW5rcy5yZW1lbWJlci5tYXNrcy5hYkJvdEZvY3VzID0gIvCflJciICsgdGhhdC50by5ib3QuaWQ7CgogICAgICAgIHRoaXNCb3QuYWJDbGljayh7bWVudTogImJvdCJ9KTsKICAgIH0KCiAgICBkZXN0cm95KGxpbmtzLmFiQm90LmxpbmtzLmFybSk7Cn0KZWxzZQp7CiAgICBsaW5rcy5yZW1lbWJlci5tYXNrcy5hYkdyaWRGb2N1cyA9IHtkaW1lbnNpb246IHRoYXQudG8uZGltZW5zaW9uLCBwb3NpdGlvbjoge3g6IHRoYXQudG8ueCwgeTogdGhhdC50by55fX07CgogICAgdGhpc0JvdC5hYkNsaWNrKHttZW51OiAiZ3JpZCJ9KTsKfScA+ffVpgu4ogEIYWJJZ25vcmUCBAD599WmC5z7AQR0cnVlJwD599WmC7iiAQNhc2sCBAD599WmC6H7ASjwn5SXZWM4NWMxZDYtOWYxYS00MGQ0LTgyZTEtNWJkNjgwMzQ5YzI3JwD599WmC7iiAQlhc2tCdXR0b24CBAD599WmC8j7AdkFQGlmICghbGlua3MucmVtZW1iZXIudGFncy5hYkF3YWtlU3RhdGUpCnsKICAgIHJldHVybjsKfQoKbGV0IGFiTWVudUJ1dHRvbiA9IHt9OwoKYWJNZW51QnV0dG9uLmFiTWVudSA9IHRydWU7CmFiTWVudUJ1dHRvbi5yZW1lbWJlciA9IGxpbmtzLm1lbnUudGFncy5yZW1lbWJlcjsKYWJNZW51QnV0dG9uLm1hbmlmZXN0YXRpb24gPSBsaW5rcy5tZW51LnRhZ3MubWFuaWZlc3RhdGlvbjsKYWJNZW51QnV0dG9uLmFiTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CmFiTWVudUJ1dHRvbi5iYXNlU2tpbGwgPSAi8J+UlyIgKyBsaW5rcy5hc2suaWQ7CmFiTWVudUJ1dHRvbi5sYWJlbCA9IGxpbmtzLmFzay50YWdzLmFiQ29yZU1lbnVMYWJlbDsKYWJNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gbGlua3MuYXNrLnRhZ3MuYWJDb3JlTWVudUljb247CmFiTWVudUJ1dHRvbi5vbkNyZWF0ZSA9IGxpbmtzLmFzay50YWdzLmFiQ29yZU1lbnVPbkdlbmVyYXRlOwphYk1lbnVCdXR0b24uYWJNZW51U29ydE9yZGVyID0gbGlua3MuYXNrLnRhZ3MuYWJDb3JlTWVudVNvcnRPcmRlcjsKYWJNZW51QnV0dG9uLmNvbG9yID0gbGlua3MuYXNrLnRhZ3MuYWJDb3JlTWVudUNvbG9yID8gbGlua3MuYXNrLnRhZ3MuYWJDb3JlTWVudUNvbG9yIDogbGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKCmxpbmtzLm1lbnUuYWJDcmVhdGVNZW51QnV0dG9uKGFiTWVudUJ1dHRvbik7JwD599WmC7iiAQlhYkJvdENoYXQCBAD599WmC6CBAtULQGlmICghbGlua3MuYWJCb3QgJiYgIXRoYXQuYm90KQp7CiAgICByZXR1cm47Cn0KCmNvbnN0IGJvdEJhc2UgPSB0aGF0LmJvdCA/IHRoYXQuYm90OiBsaW5rcy5hYkJvdDsKY29uc3QgZGltZW5zaW9uID0gIXRoYXQuYm90ID8gYm90QmFzZS50YWdzLmRpbWVuc2lvbiA6IHRoYXQuZGltZW5zaW9uID8gdGhhdC5kaW1lbnNpb24gOiBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsOwpjb25zdCBtZXNzYWdlID0gdGhhdC5tZXNzYWdlOwpjb25zdCBtZXNzYWdlVGltZSA9IHRoYXQudGltZSA/IHRoYXQudGltZSAqIDEwMDAgOiAxNjAwOyAKY29uc3QgbWVzc2FnZUJvdCA9IHt9OwoKbWVzc2FnZUJvdC5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwptZXNzYWdlQm90LnRyYW5zZm9ybWVyID0gYm90QmFzZS5pZDsKbWVzc2FnZUJvdC5mb3JtID0gInNwcml0ZSI7Cm1lc3NhZ2VCb3QuY29sb3IgPSAiIzAwMDAwMCI7Cm1lc3NhZ2VCb3QubGFiZWwgPSBtZXNzYWdlOwptZXNzYWdlQm90LmxhYmVsQ29sb3IgPSAiI2ZmZmZmZiI7Cm1lc3NhZ2VCb3QubGFiZWxTaXplID0gMTsKbWVzc2FnZUJvdC5zY2FsZVggPSBtZXNzYWdlLmxlbmd0aCAvIDUgPiAxMCA/IDEwIDogbWVzc2FnZS5sZW5ndGggPCAxMCA/IDIgOiBtZXNzYWdlLmxlbmd0aCAvIDU7Cm1lc3NhZ2VCb3Quc2NhbGVZID0gKG1lc3NhZ2UubGVuZ3RoIC8gNTApID4gMSA/IE1hdGgucm91bmQobWVzc2FnZS5sZW5ndGggLyA1MCkgOiAxLjMzOwptZXNzYWdlQm90LnNjYWxlWiA9IDAuMTsKbWVzc2FnZUJvdC5vcmllbnRhdGlvbk1vZGUgPSAiYmlsbGJvYXJkIjsKbWVzc2FnZUJvdFtkaW1lbnNpb25dID0gdHJ1ZTsKbWVzc2FnZUJvdC5kaW1lbnNpb24gPSBkaW1lbnNpb247Cm1lc3NhZ2VCb3RbZGltZW5zaW9uICsgIlgiXSA9IDA7Cm1lc3NhZ2VCb3RbZGltZW5zaW9uICsgIlkiXSA9IDA7Cm1lc3NhZ2VCb3RbZGltZW5zaW9uICsgIloiXSA9IGJvdEJhc2UudGFncy5zY2FsZSA/IGJvdEJhc2UudGFncy5zY2FsZSAvIDIgKyAyIDogMjsKbWVzc2FnZUJvdC5vbkZhZGUgPSBgQCBhd2FpdCBhbmltYXRlVGFnKHRoaXNCb3QsIHsKICAgIGZyb21WYWx1ZTogewogICAgICAgIGZvcm1PcGFjaXR5OiAxLAogICAgICAgIGxhYmVsT3BhY2l0eTogMSwKICAgICAgICBbdGFncy5kaW1lbnNpb24gKyAiWiJdOiB0YWdzW3RhZ3MuZGltZW5zaW9uICsgIloiXQogICAgfSwKICAgIHRvVmFsdWU6IHsKICAgICAgICBmb3JtT3BhY2l0eTogMCwKICAgICAgICBsYWJlbE9wYWNpdHk6IDAsCiAgICAgICAgW3RhZ3MuZGltZW5zaW9uICsgIloiXTogdGFnc1t0YWdzLmRpbWVuc2lvbiArICJaIl0gKyA1CiAgICB9LAogICAgZHVyYXRpb246ICR7dGhhdC5kdXJhdGlvbiA/PyAzfQp9KS5jYXRjaCh7fSk7CgpkZXN0cm95KHRoaXNCb3QpO2A7Cgpjb25zdCBhY3RpdmVNZXNzYWdlID0gY3JlYXRlKG1lc3NhZ2VCb3QpOwoKc2V0VGltZW91dCgoKT0+IGFjdGl2ZU1lc3NhZ2Uub25GYWRlKCksIG1lc3NhZ2VUaW1lKTsnAPn31aYLuKIBEG9uQW55Qm90RHJhZ2dpbmcCBAD599WmC/aMAokQQGlmIChsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXMgJiYgdGhhdC5ib3QuaWQgPT0gbGlua3MuYWJCb3QuaWQpCnsKICAgIGNvbnN0IGFjdGl2ZURpbWVuc2lvbiA9IGxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiQWN0aXZlRGltZW5zaW9uID8/IGNvbmZpZ0JvdC50YWdzLmdyaWRQb3J0YWw7CiAgICBsZXQgZHJhZ0Nvb3JkaW5hdG9yQm90ID0gbGlua3MuZHJhZ0Nvb3JkOwogICAgCiAgICBpZiAoIWRyYWdDb29yZGluYXRvckJvdCkKICAgIHsKICAgICAgICBjb25zdCBkcmFnQ29vcmRpbmF0b3JCb3RNb2QgPSB7fTsKCiAgICAgICAgZHJhZ0Nvb3JkaW5hdG9yQm90TW9kLnNwYWNlID0gInRlbXBMb2NhbCI7CiAgICAgICAgZHJhZ0Nvb3JkaW5hdG9yQm90TW9kLm1hbmFnZXIgPSBnZXRMaW5rKHRoaXNCb3QpOwogICAgICAgIGRyYWdDb29yZGluYXRvckJvdE1vZC5kaW1lbnNpb24gPSBhY3RpdmVEaW1lbnNpb247CiAgICAgICAgZHJhZ0Nvb3JkaW5hdG9yQm90TW9kW2FjdGl2ZURpbWVuc2lvbl0gPSB0cnVlOwogICAgICAgIGRyYWdDb29yZGluYXRvckJvdE1vZFthY3RpdmVEaW1lbnNpb24gKyAiWCJdID0gMDsKICAgICAgICBkcmFnQ29vcmRpbmF0b3JCb3RNb2RbYWN0aXZlRGltZW5zaW9uICsgIlkiXSA9IDA7CiAgICAgICAgZHJhZ0Nvb3JkaW5hdG9yQm90TW9kW2FjdGl2ZURpbWVuc2lvbiArICJaIl0gPSAtMTsKICAgICAgICBkcmFnQ29vcmRpbmF0b3JCb3RNb2QucG9pbnRhYmxlID0gZmFsc2U7CiAgICAgICAgZHJhZ0Nvb3JkaW5hdG9yQm90TW9kLmNvbG9yID0gImNsZWFyIjsKICAgICAgICBkcmFnQ29vcmRpbmF0b3JCb3RNb2Qub25BbnlCb3RQb2ludGVyVXAgPSBgQCBsaW5rcy5tYW5hZ2VyLm1hc2tzLmRyYWdDb29yZCA9IG51bGw7IHNob3V0KCdhYlN0b3BEcmFnJywge3g6IHRhZ3MuJHthY3RpdmVEaW1lbnNpb259WCwgeTogdGFncy4ke2FjdGl2ZURpbWVuc2lvbn1ZfSk7IGRlc3Ryb3kodGhpc0JvdCk7YDsKCiAgICAgICAgZHJhZ0Nvb3JkaW5hdG9yQm90ID0gY3JlYXRlKGRyYWdDb29yZGluYXRvckJvdE1vZCk7CgogICAgICAgIG1hc2tzLmRyYWdDb29yZCA9IGdldExpbmsoZHJhZ0Nvb3JkaW5hdG9yQm90KTsKCiAgICAgICAgY29uc3QgZHJhZ0JvdHMgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXM7CgogICAgICAgIGxpbmtzLmFiQm90Lm1hc2tzLnRyYW5zZm9ybWVyID0gZHJhZ0Nvb3JkaW5hdG9yQm90LmlkOwogICAgICAgIGxpbmtzLmFiQm90Lm1hc2tzLmFiU3RvcERyYWcgPSBgQCBtYXNrcy50cmFuc2Zvcm1lciA9IG51bGw7IG1hc2tzLmFiU3RvcERyYWcgPSBudWxsOyB0YWdzLiR7YWN0aXZlRGltZW5zaW9ufVggPSB0YWdzLiR7YWN0aXZlRGltZW5zaW9ufVggKyB0aGF0Lng7IHRhZ3MuJHthY3RpdmVEaW1lbnNpb259WSA9IHRhZ3MuJHthY3RpdmVEaW1lbnNpb259WSArIHRoYXQueWA7CgogICAgICAgIHNldFRhZ01hc2soZHJhZ0JvdHMsICJ0cmFuc2Zvcm1lciIsIGRyYWdDb29yZGluYXRvckJvdC5pZCwgInRlbXBMb2NhbCIpOwogICAgICAgIHNldFRhZ01hc2soZHJhZ0JvdHMsICJhYlN0b3BEcmFnIiwgYEAgbWFza3MudHJhbnNmb3JtZXIgPSBudWxsOyBtYXNrcy5hYlN0b3BEcmFnID0gbnVsbDsgdGFncy4ke2FjdGl2ZURpbWVuc2lvbn1YID0gdGFncy4ke2FjdGl2ZURpbWVuc2lvbn1YICsgdGhhdC54OyB0YWdzLiR7YWN0aXZlRGltZW5zaW9ufVkgPSB0YWdzLiR7YWN0aXZlRGltZW5zaW9ufVkgKyB0aGF0LnlgLCAidGVtcExvY2FsIik7CiAgICB9CgogICAgY29uc3QgeENoYW5nZSA9IHRoYXQudG8ueCAtIHRoYXQuZnJvbS54OwogICAgY29uc3QgeUNoYW5nZSA9IHRoYXQudG8ueSAtIHRoYXQuZnJvbS55OwoKICAgIGRyYWdDb29yZGluYXRvckJvdC50YWdzW2FjdGl2ZURpbWVuc2lvbiArICJYIl0gPSB4Q2hhbmdlOwogICAgZHJhZ0Nvb3JkaW5hdG9yQm90LnRhZ3NbYWN0aXZlRGltZW5zaW9uICsgIlkiXSA9IHlDaGFuZ2U7CiAgICBkcmFnQ29vcmRpbmF0b3JCb3QudGFnc1thY3RpdmVEaW1lbnNpb24gKyAiWiJdID0gLTE7Cn0nAPn31aYLuKIBCWFiVmVyc2lvbgIEAPn31aYLgJ0CFDkuNjUuMS4xNzMwMzE1MTY3NDIyJwD599WmC7iiARFhYkluaXRpYWxNYW5pZmVzdAIEAPn31aYLlZ0ClQlAbGV0IHNraWxsQXJyYXkgPSBbImFiSW50ZXJmYWNlIiwgImFiQWN0aW9uIiwgImFiVGVzdHMiXTsKCmZvciAobGV0IGkgPSAwOyBpIDwgc2tpbGxBcnJheS5sZW5ndGg7IGkrKykgCnsKICAgIGF3YWl0IGxpbmtzLmxlYXJuLmFiQWRhcHQoc2tpbGxBcnJheVtpXSk7Cn0KCmF3YWl0IG9zLnNsZWVwKDMwMCk7CgovL2FuaW1hdGlvbiBpZiBhcHBsaWNhYmxlCmlmIChsaW5rcy5yZW1lbWJlci50YWdzLmFiSW5pdGlhbEFuaW1hdGlvbikKewogICAgYXdhaXQgbGlua3MuYW5pbWF0aW9uW2xpbmtzLnJlbWVtYmVyLnRhZ3MuYWJJbml0aWFsQW5pbWF0aW9uXSgpOwp9CgovL2tlZXAgYWIgYXdha2UKbGlua3MucmVtZW1iZXIudGFncy5hYkF3YWtlU3RhdGUgPSB0cnVlOwoKaWYgKGNvbmZpZ0JvdC50YWdzLnBhdHRlcm4pIAp7CiAgICBsaW5rcy5yZW1lbWJlci50YWdzLmJhc2VBQiA9IGNvbmZpZ0JvdC50YWdzLnBhdHRlcm47Cn0KZWxzZSAKewogICAgbGlua3MucmVtZW1iZXIudGFncy5iYXNlQUIgPSB1dWlkKCk7Cn0KCmNoYW5nZVN0YXRlKGxpbmtzLm1hbmlmZXN0YXRpb24sICJBd2FrZSIsICJhYk1hbmlmZXN0U3RhdGUiKTsKCnRoaXNCb3QuYWJNYW5pZmVzdEJvdCh7ZGltZW5zaW9uOiAiaG9tZSIsIHBvc2l0aW9uOnt4OjAseTowfX0pOwoKLy9tZXNzYWdlIGlmIGFwcGxpY2FibGUKaWYgKGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJJbml0aWFsTWVzc2FnZSkKewogICAgc2hvdXQoInNob3dDb25zb2xlIik7CgogICAgaWYgKEFycmF5LmlzQXJyYXkobGlua3MucmVtZW1iZXIudGFncy5hYkluaXRpYWxNZXNzYWdlKSkKICAgIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJJbml0aWFsTWVzc2FnZS5sZW5ndGg7IGkrKykKICAgICAgICB7CiAgICAgICAgICAgIGFiLmxvZyhhYlJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiAiICsgbGlua3MucmVtZW1iZXIudGFncy5hYkluaXRpYWxNZXNzYWdlW2ldKTsKCiAgICAgICAgICAgIGF3YWl0IG9zLnNsZWVwKDIwMDApOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBhYi5sb2coYWJSZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogIiArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJJbml0aWFsTWVzc2FnZSk7CiAgICB9Cn0nAPn31aYLuKIBCWFuaW1hdGlvbgIEAPn31aYLq6YCKPCflJdiMjZlMTA4OS0xNzJkLTQ1YTktOGQyMi0wNWMzZjU4YzJiZjcnAPn31aYLuKIBD2FiTWFuaWZlc3RTdGF0ZQIEAPn31aYL0qYCBkFzbGVlcAA="}]}