{"version":2,"updates":[{"id":0,"timestamp":1716486539391,"update":"AZQB/ciohg4AJwEEYm90cyQxNzQxMGQ4My03ZWVlLTRhMWUtYjYzOC02NTQ2Mzc0ZDE3YzMBJwD9yKiGDgAGc3lzdGVtAgQA/ciohg4BEWFiLmludGVyZmFjZS5zY2FuJwD9yKiGDgAEZm9ybQIEAP3IqIYOEwdub3RoaW5nJwD9yKiGDgALYWJJbnRlcmZhY2UCBAD9yKiGDhsEdHJ1ZScA/ciohg4ACGFiSWdub3JlAgQA/ciohg4gBHRydWUoAP3IqIYOAAxhYkJvdFZlcnNpb24BfT8nAP3IqIYOAA9vblFSQ29kZVNjYW5uZWQCBAD9yKiGDiaNDUBpZiAoIWJ1aWxkZXJWZXJzaW9uKQp7CiAgICByZXR1cm47Cn0KCmFiLmxvZygiYWI6IHNjYW5uZWQgIiArIHRoYXQpOwoKaWYgKGNvbmZpZ0JvdC50YWdzLnV1YWJTY2FuKQp7CiAgICBvcy5jbG9zZVFSQ29kZVNjYW5uZXIoKTsKCiAgICBsaW5rcy5zdG9yZS5hYlB1Ymxpc2hVVUFCKHRoYXQpOwp9CmVsc2UgaWYgKGNvbmZpZ0JvdC50YWdzLnB1Ymxpc2hTY2FuKQp7CiAgICBvcy5jbG9zZVFSQ29kZVNjYW5uZXIoKTsKCiAgICBsaW5rcy5zdG9yZS5hYlFSUHVibGlzaCh0aGF0KTsKfQplbHNlIGlmIChjb25maWdCb3QudGFncy5wcmFjdGljZVBlcm1pdFNjYW4pCnsKICAgIGxldCBzY2FubmVkVVJMOwoKICAgIGNvbmZpZ0JvdC50YWdzLnByYWN0aWNlUGVybWl0U2NhbiA9IG51bGw7CgogICAgb3MuY2xvc2VRUkNvZGVTY2FubmVyKCk7CgogICAgdHJ5CiAgICB7CiAgICAgICAgc2Nhbm5lZFVSTCA9IG5ldyBVUkwodGhhdCk7CiAgICB9CiAgICBjYXRjaCAoZSkKICAgIHsKICAgICAgICBvcy50b2FzdCgibm90IGEgcmVjb2duaXplZCBwcmFjdGljZSBwZXJtaXQiKTsKCiAgICAgICAgY29uc29sZS5sb2coZSk7CgogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBsZXQgcGhDaGVjayA9IHNjYW5uZWRVUkwuc2VhcmNoUGFyYW1zLmhhcygicGgiKTsKICAgIGxldCBpbnN0Q2hlY2sgPSBzY2FubmVkVVJMLnNlYXJjaFBhcmFtcy5oYXMoImluc3QiKTsKICAgIGxldCBhYkNoZWNrID0gc2Nhbm5lZFVSTC5zZWFyY2hQYXJhbXMuaGFzKCJhYiIpOwogICAgbGV0IGN3Q2hlY2sgPSBzY2FubmVkVVJMLnNlYXJjaFBhcmFtcy5oYXMoImN3Iik7CgogICAgaWYgKHBoQ2hlY2sgJiYgaW5zdENoZWNrICYmIGFiQ2hlY2sgJiYgY3dDaGVjaykKICAgIHsKICAgICAgICBvcy5nb1RvVVJMKHRoYXQpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIG9zLnRvYXN0KCJub3QgYSByZWNvZ25pemVkIHByYWN0aWNlIHBlcm1pdCIpOwogICAgfQoKICAgIHNob3V0KCJhYk1lbnVSZWZyZXNoIik7Cn0KZWxzZSBpZiAoY29uZmlnQm90LnRhZ3MuYWJTY2FuKQp7CiAgICBzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKICAgIGNvbmZpZ0JvdC50YWdzLmFiU2NhbiA9IG51bGw7CiAgICAKICAgIG9zLmNsb3NlUVJDb2RlU2Nhbm5lcigpOwoKICAgIGxldCBzY2FubmVkVVJMOwoKICAgIHRyeSAKICAgIHsKICAgICAgICBzY2FubmVkVVJMID0gbmV3IFVSTCh0aGF0KTsKICAgIH0KICAgIGNhdGNoIChlKSAKICAgIHsKICAgICAgICBsaW5rcy5zZWFyY2guYWJMVE1TZWFyY2goe2FiSUQ6IHRoYXR9KTsKCiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmKHNjYW5uZWRVUkwuc2VhcmNoUGFyYW1zLmdldCgiYWIiKSA9PSAiZWdnQ2FydG9uIikKICAgIHsKICAgICAgICBvcy5nb1RvVVJMKHRoYXQpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIHNjYW5uZWRVUkwuc2VhcmNoUGFyYW1zLmZvckVhY2goKHZhbHVlLCBrZXkpID0+IHsKICAgICAgICAgICAgbGV0IG5ld1RhZyA9IGtleTsKICAgICAgICAgICAgbGV0IG5ld1ZhbHVlID0gdmFsdWU7CgogICAgICAgICAgICBjb25maWdCb3QudGFnc1tuZXdUYWddID0gbmV3VmFsdWU7CiAgICAgICAgfSk7CgogICAgICAgIGxpbmtzLnNlYXJjaC5hYkxUTVNlYXJjaCh7YWJJRDogY29uZmlnQm90LnRhZ3MuYWJ9KTsKICAgIH0KfScA/ciohg4ABXN0b3JlAgQA/ciohg60DSjwn5SXNzZhZjA0OTEtMzkxOS00OTg0LWFhODItMjJjNzQyZjQyNjNmJwD9yKiGDgAGc2VhcmNoAgQA/ciohg7bDSjwn5SXZDgzNzE0NDQtOTE1OC00NDM2LThmYzctODRjYzkxYjdmNTI1JwD9yKiGDgAQYWJDb3JlTWVudUFjdGlvbgIEAP3IqIYOgg43QG9zLm9wZW5RUkNvZGVTY2FubmVyKCk7Cgpjb25maWdCb3QudGFncy5hYlNjYW4gPSB0cnVlOycA/ciohg4AD2FiQ29yZU1lbnVMYWJlbAIEAP3IqIYOug4Ec2NhbicA/ciohg4ADmFiQ29yZU1lbnVJY29uAgQA/ciohg6/Dg9xcl9jb2RlX3NjYW5uZXInAP3IqIYOABNhYkNvcmVNZW51U29ydE9yZGVyAgQA/ciohg7PDgEzJwEEYm90cyQ0YWFmNjk5ZS1hYmJmLTQ0YTgtODVlMS02OGNiYjVkZjBlMWYBJwD9yKiGDtEOBnN5c3RlbQIEAP3IqIYO0g4TYWIuaW50ZXJmYWNlLm51Z2dldCcA/ciohg7RDgRmb3JtAgQA/ciohg7mDgdub3RoaW5nJwD9yKiGDtEOC2FiSW50ZXJmYWNlAgQA/ciohg7uDgR0cnVlJwD9yKiGDtEOCGFiSWdub3JlAgQA/ciohg7zDgR0cnVlKAD9yKiGDtEODGFiQm90VmVyc2lvbgF9gAEnAP3IqIYO0Q4MYWJMb2FkTnVnZ2V0AgQA/ciohg75DpgCQGxldCBudWdnZXROYW1lID0gdGhhdC5udWdnZXROYW1lOwpsZXQgZm9ybWF0dGVkTnVnZ2V0QUIgPSAibnVnXyIrbnVnZ2V0TmFtZTsKbGV0IGxvYWRlZE51Z2dldCA9IGF3YWl0IGxpbmtzLnNlYXJjaC5vbkxvb2t1cEFCRWdncyh7YWJJRDogZm9ybWF0dGVkTnVnZ2V0QUIsIGFiVmVyc2lvbjogdGhhdC52ZXJzaW9uLCByZXR1cm5UeXBlOiAiZGF0YSJ9KTsKCmxvYWRlZE51Z2dldCA9IGxvYWRlZE51Z2dldC5zdGF0ZVtudWdnZXROYW1lXS5udWdnZXQ7CgpyZXR1cm4gbG9hZGVkTnVnZ2V0OycA/ciohg7RDg9hYlB1Ymxpc2hOdWdnZXQCBAD9yKiGDpIR7QJALy9zaG91dCgiYWJQdWJsaXNoTnVnZ2V0Iiwge251ZzogIm51Z05hbWUiLCBkYXRhOiBkYXRhfSk7ICBBREQgRUdHIElEIEVWRU5UVUFMTFkKbGV0IHRlc3ROdWdnZXQgPSB0aGF0LmRhdGE7CmxldCBmb3JtYXR0ZWROdWdnZXQgPSB7aWQ6IHRoYXQubnVnLCBudWdnZXQ6IHRlc3ROdWdnZXR9OwpsZXQgdGVzdE51Z2dldE5hbWUgPSB0aGF0Lm51ZzsKbGV0IGZvcm1hdHRlZE51Z2dldEFCID0gIm51Z18iK3Rlc3ROdWdnZXROYW1lOwoKbWFza3MubnVnZ2V0VG9QdWJsaXNoID0gZm9ybWF0dGVkTnVnZ2V0QUI7CgpsaW5rcy5zdG9yZS5hYlB1Ymxpc2hBQih7YWI6IGZvcm1hdHRlZE51Z2dldEFCLCB0YXJnZXQ6IGZvcm1hdHRlZE51Z2dldH0pOycA/ciohg7RDg9pbXBsZW1lbnROdWdnZXQCBAD9yKiGDoAUsQdAbGV0IG51Z2dldE5hbWUgPSB0aGF0Lm51Z2dldDsKbGV0IG51Z2dldFZlcnNpb25DaGVjayA9IG51Z2dldE5hbWUuaW5kZXhPZigiLnYiKTsKbGV0IHZlcnNpb247CgppZiAobnVnZ2V0VmVyc2lvbkNoZWNrICE9IC0xKQp7CiAgICBudWdnZXROYW1lID0gbnVnZ2V0TmFtZS5zdWJzdHJpbmcoMCwgbnVnZ2V0VmVyc2lvbkNoZWNrKTsKCiAgICBsZXQgdmVyc2lvbkNoZWNrID0gdGhhdC5udWdnZXQuc3Vic3RyaW5nKG51Z2dldFZlcnNpb25DaGVjayArIDIpOwoKICAgIGlmIChpc05hTih2ZXJzaW9uQ2hlY2spKQogICAgewogICAgICAgIGNvbnNvbGUubG9nKHZlcnNpb25DaGVjaywgInZlcnNpb24gaXMgbm90IGEgbnVtYmVyIik7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgdmVyc2lvbiA9IE51bWJlcih2ZXJzaW9uQ2hlY2spOwogICAgfQp9CmNvbnNvbGUubG9nKG51Z2dldE5hbWUsIHZlcnNpb24pOwpsZXQgbnVnRGF0YSA9IGF3YWl0IHRoaXNCb3QuYWJMb2FkTnVnZ2V0KHtudWdnZXROYW1lOiBudWdnZXROYW1lLCB2ZXJzaW9uOiB2ZXJzaW9ufSk7CgppZiAobnVnRGF0YSA9PSAiYWJJRCBub3QgZm91bmQiKQp7CiAgICBvcy50b2FzdCgibnVnZ2V0IG5vdCBmb3VuZCIpOwp9CmVsc2UKewogICAgbGV0IHRhcmdldEJvdCA9IGdldEJvdCgiaWQiLCB0aGF0LmJvdCk7CiAgICBsZXQgdGFyZ2V0VGFnID0gdGFyZ2V0Qm90LnJhd1t0aGF0LnRhZ10udG9TdHJpbmcoKTsKICAgIGxldCB0YXJnZXROdWcgPSAieyIgKyB0aGF0Lm51Z2dldCArICJ9IjsgCiAgICBsZXQgbnVnUG9zID0gdGFyZ2V0VGFnLmluZGV4T2YodGFyZ2V0TnVnKTsKCiAgICBkZWxldGVUYWdUZXh0KHRhcmdldEJvdCwgdGhhdC50YWcsIG51Z1BvcywgdGFyZ2V0TnVnLmxlbmd0aCk7CiAgICBpbnNlcnRUYWdUZXh0KHRhcmdldEJvdCwgdGhhdC50YWcsIG51Z1BvcywgbnVnRGF0YSk7Cn0nAP3IqIYO0Q4MbnVnZ2V0QnV0dG9uAgQA/ciohg6yG/UMQGxldCB0YWdWYWx1ZSA9IHRoYXQudGFnVmFsdWU7CmxldCByZWdleCA9IC9cbi9naTsKbGV0IGJyZWFrQ2hlY2s7CmxldCBicmVha0FycmF5ID0gWzBdOwovL2xldCBjcmVhdGVkQnV0dG9ucyA9IFtdOwoKd2hpbGUgKGJyZWFrQ2hlY2sgPSByZWdleC5leGVjKHRhZ1ZhbHVlKSkKewogICAgYnJlYWtBcnJheS5wdXNoKGJyZWFrQ2hlY2suaW5kZXgpOwp9CgpsZXQgbmV3TnVnZ2V0QnV0dG9uID0ge307CgpuZXdOdWdnZXRCdXR0b24uc3BhY2UgPSAidGVtcExvY2FsIjsKbmV3TnVnZ2V0QnV0dG9uLmZvcm0gPSAiY29kZUJ1dHRvbiI7Cm5ld051Z2dldEJ1dHRvbi50YXJnZXRCb3QgPSB0aGF0LmJvdC5pZDsKbmV3TnVnZ2V0QnV0dG9uLnRhcmdldFRhZyA9IHRoYXQudGFnOwpuZXdOdWdnZXRCdXR0b24ubGFiZWwgPSAibG9hZCBudWdnZXQiOwpuZXdOdWdnZXRCdXR0b24ubnVnZ2V0UmVzZXQgPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7Cm5ld051Z2dldEJ1dHRvblt0aGF0LmJvdC5pZCArICIuIiArIHRoYXQudGFnXSA9IHRydWU7Cm5ld051Z2dldEJ1dHRvbi5udWdnZXRNYW5hZ2VyID0gIvCflJciICsgdGhpc0JvdC5pZDsKbmV3TnVnZ2V0QnV0dG9uLm9uQ2xpY2sgPSBgQCBsaW5rcy5udWdnZXRNYW5hZ2VyLmltcGxlbWVudE51Z2dldCh7Ym90OiB0YWdzLnRhcmdldEJvdCwgbnVnZ2V0OiB0YWdzLnRhcmdldE51Z2dldCwgdGFnOiB0YWdzLnRhcmdldFRhZ30pOwoKZGVzdHJveSh0aGlzQm90KTtgOwoKZm9yIChsZXQgbnVncyA9IDA7IG51Z3MgPCB0aGF0Lm51Z2dldC5sZW5ndGg7IG51Z3MrKykKewogICAgbGV0IGN1cnJlbnROdWdnZXQgPSB0aGF0Lm51Z2dldFtudWdzXTsKICAgIC8vbGV0IGJ1dHRvbkNoZWNrID0gY3JlYXRlZEJ1dHRvbnMuaW5kZXhPZihjdXJyZW50TnVnZ2V0Lm51Z05hbWUpOwoKICAgIGlmICghY3VycmVudE51Z2dldCB8fCBjdXJyZW50TnVnZ2V0ID09IHVuZGVmaW5lZCkgLy98fCBidXR0b25DaGVjayAhPSAtMQogICAgewogICAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIGlmIChjdXJyZW50TnVnZ2V0Lm51Z1B1Ymxpc2gpCiAgICB7CiAgICAgICAgbmV3TnVnZ2V0QnV0dG9uLm9uQ2xpY2sgPSBgQCBsaW5rcy5udWdnZXRNYW5hZ2VyLnBhY2thZ2VOdWdnZXQoe2JvdDogdGFncy50YXJnZXRCb3QsIG51Z2dldDogdGFncy50YXJnZXROdWdnZXQsIHRhZzogdGFncy50YXJnZXRUYWd9KTsKCiAgICAgICAgZGVzdHJveSh0aGlzQm90KTtgOwoKICAgICAgICBuZXdOdWdnZXRCdXR0b24ubGFiZWwgPSAicHVibGlzaCAiICsgY3VycmVudE51Z2dldC5udWdOYW1lICsgIiBudWdnZXQiOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIG5ld051Z2dldEJ1dHRvbi5sYWJlbCA9ICJsb2FkICIgKyBjdXJyZW50TnVnZ2V0Lm51Z05hbWUgKyAiIG51Z2dldCI7CiAgICB9CgogICAgbmV3TnVnZ2V0QnV0dG9uLnRhcmdldE51Z2dldCA9IGN1cnJlbnROdWdnZXQubnVnTmFtZTsKICAgIG5ld051Z2dldEJ1dHRvblt0aGF0LmJvdC5pZCArICIuIiArIHRoYXQudGFnICsgIlN0YXJ0Il0gPSBjdXJyZW50TnVnZ2V0Lm51Z1N0YXJ0OwoKICAgIGNyZWF0ZShuZXdOdWdnZXRCdXR0b24pOwoKICAgIC8vY3JlYXRlZEJ1dHRvbnMucHVzaChjdXJyZW50TnVnZ2V0Lm51Z05hbWUpOwp9CgpyZXR1cm47JwD9yKiGDtEOC251Z2dldFBhcnNlAgQA/ciohg6mKKcPQGNvbnN0IG9yaWdpbmFsVGFnVmFsdWUgPSB0aGF0LmVkaXRlZEJvdC5yYXdbdGhhdC5lZGl0ZWRUYWddOwpsZXQgdGFnVmFsdWUgPSBvcmlnaW5hbFRhZ1ZhbHVlOwoKaWYgKCF0YWdWYWx1ZSkgCnsKICAgIHJldHVybjsKfQplbHNlIGlmICh0eXBlb2YgdGFnVmFsdWUgIT09ICJzdHJpbmciKSAKewogICAgdGFnVmFsdWUgPSB0YWdWYWx1ZS50b1N0cmluZygpOwp9CgpsZXQgaW5pdGlhbFBvc3NpYmxlTnVnUG9zID0gMDsKCmlmIChpbml0aWFsUG9zc2libGVOdWdQb3MgPT0gLTEpIAp7CiAgICByZXR1cm47Cn0KZWxzZQp7CiAgICB0YWdWYWx1ZSA9IHRhZ1ZhbHVlLnN1YnN0cmluZyhpbml0aWFsUG9zc2libGVOdWdQb3MpOwp9CgpsZXQgcG9zc2libGVOdWdzID0gb3JpZ2luYWxUYWdWYWx1ZS5yZXBsYWNlKC9bXntdL2csICIiKS5sZW5ndGg7CmxldCB0b3RhbE51Z0JyZWFrcyA9IG9yaWdpbmFsVGFnVmFsdWUucmVwbGFjZSgvW15cbl0vZywgIiIpLmxlbmd0aDsKbGV0IGJyZWFrTGV2ZWwgPSAwOwpsZXQgbnVnc1RvQ2hlY2sgPSBbXTsKCmZvciAobGV0IGkgPSAwOyBpIDwgcG9zc2libGVOdWdzOyBpKyspCnsKICAgIGxldCBpbml0aWFsTnVnUG9zID0gdGFnVmFsdWUuaW5kZXhPZigieyIpICsgMTsKICAgIGxldCBwb3NzaWJsZU51Z0VuZCA9IHRhZ1ZhbHVlLmluZGV4T2YoIn0iKTsKICAgIGxldCBwb3NzaWJsZU51ZyA9IHRhZ1ZhbHVlLnN1YnN0cmluZyhpbml0aWFsTnVnUG9zLCBwb3NzaWJsZU51Z0VuZCk7CgogICAgaWYgKHBvc3NpYmxlTnVnLmluZGV4T2YoIiAiKSA9PSAtMSAmJiAvXG4vZy50ZXN0KHBvc3NpYmxlTnVnKSAhPSB0cnVlICYmIHBvc3NpYmxlTnVnLmxlbmd0aCA+IDAgJiYgcG9zc2libGVOdWcuaW5kZXhPZigiOiIpID09IC0xKQogICAgewogICAgICAgIGxldCBudWdCcmVha3MgPSB0YWdWYWx1ZS5zdWJzdHJpbmcoMCwgdGFnVmFsdWUuaW5kZXhPZigieyIrcG9zc2libGVOdWcrIn0iKSkucmVwbGFjZSgvW15cbl0vZywgIiIpLmxlbmd0aDsKICAgICAgICBsZXQgcHVibGlzaENoZWNrID0gdGFnVmFsdWUuc3Vic3RyaW5nKGluaXRpYWxOdWdQb3MgLSA2LCBpbml0aWFsTnVnUG9zIC0gMik7CiAgICAgICAgbGV0IG51Z1B1Ymxpc2ggPSBudWxsOwoKICAgICAgICBpZiAocHVibGlzaENoZWNrID09ICIubnVnIikKICAgICAgICB7CiAgICAgICAgICAgIG51Z1B1Ymxpc2ggPSB0cnVlOwogICAgICAgIH0KCiAgICAgICAgYnJlYWtMZXZlbCArPSBudWdCcmVha3M7CgogICAgICAgIG51Z0JyZWFrcyA9IHRvdGFsTnVnQnJlYWtzIC0gKHRvdGFsTnVnQnJlYWtzIC0gYnJlYWtMZXZlbCk7CiAgICAgICAgCiAgICAgICAgLy9DSEVDSyBJRiAkIGJlZm9yZSBudWdnZXQKICAgICAgICBpZiAodGFnVmFsdWUuc3Vic3RyaW5nKGluaXRpYWxOdWdQb3MgLSAyLCBpbml0aWFsTnVnUG9zIC0gMSkgIT0gIiQiKQogICAgICAgIHsKICAgICAgICAgICAgbnVnc1RvQ2hlY2sucHVzaCh7bnVnTmFtZTogcG9zc2libGVOdWcsIG51Z1N0YXJ0OiBudWdCcmVha3MgKyAxLCBudWdQdWJsaXNoOiBudWdQdWJsaXNofSk7CiAgICAgICAgfQogICAgfQogICAgZWxzZQogICAgewogICAgICAgIGxldCBudWdCcmVha3MgPSB0YWdWYWx1ZS5zdWJzdHJpbmcoMCwgdGFnVmFsdWUuaW5kZXhPZigifSIpKS5yZXBsYWNlKC9bXlxuXS9nLCAiIikubGVuZ3RoOwoKICAgICAgICBicmVha0xldmVsICs9IG51Z0JyZWFrczsKCiAgICAgICAgbnVnQnJlYWtzID0gdG90YWxOdWdCcmVha3MgLSAodG90YWxOdWdCcmVha3MgLSBicmVha0xldmVsKTsKICAgIH0KCiAgICB0YWdWYWx1ZSA9IHRhZ1ZhbHVlLnN1YnN0cmluZyhwb3NzaWJsZU51Z0VuZCArIDEpOwp9Cgp0aGlzQm90Lm51Z2dldEJ1dHRvbih7IG51Z2dldDogbnVnc1RvQ2hlY2ssIGJvdDogdGhhdC5lZGl0ZWRCb3QsIHRhZzogdGhhdC5lZGl0ZWRUYWcsIHRhZ1ZhbHVlOiBvcmlnaW5hbFRhZ1ZhbHVlfSk7JwD9yKiGDtEODW9uQUJQdWJsaXNoZWQCBAD9yKiGDs43wQFAY29uc29sZS5sb2codGhhdC5hYiwgdGFncy5udWdnZXRUb1B1Ymxpc2gpCgppZiAodGhhdC5hYiA9PSB0YWdzLm51Z2dldFRvUHVibGlzaCkKewogICAgb3MudG9hc3QoIm51Z2dldCBwdWJsaXNoZWQiKTsKCiAgICBtYXNrcy5udWdnZXRUb1B1Ymxpc2ggPSBudWxsOwoKICAgIGNvbmZpZ0JvdC5tYXNrcy5hYlZlcnNpb24gPSBudWxsOwp9JwD9yKiGDtEOEG9uQW55Qm90c0NoYW5nZWQCBAD9yKiGDpA5twRAaWYgKGNvbmZpZ0JvdCAmJiB0aGF0WzBdLmJvdC5pZCAhPSB0aGlzQm90LmlkKSAKewogICAgaWYgKCFjb25maWdCb3QudGFncy5lZGl0aW5nQm90KSByZXR1cm47IC8vIElnbm9yZSBpZiB0aGUgY29uZmlnQm90IGlzbid0IHJlYWR5IHlldC4KCiAgICBjb25zdCBlZGl0ZWRCb3RJRCA9IGNvbmZpZ0JvdC50YWdzLmVkaXRpbmdCb3QucmVwbGFjZSgi8J+UlyIsICIiKTsKCiAgICBpZiAoIXRoYXQuZmluZCh4ID0+IHguYm90LmlkID09IGVkaXRlZEJvdElEKSkgcmV0dXJuOyAvLyBJZiB0aGUgYm90IGNoYW5nZWQgd2Fzbid0IGJlaW5nIGVkaXRlZCBieSB0aGUgdXNlciBpZ25vcmUgaXQuCgogICAgY29uc3QgZWRpdGVkVGFnID0gY29uZmlnQm90LnRhZ3MuZWRpdGluZ1RhZzsKICAgIGNvbnN0IGVkaXRlZEJvdCA9IGdldEJvdCgiaWQiLCBlZGl0ZWRCb3RJRCk7CgogICAgaWYgKGVkaXRlZEJvdCAmJiBlZGl0ZWRUYWcpIAogICAgewogICAgICAgIHNob3V0KCJudWdnZXRSZXNldCIpOwoKICAgICAgICB0aGlzQm90Lm51Z2dldFBhcnNlKHsgZWRpdGVkQm90LCBlZGl0ZWRUYWcgfSk7CiAgICB9Cn0nAP3IqIYO0Q4Ib25DcmVhdGUCBAD9yKiGDsY9TEB0YWdzLmxpc3RlbmluZyA9IGZhbHNlOwoKLy9zZXRUYWdNYXNrKHRoaXNCb3QsICJsaXN0ZW5pbmciLCB0cnVlLCAibG9jYWwiKTsnAP3IqIYO0Q4NcGFja2FnZU51Z2dldAIEAP3IqIYOkz74BkBjb25zdCB0YXJnZXRCb3QgPSBnZXRCb3QoImlkIiwgdGhhdC5ib3QpOwpjb25zdCB0YWdUZXh0ID0gdGFyZ2V0Qm90LnJhd1t0aGF0LnRhZ107CgppZiAoY29uZmlnQm90LnRhZ3MuY3Vyc29yU3RhcnRJbmRleCB8fCBjb25maWdCb3QudGFncy5jdXJzb3JFbmRJbmRleCkKewogICAgbGV0IHN0YXJ0UG9zID0gY29uZmlnQm90LnRhZ3MuY3Vyc29yU3RhcnRJbmRleDsKICAgIGxldCBlbmRQb3MgPSBjb25maWdCb3QudGFncy5jdXJzb3JFbmRJbmRleDsKCiAgICBpZiAoc3RhcnRQb3MgPT0gZW5kUG9zKQogICAgewogICAgICAgIHJldHVybjsKICAgIH0KICAgIGVsc2UgaWYgKHN0YXJ0UG9zID4gZW5kUG9zKQogICAgewogICAgICAgIGxldCBuZXdTdGFydFBvcyA9IGVuZFBvczsKICAgICAgICBsZXQgbmV3RW5kUG9zID0gc3RhcnRQb3M7CgogICAgICAgIHN0YXJ0UG9zID0gbmV3U3RhcnRQb3M7CiAgICAgICAgZW5kUG9zID0gbmV3RW5kUG9zOwogICAgfQoKICAgIGxldCBkYXRhID0gdGFnVGV4dC5zdWJzdHJpbmcoc3RhcnRQb3MsIGVuZFBvcyArIDEpOwoKICAgIHNob3V0KCJhYlB1Ymxpc2hOdWdnZXQiLCB7bnVnOiB0aGF0Lm51Z2dldCwgZGF0YTogZGF0YX0pOwoKICAgIG9zLnRvYXN0KCJudWcgaXMgcHVibGlzaGluZyIsIDEwKTsKCiAgICBsZXQgdGFyZ2V0TnVnID0gIi5udWcgeyIgKyB0aGF0Lm51Z2dldCArICJ9IjsgCiAgICBsZXQgbnVnUG9zID0gdGFyZ2V0Qm90LnJhd1t0aGF0LnRhZ10uaW5kZXhPZih0YXJnZXROdWcpOwoKICAgIGRlbGV0ZVRhZ1RleHQodGFyZ2V0Qm90LCB0aGF0LnRhZywgbnVnUG9zLCB0YXJnZXROdWcubGVuZ3RoKTsKfQplbHNlCnsKICAgIG9zLnRvYXN0KCJjYW5ub3QgcmVhZCBudWdnZXQgdG8gYmUgcHVibGlzaGVkIikKfScA/ciohg7RDghyZW1lbWJlcgIEAP3IqIYOjEUo8J+Ul2U1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNycA/ciohg7RDgZzZWFyY2gCBAD9yKiGDrNFKPCflJdkODM3MTQ0NC05MTU4LTQ0MzYtOGZjNy04NGNjOTFiN2Y1MjUnAP3IqIYO0Q4Fc3RvcmUCBAD9yKiGDtpFKPCflJc3NmFmMDQ5MS0zOTE5LTQ5ODQtYWE4Mi0yMmM3NDJmNDI2M2YnAP3IqIYO0Q4JbGlzdGVuaW5nAgQA/ciohg6BRgVmYWxzZScBBGJvdHMkYjMwYzZjNWQtYTRmNy00MjY2LWJhMzgtMzkzZGM5NWUxZWNiAScA/ciohg6HRgZzeXN0ZW0CBAD9yKiGDohGEWFiLmludGVyZmFjZS5tZW51JwD9yKiGDodGBGZvcm0CBAD9yKiGDppGB25vdGhpbmcnAP3IqIYOh0YLZGVzY3JpcHRpb24CBAD9yKiGDqJGJlRoaXMgc2tpbGwgaXMgZGVzaWduZWQgZm9yIG1lbnUgc3R1ZmYuKAD9yKiGDodGC2FiSW50ZXJmYWNlAXgnAP3IqIYOh0YKYWJPcGVuTWVudQIEAP3IqIYOykbbCkBhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdEluQmFja2dyb3VuZCgpOwoKY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAiYWJNZW51IjsKCmxldCBtZW51VHlwZSA9IHRoYXQgPyAiYWIiICsgdGhhdC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHRoYXQuc2xpY2UoMSkgKyAiTWVudSI6ICJhYkNvcmVNZW51IjsgLy9zZXQgdXAgYSBjaGVjayB0byBzZWUgd2hhdCB0eXBlIG9mIG1lbnUgc2hvdWxkIGJlIG9jY3VyaW5nIFtjb3JlLCBib3QsIGdyaWQsIGluc3RdCmxldCBtZW51U2tpbGxzID0gZ2V0Qm90cyhtZW51VHlwZSArICJBY3Rpb24iKTsKbGV0IG1heE9wdGlvbnMgPSBtZW51VHlwZSA9PSAiaW5zdCIgPyA3IDogNTsKbGV0IGFiTWVudUJ1dHRvbiA9IHt9OwoKYWJNZW51QnV0dG9uLmFiTWVudSA9IHRydWU7CmFiTWVudUJ1dHRvbi5yZW1lbWJlciA9IHRhZ3MucmVtZW1iZXI7CmFiTWVudUJ1dHRvbi5tYW5pZmVzdGF0aW9uID0gdGFncy5tYW5pZmVzdGF0aW9uOwphYk1lbnVCdXR0b24uYWJNZW51UmVmcmVzaCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKYWJNZW51QnV0dG9uLm9uQ2xpY2sgPSBgQCBsaW5rcy5iYXNlU2tpbGwuJHttZW51VHlwZSArICJBY3Rpb24ifSgpO2A7Cgpmb3IgKGxldCBpID0gMDsgaSA8IG1lbnVTa2lsbHMubGVuZ3RoOyBpKyspLy9BREQgTE9HSUMgRk9SIE1PUkUgT1BUSU9OUyBUSEFOIDUgOiBtYXhPcHRpb25zCnsKICAgIGxldCBjdXJyZW50U2tpbGwgPSBtZW51U2tpbGxzW2ldOwoKICAgIGFiTWVudUJ1dHRvbi5iYXNlU2tpbGwgPSAi8J+UlyIgKyBjdXJyZW50U2tpbGwuaWQ7CiAgICBhYk1lbnVCdXR0b24ubGFiZWwgPSBjdXJyZW50U2tpbGwudGFnc1ttZW51VHlwZSArICJMYWJlbCJdOwogICAgYWJNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gY3VycmVudFNraWxsLnRhZ3NbbWVudVR5cGUgKyAiSWNvbiJdOwogICAgYWJNZW51QnV0dG9uLm9uQ3JlYXRlID0gY3VycmVudFNraWxsLnRhZ3NbbWVudVR5cGUgKyAiT25HZW5lcmF0ZSJdOwogICAgYWJNZW51QnV0dG9uLmFiTWVudVNvcnRPcmRlciA9IGN1cnJlbnRTa2lsbC50YWdzW21lbnVUeXBlICsgIlNvcnRPcmRlciJdOwogICAgYWJNZW51QnV0dG9uLmNvbG9yID0gY3VycmVudFNraWxsLnRhZ3NbbWVudVR5cGUgKyAiQ29sb3IiXSA/IGN1cnJlbnRTa2lsbC50YWdzW21lbnVUeXBlICsgIkNvbG9yIl0gOiBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZVN0cm9rZUNvbG9yOwoKICAgIHRoaXNCb3QuYWJDcmVhdGVNZW51QnV0dG9uKGFiTWVudUJ1dHRvbik7Cn0KCnRoaXNCb3QubWFza3Mub25HcmlkQ2xpY2sgPSAiQCBzaG91dCgnYWJNZW51UmVmcmVzaCcpOyBsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soKTsiOycA/ciohg6HRhJhYkNyZWF0ZU1lbnVCdXR0b24CBAD9yKiGDqRRvwNAbGV0IGFkZGl0aW9uYWxUYWdzID0gdGhhdDsKbGV0IG5ld01lbnVCdXR0b24gPSB7fTsKCm5ld01lbnVCdXR0b24uc3BhY2UgPSAidGVtcExvY2FsIjsKbmV3TWVudUJ1dHRvbi5jb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3I7Cm5ld01lbnVCdXR0b24ubGFiZWxDb2xvciA9ICJibGFjayI7Cm5ld01lbnVCdXR0b24ubGFiZWxBbGlnbm1lbnQgPSAibGVmdCI7Cm5ld01lbnVCdXR0b24ubWVudUl0ZW1TdHlsZSA9IHsgImJvcmRlci1yYWRpdXMiOiI4cHgiLCAibWFyZ2luLXRvcCI6IjNweCJ9OwoKZm9yIChjb25zdCB0YWcgaW4gYWRkaXRpb25hbFRhZ3MpCnsKICAgIG5ld01lbnVCdXR0b25bdGFnXSA9IGFkZGl0aW9uYWxUYWdzW3RhZ107Cn0KCm5ld01lbnVCdXR0b24gPSBjcmVhdGUobmV3TWVudUJ1dHRvbik7CgpyZXR1cm4gbmV3TWVudUJ1dHRvbjsnAP3IqIYOh0YNYWJNZW51UmVmcmVzaAIEAP3IqIYO5FQ+QGNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gbnVsbDsKCm1hc2tzLm9uR3JpZENsaWNrID0gbnVsbDsnAP3IqIYOh0YIcmVtZW1iZXICBAD9yKiGDqNVKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAP3IqIYOh0YNbWFuaWZlc3RhdGlvbgIEAP3IqIYOylUo8J+Ul2RjYTVkOTg3LWM0ZDgtNDZlNC1iNjBjLWRhYTdiMmY0ZGRhZCcA/ciohg6HRhFhYkVudmlyb25tZW50TWVudQIEAP3IqIYO8VXQBkBzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAiYWJNZW51IjsKCmxldCBhYk1lbnVCdXR0b24gPSB7fTsKCmFiTWVudUJ1dHRvbi5hYk1lbnUgPSB0cnVlOwphYk1lbnVCdXR0b24uYWJNZW51UmVmcmVzaCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKYWJNZW51QnV0dG9uLm1hbmlmZXN0YXRpb24gPSB0YWdzLm1hbmlmZXN0YXRpb247CmFiTWVudUJ1dHRvbi5yZW1lbWJlciA9IHRhZ3MucmVtZW1iZXI7CmFiTWVudUJ1dHRvbi5sZWFybiA9IHRhZ3MubGVhcm47CgpidXR0b25Mb29wOgpmb3IgKGxldCBpID0gMDsgaSA8IHRhZ3MuYWJFbnZpcm9ubWVudEFycmF5Lmxlbmd0aDsgaSsrKQp7CiAgICBsZXQgYWN0aXZlQnV0dG9uID0gdGFncy5hYkVudmlyb25tZW50QXJyYXlbaV07CgogICAgYWJNZW51QnV0dG9uLmFiTWVudVNvcnRPcmRlciA9IGFjdGl2ZUJ1dHRvbi5hYkVudmlyb25tZW50TWVudVNvcnRPcmRlcjsKCiAgICBpZiAoYWN0aXZlQnV0dG9uLmFiRW52aXJvbm1lbnRHYXRlKQogICAgewogICAgICAgIGlmICghbGlua3NbYWN0aXZlQnV0dG9uLmFiRW52aXJvbm1lbnRHYXRlXSkKICAgICAgICB7CiAgICAgICAgICAgIGNvbnRpbnVlIGJ1dHRvbkxvb3A7CiAgICAgICAgfQogICAgfQoKICAgIGxldCBuZXdCdXR0b25EYXRhID0gey4uLmFiTWVudUJ1dHRvbiwgLi4uYWN0aXZlQnV0dG9ufTsKCiAgICB0aGlzQm90LmFiQ3JlYXRlTWVudUJ1dHRvbihuZXdCdXR0b25EYXRhKTsKfQoKdGhpc0JvdC5tYXNrcy5vbkdyaWRDbGljayA9ICJAIHNob3V0KCdhYk1lbnVSZWZyZXNoJyk7IGxpbmtzLm1hbmlmZXN0YXRpb24uYWJDbGljaygpOyI7JwD9yKiGDodGBWxlYXJuAgQA/ciohg7CXCjwn5SXNjY1N2I4NjUtZTk4My00NDAxLTlmYzktZjU0MThkMThhN2Y3JwD9yKiGDodGA2dwdAIEAP3IqIYO6Vwo8J+Ul2VjODVjMWQ2LTlmMWEtNDBkNC04MmUxLTViZDY4MDM0OWMyNycA/ciohg6HRghhYklnbm9yZQIEAP3IqIYOkF0EdHJ1ZSgA/ciohg6HRgxhYkJvdFZlcnNpb24BfYQBJwD9yKiGDodGEWFiSW5pdGlhbEJvb3RNZW51AgQA/ciohg6WXb8KQGNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gImFiSW5pdGlhbE1lbnUiOwoKbWFza3MuZSA9ICJAIG1hc2tzLm9uR3JpZENsaWNrID0gbnVsbDsiOwptYXNrcy5vbkdyaWRDbGljayA9ICJAIG1hc2tzLm9uR3JpZENsaWNrID0gbnVsbDsgY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSBudWxsOyI7CgpsZXQgbWVudUJ1dHRvbiA9IHt9OwoKbWVudUJ1dHRvbi5hYkluaXRpYWxNZW51ID0gdHJ1ZTsKbWVudUJ1dHRvbi5ncmlkQ2xpY2sgPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7Cm1lbnVCdXR0b24uYWJNZW51UmVmcmVzaCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKbWVudUJ1dHRvbi5sZWFybiA9IHRhZ3MubGVhcm47Cm1lbnVCdXR0b24ubWFuaWZlc3RhdGlvbiA9IHRhZ3MubWFuaWZlc3RhdGlvbjsKbWVudUJ1dHRvbi5zZWFyY2ggPSB0YWdzLnNlYXJjaDsKbWVudUJ1dHRvbi5hc2sgPSB0YWdzLmFzazsKbWVudUJ1dHRvbi5sYWJlbCA9ICJidWlsZCI7Cm1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiY3ViZSI7Cm1lbnVCdXR0b24uY29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZVN0cm9rZUNvbG9yOwptZW51QnV0dG9uLm9uQ2xpY2sgPSBgQCBzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7YDsKCi8vdGhpc0JvdC5hYkNyZWF0ZU1lbnVCdXR0b24obWVudUJ1dHRvbik7CgptZW51QnV0dG9uLmxhYmVsID0gImFzayAiICsgbGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eTsKbWVudUJ1dHRvbi5mb3JtID0gImlucHV0IjsKbWVudUJ1dHRvbi5jb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3I7Cm1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiY3ViZSI7Cm1lbnVCdXR0b24ub25TdWJtaXQgPSBgQCBzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKICAgIGxpbmtzLmFzay5hYkNvcmVNZW51QWN0aW9uKHRoYXQudGV4dCk7YDsKCnRoaXNCb3QuYWJDcmVhdGVNZW51QnV0dG9uKG1lbnVCdXR0b24pOwoKbWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJxcl9jb2RlX3NjYW5uZXIiOwptZW51QnV0dG9uLmZvcm0gPSBudWxsOwptZW51QnV0dG9uLmxhYmVsID0gInNjYW4iOwptZW51QnV0dG9uLmNvbG9yID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKbWVudUJ1dHRvbi5vbkNsaWNrID0gYEAgc2hvdXQoImFiTWVudVJlZnJlc2giKTsKCmNvbmZpZ0JvdC50YWdzLnByYWN0aWNlUGVybWl0U2NhbiA9IHRydWU7Cgpvcy5vcGVuUVJDb2RlU2Nhbm5lcigpO2A7Cgp0aGlzQm90LmFiQ3JlYXRlTWVudUJ1dHRvbihtZW51QnV0dG9uKTsnAP3IqIYOh0YGc2VhcmNoAgQA/ciohg7WZyjwn5SXZDgzNzE0NDQtOTE1OC00NDM2LThmYzctODRjYzkxYjdmNTI1JwD9yKiGDodGBm51Z2dldAIEAP3IqIYO/Wco8J+UlzRhYWY2OTllLWFiYmYtNDRhOC04NWUxLTY4Y2JiNWRmMGUxZicA/ciohg6HRgV0ZXN0cwIEAP3IqIYOpGgo8J+Ul2I4M2Q5NzJiLTA1MzUtNDA1MS1iNTg5LTQxY2VkYTg1MzVmMScA/ciohg6HRg9vblBvcnRhbENoYW5nZWQCBAD9yKiGDstobkBpZiAodGhhdC5wb3J0YWwgPT0gInN5c3RlbVBvcnRhbCIgJiYgIXRoYXQuZGltZW5zaW9uICYmICFsaW5rcy50ZXN0cykKewogICAgbGlua3MubGVhcm4uYWJBZGFwdCgiYWJUZXN0cyIpOwp9JwD9yKiGDodGA2FzawIEAP3IqIYOumko8J+Ul2VjODVjMWQ2LTlmMWEtNDBkNC04MmUxLTViZDY4MDM0OWMyNycA/ciohg6HRhJhYkVudmlyb25tZW50QXJyYXkCBAD9yKiGDuFpmx7wn6esW3sibGFiZWwiOiAiaGlkZSIsICJmb3JtQWRkcmVzcyI6ICJ2aXNpYmlsaXR5X29mZiIsICJvbkNsaWNrIjogIkAgZGVzdHJveShsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90KTsgbGlua3MubWFuaWZlc3RhdGlvbi5tYXNrcy5hYkJvdCA9IG51bGw7IiwgImFiRW52aXJvbm1lbnRNZW51U29ydE9yZGVyIjogMH0sCnsibGFiZWwiOiAiY29sb3IiLCAiZm9ybUFkZHJlc3MiOiAicGFsZXR0ZSIsICJvbkNsaWNrIjogIkAgb3Muc2hvd0lucHV0Rm9yVGFnKGxpbmtzLnJlbWVtYmVyLCdhYkJhc2VDb2xvcicsIHt0eXBlOiAnY29sb3InLHRpdGxlOiAncGljayBhIGNvbG9yJ30pOyBkZXN0cm95KGxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QpO2xpbmtzLm1hbmlmZXN0YXRpb24ubWFza3MuYWJCb3QgPSBudWxsOyIsICJhYkVudmlyb25tZW50TWVudVNvcnRPcmRlciI6IDF9LAp7ImxhYmVsIjogInNsZWVwIiwgImZvcm1BZGRyZXNzIjogIm5pZ2h0c19zdGF5IiwgIm9uQ2xpY2siOiAiQGRlc3Ryb3kobGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdCk7IGxpbmtzLm1hbmlmZXN0YXRpb24ubWFza3MuYWJCb3QgPSBudWxsOyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQXdha2VTdGF0ZSA9IGZhbHNlOyIsICJhYkVudmlyb25tZW50TWVudVNvcnRPcmRlciI6IDJ9LAp7ImxhYmVsIjogImNoYXQiLCAiZm9ybUFkZHJlc3MiOiAiY2hhdCIsICJvbkNsaWNrIjogIkAgb3Muc2hvd0NoYXQoKTsiLCAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiAzfSwKeyJsYWJlbCI6ICJudWdnZXRzIiwgIm9uQ3JlYXRlIjogIkAgdGFncy5udWdNYW5hZ2VyID0gZ2V0TGluayhnZXRCb3QoJ3N5c3RlbScsICdhYi5pbnRlcmZhY2UubnVnZ2V0JykpOyBpZiAobGlua3MubnVnTWFuYWdlci50YWdzLmxpc3RlbmluZyl7dGFncy5vbkNsaWNrID0gYEAgc2hvdXQoJ2FiTWVudVJlZnJlc2gnKTsgbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7IHNldFRhZ01hc2sobGlua3MubnVnTWFuYWdlciwgJ2xpc3RlbmluZycsIG51bGwpO2A7dGFncy5mb3JtQWRkcmVzcyA9IGBjaGVja19ib3hgO31lbHNleyAgICB0YWdzLm9uQ2xpY2sgPSBgQCBzaG91dCgnYWJNZW51UmVmcmVzaCcpOyBsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soKTsgc2V0VGFnTWFzayhsaW5rcy5udWdNYW5hZ2VyLCAnbGlzdGVuaW5nJywgdHJ1ZSwgJ2xvY2FsJyk7YDsgICAgdGFncy5mb3JtQWRkcmVzcyA9IGBjaGVja19ib3hfb3V0bGluZV9ibGFua2A7fSIsICJhYkVudmlyb25tZW50TWVudVNvcnRPcmRlciI6IDR9LAp7ImxhYmVsIjogInN5c3RlbVBvcnRhbD10cnVlIiwgImZvcm1BZGRyZXNzIjogInNldHRpbmdzX2FwcGxpY2F0aW9ucyIsICJvbkNsaWNrIjogIkAgY29uc3Qgc3RhdGUgPSBvcy5nZXRJbnB1dFN0YXRlKCdrZXlib2FyZCcsICdTaGlmdCcpOyBpZiAoc3RhdGUpe29zLm9wZW5VUkwoY29uZmlnQm90LnRhZ3MucGVybWFsaW5rICsgYCZzeXN0ZW1Qb3J0YWw9dHJ1ZWApO31lbHNle2NvbmZpZ0JvdC50YWdzLnN5c3RlbVBvcnRhbCA9IHRydWU7fSIsICJhYkVudmlyb25tZW50TWVudVNvcnRPcmRlciI6IDV9LAp7ImFiRW52aXJvbm1lbnRHYXRlIjogImdwdCIsICJvbkNyZWF0ZSI6ICJAICBpZiAoIWF1dGhCb3Qpe2Rlc3Ryb3kodGhpc0JvdCk7fWVsc2UgaWYgKGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICdGcmVlUGxheScgfHwgYXV0aEJvdC50YWdzLnN1YnNjcmlwdGlvblRpZXIgPT0gdW5kZWZpbmVkKXtkZXN0cm95KHRoaXNCb3QpO307IHRhZ3MubGFiZWwgPSAnZWRpdCAnICsgbGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICcgcHJvbXB0JzsgdGFncy5ncHRCb3QgPSBnZXRMaW5rKGdldEJvdCgnc3lzdGVtJywgJ2FiLmFjdGlvbi5hc2snKSk7IiwgImZvcm1BZGRyZXNzIjogImVkaXRfbm90ZSIsICJvbkNsaWNrIjogIkAgbGlua3MuZ3B0Qm90LmVkaXRQcm9tcHQoKTsiLCAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiA2fSwKeyJsYWJlbCI6ICJncmlkIHNuYXAiLCAib25DcmVhdGUiOiAiQCB0YWdzLmZvcm1BZGRyZXNzID0gbGlua3MucmVtZW1iZXIudGFncy5hYkdyaWRTbmFwU3RhdGUgPyAnY2hlY2tfYm94JyA6ICdjaGVja19ib3hfb3V0bGluZV9ibGFuayciLCAib25DbGljayI6ICJAIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkU25hcFN0YXRlID0gIWxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkU25hcFN0YXRlO3RhZ3MuZm9ybUFkZHJlc3MgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiR3JpZFNuYXBTdGF0ZSA/ICdjaGVja19ib3gnIDogJ2NoZWNrX2JveF9vdXRsaW5lX2JsYW5rJzsiLCAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiA3fSwKeyJsYWJlbCI6ICJib3Qgc25hcCIsICJvbkNyZWF0ZSI6ICJAIHRhZ3MuZm9ybUFkZHJlc3MgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQm90U25hcFN0YXRlID8gJ2NoZWNrX2JveCcgOiAnY2hlY2tfYm94X291dGxpbmVfYmxhbmsnOyIsICJvbkNsaWNrIjogIkAgbGlua3MucmVtZW1iZXIudGFncy5hYkJvdFNuYXBTdGF0ZSA9ICFsaW5rcy5yZW1lbWJlci50YWdzLmFiQm90U25hcFN0YXRlOyB0YWdzLmZvcm1BZGRyZXNzID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJvdFNuYXBTdGF0ZSA/ICdjaGVja19ib3gnIDogJ2NoZWNrX2JveF9vdXRsaW5lX2JsYW5rJzsiLCAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiA4fSwKeyJhYkVudmlyb25tZW50R2F0ZSI6ICJ0ZXN0cyIsICJsYWJlbCI6ICJyZWNvcmQgdGVzdCIsICJmb3JtQWRkcmVzcyI6ICJzY2llbmNlIiwgIm9uS2V5RG93biI6ICJAICIsICJvbktleVVwIjogIkAgIiwgIm9uQ2xpY2siOiAiQCBsZXQgc2hpZnRDaGVjayA9IG9zLmdldElucHV0U3RhdGUoJ2tleWJvYXJkJywgJ1NoaWZ0Jyk7bGV0IGN1cnJlbnRJbnN0ID0gb3MuZ2V0Q3VycmVudEluc3QoKTtzaG91dCgnYWJSZWNvcmRUZXN0Jyk7c2hvdXQoJ2FiTWVudVJlZnJlc2gnKTsiLCAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiA5fSwKeyJhYkVudmlyb25tZW50R2F0ZSI6ICJ0ZXN0cyIsICJsYWJlbCI6ICJyZWNvcmQgdHJhY2UiLCAiZm9ybUFkZHJlc3MiOiAidGltZWxpbmUiLCAib25LZXlEb3duIjogIkAgIiwgIm9uS2V5VXAiOiAiQCAiLCAib25DbGljayI6ICJAIGxldCBzaGlmdENoZWNrID0gb3MuZ2V0SW5wdXRTdGF0ZSgna2V5Ym9hcmQnLCAnU2hpZnQnKTtsZXQgY3VycmVudEluc3QgPSBvcy5nZXRDdXJyZW50SW5zdCgpO3Nob3V0KCdhYlJlY29yZFRyYWNlJyk7c2hvdXQoJ2FiTWVudVJlZnJlc2gnKTsiLCAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiAxMH0sCnsib25DcmVhdGUiOiAiQCB0YWdzLmxhYmVsID0gJ3Blcm1hbmVudGx5IGRlbGV0ZSAnICsgbGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICcgdicgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQ29yZVZlcnNpb24gKyAnLicgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQ29yZUl0ZXJhdGlvbjsiLCAiZm9ybUFkZHJlc3MiOiAiZGVsZXRlX2ZvcmV2ZXIiLCAiY29sb3IiOiAiI0Q5MzAzMCIsICJvbkNsaWNrIjogIkAgbGV0IGFsbEJvdHMgPSBnZXRCb3RzKCdzcGFjZScsICdzaGFyZWQnKTtkZXN0cm95KGxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QpO2ZvciAobGV0IGkgPSAwOyBpIDwgYWxsQm90cy5sZW5ndGg7IGkrKyl7aWYgKGFsbEJvdHNbaV0udGFncy5zeXN0ZW0pIHtpZiAoYWxsQm90c1tpXS50YWdzLnN5c3RlbS5pbmNsdWRlcygnYWInKSl7ZGVzdHJveShhbGxCb3RzW2ldKTt9fX0iLCAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiAxMDB9Cl0nAQRib3RzJGRjYTVkOTg3LWM0ZDgtNDZlNC1iNjBjLWRhYTdiMmY0ZGRhZAEnAP3IqIYO+4cBBnN5c3RlbQIEAP3IqIYO/IcBGmFiLmludGVyZmFjZS5tYW5pZmVzdGF0aW9uJwD9yKiGDvuHAQRmb3JtAgQA/ciohg6XiAEHbm90aGluZygA/ciohg77hwELYWJJbnRlcmZhY2UBeCcA/ciohg77hwELZGVzY3JpcHRpb24CBAD9yKiGDqCIAThUaGlzIHNraWxsIGNvbnRyb2xzIHRoZSBhY3R1YWwgYm90IGZvciB0aGUgYWIgaW50ZXJmYWNlLicA/ciohg77hwEFbGVhcm4CBAD9yKiGDtmIASjwn5SXNjY1N2I4NjUtZTk4My00NDAxLTlmYzktZjU0MThkMThhN2Y3JwD9yKiGDvuHAQ9vblBvcnRhbENoYW5nZWQCBAD9yKiGDoCJAcIFQGlmICghbGlua3MucmVtZW1iZXIudGFncy5hYkF3YWtlU3RhdGUgfHwgdGhhdC5wb3J0YWwgPT0gInRhZ1BvcnRhbCIpCnsKICAgIHJldHVybjsKfQoKbGV0IHBvcnRhbEFycmF5ID0gWyJtaW5pR3JpZFBvcnRhbCIsICJncmlkUG9ydGFsIiwgIm1hcFBvcnRhbCIsICJtaW5pTWFwUG9ydGFsIiwgImxlZnRXcmlzdFBvcnRhbCIsICJyaWdodFdyaXN0UG9ydGFsIl07CgppZiAocG9ydGFsQXJyYXkuaW5kZXhPZih0aGF0LnBvcnRhbCkgIT0gLTEgJiYgdGhhdC5kaW1lbnNpb24pCnsKICAgIHRoaXNCb3QuYWJNYW5pZmVzdEJvdCh7ZGltZW5zaW9uOiB0aGF0LmRpbWVuc2lvbiwgcG9zaXRpb246e3g6MCx5OjB9fSk7Cn0KZWxzZSBpZiAocG9ydGFsQXJyYXkuaW5kZXhPZih0aGF0LnBvcnRhbCkgPT0gLTEgJiYgIXRoYXQuZGltZW5zaW9uICYmIHRoYXQucG9ydGFsICE9ICJtZW51UG9ydGFsIikKewogICAgbGV0IHN1bW1vbkRpbWVuc2lvbiA9IGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA/IGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA6IGNvbmZpZ0JvdC50YWdzLmdyaWRQb3J0YWw7CgogICAgdGhpc0JvdC5hYk1hbmlmZXN0Qm90KHtkaW1lbnNpb246IHN1bW1vbkRpbWVuc2lvbiwgcG9zaXRpb246e3g6MCx5OjB9fSk7Cn0KZWxzZSBpZiAodGhhdC5wb3J0YWwgIT0gIm1lbnVQb3J0YWwiKQp7CiAgICBkZXN0cm95KGxpbmtzLmFiQm90KTsKfScA/ciohg77hwEIcmVtZW1iZXICBAD9yKiGDsOOASjwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwD9yKiGDvuHAQ1hYk1hbmlmZXN0Qm90AgQA/ciohg7qjgHkD0BpZiAodGFncy5hYkJvdCkKewogICAgZGVzdHJveShsaW5rcy5hYkJvdCk7Cn0KCmxldCBhYiA9IHt9OwoKYWIuc3BhY2UgPSAidGVtcExvY2FsIjsKYWIuY29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZUNvbG9yOwphYi5mb3JtT3BhY2l0eSA9ICIwLjMzIjsKYWIubGFiZWwgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZUxhYmVsOwphYi5sYWJlbFBvc2l0aW9uID0gImZyb250IjsKYWIubGFiZWxDb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3I7CmFiLmxhYmVsU2l6ZSA9IDAuNjE7CmFiLm9uQ2xpY2sgPSAiQCBsaW5rcy5tYW5hZ2VyLmFiQ2xpY2soKTsiOwphYi5kaW1lbnNpb24gPSB0aGF0LmRpbWVuc2lvbjsKYWJbdGhhdC5kaW1lbnNpb25dID0gdHJ1ZTsKYWJbdGhhdC5kaW1lbnNpb24gKyAiWCJdID0gdGhhdC5wb3NpdGlvbi54OwphYlt0aGF0LmRpbWVuc2lvbiArICJZIl0gPSB0aGF0LnBvc2l0aW9uLnk7CmFiLnN0cm9rZUNvbG9yID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKYWIubGluZUNvbG9yID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKYWIubWFuYWdlciA9ICLwn5SXIiArIHRoaXNCb3QuaWQ7CmFiLmFuaW1hdGVCb3QgPSBgQCBpZiAoY29uZmlnQm90LnRhZ3MuYWJPcHRpbWl6ZWQpCnsKICAgIHJldHVybjsKfQoKY29uc3Qgcm90WiA9IHRhZ3MuZGltZW5zaW9uICsgIlJvdGF0aW9uWiI7CmxldCB0YXJnZXRTY2FsZSA9IDAuNjU7CgppZiAodGFncy5zY2FsZSA8PSAwLjY1MSkKewogICAgdGFyZ2V0U2NhbGUgPSAwLjk1Owp9Cgphd2FpdCBhbmltYXRlVGFnKHRoaXNCb3QsCnsKICAgIGZyb21WYWx1ZTogewogICAgICAgIFtyb3RaXTogMCwKICAgICAgICBzY2FsZTogdGFncy5zY2FsZQogICAgfSwKICAgIHRvVmFsdWU6IHsKICAgICAgICBbcm90Wl06IDYuMywKICAgICAgICBzY2FsZTogdGFyZ2V0U2NhbGUKICAgIH0sCiAgICBlYXNpbmc6IHsKICAgICAgICB0eXBlOiAic2ludXNvaWRhbCIsCiAgICAgICAgbW9kZTogImlub3V0IgogICAgfSwKICAgIGR1cmF0aW9uOiAyCn0pLmNhdGNoKGUgPT4ge30pOwpgOwphYi5vbkNyZWF0ZSA9IGBACgp0aGlzQm90LmFuaW1hdGVCb3QoKTsKCm1hc2tzLmludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gdGhpc0JvdC5hbmltYXRlQm90KCksIDIwMDApOwpgOwphYi5vbkRlc3Ryb3kgPSBgQApjbGVhckludGVydmFsKHRhZ3MuaW50ZXJ2YWwpOwoKc2hvdXQoImFiTWVudVJlZnJlc2giKTsKYDsKYWIuZHJhZ2dhYmxlID0gZmFsc2U7CmFiLnNjYWxlID0gMC45OwoKbGV0IGFiTWFuaWZlc3RlZCA9IGF3YWl0IGNyZWF0ZShhYik7CgppZiAobGlua3MucmVtZW1iZXIudGFncy5hYlNlY29uZGFyeUxhYmVsKQp7CiAgICBsZXQgYWJMYWJlbEJvdCA9IHt9OwoKICAgIGFiTGFiZWxCb3Quc3BhY2UgPSAidGVtcExvY2FsIjsKICAgIGFiTGFiZWxCb3RbdGhhdC5kaW1lbnNpb25dID0gdHJ1ZTsKICAgIGFiTGFiZWxCb3RbdGhhdC5kaW1lbnNpb24gKyAiWiJdID0gLTE7CiAgICBhYkxhYmVsQm90LmNyZWF0b3IgPSBhYk1hbmlmZXN0ZWQuaWQ7CiAgICBhYkxhYmVsQm90LnRyYW5zZm9ybWVyID0gYWJNYW5pZmVzdGVkLmlkOwogICAgYWJMYWJlbEJvdC5wb2ludGFibGUgPSBmYWxzZTsKICAgIGFiTGFiZWxCb3QuY29sb3IgPSAiY2xlYXIiOwogICAgYWJMYWJlbEJvdC5sYWJlbCA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJTZWNvbmRhcnlMYWJlbDsKICAgIGFiTGFiZWxCb3QubGFiZWxQb3NpdGlvbiA9ICJsZWZ0IjsKICAgIGFiTGFiZWxCb3QubGFiZWxTaXplID0gMC43OwogICAgYWJMYWJlbEJvdC5sYWJlbENvbG9yID0gYWJNYW5pZmVzdGVkLnRhZ3MubGFiZWxDb2xvcjsKCiAgICBjcmVhdGUoYWJMYWJlbEJvdCk7Cn0KCm1hc2tzLmFiQm90ID0gIvCflJciICsgYWJNYW5pZmVzdGVkLmlkOwoKbGlua3MucmVtZW1iZXIubWFza3MuYWJBY3RpdmVEaW1lbnNpb24gPSB0aGF0LmRpbWVuc2lvbjsnAP3IqIYO+4cBD2FiTWFuaWZlc3RTdGF0ZQIEAP3IqIYOy54BBkFzbGVlcCcA/ciohg77hwEcYWJNYW5pZmVzdFN0YXRlQXNsZWVwT25FbnRlcgIEAP3IqIYO0p4Bb0BkZXN0cm95KGxpbmtzLmFiQm90KTsKCm1hc2tzLmFiQm90ID0gbnVsbDsKCnNob3V0KCJhYk1lbnVSZWZyZXNoIik7CgpsaW5rcy5yZW1lbWJlci50YWdzLmFiQXdha2VTdGF0ZSA9IGZhbHNlOycA/ciohg77hwELb25HcmlkQ2xpY2sCBAD9yKiGDsKfAfYQQGlmICghbGlua3MucmVtZW1iZXIudGFncy5hYkF3YWtlU3RhdGUpCnsKICAgIHJldHVybjsKfQoKc2hvdXQoImFiTWVudVJlZnJlc2giKTsKCmNvbnN0IHNoaWZ0Q2hlY2sgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJTaGlmdCIpOwoKaWYgKHNoaWZ0Q2hlY2sgJiYgdGFncy5hYkJvdCkKewogICAgaWYgKGxpbmtzLmFiQm90LnRhZ3MuYXJtKQogICAgewogICAgICAgIGRlc3Ryb3kobGlua3MuYWJCb3QubGlua3MuYXJtKTsKCiAgICAgICAgbGlua3MuYWJCb3QubWFza3MubGluZVRvID0gbnVsbDsKICAgIH0KICAgIAogICAgbGV0IGFybSA9IHt9OwoKICAgIGFybS5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwogICAgYXJtW3RoYXQuZGltZW5zaW9uXSA9IHRydWU7CiAgICBhcm1bdGhhdC5kaW1lbnNpb24gKyAiWCJdID0gdGhhdC5wb3NpdGlvbi54OwogICAgYXJtW3RoYXQuZGltZW5zaW9uICsgIlkiXSA9IHRoYXQucG9zaXRpb24ueTsKICAgIGFybS5kaW1lbnNpb24gPSB0aGF0LmRpbWVuc2lvbjsKICAgIGFybS5zY2FsZSA9IDAuOTsKICAgIGFybS5zY2FsZVogPSAwLjAxOwogICAgYXJtLmNvbG9yID0gImNsZWFyIjsKICAgIGFybS5zdHJva2VDb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3I7CiAgICBhcm0ubGluZUNvbG9yID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKICAgIGFybS5saW5lVG8gPSBsaW5rcy5hYkJvdC5pZDsKICAgIGFybS5tYW5hZ2VyID0gIvCflJciICsgdGhpc0JvdC5pZDsKICAgIGFybS5vbkNsaWNrID0gYEAgZGVzdHJveSh0aGlzQm90KTsKCiAgICBsaW5rcy5tYW5hZ2VyLmFiTWFuaWZlc3RCb3Qoe2RpbWVuc2lvbjogdGFncy5kaW1lbnNpb24sIHBvc2l0aW9uOnt4OnRhZ3NbdGFncy5kaW1lbnNpb24gKyAiWCJdLHk6dGFnc1t0YWdzLmRpbWVuc2lvbiArICJZIl19fSk7YDsKCiAgICBsZXQgbmV3QXJtID0gYXdhaXQgY3JlYXRlKGFybSk7CgogICAgbGlua3MuYWJCb3QubWFza3MuYXJtID0gIvCflJciICsgbmV3QXJtLmlkOwoKICAgIGxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiR3JpZEZvY3VzID0ge2RpbWVuc2lvbjogdGhhdC5kaW1lbnNpb24sIHBvc2l0aW9uOiB7eDogdGhhdC5wb3NpdGlvbi54LCB5OiB0aGF0LnBvc2l0aW9uLnl9fTsKCiAgICB0aGlzQm90LmFiQ2xpY2soe21lbnU6ICJncmlkIn0pOwoKICAgIHJldHVybjsKfQoKbGV0IGZvb3RwcmludCA9IHt9OwoKZm9vdHByaW50LnNwYWNlID0gInRlbXBMb2NhbCI7CmZvb3RwcmludFt0aGF0LmRpbWVuc2lvbl0gPSB0cnVlOwpmb290cHJpbnQuZGltZW5zaW9uID0gdGhhdC5kaW1lbnNpb247CmZvb3RwcmludFt0aGF0LmRpbWVuc2lvbiArICJYIl0gPSB0aGF0LnBvc2l0aW9uLng7CmZvb3RwcmludFt0aGF0LmRpbWVuc2lvbiArICJZIl0gPSB0aGF0LnBvc2l0aW9uLnk7CmZvb3RwcmludC5zY2FsZVogPSAwLjAxOwpmb290cHJpbnQub25DbGljayA9IGBAIHRhZ3NbdGFncy5kaW1lbnNpb25dID0gZmFsc2U7CgpsaW5rcy5tYW5hZ2VyLmFiTWFuaWZlc3RCb3QodGFncy5wb3NpdGlvbkluZm8pOwpgOwpmb290cHJpbnQucG9zaXRpb25JbmZvID0gdGhhdDsKZm9vdHByaW50LmNvbG9yID0gImNsZWFyIjsKZm9vdHByaW50LnN0cm9rZUNvbG9yID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKZm9vdHByaW50LmRyYWdnYWJsZSA9IGZhbHNlOwpmb290cHJpbnQubWFuYWdlciA9ICLwn5SXIiArIHRoaXNCb3QuaWQ7CmZvb3RwcmludC5vbkNyZWF0ZSA9IGBAIHNldFRpbWVvdXQoKCkgPT4gZGVzdHJveSh0aGlzQm90KSwgODAwKTsKCiAgICBhd2FpdCBhbmltYXRlVGFnKHRoaXNCb3QsIHsKICAgICAgICBmcm9tVmFsdWU6IHsKICAgICAgICAgICAgc2NhbGVYOiAwLjEsCiAgICAgICAgICAgIHNjYWxlWTogMC4xCiAgICAgICAgfSwKICAgICAgICB0b1ZhbHVlOiB7CiAgICAgICAgICAgIHNjYWxlWDogMS4xLAogICAgICAgICAgICBzY2FsZVk6IDEuMQogICAgICAgIH0sCiAgICAgICAgZHVyYXRpb246IDAuNSwKICAgICAgICBlYXNpbmc6IHsKICAgICAgICAgICAgdHlwZTogImVsYXN0aWMiLAogICAgICAgICAgICBtb2RlOiAib3V0IgogICAgICAgIH0KICAgIH0pLmNhdGNoKGUgPT4ge30pOwpgOwoKY3JlYXRlKGZvb3RwcmludCk7JwD9yKiGDvuHAQRtZW51AgQA/ciohg6zsAEo8J+Ul2IzMGM2YzVkLWE0ZjctNDI2Ni1iYTM4LTM5M2RjOTVlMWVjYicA/ciohg77hwEHYWJDbGljawIEAP3IqIYO2rAB3wlAaWYgKCFsaW5rcy5hYkJvdCkKewogICAgcmV0dXJuOwp9Cgpjb25zdCBtZW51VHlwZSA9IHRoYXQgPyB0aGF0Lm1lbnUgOiAiY29yZSI7CmNvbnN0IHN0YXRlID0gb3MuZ2V0SW5wdXRTdGF0ZSgia2V5Ym9hcmQiLCAiU2hpZnQiKTsKCmlmIChsaW5rcy5hYkJvdC50YWdzLmludGVydmFsIHx8IHN0YXRlKQp7CiAgICBjb25zdCBhYk1lbnVCb3RzID0gZ2V0Qm90cygiYWJNZW51IiwgdHJ1ZSk7CgogICAgd2hpc3BlcihhYk1lbnVCb3RzLCAiYWJNZW51UmVmcmVzaCIpOwogICAgCiAgICBjbGVhckludGVydmFsKGxpbmtzLmFiQm90LnRhZ3MuaW50ZXJ2YWwpOwoKICAgIGxpbmtzLmFiQm90Lm1hc2tzLmludGVydmFsID0gbnVsbDsKCiAgICBjbGVhckFuaW1hdGlvbnMobGlua3MuYWJCb3QpOwoKICAgIGNvbnN0IHJvdFogPSBsaW5rcy5hYkJvdC50YWdzLmRpbWVuc2lvbiArICJSb3RhdGlvbloiOwoKICAgIGlmIChzdGF0ZSAmJiBtZW51VHlwZSA9PSAiY29yZSIpCiAgICB7CiAgICAgICAgbGlua3MubWVudS5hYkVudmlyb25tZW50TWVudSgpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIGxpbmtzLm1lbnUuYWJPcGVuTWVudShtZW51VHlwZSk7CiAgICB9CgogICAgYXdhaXQgYW5pbWF0ZVRhZyhsaW5rcy5hYkJvdCwKICAgIHsKICAgICAgICBmcm9tVmFsdWU6IHsKICAgICAgICAgICAgW3JvdFpdOiBsaW5rcy5hYkJvdC50YWdzW3JvdFpdLAogICAgICAgICAgICBzY2FsZTogbGlua3MuYWJCb3QudGFncy5zY2FsZQogICAgICAgIH0sCiAgICAgICAgdG9WYWx1ZTogewogICAgICAgICAgICBbcm90Wl06IDAsCiAgICAgICAgICAgIHNjYWxlOiAwLjkKICAgICAgICB9LAogICAgICAgIGVhc2luZzogewogICAgICAgICAgICB0eXBlOiAic2ludXNvaWRhbCIsCiAgICAgICAgICAgIG1vZGU6ICJpbm91dCIKICAgICAgICB9LAogICAgICAgIGR1cmF0aW9uOiAwLjUKICAgIH0pLmNhdGNoKGUgPT4ge30pOwp9CmVsc2UKewogICAgbGlua3MuYWJCb3QuYW5pbWF0ZUJvdCgpOwoKICAgIGxpbmtzLmFiQm90Lm1hc2tzLmxpbmVUbyA9IG51bGw7CgogICAgaWYgKGxpbmtzLmFiQm90LnRhZ3MuYXJtKQogICAgewogICAgICAgIGRlc3Ryb3kobGlua3MuYWJCb3QubGlua3MuYXJtKTsKICAgIH0KCiAgICBzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKICAgIGxpbmtzLmFiQm90Lm1hc2tzLmludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gbGlua3MuYWJCb3QuYW5pbWF0ZUJvdCgpLCAyMDAwKTsKfScA/ciohg77hwEbYWJNYW5pZmVzdFN0YXRlQXdha2VPbkVudGVyAgQA/ciohg66ugH0AUBsaW5rcy5yZW1lbWJlci50YWdzLmFiQXdha2VTdGF0ZSA9IHRydWU7CgpsZXQgZGltZW5zaW9uID0gY29uZmlnQm90LnRhZ3MubWFwUG9ydGFsID8gY29uZmlnQm90LnRhZ3MubWFwUG9ydGFsIDogY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbDsKCmlmICghZGltZW5zaW9uKQp7CiAgICByZXR1cm47Cn0KCnRoaXNCb3QuYWJNYW5pZmVzdEJvdCh7ZGltZW5zaW9uOiBkaW1lbnNpb24sIHBvc2l0aW9uOiB7eDogMCwgeTogMH19KTsnAP3IqIYO+4cBDG9uQW55Qm90RHJhZwIEAP3IqIYOr7wB+whAaWYgKHRoYXQuYm90ICE9IGxpbmtzLmFiQm90KSByZXR1cm47CgppZiAobGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzICYmIHRoYXQuYm90LmlkID09IGxpbmtzLmFiQm90LmlkKQp7CiAgICBvcy5lbmFibGVDdXN0b21EcmFnZ2luZygpOwoKICAgIHJldHVybjsKfQoKaWYgKGxpbmtzLmFiQm90LnRhZ3MuYXJtKQp7CiAgICBkZXN0cm95KGxpbmtzLmFiQm90LmxpbmtzLmFybSk7Cn0KCmlmICghdGhhdC5ib3QudGFncy5pbnRlcnZhbCkKewogICAgdGhpc0JvdC5hYkNsaWNrKCk7Cn0KCmxldCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7CmxldCBhcm0gPSB7fTsKCmFybS5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwphcm1bdGhhdC5mcm9tLmRpbWVuc2lvbl0gPSB0cnVlOwphcm0uY3JlYXRvciA9IGxpbmtzLmFiQm90LmlkOwphcm0uZGltZW5zaW9uID0gdGhhdC5mcm9tLmRpbWVuc2lvbjsKYXJtLnNjYWxlID0gMC45Owphcm0uc2NhbGVaID0gMC4wMTsKYXJtLmNvbG9yID0gImNsZWFyIjsKYXJtLnN0cm9rZUNvbG9yID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKYXJtLmxpbmVDb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3I7CmFybS5saW5lVG8gPSB0aGF0LmJvdC5pZDsKYXJtLm1hbmFnZXIgPSAi8J+UlyIgKyB0aGlzQm90LmlkOwphcm0ub25DbGljayA9IGBAIGRlc3Ryb3kodGhpc0JvdCk7CgpsaW5rcy5tYW5hZ2VyLmFiTWFuaWZlc3RCb3Qoe2RpbWVuc2lvbjogdGFncy5kaW1lbnNpb24sIHBvc2l0aW9uOnt4OnRhZ3NbdGFncy5kaW1lbnNpb24gKyAiWCJdLHk6dGFnc1t0YWdzLmRpbWVuc2lvbiArICJZIl19fSk7YDsKCmlmIChzdGF0ZSkKewogICAgYXJtLm11bHRpU2VsZWN0ID0gdHJ1ZTsKICAgIGFybS5mb3JtID0gInNwaGVyZSI7CiAgICBhcm0uY29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZVN0cm9rZUNvbG9yOwoKICAgIGxpbmtzLmFiQm90Lm1hc2tzLmRyYWdnYWJsZSA9IHRydWU7Cn0KCmxldCBuZXdBcm0gPSBhd2FpdCBjcmVhdGUoYXJtKTsKCmxpbmtzLmFiQm90Lm1hc2tzLmFybSA9ICLwn5SXIiArIG5ld0FybS5pZDsKCm9zLnJlcGxhY2VEcmFnQm90KG5ld0FybSk7JwD9yKiGDvuHARFvbkFueUJvdERyb3BFbnRlcgIEAP3IqIYOp8UBuQdAaWYgKCF0YWdzLmFiQm90KSByZXR1cm47CmlmIChsaW5rcy5hYkJvdC5saW5rcy5hcm0gIT0gdGhhdC5kcmFnQm90KSByZXR1cm47CgppZiAobGlua3MuYWJCb3QubGlua3MuYXJtLnRhZ3MubXVsdGlTZWxlY3QpCnsKICAgIGlmIChBcnJheS5pc0FycmF5KGxpbmtzLmFiQm90LnRhZ3MubGluZVRvKSkKICAgIHsKICAgICAgICBsaW5rcy5hYkJvdC5tYXNrcy5saW5lVG8ucHVzaCh0aGF0LnRvLmJvdC5pZCk7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbGlua3MuYWJCb3QubWFza3MubGluZVRvID0gW3RoYXQudG8uYm90LmlkXTsKICAgIH0KCiAgICBsZXQgbmV3TGluazsKCiAgICBpZiAoIWxpbmtzLmFiQm90LmxpbmtzLmFybS50YWdzLnNlbGVjdGVkQm90cykKICAgIHsKICAgICAgICBuZXdMaW5rID0gZ2V0TGluayh0aGF0LnRvLmJvdCk7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbGV0IHByZXZpb3VzTGlua0JvdHMgPSBsaW5rcy5hYkJvdC5saW5rcy5hcm0ubGlua3Muc2VsZWN0ZWRCb3RzOwoKICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkocHJldmlvdXNMaW5rQm90cykpCiAgICAgICAgewogICAgICAgICAgICBwcmV2aW91c0xpbmtCb3RzID0gW3ByZXZpb3VzTGlua0JvdHNdCiAgICAgICAgfQoKICAgICAgICBwcmV2aW91c0xpbmtCb3RzLnB1c2godGhhdC50by5ib3QpOwoKICAgICAgICBuZXdMaW5rID0gZ2V0TGluayhwcmV2aW91c0xpbmtCb3RzKTsKICAgIH0KCiAgICBsaW5rcy5hYkJvdC5saW5rcy5hcm0udGFncy5zZWxlY3RlZEJvdHMgPSBuZXdMaW5rOwp9CmVsc2UKewogICAgbGlua3MuYWJCb3QubGlua3MuYXJtLm1hc2tzLnN0cm9rZUNvbG9yID0gImNsZWFyIjsKICAgIGxpbmtzLmFiQm90LmxpbmtzLmFybS5tYXNrcy5saW5lVG8gPSBmYWxzZTsKCiAgICBsaW5rcy5hYkJvdC5tYXNrcy5saW5lVG8gPSB0aGF0LnRvLmJvdC5pZDsKfScA/ciohg77hwEQb25BbnlCb3REcm9wRXhpdAIEAP3IqIYO4cwBmwJAaWYgKCF0YWdzLmFiQm90KSByZXR1cm47CmlmIChsaW5rcy5hYkJvdC5saW5rcy5hcm0gIT0gdGhhdC5kcmFnQm90KSByZXR1cm47CgppZiAoIWxpbmtzLmFiQm90LmxpbmtzLmFybS50YWdzLm11bHRpU2VsZWN0KQp7CiAgICBsaW5rcy5hYkJvdC5saW5rcy5hcm0ubWFza3Muc3Ryb2tlQ29sb3IgPSBudWxsOwogICAgbGlua3MuYWJCb3QubGlua3MuYXJtLm1hc2tzLmxpbmVUbyA9IG51bGw7CgogICAgbGlua3MuYWJCb3QubWFza3MubGluZVRvID0gbGlua3MuYWJCb3QubGlua3MuYXJtLmlkOwp9JwD9yKiGDvuHAQxvbkFueUJvdERyb3ACBAD9yKiGDv3OAbIGQG1hc2tzLm11bHRpRHJhZyA9IG51bGw7CgppZiAoIXRhZ3MuYWJCb3QpIHJldHVybjsKaWYgKCFsaW5rcy5hYkJvdCkgcmV0dXJuOwppZiAoIWxpbmtzLmFiQm90LnRhZ3MuYXJtKSByZXR1cm47CmlmIChsaW5rcy5hYkJvdC5saW5rcy5hcm0gIT0gdGhhdC5kcmFnQm90KSByZXR1cm47CgppZiAobGlua3MuYWJCb3QubGlua3MuYXJtLnRhZ3MubXVsdGlTZWxlY3QpCnsKICAgIGxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiTXVsdGlwbGVCb3RGb2N1cyA9IGxpbmtzLmFiQm90LmxpbmtzLmFybS50YWdzLnNlbGVjdGVkQm90czsKCiAgICB0aGlzQm90LmFiQ2xpY2soe21lbnU6ICJtdWx0aXBsZUJvdCJ9KTsKCiAgICBkZXN0cm95KGxpbmtzLmFiQm90LmxpbmtzLmFybSk7Cn0KZWxzZSBpZiAodGhhdC50by5ib3QpCnsKICAgIGlmICh0aGF0LnRvLmJvdCA9PSBsaW5rcy5hYkJvdCkKICAgIHsKICAgICAgICBsaW5rcy5tZW51LmFiRW52aXJvbm1lbnRNZW51KCk7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgbGlua3MucmVtZW1iZXIubWFza3MuYWJCb3RGb2N1cyA9ICLwn5SXIiArIHRoYXQudG8uYm90LmlkOwoKICAgICAgICB0aGlzQm90LmFiQ2xpY2soe21lbnU6ICJib3QifSk7CiAgICB9CgogICAgZGVzdHJveShsaW5rcy5hYkJvdC5saW5rcy5hcm0pOwp9CmVsc2UKewogICAgbGlua3MucmVtZW1iZXIubWFza3MuYWJHcmlkRm9jdXMgPSB7ZGltZW5zaW9uOiB0aGF0LnRvLmRpbWVuc2lvbiwgcG9zaXRpb246IHt4OiB0aGF0LnRvLngsIHk6IHRoYXQudG8ueX19OwoKICAgIHRoaXNCb3QuYWJDbGljayh7bWVudTogImdyaWQifSk7Cn0nAP3IqIYO+4cBCGFiSWdub3JlAgQA/ciohg6u1QEEdHJ1ZSgA/ciohg77hwEMYWJCb3RWZXJzaW9uAX2EAScA/ciohg77hwEDYXNrAgQA/ciohg601QEo8J+Ul2VjODVjMWQ2LTlmMWEtNDBkNC04MmUxLTViZDY4MDM0OWMyNycA/ciohg77hwEJYXNrQnV0dG9uAgQA/ciohg7b1QHZBUBpZiAoIWxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJBd2FrZVN0YXRlKQp7CiAgICByZXR1cm47Cn0KCmxldCBhYk1lbnVCdXR0b24gPSB7fTsKCmFiTWVudUJ1dHRvbi5hYk1lbnUgPSB0cnVlOwphYk1lbnVCdXR0b24ucmVtZW1iZXIgPSBsaW5rcy5tZW51LnRhZ3MucmVtZW1iZXI7CmFiTWVudUJ1dHRvbi5tYW5pZmVzdGF0aW9uID0gbGlua3MubWVudS50YWdzLm1hbmlmZXN0YXRpb247CmFiTWVudUJ1dHRvbi5hYk1lbnVSZWZyZXNoID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwphYk1lbnVCdXR0b24uYmFzZVNraWxsID0gIvCflJciICsgbGlua3MuYXNrLmlkOwphYk1lbnVCdXR0b24ubGFiZWwgPSBsaW5rcy5hc2sudGFncy5hYkNvcmVNZW51TGFiZWw7CmFiTWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9IGxpbmtzLmFzay50YWdzLmFiQ29yZU1lbnVJY29uOwphYk1lbnVCdXR0b24ub25DcmVhdGUgPSBsaW5rcy5hc2sudGFncy5hYkNvcmVNZW51T25HZW5lcmF0ZTsKYWJNZW51QnV0dG9uLmFiTWVudVNvcnRPcmRlciA9IGxpbmtzLmFzay50YWdzLmFiQ29yZU1lbnVTb3J0T3JkZXI7CmFiTWVudUJ1dHRvbi5jb2xvciA9IGxpbmtzLmFzay50YWdzLmFiQ29yZU1lbnVDb2xvciA/IGxpbmtzLmFzay50YWdzLmFiQ29yZU1lbnVDb2xvciA6IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3I7CgpsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihhYk1lbnVCdXR0b24pOycA/ciohg77hwEJYWJCb3RDaGF0AgQA/ciohg6z2wHBC0BpZiAoIWxpbmtzLmFiQm90ICYmICF0aGF0LmJvdCkKewogICAgcmV0dXJuOwp9Cgpjb25zdCBib3RCYXNlID0gdGhhdC5ib3QgPyB0aGF0LmJvdDogbGlua3MuYWJCb3Q7CmNvbnN0IGRpbWVuc2lvbiA9ICF0aGF0LmJvdCA/IGJvdEJhc2UudGFncy5kaW1lbnNpb24gOiB0aGF0LmRpbWVuc2lvbiA/IHRoYXQuZGltZW5zaW9uIDogY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbDsKY29uc3QgbWVzc2FnZSA9IHRoYXQubWVzc2FnZTsKY29uc3QgbWVzc2FnZVRpbWUgPSB0aGF0LnRpbWUgPyB0aGF0LnRpbWUgKiAxMDAwIDogMTYwMDsgCmNvbnN0IG1lc3NhZ2VCb3QgPSB7fTsKCm1lc3NhZ2VCb3Quc3BhY2UgPSAidGVtcExvY2FsIjsKbWVzc2FnZUJvdC50cmFuc2Zvcm1lciA9IGJvdEJhc2UuaWQ7Cm1lc3NhZ2VCb3QuZm9ybSA9ICJzcHJpdGUiOwptZXNzYWdlQm90LmNvbG9yID0gIiMwMDAwMDAiOwptZXNzYWdlQm90LmxhYmVsID0gbWVzc2FnZTsKbWVzc2FnZUJvdC5sYWJlbENvbG9yID0gIiNmZmZmZmYiOwptZXNzYWdlQm90LmxhYmVsU2l6ZSA9IDE7Cm1lc3NhZ2VCb3Quc2NhbGVYID0gbWVzc2FnZS5sZW5ndGggLyA1ID4gMTAgPyAxMCA6IG1lc3NhZ2UubGVuZ3RoIDwgMTAgPyAyIDogbWVzc2FnZS5sZW5ndGggLyA1OwptZXNzYWdlQm90LnNjYWxlWSA9IChtZXNzYWdlLmxlbmd0aCAvIDUwKSA+IDEgPyBNYXRoLnJvdW5kKG1lc3NhZ2UubGVuZ3RoIC8gNTApIDogMS4zMzsKbWVzc2FnZUJvdC5zY2FsZVogPSAwLjE7Cm1lc3NhZ2VCb3Qub3JpZW50YXRpb25Nb2RlID0gImJpbGxib2FyZCI7Cm1lc3NhZ2VCb3RbZGltZW5zaW9uXSA9IHRydWU7Cm1lc3NhZ2VCb3QuZGltZW5zaW9uID0gZGltZW5zaW9uOwptZXNzYWdlQm90W2RpbWVuc2lvbiArICJYIl0gPSAwOwptZXNzYWdlQm90W2RpbWVuc2lvbiArICJZIl0gPSAwOwptZXNzYWdlQm90W2RpbWVuc2lvbiArICJaIl0gPSBib3RCYXNlLnRhZ3Muc2NhbGUgPyBib3RCYXNlLnRhZ3Muc2NhbGUgLyAyICsgMiA6IDI7Cm1lc3NhZ2VCb3Qub25GYWRlID0gYEAgYXdhaXQgYW5pbWF0ZVRhZyh0aGlzQm90LCB7CiAgICBmcm9tVmFsdWU6IHsKICAgICAgICBmb3JtT3BhY2l0eTogMSwKICAgICAgICBsYWJlbE9wYWNpdHk6IDEsCiAgICAgICAgW3RhZ3MuZGltZW5zaW9uICsgIloiXTogdGFnc1t0YWdzLmRpbWVuc2lvbiArICJaIl0KICAgIH0sCiAgICB0b1ZhbHVlOiB7CiAgICAgICAgZm9ybU9wYWNpdHk6IDAsCiAgICAgICAgbGFiZWxPcGFjaXR5OiAwLAogICAgICAgIFt0YWdzLmRpbWVuc2lvbiArICJaIl06IHRhZ3NbdGFncy5kaW1lbnNpb24gKyAiWiJdICsgNQogICAgfSwKICAgIGR1cmF0aW9uOiAzCn0pLmNhdGNoKHt9KTsKCmRlc3Ryb3kodGhpc0JvdCk7YDsKCmNvbnN0IGFjdGl2ZU1lc3NhZ2UgPSBjcmVhdGUobWVzc2FnZUJvdCk7CgpzZXRUaW1lb3V0KCgpPT4gYWN0aXZlTWVzc2FnZS5vbkZhZGUoKSwgbWVzc2FnZVRpbWUpOycA/ciohg77hwEQb25BbnlCb3REcmFnZ2luZwIEAP3IqIYO9eYBhRBAaWYgKGxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiTXVsdGlwbGVCb3RGb2N1cyAmJiB0aGF0LmJvdC5pZCA9PSBsaW5rcy5hYkJvdC5pZCkKewogICAgY29uc3QgYWN0aXZlRGltZW5zaW9uID0gbGlua3MucmVtZW1iZXIubWFza3MuYWJBY3RpdmVEaW1lbnNpb24gPz8gY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbDsKICAgIGxldCBkcmFnQ29vcmRpbmF0b3JCb3QgPSBsaW5rcy5kcmFnQ29vcmQ7CgogICAgaWYgKCFkcmFnQ29vcmRpbmF0b3JCb3QpCiAgICB7CiAgICAgICAgY29uc3QgZHJhZ0Nvb3JkaW5hdG9yQm90TW9kID0ge307CgogICAgICAgIGRyYWdDb29yZGluYXRvckJvdE1vZC5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwogICAgICAgIGRyYWdDb29yZGluYXRvckJvdE1vZC5tYW5hZ2VyID0gZ2V0TGluayh0aGlzQm90KTsKICAgICAgICBkcmFnQ29vcmRpbmF0b3JCb3RNb2QuZGltZW5zaW9uID0gYWN0aXZlRGltZW5zaW9uOwogICAgICAgIGRyYWdDb29yZGluYXRvckJvdE1vZFthY3RpdmVEaW1lbnNpb25dID0gdHJ1ZTsKICAgICAgICBkcmFnQ29vcmRpbmF0b3JCb3RNb2RbYWN0aXZlRGltZW5zaW9uICsgIlgiXSA9IDA7CiAgICAgICAgZHJhZ0Nvb3JkaW5hdG9yQm90TW9kW2FjdGl2ZURpbWVuc2lvbiArICJZIl0gPSAwOwogICAgICAgIGRyYWdDb29yZGluYXRvckJvdE1vZFthY3RpdmVEaW1lbnNpb24gKyAiWiJdID0gLTE7CiAgICAgICAgZHJhZ0Nvb3JkaW5hdG9yQm90TW9kLnBvaW50YWJsZSA9IGZhbHNlOwogICAgICAgIGRyYWdDb29yZGluYXRvckJvdE1vZC5jb2xvciA9ICJjbGVhciI7CiAgICAgICAgZHJhZ0Nvb3JkaW5hdG9yQm90TW9kLm9uQW55Qm90UG9pbnRlclVwID0gYEAgbGlua3MubWFuYWdlci5tYXNrcy5kcmFnQ29vcmQgPSBudWxsOyBzaG91dCgnYWJTdG9wRHJhZycsIHt4OiB0YWdzLiR7YWN0aXZlRGltZW5zaW9ufVgsIHk6IHRhZ3MuJHthY3RpdmVEaW1lbnNpb259WX0pOyBkZXN0cm95KHRoaXNCb3QpO2A7CgogICAgICAgIGRyYWdDb29yZGluYXRvckJvdCA9IGNyZWF0ZShkcmFnQ29vcmRpbmF0b3JCb3RNb2QpOwoKICAgICAgICBtYXNrcy5kcmFnQ29vcmQgPSBnZXRMaW5rKGRyYWdDb29yZGluYXRvckJvdCk7CgogICAgICAgIGNvbnN0IGRyYWdCb3RzID0gbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzOwoKICAgICAgICBsaW5rcy5hYkJvdC5tYXNrcy50cmFuc2Zvcm1lciA9IGRyYWdDb29yZGluYXRvckJvdC5pZDsKICAgICAgICBsaW5rcy5hYkJvdC5tYXNrcy5hYlN0b3BEcmFnID0gYEAgbWFza3MudHJhbnNmb3JtZXIgPSBudWxsOyBtYXNrcy5hYlN0b3BEcmFnID0gbnVsbDsgdGFncy4ke2FjdGl2ZURpbWVuc2lvbn1YID0gdGFncy4ke2FjdGl2ZURpbWVuc2lvbn1YICsgdGhhdC54OyB0YWdzLiR7YWN0aXZlRGltZW5zaW9ufVkgPSB0YWdzLiR7YWN0aXZlRGltZW5zaW9ufVkgKyB0aGF0LnlgOwoKICAgICAgICBzZXRUYWdNYXNrKGRyYWdCb3RzLCAidHJhbnNmb3JtZXIiLCBkcmFnQ29vcmRpbmF0b3JCb3QuaWQsICJ0ZW1wTG9jYWwiKTsKICAgICAgICBzZXRUYWdNYXNrKGRyYWdCb3RzLCAiYWJTdG9wRHJhZyIsIGBAIG1hc2tzLnRyYW5zZm9ybWVyID0gbnVsbDsgbWFza3MuYWJTdG9wRHJhZyA9IG51bGw7IHRhZ3MuJHthY3RpdmVEaW1lbnNpb259WCA9IHRhZ3MuJHthY3RpdmVEaW1lbnNpb259WCArIHRoYXQueDsgdGFncy4ke2FjdGl2ZURpbWVuc2lvbn1ZID0gdGFncy4ke2FjdGl2ZURpbWVuc2lvbn1ZICsgdGhhdC55YCwgInRlbXBMb2NhbCIpOwogICAgfQoKICAgIGNvbnN0IHhDaGFuZ2UgPSB0aGF0LnRvLnggLSB0aGF0LmZyb20ueDsKICAgIGNvbnN0IHlDaGFuZ2UgPSB0aGF0LnRvLnkgLSB0aGF0LmZyb20ueTsKCiAgICBkcmFnQ29vcmRpbmF0b3JCb3QudGFnc1thY3RpdmVEaW1lbnNpb24gKyAiWCJdID0geENoYW5nZTsKICAgIGRyYWdDb29yZGluYXRvckJvdC50YWdzW2FjdGl2ZURpbWVuc2lvbiArICJZIl0gPSB5Q2hhbmdlOwogICAgZHJhZ0Nvb3JkaW5hdG9yQm90LnRhZ3NbYWN0aXZlRGltZW5zaW9uICsgIloiXSA9IC0xOwp9AA=="}]}